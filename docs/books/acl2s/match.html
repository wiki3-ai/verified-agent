<!DOCTYPE html>
<html lang="en" vocab="http://schema.org/" typeof="SoftwareSourceCode">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>match - ACL2 Book</title>
  <meta property="name" content="match">
  <meta property="programmingLanguage" content="ACL2">
  
<style>
/* ACL2 Book HTML Documentation Styles */
/* Generated by cert2 - build2 system */

/* Dark theme (default) */
:root {
  --bg: #1e1e2e;
  --fg: #cdd6f4;
  --comment: #6c7086;
  --keyword: #cba6f7;
  --string: #a6e3a1;
  --function: #89b4fa;
  --type: #f9e2af;
  --link: #89dceb;
  --link-hover: #f5c2e7;
  --highlight: rgba(137, 180, 250, 0.2);
  --border: #313244;
  --block-bg: rgba(49, 50, 68, 0.5);
  --btn-bg: #313244;
  --btn-hover: rgba(137, 180, 250, 0.2);
}

/* Light theme */
[data-theme="light"] {
  --bg: #eff1f5;
  --fg: #4c4f69;
  --comment: #6c6f85;
  --keyword: #8839ef;
  --string: #40a02b;
  --function: #1e66f5;
  --type: #df8e1d;
  --link: #04a5e5;
  --link-hover: #ea76cb;
  --highlight: rgba(30, 102, 245, 0.15);
  --border: #ccd0da;
  --block-bg: rgba(204, 208, 218, 0.3);
  --btn-bg: #ccd0da;
  --btn-hover: rgba(30, 102, 245, 0.15);
}

body {
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  background: var(--bg);
  color: var(--fg);
  margin: 0;
  padding: 20px;
  line-height: 1.6;
  font-size: 14px;
  transition: background 0.1s, color 0.1s;
}

/* Controls toolbar */
.controls-left {
  position: fixed;
  top: 10px;
  left: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
  transition: transform 0.1s ease;
}

.controls-right {
  position: fixed;
  top: 10px;
  right: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
}

.control-btn {
  padding: 6px 12px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-family: inherit;
  font-size: 14px;
  transition: all 0.1s;
}

.control-btn:hover {
  background: var(--btn-hover);
  border-color: var(--link);
}

.name-filter {
  padding: 6px 10px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  font-family: inherit;
  font-size: 13px;
  width: 150px;
  transition: all 0.1s;
}

.name-filter:focus {
  outline: none;
  border-color: var(--link);
  width: 200px;
}

.name-filter::placeholder {
  color: var(--comment);
}

.regex-label {
  display: flex;
  align-items: center;
  gap: 4px;
  color: var(--comment);
  font-size: 12px;
  cursor: pointer;
}

.regex-label input {
  cursor: pointer;
}

.book-header {
  border-bottom: 2px solid var(--border);
  padding-bottom: 20px;
  margin-bottom: 20px;
}

.book-header h1 {
  color: var(--keyword);
  margin: 0;
}

.book-header .path {
  color: var(--comment);
  font-size: 0.9em;
}

.book-header .path .source-link {
  color: var(--comment);
  text-decoration: none;
}

.book-header .path .source-link:hover {
  color: var(--link);
  text-decoration: underline;
}

.form-block {
  margin: 10px 0;
  padding: 15px;
  background: var(--block-bg);
  border-radius: 8px;
  border-left: 3px solid var(--border);
}

.form-block.theorem { border-left-color: var(--keyword); }
.form-block.function { border-left-color: var(--function); }
.form-block.macro { border-left-color: var(--type); }
.form-block.include-book { border-left-color: var(--string); }

.form-block.hidden { display: none; }
.form-block.dimmed { opacity: 0.3; }

.form-block.highlight {
  animation: highlight-pulse 0.4s ease-out;
}

@keyframes highlight-pulse {
  0% { background: var(--highlight); box-shadow: 0 0 20px var(--link); }
  100% { background: rgba(49, 50, 68, 0.5); box-shadow: none; }
}

.form-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.form-name {
  color: var(--function);
  font-weight: bold;
  cursor: pointer;
}

.form-name:hover {
  color: var(--link-hover);
  text-decoration: underline;
}

.form-type {
  color: var(--comment);
  font-size: 0.85em;
}

pre.code {
  margin: 0;
  overflow-x: auto;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.sym-ref {
  color: var(--link);
  cursor: pointer;
  border-radius: 2px;
}

.sym-ref:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.sym-ref.local-def { color: var(--function); font-weight: bold; }
.sym-ref.external { color: var(--type); }

/* Symbol links (clickable hyperlinks) */
.sym-link {
  color: var(--link);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
  position: relative;
}

.sym-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

.sym-link.local-def {
  color: var(--function);
  font-weight: bold;
}

.sym-link.external {
  color: var(--type);
}

/* Tooltips using title attribute with custom styling */
.sym-link[title] {
  /* Browser will show title on hover */
}

/* Syntax highlighting in code blocks */
.keyword {
  color: var(--keyword);
}

.string {
  color: var(--string);
}

.number {
  color: #f77524; /* orange */
}

/* Include-book path links */
.include-path {
  color: var(--string);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
}

.include-path:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

/* Part buttons for defthm */
.part-buttons {
  display: flex;
  gap: 5px;
  margin: 10px 0;
  flex-wrap: wrap;
}

.part-btn {
  padding: 4px 10px;
  background: var(--border);
  border: 1px solid var(--comment);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-size: 0.85em;
  font-family: inherit;
}

.part-btn:hover {
  background: var(--highlight);
  border-color: var(--link);
}

.part-btn.active {
  background: var(--link);
  color: var(--bg);
  border-color: var(--link);
}

/* References panel */
.refs-panel {
  margin-top: 10px;
  padding: 10px;
  background: rgba(0,0,0,0.2);
  border-radius: 4px;
  display: none;
}

.refs-panel.visible { display: block; }

.refs-panel h4 {
  margin: 0 0 5px 0;
  color: var(--comment);
  font-size: 0.9em;
}

.refs-list {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

/* Included books section */
.includes-section {
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(49, 50, 68, 0.3);
  border-radius: 8px;
  border: 1px solid var(--border);
}

.includes-section h2 {
  margin: 0 0 10px 0;
  color: var(--comment);
  font-size: 1em;
  font-weight: normal;
}

.includes-list {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.include-link {
  padding: 6px 12px;
  background: var(--border);
  border-radius: 4px;
  color: var(--link);
  text-decoration: none;
  font-size: 0.9em;
  transition: all 0.1s;
}

.include-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.include-link.local {
  border-left: 2px solid var(--comment);
}

/* Filter status */
.filter-status {
  position: fixed;
  top: 10px;
  left: 20px;
  background: var(--bg);
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: 4px;
  z-index: 201;
  display: none;
  align-items: center;
  gap: 10px;
}

.filter-status.active {
  display: flex;
  align-items: center;
  gap: 10px;
}

.clear-filter {
  padding: 5px 15px;
  background: var(--keyword);
  color: var(--bg);
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

/* RDFa vocab indicator */
[vocab] { /* semantic web annotations present */ }

</style>

</head>
<body>
  <div class="controls-left">
    <input type="text" id="name-filter" class="name-filter" placeholder="Filter by name..." title="Filter definitions by name">
    <label class="regex-label"><input type="checkbox" id="regex-toggle"> regex</label>
  </div>

  <div class="controls-right">
    <button class="control-btn" id="theme-toggle" title="Toggle light/dark theme">☀️</button>
    <button class="control-btn" id="font-smaller" title="Decrease font size">A-</button>
    <button class="control-btn" id="font-larger" title="Increase font size">A+</button>
  </div>

  <div class="filter-status">
    <span class="filter-text">Filtering...</span>
    <button class="clear-filter">Clear Filter</button>
  </div>
  
  <div class="book-header">
    <h1 property="name">match</h1>
    <div class="path"><a href="match.lisp" class="source-link">books/acl2s/match</a></div>
  </div>
  
  <main property="text">
<div class="form-block other" id="form-0" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-in-package" data-sym="IN-PACKAGE">in-package</a> <span class="string">"ACL2S"</span>)</pre>
  </div>

<div class="form-block other" id="form-1" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../acl2s/ccg/ccg.html" title="Open acl2s/ccg/ccg">"acl2s/ccg/ccg"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span> <span class="keyword">:uncertified-okp</span> nil <span class="keyword">:ttags</span> ((<span class="keyword">:ccg</span>)) <span class="keyword">:load-compiled-file</span> nil)</pre>
  </div>

<div class="form-block other" id="form-2" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(set-termination-method <span class="keyword">:ccg</span>)</pre>
  </div>

<div class="form-block other" id="form-3" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="definec.html" title="Open definec">"definec"</a> <span class="keyword">:ttags</span> <span class="keyword">:all</span>)</pre>
  </div>

<div class="form-block other" id="form-4" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="base-lists.html" title="Open base-lists">"base-lists"</a> <span class="keyword">:ttags</span> <span class="keyword">:all</span>)</pre>
  </div>

<div class="form-block other" id="form-5" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="base-arithmetic.html" title="Open base-arithmetic">"base-arithmetic"</a> <span class="keyword">:ttags</span> <span class="keyword">:all</span>)</pre>
  </div>

<div class="form-block other" id="form-6" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(definec get-type-from-keyword
  (k <span class="keyword">:keyword</span>)
  <span class="keyword">:symbol</span> (<a class="sym-link system" href="../../axioms.html#def-case" data-sym="CASE">case</a> k
    (<span class="keyword">:atom</span> '<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a>)
    (otherwise (make-symbl `(,(SYMBOL-NAME ACL2S::K) p)
        <span class="string">"ACL2S"</span>))))</pre>
  </div>

<div class="form-block other" id="form-7" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable <a class="sym-link system" href="../../axioms.html#def-strip-cars" data-sym="STRIP-CARS">strip-cars</a> <a class="sym-link system" href="../../axioms.html#def-strip-cdrs" data-sym="STRIP-CDRS">strip-cdrs</a>)))</pre>
  </div>

<div class="form-block other" id="form-8" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> acl2s-size-consp
  (=&gt; (consp x)
    (&lt; <span class="number">0</span> (acl2s-size x)))
  <span class="keyword">:rule-classes</span> ((<span class="keyword">:linear</span>) (<span class="keyword">:type-prescription</span>)))</pre>
  </div>

<div class="form-block other" id="form-9" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> acl2s-size-of-car
  (<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (equal (acl2s-size (car x))
      (acl2s-size x))
    (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> x))
  <span class="keyword">:rule-classes</span> (<span class="keyword">:forward-chaining</span>))</pre>
  </div>

<div class="form-block other" id="form-10" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> acl2s-size-cdr
  (<a class="sym-link system" href="../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> (acl2s-size (cdr x))
    (acl2s-size x))
  <span class="keyword">:rule-classes</span> <span class="keyword">:linear</span>)</pre>
  </div>

<div class="form-block other" id="form-11" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> acl2s-size-car
  (<a class="sym-link system" href="../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> (acl2s-size (car x))
    (acl2s-size x))
  <span class="keyword">:rule-classes</span> <span class="keyword">:linear</span>)</pre>
  </div>

<div class="form-block other" id="form-12" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> acl2s-size-&lt;=-strip-cdrs
  (<a class="sym-link system" href="../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> (acl2s-size (<a class="sym-link system" href="../../axioms.html#def-strip-cdrs" data-sym="STRIP-CDRS">strip-cdrs</a> x))
    (acl2s-size x))
  <span class="keyword">:rule-classes</span> <span class="keyword">:linear</span>)</pre>
  </div>

<div class="form-block other" id="form-13" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> acl2s-size-&lt;=-strip-cars
  (<a class="sym-link system" href="../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> (acl2s-size (<a class="sym-link system" href="../../axioms.html#def-strip-cars" data-sym="STRIP-CARS">strip-cars</a> x))
    (acl2s-size x))
  <span class="keyword">:rule-classes</span> <span class="keyword">:linear</span>)</pre>
  </div>

<div class="form-block other" id="form-14" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> acl2s-size-&lt;-strip-cars
  (=&gt; (consp (car x))
    (&lt; (acl2s-size (<a class="sym-link system" href="../../axioms.html#def-strip-cars" data-sym="STRIP-CARS">strip-cars</a> x))
      (acl2s-size x)))
  <span class="keyword">:rule-classes</span> <span class="keyword">:linear</span>)</pre>
  </div>

<div class="form-block other" id="form-15" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> acl2s-size-&lt;-strip-cdrs
  (=&gt; (consp (car x))
    (&lt; (acl2s-size (<a class="sym-link system" href="../../axioms.html#def-strip-cdrs" data-sym="STRIP-CDRS">strip-cdrs</a> x))
      (acl2s-size x)))
  <span class="keyword">:rule-classes</span> <span class="keyword">:linear</span>)</pre>
  </div>

<div class="form-block other" id="form-16" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> strip-cars-cdrs-=
  (=&gt; (<a class="sym-link system" href="../../axioms.html#def-alistp" data-sym="ALISTP">alistp</a> x)
    (<a class="sym-link system" href="../../axioms.html#def-_3D" data-sym="=">=</a> (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> (acl2s-size (<a class="sym-link system" href="../../axioms.html#def-strip-cars" data-sym="STRIP-CARS">strip-cars</a> x))
        (acl2s-size (<a class="sym-link system" href="../../axioms.html#def-strip-cdrs" data-sym="STRIP-CDRS">strip-cdrs</a> x)))
      (acl2s-size x)))
  <span class="keyword">:rule-classes</span> <span class="keyword">:linear</span>)</pre>
  </div>

<div class="form-block other" id="form-17" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(definec len1tl
  (x <span class="keyword">:all</span>)
  <span class="keyword">:bool</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (consp x) (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> (cdr x))))</pre>
  </div>

<div class="form-block other" id="form-18" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(definec match-type
  (pat <span class="keyword">:all</span>)
  <span class="keyword">:symbol</span> (<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> pat)
      (get-type-from-keyword pat))
    (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (consp pat)
      (consp (cdr pat))
      (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> (<a class="sym-link system" href="../../axioms.html#def-cddr" data-sym="CDDR">cddr</a> pat))
      (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (car pat) <span class="keyword">:r</span>)
      (symbolp (<a class="sym-link system" href="../../axioms.html#def-second" data-sym="SECOND">second</a> pat))
      (<a class="sym-link system" href="../../axioms.html#def-second" data-sym="SECOND">second</a> pat))))</pre>
  </div>

<div class="form-block other" id="form-19" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(definec match-or
  (pat <span class="keyword">:all</span>)
  <span class="keyword">:tl</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (consp pat)
    (consp (cdr pat))
    (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (car pat) <span class="keyword">:or</span>)
    (tlp pat)
    (cdr pat)))</pre>
  </div>

<div class="form-block other" id="form-20" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(definec match-t
  (pat <span class="keyword">:all</span>)
  <span class="keyword">:tl</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (consp pat)
    (consp (cdr pat))
    (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> (<a class="sym-link system" href="../../axioms.html#def-cddr" data-sym="CDDR">cddr</a> pat))
    (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (car pat) <span class="keyword">:t</span>)
    (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (<a class="sym-link system" href="../../axioms.html#def-second" data-sym="SECOND">second</a> pat))))</pre>
  </div>

<div class="form-block other" id="form-21" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(definec match-pats-codes
  (pats <span class="keyword">:tl</span> codes <span class="keyword">:true-list-list</span>)
  <span class="keyword">:bool</span> (declare (xargs <span class="keyword">:consider-only-ccms</span> ((acl2s-size codes))))
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> pats) (<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> codes))
    ((<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> codes) (<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> pats))
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (b* ((pat (car pats)) (code (car codes))
          (type? (match-type pat)))
        (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((! type?) (^ (len1tl code)
              (match-pats-codes (cdr pats)
                (cdr codes))))
          ((len1tl code) (match-pats-codes (cdr pats)
              (cdr codes)))
          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (^ (<a class="sym-link system" href="../../axioms.html#def-alistp" data-sym="ALISTP">alistp</a> code)
              (b* ((npats (<a class="sym-link system" href="../../axioms.html#def-strip-cars" data-sym="STRIP-CARS">strip-cars</a> code)) (ncodes (<a class="sym-link system" href="../../axioms.html#def-strip-cdrs" data-sym="STRIP-CDRS">strip-cdrs</a> code)))
                (^ (<a class="sym-link system" href="../../axioms.html#def-true-list-listp" data-sym="TRUE-LIST-LISTP">true-list-listp</a> ncodes)
                  (match-pats-codes npats ncodes)
                  (match-pats-codes (cdr pats)
                    (cdr codes)))))))))))</pre>
  </div>

<div class="form-block other" id="form-22" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> march-pats-codes-or
  (=&gt; (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (match-pats-codes (cons (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> <span class="keyword">:or</span> pats5 pats6) pats2)
        codes)
      (<a class="sym-link system" href="../../axioms.html#def-true-list-listp" data-sym="TRUE-LIST-LISTP">true-list-listp</a> codes)
      (tlp pats2))
    (match-pats-codes (cons (cons <span class="keyword">:or</span> pats6) pats2)
      codes)))</pre>
  </div>

<div class="form-block other" id="form-23" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> symbol-doublet-listp-assoc-equal
  (<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-symbol-doublet-listp" data-sym="SYMBOL-DOUBLET-LISTP">symbol-doublet-listp</a> bindings)
      (<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (consp (cdr (<a class="sym-link system" href="../../axioms.html#def-assoc-equal" data-sym="ASSOC-EQUAL">assoc-equal</a> pat bindings)))))
    (<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (cdr (<a class="sym-link system" href="../../axioms.html#def-assoc-equal" data-sym="ASSOC-EQUAL">assoc-equal</a> pat bindings)))))</pre>
  </div>

<div class="form-block function" id="def-match-tests-and-bindings" data-defines="MATCH-TESTS-AND-BINDINGS" data-references="BINDINGS1,TESTS1,MV-LET,SYMBOL-NAME-EQUAL,QUOTE~,CDDR,CDR,CONSP,CAR,EQUAL-X-CONSTANT,ATOM,CADR,NULL,ASSOC-EQ,BINDING,&,SUBSEQ,INTERN-IN-PACKAGE-OF-SYMBOL,EQUAL,1-,CHAR,EQL,>,SYMBOL-NAME,LENGTH,LEN,LET,QUOTE,KEYWORDP,T,EQ,OR,SYMBOLP,LIST,CONS,MV,COND,MATCH-TYPE,TYPE?,B*,TLP,SYMBOL-DOUBLET-LISTP,AND,XARGS,DECLARE,BINDINGS,TESTS,PAT,X,DEFUN" data-used-by="MATCH-CLAUSE" data-part-name="MATCH-TESTS-AND-BINDINGS" data-part-args="BINDINGS,TESTS,PAT,X" data-part-declare="TESTS,TLP,BINDINGS,SYMBOL-DOUBLET-LISTP,AND,XARGS,DECLARE" data-part-body="MATCH-TESTS-AND-BINDINGS,BINDINGS1,TESTS1,MV-LET,SYMBOL-NAME-EQUAL,QUOTE~,CDDR,CDR,CONSP,CAR,EQUAL-X-CONSTANT,ATOM,CADR,NULL,ASSOC-EQ,BINDING,&,SUBSEQ,INTERN-IN-PACKAGE-OF-SYMBOL,EQUAL,1-,CHAR,EQL,>,AND,SYMBOL-NAME,LENGTH,LEN,LET,QUOTE,KEYWORDP,T,EQ,OR,SYMBOLP,BINDINGS,TESTS,X,LIST,CONS,MV,COND,PAT,MATCH-TYPE,TYPE?,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="MATCH-TESTS-AND-BINDINGS">match-tests-and-bindings</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-match-tests-and-bindings" data-sym="MATCH-TESTS-AND-BINDINGS" title="(defun acl2s::match-tests-and-bindings
       (acl2s::x acl2s::pat acl2s::tests acl2s::bindings)
  (declare
   (acl2s::xargs :guard
    (and (acl2s::symbol-doublet-listp acl2s::bindings)
...">match-tests-and-bindings</a>
  (x pat tests bindings)
  (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-symbol-doublet-listp" data-sym="SYMBOL-DOUBLET-LISTP">symbol-doublet-listp</a> bindings)
        (tlp tests)
        (tlp bindings))
      <span class="keyword">:verify-guards</span> nil))
  (b* ((type? (match-type pat)))
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (type? (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (cons (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> type? x) tests)
          bindings))
      ((symbolp pat) (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> pat <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>)
             (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> pat nil)
             (<a class="sym-link system" href="../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> pat)) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (cons (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> '<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> x pat) tests)
              bindings))
          ((let ((<a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> (symbol-name pat))))
             (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-_3E" data-sym="&gt;">&gt;</a> <a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> <span class="number">0</span>)
               (<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> #\* (<a class="sym-link system" href="../../axioms.html#def-char" data-sym="CHAR">char</a> (symbol-name pat) <span class="number">0</span>))
               (<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> #\* (<a class="sym-link system" href="../../axioms.html#def-char" data-sym="CHAR">char</a> (symbol-name pat) (<a class="sym-link system" href="../../axioms.html#def-1-" data-sym="1-">1-</a> <a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a>))))) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (cons (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> 'equal x pat) tests)
              bindings))
          ((<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-_3E" data-sym="&gt;">&gt;</a> (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> (symbol-name pat)) <span class="number">0</span>)
             (<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> #\! (<a class="sym-link system" href="../../axioms.html#def-char" data-sym="CHAR">char</a> (symbol-name pat) <span class="number">0</span>))) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (cons (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> 'equal
                  x
                  (intern-in-package-of-symbol (<a class="sym-link system" href="../../axioms.html#def-subseq" data-sym="SUBSEQ">subseq</a> (symbol-name pat)
                      <span class="number">1</span>
                      (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> (symbol-name pat)))
                    pat))
                tests)
              bindings))
          ((<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> pat '&amp;) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> tests bindings))
          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (let ((binding (<a class="sym-link system" href="../../axioms.html#def-assoc-eq" data-sym="ASSOC-EQ">assoc-eq</a> pat bindings)))
              (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> binding) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> tests
                    (cons (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> pat x) bindings)))
                (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (cons (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> 'equal x (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> binding))
                      tests)
                    bindings)))))))
      ((<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> pat) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (cons (<a class="sym-link system" href="../../basis-a.html#def-equal-x-constant" data-sym="EQUAL-X-CONSTANT">equal-x-constant</a> x (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> 'quote pat))
            tests)
          bindings))
      ((<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (car pat) 'quote)
         (consp (cdr pat))
         (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> (<a class="sym-link system" href="../../axioms.html#def-cddr" data-sym="CDDR">cddr</a> pat))) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (cons (<a class="sym-link system" href="../../basis-a.html#def-equal-x-constant" data-sym="EQUAL-X-CONSTANT">equal-x-constant</a> x pat) tests)
          bindings))
      ((<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (car pat) 'quote~)
         (consp (cdr pat))
         (symbolp (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> pat))
         (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> (<a class="sym-link system" href="../../axioms.html#def-cddr" data-sym="CDDR">cddr</a> pat))) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (cons (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> 'symbol-name-equal
              x
              (symbol-name (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> pat)))
            tests)
          bindings))
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (tests1 bindings1)
          (<a class="sym-link local-def" href="#def-match-tests-and-bindings" data-sym="MATCH-TESTS-AND-BINDINGS" title="(defun acl2s::match-tests-and-bindings
       (acl2s::x acl2s::pat acl2s::tests acl2s::bindings)
  (declare
   (acl2s::xargs :guard
    (and (acl2s::symbol-doublet-listp acl2s::bindings)
...">match-tests-and-bindings</a> (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> 'car x)
            (car pat)
            (cons (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> 'consp x) tests)
            bindings)
          (<a class="sym-link local-def" href="#def-match-tests-and-bindings" data-sym="MATCH-TESTS-AND-BINDINGS" title="(defun acl2s::match-tests-and-bindings
       (acl2s::x acl2s::pat acl2s::tests acl2s::bindings)
  (declare
   (acl2s::xargs :guard
    (and (acl2s::symbol-doublet-listp acl2s::bindings)
...">match-tests-and-bindings</a> (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> 'cdr x)
            (cdr pat)
            tests1
            bindings1))))))</pre>
  </div>

<div class="form-block other" id="form-25" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> match-tests-and-bindings-guards1
  (<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (tlp y)
    (tlp (<a class="sym-link system" href="../../axioms.html#def-mv-nth" data-sym="MV-NTH">mv-nth</a> <span class="number">0</span>
        (<a class="sym-link local-def" href="#def-match-tests-and-bindings" data-sym="MATCH-TESTS-AND-BINDINGS" title="(defun acl2s::match-tests-and-bindings
       (acl2s::x acl2s::pat acl2s::tests acl2s::bindings)
  (declare
   (acl2s::xargs :guard
    (and (acl2s::symbol-doublet-listp acl2s::bindings)
...">match-tests-and-bindings</a> x
          pat
          y
          z))))
  <span class="keyword">:rule-classes</span> <span class="keyword">:type-prescription</span>)</pre>
  </div>

<div class="form-block other" id="form-26" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> match-tests-and-bindings-guards3
  (<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (tlp z)
    (tlp (<a class="sym-link system" href="../../axioms.html#def-mv-nth" data-sym="MV-NTH">mv-nth</a> <span class="number">1</span>
        (<a class="sym-link local-def" href="#def-match-tests-and-bindings" data-sym="MATCH-TESTS-AND-BINDINGS" title="(defun acl2s::match-tests-and-bindings
       (acl2s::x acl2s::pat acl2s::tests acl2s::bindings)
  (declare
   (acl2s::xargs :guard
    (and (acl2s::symbol-doublet-listp acl2s::bindings)
...">match-tests-and-bindings</a> x
          pat
          y
          z))))
  <span class="keyword">:rule-classes</span> <span class="keyword">:type-prescription</span>)</pre>
  </div>

<div class="form-block other" id="form-27" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> match-tests-and-bindings-guards2
  (<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../axioms.html#def-symbol-doublet-listp" data-sym="SYMBOL-DOUBLET-LISTP">symbol-doublet-listp</a> z)
    (<a class="sym-link system" href="../../axioms.html#def-symbol-doublet-listp" data-sym="SYMBOL-DOUBLET-LISTP">symbol-doublet-listp</a> (<a class="sym-link system" href="../../axioms.html#def-mv-nth" data-sym="MV-NTH">mv-nth</a> <span class="number">1</span>
        (<a class="sym-link local-def" href="#def-match-tests-and-bindings" data-sym="MATCH-TESTS-AND-BINDINGS" title="(defun acl2s::match-tests-and-bindings
       (acl2s::x acl2s::pat acl2s::tests acl2s::bindings)
  (declare
   (acl2s::xargs :guard
    (and (acl2s::symbol-doublet-listp acl2s::bindings)
...">match-tests-and-bindings</a> x
          pat
          y
          z)))))</pre>
  </div>

<div class="form-block other" id="form-28" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-verify-guards" data-sym="VERIFY-GUARDS">verify-guards</a> <a class="sym-link local-def" href="#def-match-tests-and-bindings" data-sym="MATCH-TESTS-AND-BINDINGS" title="(defun acl2s::match-tests-and-bindings
       (acl2s::x acl2s::pat acl2s::tests acl2s::bindings)
  (declare
   (acl2s::xargs :guard
    (and (acl2s::symbol-doublet-listp acl2s::bindings)
...">match-tests-and-bindings</a>)</pre>
  </div>

<div class="form-block function" id="def-match-clause" data-defines="MATCH-CLAUSE" data-references="LET,REVERSE,AND,QUOTE,CONS,NULL,IF,LIST,MATCH-TESTS-AND-BINDINGS,BINDINGS,TESTS,MV-LET,T,XARGS,DECLARE,FORMS,PAT,X,DEFUN" data-part-name="MATCH-CLAUSE" data-part-args="FORMS,PAT,X" data-part-declare="T,XARGS,DECLARE" data-part-body="FORMS,LET,REVERSE,AND,QUOTE,CONS,T,NULL,IF,LIST,PAT,X,MATCH-TESTS-AND-BINDINGS,BINDINGS,TESTS,MV-LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="MATCH-CLAUSE">match-clause</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-match-clause" data-sym="MATCH-CLAUSE" title="(defun acl2s::match-clause (acl2s::x acl2s::pat acl2s::forms)
  (declare (acl2s::xargs :guard t))
  (acl2s::mv-let (acl2s::tests acl2s::bindings)
   (acl2s::match-tests-and-bindings acl2s::x acl2s::pat nil nil)
   (list
...">match-clause</a>
  (x pat forms)
  (declare (xargs <span class="keyword">:guard</span> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>))
  (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (tests bindings)
    (<a class="sym-link local-def" href="#def-match-tests-and-bindings" data-sym="MATCH-TESTS-AND-BINDINGS" title="(defun acl2s::match-tests-and-bindings
       (acl2s::x acl2s::pat acl2s::tests acl2s::bindings)
  (declare
   (acl2s::xargs :guard
    (and (acl2s::symbol-doublet-listp acl2s::bindings)
...">match-tests-and-bindings</a> x
      pat
      nil
      nil)
    (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (if (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> tests)
        <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>
        (cons '<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-reverse" data-sym="REVERSE">reverse</a> tests)))
      (cons 'let (cons (<a class="sym-link system" href="../../axioms.html#def-reverse" data-sym="REVERSE">reverse</a> bindings) forms)))))</pre>
  </div>

<div class="form-block other" id="form-30" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(definec gen-match-body1
  (exp <span class="keyword">:all</span> pats <span class="keyword">:tl</span> codes <span class="keyword">:true-list-list</span>)
  <span class="keyword">:tl</span> <span class="keyword">:pre</span> (match-pats-codes pats codes)
  <span class="keyword">:skip-tests</span> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>
  <span class="keyword">:timeout</span> <span class="number">500</span>
  (declare (xargs <span class="keyword">:consider-only-ccms</span> ((acl2s-size codes) (acl2s-size pats))))
  (if (<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> pats)
    nil
    (b* ((pat (car pats)) (code (car codes))
        (or? (match-or pat))
        (pat (if (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> or? (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> (cdr or?)))
            (car or?)
            pat))
        (or? (if (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> or? (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> (cdr or?)))
            nil
            or?))
        (type? (match-type pat))
        (t? (match-t pat)))
      (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (type? (if (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> (cdr code))
            (cons `((,ACL2S::TYPE? ,EXP) ,(CAR ACL2S::CODE))
              (gen-match-body1 exp
                (cdr pats)
                (cdr codes)))
            (cons `((,ACL2S::TYPE? ,EXP) ,(CONS &#39;COND
       (APPEND
        (ACL2S::GEN-MATCH-BODY1 EXP (ACL2S::STRIP-CARS ACL2S::CODE)
         (ACL2S::STRIP-CDRS ACL2S::CODE))
        &#39;((T (ACL2S::ILLEGAL &#39;ACL2S::MATCH &quot;match is not exhaustive&quot; NIL))))))
              (gen-match-body1 exp
                (cdr pats)
                (cdr codes)))))
        (or? (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> (gen-match-body1 exp
              (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (car or?))
              (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> code))
            (gen-match-body1 exp
              `((<span class="keyword">:or</span> ,@(CDR ACL2S::OR?)) ,@(CDR ACL2S::PATS))
              codes)))
        (t? (cons `(,(CAR ACL2S::T?) ,(CAR ACL2S::CODE))
            (gen-match-body1 exp
              (cdr pats)
              (cdr codes))))
        (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (if (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> pat '&amp;)
            (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (<a class="sym-link local-def" href="#def-match-clause" data-sym="MATCH-CLAUSE" title="(defun acl2s::match-clause (acl2s::x acl2s::pat acl2s::forms)
  (declare (acl2s::xargs :guard t))
  (acl2s::mv-let (acl2s::tests acl2s::bindings)
   (acl2s::match-tests-and-bindings acl2s::x acl2s::pat nil nil)
   (list
...">match-clause</a> exp '&amp; code))
            (cons (<a class="sym-link local-def" href="#def-match-clause" data-sym="MATCH-CLAUSE" title="(defun acl2s::match-clause (acl2s::x acl2s::pat acl2s::forms)
  (declare (acl2s::xargs :guard t))
  (acl2s::mv-let (acl2s::tests acl2s::bindings)
   (acl2s::match-tests-and-bindings acl2s::x acl2s::pat nil nil)
   (list
...">match-clause</a> exp pat code)
              (gen-match-body1 exp
                (cdr pats)
                (cdr codes)))))))))</pre>
  </div>

<div class="form-block other" id="form-31" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(definec gen-match-body
  (exp <span class="keyword">:all</span> pats <span class="keyword">:tl</span> codes <span class="keyword">:true-list-list</span>)
  <span class="keyword">:tl</span> <span class="keyword">:pre</span> (match-pats-codes pats codes)
  <span class="keyword">:skip-tests</span> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>
  <span class="keyword">:timeout</span> <span class="number">500</span>
  (declare (xargs <span class="keyword">:consider-only-ccms</span> ((acl2s-size codes))))
  (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> (gen-match-body1 exp pats codes)
    '((<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-illegal" data-sym="ILLEGAL">illegal</a> '<a class="sym-link local-def" href="#def-match" data-sym="MATCH" title="(defmacro acl2s::match (exp &amp;rest acl2s::args)
  (acl2s::match-fun exp acl2s::args))">match</a> <span class="string">"match is not exhaustive"</span> nil)))))</pre>
  </div>

<div class="form-block other" id="form-32" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(definec match-fun
  (exp <span class="keyword">:all</span> <a class="sym-link system" href="../../defuns.html#def-args" data-sym="ARGS">args</a> <span class="keyword">:alist</span>)
  <span class="keyword">:tl</span> <span class="keyword">:pre</span> (<a class="sym-link system" href="../../axioms.html#def-true-list-listp" data-sym="TRUE-LIST-LISTP">true-list-listp</a> (<a class="sym-link system" href="../../axioms.html#def-strip-cdrs" data-sym="STRIP-CDRS">strip-cdrs</a> <a class="sym-link system" href="../../defuns.html#def-args" data-sym="ARGS">args</a>))
  <span class="keyword">:pre</span> (tlp (<a class="sym-link system" href="../../axioms.html#def-strip-cars" data-sym="STRIP-CARS">strip-cars</a> <a class="sym-link system" href="../../defuns.html#def-args" data-sym="ARGS">args</a>))
  <span class="keyword">:pre</span> (match-pats-codes (<a class="sym-link system" href="../../axioms.html#def-strip-cars" data-sym="STRIP-CARS">strip-cars</a> <a class="sym-link system" href="../../defuns.html#def-args" data-sym="ARGS">args</a>)
    (<a class="sym-link system" href="../../axioms.html#def-strip-cdrs" data-sym="STRIP-CDRS">strip-cdrs</a> <a class="sym-link system" href="../../defuns.html#def-args" data-sym="ARGS">args</a>))
  (b* ((pats (<a class="sym-link system" href="../../axioms.html#def-strip-cars" data-sym="STRIP-CARS">strip-cars</a> <a class="sym-link system" href="../../defuns.html#def-args" data-sym="ARGS">args</a>)) (codes (<a class="sym-link system" href="../../axioms.html#def-strip-cdrs" data-sym="STRIP-CDRS">strip-cdrs</a> <a class="sym-link system" href="../../defuns.html#def-args" data-sym="ARGS">args</a>)))
    (cons '<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a>
      (gen-match-body exp pats codes))))</pre>
  </div>

<div class="form-block macro" id="def-match" data-defines="MATCH" data-references="MATCH-FUN,ARGS,&REST,EXP,DEFMACRO" typeof="Code">
    <div class="form-header"><span class="form-name" property="name" data-sym="MATCH">match</span><span class="form-type">macro</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> <a class="sym-link local-def" href="#def-match" data-sym="MATCH" title="(defmacro acl2s::match (exp &amp;rest acl2s::args)
  (acl2s::match-fun exp acl2s::args))">match</a>
  (exp &amp;rest <a class="sym-link system" href="../../defuns.html#def-args" data-sym="ARGS">args</a>)
  (match-fun exp <a class="sym-link system" href="../../defuns.html#def-args" data-sym="ARGS">args</a>))</pre>
  </div>

<div class="form-block other" id="form-34" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../xdoc/top.html" title="Open xdoc/top">"xdoc/top"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block other" id="form-35" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc <a class="sym-link local-def" href="#def-match" data-sym="MATCH" title="(defmacro acl2s::match (exp &amp;rest acl2s::args)
  (acl2s::match-fun exp acl2s::args))">match</a>
  <span class="keyword">:parents</span> (acl2-sedan defdata)
  <span class="keyword">:short</span> <span class="string">"Pattern matching supporting predicates, including
  recognizers automatically generated by @(see defdata),
  disjunctive patterns and patterns containing arbitrary code.
  Can be thought of as ACL2s version of @(see? case-match)."</span>
  <span class="keyword">:long</span> <span class="string">"
&lt;h3&gt;Examples&lt;/h3&gt;

@({

  ;; Predicate/recognizer patterns are defined using keywords.
  ;; The keyword pos corresponds to the recognizer posp. For all
  ;; keywords except atom, we generate the corresponding
  ;; predicate/recognizer by adding a p to the end of the symbol.
  
  ;; This function, given an integer as input, returns 1 if it is
  ;; positive, else 2 if it is even, else 3. Match forms are checked
  ;; to make sure that they are exhaustive. If not, that is an error,
  ;; e.g., if you remove one of the cases to match, you will get an
  ;; error. Note that :even gets turned into the predicate evenp,
  ;; which is not a recognizer (as its domain is not all).
  
  (definec int-class (x :int) :pos
    (match x
      (:pos 1)
      (:even 2)
      (:neg 3)))

  ;; Here is a more complex example, showing that predicate/recognizer
  ;; patterns can be nested. The match form matches any positive x,
  ;; and then checks if it even or odd. The nested match forms must
  ;; also be exhaustive, given that x is positive. If x is not
  ;; positive, then we check if it is negative and then we perform
  ;; another nested check. 

  ;; Finally, we check if x is 0. Constants such as 0 can be used as
  ;; patterns, as shown below.
  
  (definec int-class2 (x :int) :pos
    (match x
      (:pos 
       (:even 1)
       (:odd 2))
      (:neg
       (:even 3)
       (:odd 4))
      (0 5)))
    
  ;; The next definition is equivalent to the previous definition, but
  ;; makes maximal use of &amp;.
  
  ;; &amp; matches anything and is not bound. Repeated occurrences of &amp;
  ;; may match different structures. 

  (definec int-class3 (x :int) :pos
    (match x
      (:pos 
       (:even 1)
       (&amp; 2))
      (:neg
       (:even 3)
       (&amp; 4))
      (&amp; 5)))
  
  (definec fact (n :nat) :pos
    (match n
      (0 1)
      (&amp; (* n (fact (1- n))))))

  ;; The following three definitions of fib are equivalent.

  ;; Disjunctive patterns are defined with the use of :or, as shown in
  ;; the first definition of fib. This match form can be thought of as
  ;; expanding into the match form of the second version of fib. A
  ;; disjunctive pattern can have any positive number of patterns.
  
  (definec fib (n :nat) :pos
    :skip-tests t
    (match n
      ((:or 0 1) 1)
      (&amp; (+ (fib (1- n)) (fib (- n 2))))))
  
  (definec fib (n :nat) :pos
    :skip-tests t
    (match n
      (0 1)
      (1 1)
      (&amp; (+ (fib (1- n)) (fib (- n 2))))))

  ;; Patterns with arbitrary code are defined with the use of :t, as
  ;; shown below, where the pattern checks if n is less than 2.
  
  (definec fib (n :nat) :pos
    :skip-tests t
    (match n
      ((:t (&lt; n 2)) 1)
      (&amp; (+ (fib (1- n)) (fib (- n 2))))))

  ;; The following definitions of pascal are equivalent.

  ;; !sym, where sym is a symbol that is already bound in the context
  ;; of the match form, matches only the current binding of
  ;; sym. Hence, in the first definition of pascal, the last pattern
  ;; in the :or form matches a list whose first element is anything,
  ;; but whose second element is i (the first argument to
  ;; pascal). Notice that the first argument is also i, which explains
  ;; the equivalence between the two versions of pascal.
  
  (definec pascal (i :nat j :nat) :pos
    :skip-tests t
    (match (list i j)
      ((:or (0 &amp;) (&amp; 0) (&amp; !i)) 1)
      (&amp; (+ (pascal (1- i) (1- j))
            (pascal (1- i) j)))))

  (definec pascal (i :nat j :nat) :pos
    :skip-tests t
    (match (list i j)
      ((0 &amp;) 1)
      ((&amp; 0) 1)
      ((!i !i) 1)
      (&amp; (+ (pascal (1- i) (1- j))
            (pascal (1- i) j)))))

  ;; The following examples show how to use match with conses.  In mem,
  ;; we first check if x is nil. The symbols nil, t, *sym* and cannot
  ;; be bound and only match their global values, as was the case for
  ;; constants, as we have seen above. The pattern (f . r) matches any
  ;; cons, with f being the car and r being the cdr. Since mem is
  ;; checking whether e is a member of x, notice the use of !e to
  ;; match e with the first element of x.
  
  (definec mem (e :all x :tl) :bool
    (match x
      (nil nil)
      ((!e . &amp;) t)
      ((&amp; . r) (mem e r))))

  (definec subset (x :tl y :tl) :bool
    (match x
      (nil t)
      ((f . r) (and (mem f y) (subset r y)))))
  
  ;; If you want to match an object, say obj, you can use the pattern
  ;; &#39;obj.  This allows you to match keywords that may otherwise be
  ;; interpreted as types.
  
  ;; Here is the definition of the built-in function acl2-count.

  (defun acl2-count (x)
    (declare (xargs :guard t :mode :program))
    (if (consp x)
        (+ 1 (acl2-count (car x))
           (acl2-count (cdr x)))
      (if (rationalp x)
          (if (integerp x)
              (integer-abs x)
            (+ (integer-abs (numerator x))
               (denominator x)))
        (if (complex/complex-rationalp x)
            (+ 1 (acl2-count (realpart x))
               (acl2-count (imagpart x)))
          (if (stringp x)
              (length x)
            0)))))

  ;; Here is an equivalent definition using match. 

  (definec acl2-count2 (x :all) :nat
    (match x
      ((a . b) (+ 1 (acl2-count2 a) (acl2-count2 b)))
      (:rational
       (:integer (integer-abs x))
       (&amp; (+ (integer-abs (numerator x))
             (denominator x))))
      ((:r complex/complex-rationalp)
       (+ 1 (acl2-count2 (realpart x))
          (acl2-count2 (imagpart x))))
      (:string (length x))
      (&amp; 0)))

  
  ;; Note that the two definitions are equivalent, 
  ;; as the following is a theorem. 

  (thm (equal (acl2-count2 x) (acl2-count x)))

  ;; More complex patterns than (f . r) can be used to match with
  ;; conses and lists. For example, (x x y), (&#39;x (&#39;:x x) . t), and
  ;; (&#39;x (:x x)) are allowed patterns. The first pattern matches
  ;; (1 1 2), ((1 2) (1 2) (3)), etc. The second pattern only matches
  ;; lists whose first element is the symbol x, whose second element
  ;; is a list of length two whose first element is the keyword x, and
  ;; whose cddr is t. The third pattern only matches lists of length
  ;; two, whose first element is the symbol x and whose second element
  ;; is a list of length two whose first element is of type x (i.e.,
  ;; recognized by xp).

  ;; There are restrictions on the patterns that are used to match
  ;; conses and lists. At the top level, all of the patterns above are
  ;; allowed, but inside of such patterns, disjunctive patterns, and
  ;; code patterns (using :t) are not supported. Type patterns (such
  ;; as :int, :bool, (:r intp), etc) are supported.

})

&lt;h3&gt;Purpose&lt;/h3&gt;

&lt;p&gt; The macro @(see match) provides pattern matching.  It includes the
functionality similar to that provided by @(see? case-match) and more.
It supports predicate/recognizer patterns in a style similar to how
@(see?  definec) allows you to specify @(see? defdata) types. These
patterns can be nested. The @(see match) macro also provides
disjunctive patterns and patters containing arbitrary code.  Patterns
are required to be exhaustive.  &lt;/p&gt;

&lt;p&gt; There are two ways to specify predicates/recognizers. One is to
use a keyword, such as :rational; see the examples above. Such
keywords are turned into predicates/recognizers by creating a regular
symbol with a &quot;p&quot; at the end, e.g., :rational gets turned into
rationalp (the only special case is that :atom gets turned into
atom). The generated symbols are in the ACL2s package. The more
general mechanism is to specify a predicate/recognizer using the
(:r predicate/recognizer) form; an example is
(:r complex/complex-rationalp) in the acl2-count2 definition above. In
this way, you can also specify the package of the
predicate/recognizer.  &lt;/p&gt;

&lt;p&gt;If you want to match a keyword, you can do that by quoting it.
So &lt;tt&gt;&#39;:rational&lt;/tt&gt; matches the keyword, not the type.&lt;/p&gt;

&lt;p&gt; If you are matching a predicate/recognizer, you can either have a
single form after that, in which case, that form is an ACL2 expression
that gets associated with the predicate/recognizer, or you can have a
list of forms, in which case they are treated as nested matching
forms.  An example of such nesting is shown in the :rational case of
the match in the definition of acl2-count2, above.  &lt;/p&gt;

&lt;p&gt;
Disjunctive patterns and patterns containing arbitrary code are also
supported. See the examples above.
&lt;/p&gt;

&lt;p&gt;
If you are not matching any of the above patterns
(predicate/recognizer, disjunctive, code), then match behaves like
@(see? case-match).  &lt;/p&gt;

&lt;p&gt; One important difference with @(see? case-match) is that match
requires that the cases are exhaustive (or complete). It does this by,
essentially, adding the following as a final case.  &lt;/p&gt;

@({

 (&amp; (illegal &#39;match &quot;match is not exhaustive&quot; ()))

})

&lt;p&gt; During contract checking (or guard verification), if the above
case is reachable, that will lead to an error.  The reason for this is
to not have any hidden control flow, which can make debugging hard.
Finally, we note that nested patterns are also required to be
exhaustive. 
&lt;/p&gt;

"</span>)</pre>
  </div>


  </main>
  
<script>
// ACL2 Book HTML Documentation - Interactive Features
// Generated by cert2 - build2 system

// State
let activeFilter = null;
let activePartFilter = null;
let activeNameFilter = null;
let currentFontSize = 14;

// Theme management
function getStoredTheme() {
  return localStorage.getItem('acl2-theme') || 'dark';
}

function setTheme(theme) {
  if (theme === 'light') {
    document.documentElement.setAttribute('data-theme', 'light');
    document.getElementById('theme-toggle').textContent = '🌙';
  } else {
    document.documentElement.removeAttribute('data-theme');
    document.getElementById('theme-toggle').textContent = '☀️';
  }
  localStorage.setItem('acl2-theme', theme);
}

function toggleTheme() {
  const current = getStoredTheme();
  setTheme(current === 'dark' ? 'light' : 'dark');
}

// Font size management
function getStoredFontSize() {
  return parseInt(localStorage.getItem('acl2-fontsize') || '14', 10);
}

function setFontSize(size) {
  size = Math.max(10, Math.min(24, size)); // Clamp between 10-24
  currentFontSize = size;
  document.body.style.fontSize = size + 'px';
  localStorage.setItem('acl2-fontsize', size.toString());
}

function increaseFontSize() {
  setFontSize(currentFontSize + 2);
}

function decreaseFontSize() {
  setFontSize(currentFontSize - 2);
}

// Get all form blocks
function getFormBlocks() {
  return document.querySelectorAll('.form-block');
}

// Clear all filters
function clearFilter() {
  activeFilter = null;
  activePartFilter = null;
  activeNameFilter = null;
  getFormBlocks().forEach(b => {
    b.classList.remove('hidden', 'dimmed');
  });
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  const status = document.querySelector('.filter-status');
  status.classList.remove('active');
  // Slide name filter back to original position
  document.querySelector('.controls-left').style.transform = '';
  // Clear the name filter input
  const nameInput = document.getElementById('name-filter');
  if (nameInput) nameInput.value = '';
}

// Show filter status and slide name filter right
function showFilterStatus(text) {
  const status = document.querySelector('.filter-status');
  status.classList.add('active');
  status.querySelector('.filter-text').textContent = text;
  // Slide name filter to the right to make room
  setTimeout(() => {
    const statusWidth = status.offsetWidth;
    document.querySelector('.controls-left').style.transform = `translateX(${statusWidth + 15}px)`;
  }, 10);
}

// Filter to show only forms that define or reference a symbol
function filterBySymbol(symName, showUsedBy) {
  clearFilter();
  activeFilter = symName;
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines;
    const references = (block.dataset.references || '').split(',');
    const usedBy = (block.dataset.usedBy || '').split(',');
    
    let show = false;
    if (showUsedBy) {
      // Show forms that USE this symbol
      show = references.includes(symName) || definesName === symName;
    } else {
      // Show forms that this symbol USES
      show = usedBy.includes(symName) || definesName === symName;
    }
    
    if (show) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering by: ${symName} (${visibleCount} items)`);
}

// Filter by defthm part (term, hints, rule-classes, etc.)
function filterByPart(formId, partName) {
  clearFilter();
  activePartFilter = { formId, partName };
  
  // Get the part's referenced symbols
  // data-part-term becomes dataset.partTerm, data-part-hints becomes dataset.partHints, etc.
  const block = document.getElementById(formId);
  const datasetKey = 'part' + partName.charAt(0).toUpperCase() + partName.slice(1).replace(/-([a-z])/g, (g) => g[1].toUpperCase());
  const partData = block.dataset[datasetKey];
  if (!partData) return;
  
  const partSyms = partData.split(',').filter(s => s);
  
  // Highlight the button
  block.querySelector(`.part-btn[data-part="${partName}"]`).classList.add('active');
  
  // Hide forms not referenced by this part
  getFormBlocks().forEach(b => {
    const definesName = b.dataset.defines;
    if (b.id === formId || partSyms.includes(definesName)) {
      b.classList.remove('hidden');
    } else {
      b.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering ${formId} :${partName} (${partSyms.length} references)`);
}

// Filter by name (substring or regex)
function filterByName(pattern, useRegex) {
  // Clear other filters but keep the input value
  activeFilter = null;
  activePartFilter = null;
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  
  if (!pattern || pattern.trim() === '') {
    // Empty pattern - show all
    activeNameFilter = null;
    getFormBlocks().forEach(b => b.classList.remove('hidden'));
    const status = document.querySelector('.filter-status');
    status.classList.remove('active');
    document.querySelector('.controls-left').style.transform = '';
    return;
  }
  
  activeNameFilter = pattern;
  
  let matcher;
  let isValidRegex = true;
  
  if (useRegex) {
    try {
      matcher = new RegExp(pattern, 'i');
    } catch (e) {
      // Invalid regex - show error in status and don't filter
      showFilterStatus(`Invalid regex: ${e.message}`);
      return;
    }
  } else {
    // Plain substring match (case-insensitive)
    const lowerPattern = pattern.toLowerCase();
    matcher = { test: (s) => s.toLowerCase().includes(lowerPattern) };
  }
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines || '';
    if (matcher.test(definesName)) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  const modeText = useRegex ? 'regex' : 'name';
  showFilterStatus(`Filtering by ${modeText}: "${pattern}" (${visibleCount} matches)`);
}

// Click on a name to show what references it
function handleNameClick(symName) {
  if (activeFilter === symName) {
    clearFilter();
  } else {
    filterBySymbol(symName, true);
  }
}

// Navigate to a definition (same file or different)
function navigateTo(symName, file) {
  if (file) {
    // External file - navigate
    window.location.href = file + '.html#def-' + symName.toLowerCase();
  } else {
    // Same file - scroll
    const target = document.getElementById('def-' + symName.toLowerCase());
    if (target) {
      target.scrollIntoView({ behavior: 'smooth', block: 'center' });
      target.classList.add('highlight');
      setTimeout(() => target.classList.remove('highlight'), 400);
    }
  }
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  // Part buttons
  document.querySelectorAll('.part-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const formId = btn.closest('.form-block').id;
      const partName = btn.dataset.part;
      if (activePartFilter && activePartFilter.formId === formId && 
          activePartFilter.partName === partName) {
        clearFilter();
      } else {
        filterByPart(formId, partName);
      }
    });
  });
  
  // Clear filter button
  document.querySelector('.clear-filter').addEventListener('click', clearFilter);
  
  // Name filter input
  const nameFilter = document.getElementById('name-filter');
  const regexToggle = document.getElementById('regex-toggle');
  
  let filterTimeout = null;
  nameFilter.addEventListener('input', () => {
    // Debounce the filter to avoid excessive updates while typing
    clearTimeout(filterTimeout);
    filterTimeout = setTimeout(() => {
      filterByName(nameFilter.value, regexToggle.checked);
    }, 150);
  });
  
  // Re-filter when regex toggle changes
  regexToggle.addEventListener('change', () => {
    if (nameFilter.value) {
      filterByName(nameFilter.value, regexToggle.checked);
    }
  });
  
  // Allow Escape key to clear filter when in input
  nameFilter.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      clearFilter();
      nameFilter.blur();
    }
  });
  
  // Symbol references (old span-based refs)
  document.querySelectorAll('.sym-ref').forEach(ref => {
    ref.addEventListener('click', (e) => {
      e.stopPropagation();
      const sym = ref.dataset.sym;
      const file = ref.dataset.file;
      if (file) {
        navigateTo(sym, file);
      } else {
        handleNameClick(sym);
      }
    });
  });
  
  // Symbol links (new anchor-based links)
  // These use standard <a> tags so navigation happens automatically
  // But we need to clear filters if target would be hidden
  document.querySelectorAll('.sym-link').forEach(link => {
    link.addEventListener('click', (e) => {
      const href = link.getAttribute('href');
      if (href && href.startsWith('#')) {
        // Local link - check if target is hidden by filter
        const targetId = href.substring(1);
        const target = document.getElementById(targetId);
        if (target) {
          // If target is hidden, clear the filter first
          if (target.classList.contains('hidden')) {
            clearFilter();
          }
          // Add highlight effect after a short delay
          setTimeout(() => {
            target.classList.add('highlight');
            setTimeout(() => target.classList.remove('highlight'), 400);
          }, 100);
        }
      }
      // For external links, default behavior handles navigation
    });
  });
  
  // Form names (show what uses them)
  document.querySelectorAll('.form-name').forEach(name => {
    name.addEventListener('click', (e) => {
      handleNameClick(name.dataset.sym);
    });
  });
  
  // Handle hash navigation (when arriving at page with #anchor)
  if (window.location.hash) {
    const target = document.querySelector(window.location.hash);
    if (target) {
      setTimeout(() => {
        target.scrollIntoView({ behavior: 'smooth', block: 'center' });
        target.classList.add('highlight');
        setTimeout(() => target.classList.remove('highlight'), 400);
      }, 200);
    }
  }
  
  // Initialize theme from storage
  setTheme(getStoredTheme());
  
  // Initialize font size from storage
  currentFontSize = getStoredFontSize();
  setFontSize(currentFontSize);
  
  // Theme toggle button
  document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
  
  // Font size buttons
  document.getElementById('font-larger').addEventListener('click', increaseFontSize);
  document.getElementById('font-smaller').addEventListener('click', decreaseFontSize);
});

</script>

</body>
</html>
<!DOCTYPE html>
<html lang="en" vocab="http://schema.org/" typeof="SoftwareSourceCode">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>doc - ACL2 Book</title>
  <meta property="name" content="doc">
  <meta property="programmingLanguage" content="ACL2">
  
<style>
/* ACL2 Book HTML Documentation Styles */
/* Generated by cert2 - build2 system */

/* Dark theme (default) */
:root {
  --bg: #1e1e2e;
  --fg: #cdd6f4;
  --comment: #6c7086;
  --keyword: #cba6f7;
  --string: #a6e3a1;
  --function: #89b4fa;
  --type: #f9e2af;
  --link: #89dceb;
  --link-hover: #f5c2e7;
  --highlight: rgba(137, 180, 250, 0.2);
  --border: #313244;
  --block-bg: rgba(49, 50, 68, 0.5);
  --btn-bg: #313244;
  --btn-hover: rgba(137, 180, 250, 0.2);
}

/* Light theme */
[data-theme="light"] {
  --bg: #eff1f5;
  --fg: #4c4f69;
  --comment: #6c6f85;
  --keyword: #8839ef;
  --string: #40a02b;
  --function: #1e66f5;
  --type: #df8e1d;
  --link: #04a5e5;
  --link-hover: #ea76cb;
  --highlight: rgba(30, 102, 245, 0.15);
  --border: #ccd0da;
  --block-bg: rgba(204, 208, 218, 0.3);
  --btn-bg: #ccd0da;
  --btn-hover: rgba(30, 102, 245, 0.15);
}

body {
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  background: var(--bg);
  color: var(--fg);
  margin: 0;
  padding: 20px;
  line-height: 1.6;
  font-size: 14px;
  transition: background 0.1s, color 0.1s;
}

/* Controls toolbar */
.controls-left {
  position: fixed;
  top: 10px;
  left: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
  transition: transform 0.1s ease;
}

.controls-right {
  position: fixed;
  top: 10px;
  right: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
}

.control-btn {
  padding: 6px 12px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-family: inherit;
  font-size: 14px;
  transition: all 0.1s;
}

.control-btn:hover {
  background: var(--btn-hover);
  border-color: var(--link);
}

.name-filter {
  padding: 6px 10px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  font-family: inherit;
  font-size: 13px;
  width: 150px;
  transition: all 0.1s;
}

.name-filter:focus {
  outline: none;
  border-color: var(--link);
  width: 200px;
}

.name-filter::placeholder {
  color: var(--comment);
}

.regex-label {
  display: flex;
  align-items: center;
  gap: 4px;
  color: var(--comment);
  font-size: 12px;
  cursor: pointer;
}

.regex-label input {
  cursor: pointer;
}

.book-header {
  border-bottom: 2px solid var(--border);
  padding-bottom: 20px;
  margin-bottom: 20px;
}

.book-header h1 {
  color: var(--keyword);
  margin: 0;
}

.book-header .path {
  color: var(--comment);
  font-size: 0.9em;
}

.book-header .path .source-link {
  color: var(--comment);
  text-decoration: none;
}

.book-header .path .source-link:hover {
  color: var(--link);
  text-decoration: underline;
}

.form-block {
  margin: 10px 0;
  padding: 15px;
  background: var(--block-bg);
  border-radius: 8px;
  border-left: 3px solid var(--border);
}

.form-block.theorem { border-left-color: var(--keyword); }
.form-block.function { border-left-color: var(--function); }
.form-block.macro { border-left-color: var(--type); }
.form-block.include-book { border-left-color: var(--string); }

.form-block.hidden { display: none; }
.form-block.dimmed { opacity: 0.3; }

.form-block.highlight {
  animation: highlight-pulse 0.4s ease-out;
}

@keyframes highlight-pulse {
  0% { background: var(--highlight); box-shadow: 0 0 20px var(--link); }
  100% { background: rgba(49, 50, 68, 0.5); box-shadow: none; }
}

.form-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.form-name {
  color: var(--function);
  font-weight: bold;
  cursor: pointer;
}

.form-name:hover {
  color: var(--link-hover);
  text-decoration: underline;
}

.form-type {
  color: var(--comment);
  font-size: 0.85em;
}

pre.code {
  margin: 0;
  overflow-x: auto;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.sym-ref {
  color: var(--link);
  cursor: pointer;
  border-radius: 2px;
}

.sym-ref:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.sym-ref.local-def { color: var(--function); font-weight: bold; }
.sym-ref.external { color: var(--type); }

/* Symbol links (clickable hyperlinks) */
.sym-link {
  color: var(--link);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
  position: relative;
}

.sym-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

.sym-link.local-def {
  color: var(--function);
  font-weight: bold;
}

.sym-link.external {
  color: var(--type);
}

/* Tooltips using title attribute with custom styling */
.sym-link[title] {
  /* Browser will show title on hover */
}

/* Syntax highlighting in code blocks */
.keyword {
  color: var(--keyword);
}

.string {
  color: var(--string);
}

.number {
  color: #f77524; /* orange */
}

/* Include-book path links */
.include-path {
  color: var(--string);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
}

.include-path:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

/* Part buttons for defthm */
.part-buttons {
  display: flex;
  gap: 5px;
  margin: 10px 0;
  flex-wrap: wrap;
}

.part-btn {
  padding: 4px 10px;
  background: var(--border);
  border: 1px solid var(--comment);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-size: 0.85em;
  font-family: inherit;
}

.part-btn:hover {
  background: var(--highlight);
  border-color: var(--link);
}

.part-btn.active {
  background: var(--link);
  color: var(--bg);
  border-color: var(--link);
}

/* References panel */
.refs-panel {
  margin-top: 10px;
  padding: 10px;
  background: rgba(0,0,0,0.2);
  border-radius: 4px;
  display: none;
}

.refs-panel.visible { display: block; }

.refs-panel h4 {
  margin: 0 0 5px 0;
  color: var(--comment);
  font-size: 0.9em;
}

.refs-list {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

/* Included books section */
.includes-section {
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(49, 50, 68, 0.3);
  border-radius: 8px;
  border: 1px solid var(--border);
}

.includes-section h2 {
  margin: 0 0 10px 0;
  color: var(--comment);
  font-size: 1em;
  font-weight: normal;
}

.includes-list {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.include-link {
  padding: 6px 12px;
  background: var(--border);
  border-radius: 4px;
  color: var(--link);
  text-decoration: none;
  font-size: 0.9em;
  transition: all 0.1s;
}

.include-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.include-link.local {
  border-left: 2px solid var(--comment);
}

/* Filter status */
.filter-status {
  position: fixed;
  top: 10px;
  left: 20px;
  background: var(--bg);
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: 4px;
  z-index: 201;
  display: none;
  align-items: center;
  gap: 10px;
}

.filter-status.active {
  display: flex;
  align-items: center;
  gap: 10px;
}

.clear-filter {
  padding: 5px 15px;
  background: var(--keyword);
  color: var(--bg);
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

/* RDFa vocab indicator */
[vocab] { /* semantic web annotations present */ }

</style>

</head>
<body>
  <div class="controls-left">
    <input type="text" id="name-filter" class="name-filter" placeholder="Filter by name..." title="Filter definitions by name">
    <label class="regex-label"><input type="checkbox" id="regex-toggle"> regex</label>
  </div>

  <div class="controls-right">
    <button class="control-btn" id="theme-toggle" title="Toggle light/dark theme">‚òÄÔ∏è</button>
    <button class="control-btn" id="font-smaller" title="Decrease font size">A-</button>
    <button class="control-btn" id="font-larger" title="Increase font size">A+</button>
  </div>

  <div class="filter-status">
    <span class="filter-text">Filtering...</span>
    <button class="clear-filter">Clear Filter</button>
  </div>
  
  <div class="book-header">
    <h1 property="name">doc</h1>
    <div class="path"><a href="doc.lisp" class="source-link">books/acl2s/aspf/interface/doc</a></div>
  </div>
  
  <main property="text">
  <div class="includes-section">
    <h2>Included Books</h2>
    <div class="includes-list">
      <a class="include-link" href="../../../xdoc/top.html" title="xdoc/top">top</a>
    </div>
  </div>

<div class="form-block other" id="form-0" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../../axioms.html#def-in-package" data-sym="IN-PACKAGE">in-package</a> <span class="string">"ACL2S-INTERFACE"</span>)</pre>
  </div>

<div class="form-block include-book" id="form-1" typeof="Code">
    <div class="form-header"><span class="form-type">include-book</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../../xdoc/top.html" title="Open xdoc/top">"xdoc/top"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block other" id="form-2" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc acl2s-interface
  <span class="keyword">:parents</span> (interfacing-tools acl2-sedan)
  <span class="keyword">:short</span> <span class="string">"An interface for interacting with ACL2/ACL2s from Common Lisp."</span>
  <span class="keyword">:long</span> <span class="string">" &lt;p&gt;WARNING: Loading this book by default will result in the
redefinition of @(&#39;comment-window-co&#39;). This is unfortunately the only
way we found to control comment-window printing. If you would like to
disable this feature, you can add the
@(&#39;ACL2S-INTERFACE-NO-OVERWRITE&#39;) feature, e.g. by running @(&#39;(push
:ACL2S-INTERFACE-NO-OVERWRITE *features*)&#39;) in raw mode before
certifying this book.&lt;/p&gt;"</span>)</pre>
  </div>

<div class="form-block other" id="form-3" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc quiet-mode
  <span class="keyword">:parents</span> (acl2s-interface)
  <span class="keyword">:short</span> <span class="string">"Control whether or not the acl2s-interface attempts to suppress ACL2 printed output"</span>
  <span class="keyword">:long</span> <span class="string">"
Examples:
@({
 (quiet-mode-on)    ; from this point forward all acl2s-interface functions will
                    ; attempt to suppress all ACL2 printed output
 (quiet-mode-off)   ; (default) from this point forward all acl2s-interface
                    ; functions will print any ACL2 output as normal
})
&lt;p&gt;
Most of the ACL2s interface functions also take a @(&#39;:quiet&#39;) argument for
locally controlling quiet mode without affecting the global setting.
&lt;/p&gt;

&lt;p&gt;
The ACL2s interface provides hooks for code that should run when quiet mode
is enabled or disabled. See @(see quiet-mode-hooks) for more information.
&lt;/p&gt;
"</span>)</pre>
  </div>

<div class="form-block other" id="form-4" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc quiet-mode-hooks
  <span class="keyword">:parents</span> (acl2s-interface)
  <span class="keyword">:short</span> <span class="string">"Hooks that fire when the ACL2s interface quiet mode is turned on or off."</span>
  <span class="keyword">:long</span> <span class="string">"
&lt;b&gt;General form&lt;/b&gt;
@({
 (add-quiet-mode-on-hook
   name  ; A (symbol) name to associate with this hook
   hook) ; A function to call when quiet mode transitions from disabled to enabled.
         ; The return value of the hook function should be a list of ACL2 forms to
         ; be executed.

 (add-quiet-mode-off-hook
   name  ; A (symbol) name to associate with this hook
   hook) ; A function to call when quiet mode transitions from enabled to disabled.
         ; The return value of the hook function should be a list of ACL2 forms to
         ; be executed.
})
&lt;p&gt;
Some applications may have verbosity settings beyond the standard ACL2 ones. Quiet
mode hooks provide a way to change these settings whenever the ACL2s interface
transitions from quiet mode being enabled to disabled, and vice versa.
&lt;/p&gt;

&lt;p&gt;
Upon the appropriate transition, each hook function for that transition is called.
The return values of all of the hook functions for that transition type are
appended, and the resulting list of ACL2 forms is evaluated using @(see acl2::ld)
in an environment that disables all output. Typically, hooks will perform some
stateful operation (for example, a quiet-mode-on hook might save the current value
of a setting into a variable) and then produce a list of ACL2 forms that will change
the setting to its original value (for a quiet-mode-off hook) or to a particular
quiet value (for a quiet-mode-on hook). One should &lt;b&gt;not&lt;/b&gt; call any of
@(&#39;acl2s-compute&#39;), @(&#39;acl2s-query&#39;), or @(&#39;acl2s-event&#39;) from inside of a hook.
&lt;/p&gt;

&lt;p&gt;
For each transition type, adding a hook with the same name as another hook for that
same transition type will result in the previously added hook being removed from
the list of hooks.
&lt;/p&gt;

&lt;b&gt;Examples&lt;/b&gt;
@({
  ;; Define a variable to store the last seen gag mode.
  ;; See books/acl2s/interface/acl2s-interface.lsp for the definition
  ;; of define-var, which is needed to work around SBCL and CCL quirks.
  (define-var *saved-gag-mode* (acl2::gag-mode))

  (add-quiet-mode-on-hook
    :gag-mode
    (lambda ()
      ;; Calling acl2::@ here is probably not super safe, but it seems to work...
      (setf *saved-gag-mode* (acl2::@ acl2::gag-mode))
      &#39;((acl2::set-gag-mode t))))

  (add-quiet-mode-off-hook
    :gag-mode
    (lambda () `((acl2::set-gag-mode ,*saved-gag-mode*))))
})

&lt;p&gt;
See @(&#39;books/acl2s/interface/acl2s-utils/additions.lsp&#39;) for some example hooks.
&lt;/p&gt;
"</span>)</pre>
  </div>

<div class="form-block other" id="form-5" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc capture-output
  <span class="keyword">:parents</span> (acl2s-interface)
  <span class="keyword">:short</span> <span class="string">"Control whether or not the acl2s-interface attempts to capture ACL2 printed output"</span>
  <span class="keyword">:long</span> <span class="string">"
Examples:
@({
 (capture-output-on)    ; From this point forward all acl2s-interface functions will
                        ; attempt to capture all ACL2 printed output
 (capture-output-off)   ; (default) From this point forward all acl2s-interface
                        ; functions will print any ACL2 output as normal
 (get-captured-output)  ; Returns a string containing all captured output since the
                        ; last (get-captured-output) call. Note that the three primary
                        ; acl2s-interface functions will call this before each query.
})
&lt;p&gt;
Most of the ACL2s interface functions also take a @(&#39;:capture-output&#39;) argument for
locally controlling whether output is captured without affecting the global setting.
&lt;/p&gt;
"</span>)</pre>
  </div>

<div class="form-block other" id="form-6" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc acl2s-interface-symbol-package-tips
  <span class="keyword">:parents</span> (acl2s-interface)
  <span class="keyword">:short</span> <span class="string">"Tips for dealing with symbol package issues when using the ACL2s interface"</span>
  <span class="keyword">:long</span> <span class="string">"
&lt;p&gt;When using any of the ACL2s interface functions from inside of a package other than &quot;ACL2&quot;, you may run into problems because the symbols inside of any query literals will default to being interned in that package. This is mainly problematic when it comes to writing expressions that call ACL2 functions.
&lt;/p&gt;
&lt;p&gt;
The simplest way to solve this problem while still working in a non-ACL2 package is to fully specify the names of all functions inside your queries. For example, one would write &lt;tt&gt;(acl2s-compute &#39;(acl2::expt 2 3))&lt;/tt&gt; instead of &lt;tt&gt;(acl2s-compute &#39;(expt 2 3))&lt;/tt&gt;.
&lt;/p&gt;
&lt;p&gt;
This gets painful when writing queries containing many function calls. In this case, depending on your host Lisp, you may be able to use &lt;a href=&quot;http://www.sbcl.org/manual/#Extended-Package-Prefix-Syntax&quot;&gt;extended package prefix notation&lt;/a&gt;. For example, in SBCL, one could write &lt;tt&gt;(acl2s-compute &#39;acl2::(expt 2 (expt 2 3)))&lt;/tt&gt; instead of &lt;tt&gt;(acl2s-compute &#39;(acl2::expt 2 (acl2::expt 2 3)))&lt;/tt&gt;.
&lt;/p&gt;

&lt;p&gt;
Note that using extended package prefix notation with a backquoted value will also affect any evaluated subexpressions. The following example shows one way of getting around this, by providing the full name of the argument @(&#39;foo::x&#39;).&lt;/p&gt;
@({
(in-package :foo) ;; assume we&#39;ve defined a package named foo in Common Lisp
(defun baz-ok-1 (x)
  (acl2s-compute `(acl2::expt 2 (acl2::expt 2 ,x))))
(defun baz-bad (x)
  (acl2s-compute `acl2::(expt 2 (expt 2 ,x)))) ;; ,x here will evaluate acl2::x instead of foo::x.
(defun baz-ok-2 (x)
  (acl2s-compute `acl2::(expt 2 (expt 2 ,foo::x)))) ;; we can just override the default package to fix this
})
"</span>)</pre>
  </div>

<div class="form-block other" id="form-7" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc acl2s-compute
  <span class="keyword">:parents</span> (acl2s-interface)
  <span class="keyword">:short</span> <span class="string">"Run a single-value ACL2 computation from Common Lisp"</span>
  <span class="keyword">:long</span> <span class="string">"
&lt;b&gt;General form&lt;/b&gt;
@({
(acl2s-compute
  form                   ; The form to evaluate. Should return a single value.
  :quiet &lt;bool&gt;          ; Optional. Whether or not to suppress all ACL2 printed output. Defaults to nil.
  :capture-output &lt;bool&gt; ; Optional. Whether or not to capture all ACL2 printed output. Defaults to nil.
  ...)       ;; Any additional arguments will be passed to ld, except for :ld-error-action
=&gt;
(list erp val)
})
&lt;dl&gt;
&lt;dt&gt;Returns&lt;/dt&gt;
&lt;dd&gt;@(&#39;erp&#39;) is @(&#39;t&#39;) if an error occurred during execution of @(&#39;form&#39;), and is @(&#39;nil&#39;) otherwise.&lt;/dd&gt;
&lt;dd&gt;@(&#39;val&#39;) is the single value that @(&#39;form&#39;) evaluated to.&lt;/dd&gt;
&lt;/dl&gt;

&lt;p&gt;
The @(&#39;form&#39;) argument should be an ACL2 expression that evaluates to a single value. Be careful about symbol packages when using @(&#39;acl2s-compute&#39;) when inside a different package - you may need to fully specify the name of an ACL2 function when calling it. See @(see acl2s-interface-symbol-package-tips) for more information.
&lt;/p&gt;

&lt;p&gt;
When the @(&#39;:quiet&#39;) option is set to @(&#39;t&#39;), @(&#39;acl2s-compute&#39;) will attempt to suppress all ACL2 printed output during evaluation of @(&#39;form&#39;). This temporarily overrides the current @(see quiet-mode).
&lt;/p&gt;

&lt;p&gt;
When the @(&#39;:capture-output&#39;) option is set to @(&#39;t&#39;), @(&#39;acl2s-compute&#39;) will attempt capture all ACL2 printed output during evaluation of @(&#39;form&#39;). This temporarily overrides the current @(see capture-output).
&lt;/p&gt;

&lt;h4&gt;Examples&lt;/h4&gt;

@({(acl2s-compute &#39;(+ 1 2))})
Returns (nil 3)
@({(acl2s-compute &#39;(+ 1 2) :quiet nil :ld-pre-eval-print t)})
Returns (nil 3), does not attempt to suppress any ACL2 printed output, and passes @(&#39;:ld-pre-eval-print t&#39;) to @(see acl2::ld)
@({(acl2s-compute &#39;(append &#39;(1 2) &#39;(3 4)))})
Returns (nil (1 2 3 4))
@({(acl2s-compute &#39;(+ 1 &#39;(1 2)))})
Returns (t nil) and prints out a guard violation error message
@({(acl2s-compute &#39;(mv nil t state))})
"</span>)</pre>
  </div>

<div class="form-block other" id="form-8" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc acl2s-query
  <span class="keyword">:parents</span> (acl2s-interface)
  <span class="keyword">:short</span> <span class="string">"Run a multiple-value ACL2 computation from Common Lisp"</span>
  <span class="keyword">:long</span> <span class="string">"
&lt;b&gt;General form&lt;/b&gt;
@({
(acl2s-query
  form                         ; The form to evaluate. Should evaluate to an error triple.
  :quiet &lt;bool&gt;                ; Optional. Whether or not to suppress all ACL2 printed output. Defaults to nil.
  :capture-output &lt;bool&gt;       ; Optional. Whether or not to capture all ACL2 printed output. Defaults to nil.
  :prover-step-limit &lt;integer&gt; ; Optional. Sets the prover step limit. Defaults to what ACL2 would have used
                               ;           for a top-level evaluation (see set-prover-step-limit).
  ...)                         ; Any additional arguments will be passed to ld, except for :ld-error-action
=&gt;
(list erp val)
})
&lt;dl&gt;
&lt;dt&gt;Returns&lt;/dt&gt;
&lt;dd&gt;@(&#39;erp&#39;) is the first value of the error triple that @(&#39;form&#39;) evaluated to, or @(&#39;nil&#39;) if an error occurred while evaluating @(&#39;form&#39;).&lt;/dd&gt;
&lt;dd&gt;@(&#39;val&#39;) is the second value of the error triple that @(&#39;form&#39;) evaluated to.&lt;/dd&gt;
&lt;/dl&gt;

&lt;p&gt;
The @(&#39;form&#39;) argument should be an ACL2 expression that evaluates to an @(see acl2::error-triple). @(&#39;form&#39;) should also not change the state of the ACL2 world with respect to events. Be careful about symbol packages when using @(&#39;acl2s-query&#39;) when inside a different package - you may need to fully specify the name of an ACL2 function when calling it. See @(see acl2s-interface-symbol-package-tips) for more information.
&lt;/p&gt;

&lt;p&gt;
When the @(&#39;:quiet&#39;) option is set to @(&#39;t&#39;), @(&#39;acl2s-query&#39;) will attempt to suppress all ACL2 printed output during evaluation of @(&#39;form&#39;). This temporarily overrides the current @(see quiet-mode).
&lt;/p&gt;

&lt;p&gt;
When the @(&#39;:capture-output&#39;) option is set to @(&#39;t&#39;), @(&#39;acl2s-query&#39;) will attempt capture all ACL2 printed output during evaluation of @(&#39;form&#39;). This temporarily overrides the current @(see capture-output).
&lt;/p&gt;

&lt;p&gt;
@(&#39;acl2s-query&#39;) evaluates @(&#39;form&#39;) inside of a @(see acl2::with-prover-step-limit), where the step-limit is set to the value provided to @(&#39;:prover-step-limit&#39;), or ACL2&#39;s set prover-step-limit if that option is not provided. See @(see acl2::set-prover-step-limit) for more information about the prover step-limit. If you don&#39;t want to limit the number of prover steps permitted for an event, set @(&#39;:prover-step-limit&#39;) to nil.
&lt;/p&gt;

&lt;h4&gt;Examples&lt;/h4&gt;
@({(acl2s-query &#39;(value (+ 1 2)))})
Returns (nil 3)

@({(acl2s-query &#39;(thm (implies (natp x) (integerp x))))})
Returns (nil :invisible)

@({(acl2s-query &#39;(mv nil t state))})
Returns (nil t)

@({(acl2s-query &#39;(value (+ 1 2)) :quiet nil :ld-pre-eval-print t)})
Returns (nil 3), does not attempt to suppress any ACL2 printed output, and passes @(&#39;:ld-pre-eval-print t&#39;) to @(see acl2::ld)

@({(acl2s-query &#39;(trans-eval &#39;(+ 1 2) &#39;my-ctx state nil))})
Returns (nil ((nil) . 3)). See @(see acl2::trans-eval) for more information
about trans-eval&#39;s return value.

@({(acl2s-query &#39;(test? (implies (integerp x) (natp x))))})
Returns (t nil)
"</span>)</pre>
  </div>

<div class="form-block other" id="form-9" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc acl2s-event
  <span class="keyword">:parents</span> (acl2s-interface)
  <span class="keyword">:short</span> <span class="string">"Install an ACL2 event from Common Lisp"</span>
  <span class="keyword">:long</span> <span class="string">"
&lt;b&gt;General form&lt;/b&gt;
@({
(acl2s-event
  form                         ; The form to evaluate. Should return an error triple.
  :quiet &lt;bool&gt;                ; Optional. Whether or not to suppress all ACL2 printed output. Defaults to nil.
  :capture-output &lt;bool&gt;       ; Optional. Whether or not to capture all ACL2 printed output. Defaults to nil.
  :prover-step-limit           ; Optional. Sets the prover step limit. Defaults to what ACL2 would have used
                               ;           for a top-level evaluation (see acl2::set-prover-step-limit).
  ...)                         ; Any additional arguments will be passed to ld, except for :ld-error-action.
=&gt;
(list erp nil)
})
&lt;dl&gt;
&lt;dt&gt;Returns&lt;/dt&gt;
&lt;dd&gt;@(&#39;erp&#39;) is `nil` if ld indicates that the form was successfully evaluated.&lt;/dd&gt;
&lt;/dl&gt;

&lt;p&gt;
The @(&#39;form&#39;) argument should be an ACL2 expression that evaluates to an @(see acl2::error-triple). Be careful about symbol packages when using @(&#39;acl2s-event&#39;) when inside a different package - you may need to fully specify the name of an ACL2 function when calling it. See @(see acl2s-interface-symbol-package-tips) for more information.
&lt;/p&gt;

&lt;p&gt;
When the @(&#39;:quiet&#39;) option is set to @(&#39;t&#39;), @(&#39;acl2s-event&#39;) will attempt to suppress all ACL2 printed output during evaluation of @(&#39;form&#39;). This temporarily overrides the current @(see quiet-mode).
&lt;/p&gt;

&lt;p&gt;
When the @(&#39;:capture-output&#39;) option is set to @(&#39;t&#39;), @(&#39;acl2s-event&#39;) will attempt capture all ACL2 printed output during evaluation of @(&#39;form&#39;). This temporarily overrides the current @(see capture-output).
&lt;/p&gt;

&lt;p&gt;
@(&#39;acl2s-event&#39;) evaluates @(&#39;form&#39;) inside of a @(see acl2::with-prover-step-limit), where the step-limit is set to the value provided to @(&#39;:prover-step-limit&#39;), or ACL2&#39;s set prover-step-limit if that option is not provided. See @(see acl2::set-prover-step-limit) for more information about the prover step-limit. If you don&#39;t want to limit the number of prover steps permitted for an event, set @(&#39;:prover-step-limit&#39;) to nil.
&lt;/p&gt;

&lt;h4&gt;Examples&lt;/h4&gt;
@({(acl2s-event &#39;(definec f (x :int) :int (* x x)))})
Returns (nil nil), and defines the function @(&#39;f&#39;) in the ACL2 world.

@({(acl2s-event &#39;(definec g (x :int) :int (* 5 x)) :quiet t)})
Returns (nil nil), and defines the function @(&#39;g&#39;) in the ACL2 world. Tries to suppresses all ACL2 printed output during this process.

@({(acl2s-event &#39;(defthm triangle-inequality
                              (implies (and (natp x) (natp y))
                                       (&gt;= (+ (abs x) (abs y)) (abs (+ x y)))))
              :prover-step-limit 200)})
Returns (t nil), indicating that the @(&#39;defthm&#39;) did not successfully execute. This is because the @(&#39;defthm&#39;) was limited to 200 prover steps, and more prover steps than that are required to prove it.

@({(acl2s-event &#39;(defthm triangle-inequality
                              (implies (and (natp x) (natp y))
                                       (&gt;= (+ (abs x) (abs y)) (abs (+ x y)))))
              :prover-step-limit 1000)})
Returns (nil nil), and defines the theorem @(&#39;triangle-inequality&#39;) in the ACL2 world. It limits the @(&#39;defthm&#39;) call to 1000 prover steps.
"</span>)</pre>
  </div>

<div class="form-block other" id="form-10" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc acl2s-interface-utils
  <span class="keyword">:parents</span> (acl2s-interface)
  <span class="keyword">:pkg</span> <span class="string">"ACL2S-INTERFACE-EXTRAS"</span>
  <span class="keyword">:short</span> <span class="string">"Some utilities built into the ACL2s interface."</span>
  <span class="keyword">:long</span> <span class="string">"
&lt;ul&gt;
&lt;li&gt;@(&#39;(flatten-and l)&#39;): Given a list of terms representing the conjunction of those terms, recursively flatten any conjunctions inside those terms.&lt;/li&gt;
&lt;li&gt;@(&#39;(conjunction-terms x y)&#39;): Given two terms, produce the conjunction of them, simplifying if either of the terms has a top-level conjunction.&lt;/li&gt;
&lt;li&gt;@(&#39;(cnf-disjunct-to-or expr)&#39;): Given a CNF disjunct, convert to an equivalent ACL2s expression by adding &#39;or.&lt;/li&gt;
&lt;li&gt;@(&#39;(get-hyps expr)&#39;): Get the hypotheses of an implication, returning nil if the given expression is not an implication.&lt;/li&gt;
&lt;li&gt;@(&#39;(get-conc expr)&#39;): Get the conclusion of an implication, returning nil if the given expression is not an implication.&lt;/li&gt;
&lt;/ul&gt;
"</span>)</pre>
  </div>


  </main>
  
<script>
// ACL2 Book HTML Documentation - Interactive Features
// Generated by cert2 - build2 system

// State
let activeFilter = null;
let activePartFilter = null;
let activeNameFilter = null;
let currentFontSize = 14;

// Theme management
function getStoredTheme() {
  return localStorage.getItem('acl2-theme') || 'dark';
}

function setTheme(theme) {
  if (theme === 'light') {
    document.documentElement.setAttribute('data-theme', 'light');
    document.getElementById('theme-toggle').textContent = 'üåô';
  } else {
    document.documentElement.removeAttribute('data-theme');
    document.getElementById('theme-toggle').textContent = '‚òÄÔ∏è';
  }
  localStorage.setItem('acl2-theme', theme);
}

function toggleTheme() {
  const current = getStoredTheme();
  setTheme(current === 'dark' ? 'light' : 'dark');
}

// Font size management
function getStoredFontSize() {
  return parseInt(localStorage.getItem('acl2-fontsize') || '14', 10);
}

function setFontSize(size) {
  size = Math.max(10, Math.min(24, size)); // Clamp between 10-24
  currentFontSize = size;
  document.body.style.fontSize = size + 'px';
  localStorage.setItem('acl2-fontsize', size.toString());
}

function increaseFontSize() {
  setFontSize(currentFontSize + 2);
}

function decreaseFontSize() {
  setFontSize(currentFontSize - 2);
}

// Get all form blocks
function getFormBlocks() {
  return document.querySelectorAll('.form-block');
}

// Clear all filters
function clearFilter() {
  activeFilter = null;
  activePartFilter = null;
  activeNameFilter = null;
  getFormBlocks().forEach(b => {
    b.classList.remove('hidden', 'dimmed');
  });
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  const status = document.querySelector('.filter-status');
  status.classList.remove('active');
  // Slide name filter back to original position
  document.querySelector('.controls-left').style.transform = '';
  // Clear the name filter input
  const nameInput = document.getElementById('name-filter');
  if (nameInput) nameInput.value = '';
}

// Show filter status and slide name filter right
function showFilterStatus(text) {
  const status = document.querySelector('.filter-status');
  status.classList.add('active');
  status.querySelector('.filter-text').textContent = text;
  // Slide name filter to the right to make room
  setTimeout(() => {
    const statusWidth = status.offsetWidth;
    document.querySelector('.controls-left').style.transform = `translateX(${statusWidth + 15}px)`;
  }, 10);
}

// Filter to show only forms that define or reference a symbol
function filterBySymbol(symName, showUsedBy) {
  clearFilter();
  activeFilter = symName;
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines;
    const references = (block.dataset.references || '').split(',');
    const usedBy = (block.dataset.usedBy || '').split(',');
    
    let show = false;
    if (showUsedBy) {
      // Show forms that USE this symbol
      show = references.includes(symName) || definesName === symName;
    } else {
      // Show forms that this symbol USES
      show = usedBy.includes(symName) || definesName === symName;
    }
    
    if (show) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering by: ${symName} (${visibleCount} items)`);
}

// Filter by defthm part (term, hints, rule-classes, etc.)
function filterByPart(formId, partName) {
  clearFilter();
  activePartFilter = { formId, partName };
  
  // Get the part's referenced symbols
  // data-part-term becomes dataset.partTerm, data-part-hints becomes dataset.partHints, etc.
  const block = document.getElementById(formId);
  const datasetKey = 'part' + partName.charAt(0).toUpperCase() + partName.slice(1).replace(/-([a-z])/g, (g) => g[1].toUpperCase());
  const partData = block.dataset[datasetKey];
  if (!partData) return;
  
  const partSyms = partData.split(',').filter(s => s);
  
  // Highlight the button
  block.querySelector(`.part-btn[data-part="${partName}"]`).classList.add('active');
  
  // Hide forms not referenced by this part
  getFormBlocks().forEach(b => {
    const definesName = b.dataset.defines;
    if (b.id === formId || partSyms.includes(definesName)) {
      b.classList.remove('hidden');
    } else {
      b.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering ${formId} :${partName} (${partSyms.length} references)`);
}

// Filter by name (substring or regex)
function filterByName(pattern, useRegex) {
  // Clear other filters but keep the input value
  activeFilter = null;
  activePartFilter = null;
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  
  if (!pattern || pattern.trim() === '') {
    // Empty pattern - show all
    activeNameFilter = null;
    getFormBlocks().forEach(b => b.classList.remove('hidden'));
    const status = document.querySelector('.filter-status');
    status.classList.remove('active');
    document.querySelector('.controls-left').style.transform = '';
    return;
  }
  
  activeNameFilter = pattern;
  
  let matcher;
  let isValidRegex = true;
  
  if (useRegex) {
    try {
      matcher = new RegExp(pattern, 'i');
    } catch (e) {
      // Invalid regex - show error in status and don't filter
      showFilterStatus(`Invalid regex: ${e.message}`);
      return;
    }
  } else {
    // Plain substring match (case-insensitive)
    const lowerPattern = pattern.toLowerCase();
    matcher = { test: (s) => s.toLowerCase().includes(lowerPattern) };
  }
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines || '';
    if (matcher.test(definesName)) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  const modeText = useRegex ? 'regex' : 'name';
  showFilterStatus(`Filtering by ${modeText}: "${pattern}" (${visibleCount} matches)`);
}

// Click on a name to show what references it
function handleNameClick(symName) {
  if (activeFilter === symName) {
    clearFilter();
  } else {
    filterBySymbol(symName, true);
  }
}

// Navigate to a definition (same file or different)
function navigateTo(symName, file) {
  if (file) {
    // External file - navigate
    window.location.href = file + '.html#def-' + symName.toLowerCase();
  } else {
    // Same file - scroll
    const target = document.getElementById('def-' + symName.toLowerCase());
    if (target) {
      target.scrollIntoView({ behavior: 'smooth', block: 'center' });
      target.classList.add('highlight');
      setTimeout(() => target.classList.remove('highlight'), 400);
    }
  }
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  // Part buttons
  document.querySelectorAll('.part-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const formId = btn.closest('.form-block').id;
      const partName = btn.dataset.part;
      if (activePartFilter && activePartFilter.formId === formId && 
          activePartFilter.partName === partName) {
        clearFilter();
      } else {
        filterByPart(formId, partName);
      }
    });
  });
  
  // Clear filter button
  document.querySelector('.clear-filter').addEventListener('click', clearFilter);
  
  // Name filter input
  const nameFilter = document.getElementById('name-filter');
  const regexToggle = document.getElementById('regex-toggle');
  
  let filterTimeout = null;
  nameFilter.addEventListener('input', () => {
    // Debounce the filter to avoid excessive updates while typing
    clearTimeout(filterTimeout);
    filterTimeout = setTimeout(() => {
      filterByName(nameFilter.value, regexToggle.checked);
    }, 150);
  });
  
  // Re-filter when regex toggle changes
  regexToggle.addEventListener('change', () => {
    if (nameFilter.value) {
      filterByName(nameFilter.value, regexToggle.checked);
    }
  });
  
  // Allow Escape key to clear filter when in input
  nameFilter.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      clearFilter();
      nameFilter.blur();
    }
  });
  
  // Symbol references (old span-based refs)
  document.querySelectorAll('.sym-ref').forEach(ref => {
    ref.addEventListener('click', (e) => {
      e.stopPropagation();
      const sym = ref.dataset.sym;
      const file = ref.dataset.file;
      if (file) {
        navigateTo(sym, file);
      } else {
        handleNameClick(sym);
      }
    });
  });
  
  // Symbol links (new anchor-based links)
  // These use standard <a> tags so navigation happens automatically
  // But we need to clear filters if target would be hidden
  document.querySelectorAll('.sym-link').forEach(link => {
    link.addEventListener('click', (e) => {
      const href = link.getAttribute('href');
      if (href && href.startsWith('#')) {
        // Local link - check if target is hidden by filter
        const targetId = href.substring(1);
        const target = document.getElementById(targetId);
        if (target) {
          // If target is hidden, clear the filter first
          if (target.classList.contains('hidden')) {
            clearFilter();
          }
          // Add highlight effect after a short delay
          setTimeout(() => {
            target.classList.add('highlight');
            setTimeout(() => target.classList.remove('highlight'), 400);
          }, 100);
        }
      }
      // For external links, default behavior handles navigation
    });
  });
  
  // Form names (show what uses them)
  document.querySelectorAll('.form-name').forEach(name => {
    name.addEventListener('click', (e) => {
      handleNameClick(name.dataset.sym);
    });
  });
  
  // Handle hash navigation (when arriving at page with #anchor)
  if (window.location.hash) {
    const target = document.querySelector(window.location.hash);
    if (target) {
      setTimeout(() => {
        target.scrollIntoView({ behavior: 'smooth', block: 'center' });
        target.classList.add('highlight');
        setTimeout(() => target.classList.remove('highlight'), 400);
      }, 200);
    }
  }
  
  // Initialize theme from storage
  setTheme(getStoredTheme());
  
  // Initialize font size from storage
  currentFontSize = getStoredFontSize();
  setFontSize(currentFontSize);
  
  // Theme toggle button
  document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
  
  // Font size buttons
  document.getElementById('font-larger').addEventListener('click', increaseFontSize);
  document.getElementById('font-smaller').addEventListener('click', decreaseFontSize);
});

</script>

</body>
</html>
<!DOCTYPE html>
<html lang="en" vocab="http://schema.org/" typeof="SoftwareSourceCode">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>removable-runes - ACL2 Book</title>
  <meta property="name" content="removable-runes">
  <meta property="programmingLanguage" content="ACL2">
  
<style>
/* ACL2 Book HTML Documentation Styles */
/* Generated by cert2 - build2 system */

/* Dark theme (default) */
:root {
  --bg: #1e1e2e;
  --fg: #cdd6f4;
  --comment: #6c7086;
  --keyword: #cba6f7;
  --string: #a6e3a1;
  --function: #89b4fa;
  --type: #f9e2af;
  --link: #89dceb;
  --link-hover: #f5c2e7;
  --highlight: rgba(137, 180, 250, 0.2);
  --border: #313244;
  --block-bg: rgba(49, 50, 68, 0.5);
  --btn-bg: #313244;
  --btn-hover: rgba(137, 180, 250, 0.2);
}

/* Light theme */
[data-theme="light"] {
  --bg: #eff1f5;
  --fg: #4c4f69;
  --comment: #6c6f85;
  --keyword: #8839ef;
  --string: #40a02b;
  --function: #1e66f5;
  --type: #df8e1d;
  --link: #04a5e5;
  --link-hover: #ea76cb;
  --highlight: rgba(30, 102, 245, 0.15);
  --border: #ccd0da;
  --block-bg: rgba(204, 208, 218, 0.3);
  --btn-bg: #ccd0da;
  --btn-hover: rgba(30, 102, 245, 0.15);
}

body {
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  background: var(--bg);
  color: var(--fg);
  margin: 0;
  padding: 20px;
  line-height: 1.6;
  font-size: 14px;
  transition: background 0.1s, color 0.1s;
}

/* Controls toolbar */
.controls-left {
  position: fixed;
  top: 10px;
  left: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
  transition: transform 0.1s ease;
}

.controls-right {
  position: fixed;
  top: 10px;
  right: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
}

.control-btn {
  padding: 6px 12px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-family: inherit;
  font-size: 14px;
  transition: all 0.1s;
}

.control-btn:hover {
  background: var(--btn-hover);
  border-color: var(--link);
}

.name-filter {
  padding: 6px 10px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  font-family: inherit;
  font-size: 13px;
  width: 150px;
  transition: all 0.1s;
}

.name-filter:focus {
  outline: none;
  border-color: var(--link);
  width: 200px;
}

.name-filter::placeholder {
  color: var(--comment);
}

.regex-label {
  display: flex;
  align-items: center;
  gap: 4px;
  color: var(--comment);
  font-size: 12px;
  cursor: pointer;
}

.regex-label input {
  cursor: pointer;
}

.book-header {
  border-bottom: 2px solid var(--border);
  padding-bottom: 20px;
  margin-bottom: 20px;
}

.book-header h1 {
  color: var(--keyword);
  margin: 0;
}

.book-header .path {
  color: var(--comment);
  font-size: 0.9em;
}

.book-header .path .source-link {
  color: var(--comment);
  text-decoration: none;
}

.book-header .path .source-link:hover {
  color: var(--link);
  text-decoration: underline;
}

.form-block {
  margin: 10px 0;
  padding: 15px;
  background: var(--block-bg);
  border-radius: 8px;
  border-left: 3px solid var(--border);
}

.form-block.theorem { border-left-color: var(--keyword); }
.form-block.function { border-left-color: var(--function); }
.form-block.macro { border-left-color: var(--type); }
.form-block.include-book { border-left-color: var(--string); }

.form-block.hidden { display: none; }
.form-block.dimmed { opacity: 0.3; }

.form-block.highlight {
  animation: highlight-pulse 0.4s ease-out;
}

@keyframes highlight-pulse {
  0% { background: var(--highlight); box-shadow: 0 0 20px var(--link); }
  100% { background: rgba(49, 50, 68, 0.5); box-shadow: none; }
}

.form-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.form-name {
  color: var(--function);
  font-weight: bold;
  cursor: pointer;
}

.form-name:hover {
  color: var(--link-hover);
  text-decoration: underline;
}

.form-type {
  color: var(--comment);
  font-size: 0.85em;
}

pre.code {
  margin: 0;
  overflow-x: auto;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.sym-ref {
  color: var(--link);
  cursor: pointer;
  border-radius: 2px;
}

.sym-ref:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.sym-ref.local-def { color: var(--function); font-weight: bold; }
.sym-ref.external { color: var(--type); }

/* Symbol links (clickable hyperlinks) */
.sym-link {
  color: var(--link);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
  position: relative;
}

.sym-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

.sym-link.local-def {
  color: var(--function);
  font-weight: bold;
}

.sym-link.external {
  color: var(--type);
}

/* Tooltips using title attribute with custom styling */
.sym-link[title] {
  /* Browser will show title on hover */
}

/* Syntax highlighting in code blocks */
.keyword {
  color: var(--keyword);
}

.string {
  color: var(--string);
}

.number {
  color: #f77524; /* orange */
}

/* Include-book path links */
.include-path {
  color: var(--string);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
}

.include-path:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

/* Part buttons for defthm */
.part-buttons {
  display: flex;
  gap: 5px;
  margin: 10px 0;
  flex-wrap: wrap;
}

.part-btn {
  padding: 4px 10px;
  background: var(--border);
  border: 1px solid var(--comment);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-size: 0.85em;
  font-family: inherit;
}

.part-btn:hover {
  background: var(--highlight);
  border-color: var(--link);
}

.part-btn.active {
  background: var(--link);
  color: var(--bg);
  border-color: var(--link);
}

/* References panel */
.refs-panel {
  margin-top: 10px;
  padding: 10px;
  background: rgba(0,0,0,0.2);
  border-radius: 4px;
  display: none;
}

.refs-panel.visible { display: block; }

.refs-panel h4 {
  margin: 0 0 5px 0;
  color: var(--comment);
  font-size: 0.9em;
}

.refs-list {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

/* Included books section */
.includes-section {
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(49, 50, 68, 0.3);
  border-radius: 8px;
  border: 1px solid var(--border);
}

.includes-section h2 {
  margin: 0 0 10px 0;
  color: var(--comment);
  font-size: 1em;
  font-weight: normal;
}

.includes-list {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.include-link {
  padding: 6px 12px;
  background: var(--border);
  border-radius: 4px;
  color: var(--link);
  text-decoration: none;
  font-size: 0.9em;
  transition: all 0.1s;
}

.include-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.include-link.local {
  border-left: 2px solid var(--comment);
}

/* Filter status */
.filter-status {
  position: fixed;
  top: 10px;
  left: 20px;
  background: var(--bg);
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: 4px;
  z-index: 201;
  display: none;
  align-items: center;
  gap: 10px;
}

.filter-status.active {
  display: flex;
  align-items: center;
  gap: 10px;
}

.clear-filter {
  padding: 5px 15px;
  background: var(--keyword);
  color: var(--bg);
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

/* RDFa vocab indicator */
[vocab] { /* semantic web annotations present */ }

</style>

</head>
<body>
  <div class="controls-left">
    <input type="text" id="name-filter" class="name-filter" placeholder="Filter by name..." title="Filter definitions by name">
    <label class="regex-label"><input type="checkbox" id="regex-toggle"> regex</label>
  </div>

  <div class="controls-right">
    <button class="control-btn" id="theme-toggle" title="Toggle light/dark theme">☀️</button>
    <button class="control-btn" id="font-smaller" title="Decrease font size">A-</button>
    <button class="control-btn" id="font-larger" title="Increase font size">A+</button>
  </div>

  <div class="filter-status">
    <span class="filter-text">Filtering...</span>
    <button class="clear-filter">Clear Filter</button>
  </div>
  
  <div class="book-header">
    <h1 property="name">removable-runes</h1>
    <div class="path"><a href="removable-runes.lisp" class="source-link">books/tools/removable-runes</a></div>
  </div>
  
  <main property="text">
  <div class="includes-section">
    <h2>Included Books</h2>
    <div class="includes-list">
      <a class="include-link" href="../xdoc/top.html" title="xdoc/top">top</a>
    </div>
  </div>

<div class="form-block other" id="form-0" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-in-package" data-sym="IN-PACKAGE">in-package</a> <span class="string">"ACL2"</span>)</pre>
  </div>

<div class="form-block include-book" id="form-1" typeof="Code">
    <div class="form-header"><span class="form-type">include-book</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../xdoc/top.html" title="Open xdoc/top">"xdoc/top"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block other" id="form-2" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc <a class="sym-link local-def" href="#def-removable-runes" data-sym="REMOVABLE-RUNES" title="(defmacro removable-runes (form &amp;key (verbose-p &#39;:normal) (multiplier &#39;1))
  (declare
   (xargs :guard
    (and (member-eq verbose-p *rrv-levels*) (rationalp multiplier)
         (&lt; 0 multiplier))))
...">removable-runes</a>
  <span class="keyword">:parents</span> (proof-automation debugging)
  <span class="keyword">:short</span> <span class="string">"Compute @(see rune)s to @(see disable)"</span>
  <span class="keyword">:long</span> <span class="string">"@({

 Example Form:
 (removable-runes (defun proper-cons-nest-p (x)
                    (declare (xargs :guard (pseudo-termp x)))
                    (cond ((symbolp x) nil)
                          ((fquotep x) (true-listp (cadr x)))
                          ((eq (ffn-symb x) &#39;cons)
                           (proper-cons-nest-p (fargn x 2)))
                          (t nil)))
                  :verbose-p :minimal)

 General Form:
 (removable-runes event-form
                  :verbose-p  v ; default = :normal
                  :multiplier m ; default = 1)
                  )
 })

 &lt;p&gt;where @(&#39;event-form&#39;) is an embeddable event (see @(see events)); @(&#39;v&#39;) is
 @(&#39;nil&#39;), @(&#39;:minimal&#39;), @(&#39;:normal&#39;), or @(&#39;t&#39;); and @(&#39;m&#39;) is a positive
 rational number.  The value returned is an @(see error-triple) @(&#39;(mv erp
 runes state)&#39;), where @(&#39;erp&#39;) is typically @(&#39;nil&#39;) and @(&#39;runes&#39;) is a list
 of @(see rune)s that can be @(see disable)d for the indicated @(&#39;event-form&#39;);
 moreover, if the multiplier @(&#39;m&#39;) is less than 1, then the event is admitted
 with fewer prover steps.  (See @(see set-prover-step-limit) for a discussion
 of prover steps.)  For example, if the list of runes returned for an event
 form is @(&#39;((:definition f1) (:rewrite thm1))&#39;), then the proof of that event
 form was performed successfully &amp;mdash; and, for the default @(&#39;m&#39;) = 1, with
 no more prover steps &amp;mdash; if we first evaluate the event
 @(&#39;(in-theory (disable (:definition f1) (:rewrite thm1)))&#39;).&lt;/p&gt;

 &lt;p&gt;For a related utility, see @(see minimal-runes).&lt;/p&gt;

 &lt;p&gt;WARNING: It is generally best to avoid using @(&#39;:&#39;)@(tsee in-theory) @(see
 hints) in the form you supply to @(&#39;removable-runes&#39;) or its related utility,
 @(&#39;minimal-runes&#39;).  We explain why below, after describing how the tool
 works.&lt;/p&gt;

 &lt;p&gt;We now describe the two keyword arguments in turn, and in doing so, we
 explain how the tool works.&lt;/p&gt;

 &lt;p&gt;The @(&#39;:verbose-p&#39;) argument controls the level of output.  We begin by
 describing the default behavior.  The output for the default value
 @(&#39;:verbose-p = :normal&#39;) is broken into sections for successive ``rounds&#39;&#39;.
 Each section appears as follows, other than the initial section, which only
 lists the steps for the original proof attempt.&lt;/p&gt;

 @({
 New steps: [steps]
 Old steps: [steps] (Initially: [steps])
 Time: [time]
 Removed: [rune]
 Removable:
 [list of runes]
 Used:
 [list of runes]
 [progress line]
 })

 &lt;p&gt;The ``@(&#39;New Steps&#39;)&#39;&#39; field has the number of prover steps taken by that
 round&#39;s proof attempt.  The ``@(&#39;Old Steps&#39;)&#39;&#39;, ``@(&#39;Time&#39;)&#39;&#39;,
 ``@(&#39;Removed&#39;)&#39;&#39;, ``@(&#39;Removable&#39;)&#39;&#39;, and ``@(&#39;Used&#39;)&#39;&#39; fields state the
 following, respectively: the number of prover steps for the previous round and
 for the initial round (but this line is omitted for the initial round); the
 time taken for the new event (by default, the run time; see @(see
 get-internal-time)); the rune that was newly disabled for the current round;
 the list of runes disabled after the current round, which extends the previous
 round&#39;s @(&#39;Removable&#39;) field with that newly disabled rune; and the list of
 runes used automatically in the proof for the current round.  For all but the
 initial round, the event was admitted in the previous round after disabling
 the @(&#39;Removable&#39;) runes (with an @(tsee in-theory) event), resulting in a set
 @(&#39;S&#39;) of runes reported for that event.  The progress line shows attempts in
 the current round to decrease the number of steps by disabling one rune from
 @(&#39;S&#39;) per attempt, using @(&#39;&#39;.&#39;&#39;) for a failed such attempt and @(&#39;&#39;+&#39;&#39;) for
 a success.  Each such rune is chosen from the list of runes reported for the
 previous round.&lt;/p&gt;

 &lt;p&gt;If @(&#39;:verbose-p = :minimal&#39;), then the output will be as described above
 except that the @(&#39;Removable&#39;) and @(&#39;Used&#39;) fields are omitted.  If
 @(&#39;:verbose-p = nil&#39;), then there is no output.  Finally, if @(&#39;:verbose-p =
 t&#39;), then all the fields are printed, but in addition you will see the usual
 output for each attempt, each (except for the initial event) preceded by the
 corresponding @(tsee in-theory) event.&lt;/p&gt;

 &lt;p&gt;We now say a bit more about the tool&#39;s algorithm as we describe the
 @(&#39;:multiplier&#39;) argument, which is 1 by default but can also be any positive
 rational number.  Recall that each round is an attempt to find a rune to
 disable: specifically, one that provides the fewest number of resulting prover
 steps.  The multiplier provides a bound on the number of prover steps: if
 @(&#39;s0&#39;) is the number of steps for the preceding (or initial) round, then the
 number of steps for the next round is not allowed to exceed @(&#39;(floor (* m s0)
 1)&#39;), where @(&#39;m&#39;) is the value of the @(&#39;:multiplier&#39;) keyword.  If this
 bound reaches 0 (which can only happen if @(&#39;m &lt; 1&#39;), the algorithm
 terminates.&lt;/p&gt;

 &lt;p&gt;As promised above, we now explain why it is generally best to avoid using
 @(&#39;:&#39;)@(tsee in-theory) @(see hints) in the form you supply to
 @(&#39;removable-runes&#39;) or its related utility, @(&#39;minimal-runes&#39;).  To see why,
 consider the following example.  First evaluate:&lt;/p&gt;

 @({
 (include-book &quot;tools/removable-runes&quot; :dir :system)
 (defund foo (x) (cons x x))
 })

 &lt;p&gt;Notice that @(&#39;foo&#39;) is now @(see disable)d; see @(see defund).  The
 following example may seem surprising; an explanation is below.&lt;/p&gt;

 @({
 ACL2 !&gt;(removable-runes
         (thm (equal (foo x) (cons x x))
              :hints ((&quot;Goal&quot; :in-theory (enable foo)))))
 -
 New steps: 15 (initial attempt)
 Time: 0.00
 Used: ((:DEFINITION FOO))
 +
 New steps: 15
 Old steps: 15 (Initially: 15)
 Time: 0.00
 Removed: (:DEFINITION FOO)
 Removable:
 ((:DEFINITION FOO))
 Used:
 ((:DEFINITION FOO))

  ((:DEFINITION FOO))
 ACL2 !&gt;
 })

 &lt;p&gt;The result is that the definition of @(&#39;foo&#39;) is removable, i.e., can be
 disabled; yet clearly that definition is needed for the proof!  To understand
 this possibly surprising result, understand that @(&#39;removable-runes&#39;) precedes
 each proof attempt by globally disabling the candidate set of removable runes.
 So in essence the proof attempt when attempting to disable the definition of
 @(&#39;foo&#39;) is really as follows.&lt;/p&gt;

 @({
 (progn (in-theory (disable foo))
        (thm (equal (foo x) (cons x x))
             :hints ((&quot;Goal&quot; :in-theory (enable foo)))))
 })

 &lt;p&gt;Obviously the hint takes precedence over the initial @(&#39;in-theory&#39;) event,
 which is why the proof succeeds.  The moral of the story is this: avoid
 @(&#39;:in-theory&#39;) hints when using @(&#39;removable-runes&#39;) or its companion tool,
 @(tsee minimal-runes).  Instead, you could do this, for example:&lt;/p&gt;

 @({
 (in-theory (enable foo))
 (removable-runes
  (thm (equal (foo x) (cons x x))))
 })

 &lt;p&gt;Finally, we expand on a point made above.  When a rune is chosen to add to
 the evolving list of disables, the corresponding proof attempt might actually
 involve runes that were not present in any earlier proof attempt.  Any new
 such runes are then considered for disabling in later rounds.&lt;/p&gt;"</span>)</pre>
  </div>

<div class="form-block other" id="form-3" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc <a class="sym-link local-def" href="#def-minimal-runes" data-sym="MINIMAL-RUNES" title="(defmacro minimal-runes (form &amp;key (verbose-p &#39;:normal) (multiplier &#39;1) name)
  (declare
   (xargs :guard
    (and (member-eq verbose-p *rrv-levels*) (rationalp multiplier)
         (&lt; 0 multiplier))))
...">minimal-runes</a>
  <span class="keyword">:parents</span> (proof-automation debugging)
  <span class="keyword">:short</span> <span class="string">"Compute @(see rune)s to leave @(see enable)d"</span>
  <span class="keyword">:long</span> <span class="string">"@({

 Example Form:
 (minimal-runes (defun proper-cons-nest-p (x)
                  (declare (xargs :guard (pseudo-termp x)))
                  (cond ((symbolp x) nil)
                        ((fquotep x) (true-listp (cadr x)))
                        ((eq (ffn-symb x) &#39;cons)
                         (proper-cons-nest-p (fargn x 2)))
                        (t nil)))
                  :verbose-p :minimal)

 General Form:
 (minimal-runes event-form
                :verbose-p  v ; default = :normal ;
                :multiplier m ; default = 1 ;
                :name       n ; default = nil ;
                )
 })

 &lt;p&gt;where @(&#39;event-form&#39;) is an embeddable event (see @(see events)); @(&#39;v&#39;) is
 @(&#39;nil&#39;), @(&#39;:minimal&#39;), @(&#39;:normal&#39;), or @(&#39;t&#39;); @(&#39;m&#39;) is a positive
 rational number; and n is nil or a @(see logical-name).  The value returned is
 an @(see error-triple) @(&#39;(mv erp runes state)&#39;), where @(&#39;erp&#39;) is typically
 @(&#39;nil&#39;) and @(&#39;runes&#39;) is a list of @(see rune)s that suffice to admit
 the indicated @(&#39;event-form&#39;); moreover, if the multiplier @(&#39;m&#39;) is less
 than 1, then the event is admitted with fewer prover steps.&lt;/p&gt;

 &lt;p&gt;This utility is essentially identical to @(&#39;removable-runes&#39;) &amp;mdash;
 indeed, they share the same algorithm &amp;mdash; except that instead of returning
 a list of @(see rune)s to disable, it returns a list of runes sufficient for
 admitting the event.  See @(see removable-runes) for detailed documentation.
 There is one other difference: @(&#39;minimal-runes&#39;) has an extra keyword
 argument, @(&#39;:name&#39;).  If @(&#39;:name&#39;) is supplied then its value must be a
 symbol, @(&#39;n&#39;), that is a @(see logical-name).  In that case, the list of
 runes returned is modified by first removing all those in @(&#39;(current-theory
 n)&#39;); see @(see current-theory).&lt;/p&gt;"</span>)</pre>
  </div>

<div class="form-block other" id="form-4" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-set-state-ok" data-sym="SET-STATE-OK">set-state-ok</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>)</pre>
  </div>

<div class="form-block other" id="form-5" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-program" data-sym="PROGRAM">program</a>)</pre>
  </div>

<div class="form-block function" id="def-non-removable-runes" data-defines="NON-REMOVABLE-RUNES" data-references="EXECUTABLE-COUNTERPART-MINIMAL-THEORY,DEFINITION-MINIMAL-THEORY,QUOTE,THEORY,UNION-EQUAL,*FAKE-RUNE-FOR-LINEAR*,*FAKE-RUNE-FOR-TYPE-SET*,*FAKE-RUNE-FOR-ANONYMOUS-ENABLED-RULE*,LIST,APPEND,WORLD,DEFUN" data-used-by="REMOVABLE-OR-MINIMAL-RUNES-FN" data-part-name="NON-REMOVABLE-RUNES" data-part-args="WORLD" data-part-body="EXECUTABLE-COUNTERPART-MINIMAL-THEORY,DEFINITION-MINIMAL-THEORY,QUOTE,THEORY,UNION-EQUAL,*FAKE-RUNE-FOR-LINEAR*,*FAKE-RUNE-FOR-TYPE-SET*,*FAKE-RUNE-FOR-ANONYMOUS-ENABLED-RULE*,LIST,APPEND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="NON-REMOVABLE-RUNES">non-removable-runes</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-non-removable-runes" data-sym="NON-REMOVABLE-RUNES" title="(defun non-removable-runes (world)
  (append
   (list *fake-rune-for-anonymous-enabled-rule* *fake-rune-for-type-set*
         *fake-rune-for-linear*)
   (union-equal (theory &#39;definition-minimal-theory)">non-removable-runes</a>
  (world)
  (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> *fake-rune-for-anonymous-enabled-rule*
      *fake-rune-for-type-set*
      <a class="sym-link system" href="../../rewrite.html#def-_2Afake-rune-for-linear_2A" data-sym="*FAKE-RUNE-FOR-LINEAR*">*fake-rune-for-linear*</a>)
    (<a class="sym-link system" href="../../axioms.html#def-union-equal" data-sym="UNION-EQUAL">union-equal</a> (theory 'definition-minimal-theory)
      (theory 'executable-counterpart-minimal-theory))))</pre>
  </div>

<div class="form-block function" id="def-get-event-data-total-time" data-defines="GET-EVENT-DATA-TOTAL-TIME" data-references="+,D,C,B,CDR,CAR,A,LET*,TIME,QUOTE,GET-EVENT-DATA,LST,LET,STATE,DEFUN" data-used-by="EVENT-STEPS-RUNES-FORM" data-part-name="GET-EVENT-DATA-TOTAL-TIME" data-part-args="STATE" data-part-body="+,D,C,B,CDR,CAR,A,LET*,STATE,TIME,QUOTE,GET-EVENT-DATA,LST,LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="GET-EVENT-DATA-TOTAL-TIME">get-event-data-total-time</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-get-event-data-total-time" data-sym="GET-EVENT-DATA-TOTAL-TIME" title="(defun get-event-data-total-time (state)
  (let ((lst (get-event-data &#39;time state)))
    (let* ((a (car lst))
           (lst (cdr lst))
           (b (car lst))
...">get-event-data-total-time</a>
  (state)
  (let ((lst (<a class="sym-link system" href="../../history-management.html#def-get-event-data" data-sym="GET-EVENT-DATA">get-event-data</a> 'time state)))
    (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((a (car lst)) (lst (cdr lst))
        (b (car lst))
        (lst (cdr lst))
        (c (car lst))
        (lst (cdr lst))
        (d (car lst)))
      (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> a b c d))))</pre>
  </div>

<div class="form-block function" id="def-event-steps-runes-form" data-defines="EVENT-STEPS-RUNES-FORM" data-references="SILENT-ERROR,GET-EVENT-DATA-TOTAL-TIME,RULES,SET-DIFFERENCE-EQUAL,LAST-PROVER-STEPS,OR,T,ABORT-CAUSES,GET-EVENT-DATA,INTERRUPT,MEMBER-EQ,COND,IGNORE,DECLARE,OUR-TIME,OUR-RUNES,OUR-STEPS,QUOTE,F-PUT-GLOBAL,PPROGN,STATE,VAL,ERP,MV-LET,MAKE-EVENT,PROGN,WITH-OUTPUT,QUASIQUOTE,IGNORED-RUNES,VERBOSE-P,FORM0,DISABLE-FORM,DEFUN" data-used-by="EVENT-STEPS-RUNES+" data-part-name="EVENT-STEPS-RUNES-FORM" data-part-args="IGNORED-RUNES,VERBOSE-P,FORM0,DISABLE-FORM" data-part-body="SILENT-ERROR,GET-EVENT-DATA-TOTAL-TIME,RULES,SET-DIFFERENCE-EQUAL,LAST-PROVER-STEPS,OR,T,ABORT-CAUSES,GET-EVENT-DATA,INTERRUPT,MEMBER-EQ,COND,IGNORE,DECLARE,OUR-TIME,OUR-RUNES,OUR-STEPS,QUOTE,F-PUT-GLOBAL,PPROGN,STATE,VAL,ERP,MV-LET,MAKE-EVENT,PROGN,WITH-OUTPUT,QUASIQUOTE" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="EVENT-STEPS-RUNES-FORM">event-steps-runes-form</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-event-steps-runes-form" data-sym="EVENT-STEPS-RUNES-FORM" title="(defun event-steps-runes-form (disable-form form0 verbose-p ignored-runes)
  `(with-output :stack :push :off :all :gag-mode nil
                (progn
                 ,@(and disable-form
                        (list
...">event-steps-runes-form</a>
  (disable-form form0 verbose-p ignored-runes)
  `(<a class="sym-link system" href="../../axioms.html#def-with-output" data-sym="WITH-OUTPUT">with-output</a> <span class="keyword">:stack</span> <span class="keyword">:push</span> <span class="keyword">:off</span> <span class="keyword">:all</span> <span class="keyword">:gag-mode</span> nil
    (<a class="sym-link system" href="../../axioms.html#def-progn" data-sym="PROGN">progn</a> ,@(AND DISABLE-FORM
       (LIST
        (IF (EQ VERBOSE-P T)
            `(PROGN ,DISABLE-FORM (VALUE-TRIPLE (CW &quot;~x0~|&quot; &#39;,DISABLE-FORM)))
            DISABLE-FORM)))
      (<a class="sym-link system" href="../../axioms.html#def-make-event" data-sym="MAKE-EVENT">make-event</a> (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (erp val state)
          (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link system" href="../../axioms.html#def-f-put-global" data-sym="F-PUT-GLOBAL">f-put-global</a> 'our-steps nil state)
            (<a class="sym-link system" href="../../axioms.html#def-f-put-global" data-sym="F-PUT-GLOBAL">f-put-global</a> 'our-runes nil state)
            (<a class="sym-link system" href="../../axioms.html#def-f-put-global" data-sym="F-PUT-GLOBAL">f-put-global</a> 'our-time nil state)
            ,(IF (EQ VERBOSE-P T)
     `(WITH-OUTPUT :STACK :POP ,FORM0)
     FORM0))
          (declare (ignore val))
          (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-member-eq" data-sym="MEMBER-EQ">member-eq</a> 'interrupt (<a class="sym-link system" href="../../history-management.html#def-get-event-data" data-sym="GET-EVENT-DATA">get-event-data</a> 'abort-causes state)) (<a class="sym-link system" href="../../axioms.html#def-f-put-global" data-sym="F-PUT-GLOBAL">f-put-global</a> 'our-steps nil state))
              (erp (<a class="sym-link system" href="../../axioms.html#def-f-put-global" data-sym="F-PUT-GLOBAL">f-put-global</a> 'our-steps <span class="keyword">:error</span> state))
              (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link system" href="../../axioms.html#def-f-put-global" data-sym="F-PUT-GLOBAL">f-put-global</a> 'our-steps
                    (<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../history-management.html#def-last-prover-steps" data-sym="LAST-PROVER-STEPS">last-prover-steps</a> state) <span class="keyword">:error</span>)
                    state)
                  (<a class="sym-link system" href="../../axioms.html#def-f-put-global" data-sym="F-PUT-GLOBAL">f-put-global</a> 'our-runes
                    (<a class="sym-link system" href="../../axioms.html#def-set-difference-equal" data-sym="SET-DIFFERENCE-EQUAL">set-difference-equal</a> (<a class="sym-link system" href="../../history-management.html#def-get-event-data" data-sym="GET-EVENT-DATA">get-event-data</a> 'rules state)
                      ',IGNORED-RUNES)
                    state)
                  (<a class="sym-link system" href="../../axioms.html#def-f-put-global" data-sym="F-PUT-GLOBAL">f-put-global</a> 'our-time
                    (<a class="sym-link local-def" href="#def-get-event-data-total-time" data-sym="GET-EVENT-DATA-TOTAL-TIME" title="(defun get-event-data-total-time (state)
  (let ((lst (get-event-data &#39;time state)))
    (let* ((a (car lst))
           (lst (cdr lst))
           (b (car lst))
...">get-event-data-total-time</a> state)
                    state))))
            (silent-error state)))))))</pre>
  </div>

<div class="form-block function" id="def-event-steps-runes_2B" data-defines="EVENT-STEPS-RUNES+" data-references="OUR-TIME,OUR-RUNES,OUR-STEPS,F-GET-GLOBAL,LIST*,VALUE,T,EVENT-STEPS,QUOTE,TRANS-EVAL,ER-PROGN,EVENT-STEPS-RUNES-FORM,NEW-FORM,DISABLE,IN-THEORY,AND,DISABLE-FORM,WITH-PROVER-STEP-LIMIT,QUASIQUOTE,IF,FORM0,LET*,STATE,IGNORED-RUNES,VERBOSE-P,DISABLES,STEPS,FORM,DEFUN" data-used-by="REMOVABLE-OR-MINIMAL-RUNES-FN,REMOVABLE-RUNES-NEXT" data-part-name="EVENT-STEPS-RUNES+" data-part-args="STATE,IGNORED-RUNES,VERBOSE-P,DISABLES,STEPS,FORM" data-part-body="OUR-TIME,OUR-RUNES,OUR-STEPS,F-GET-GLOBAL,LIST*,VALUE,T,STATE,EVENT-STEPS,QUOTE,TRANS-EVAL,ER-PROGN,IGNORED-RUNES,VERBOSE-P,EVENT-STEPS-RUNES-FORM,NEW-FORM,DISABLE,IN-THEORY,DISABLES,AND,DISABLE-FORM,FORM,WITH-PROVER-STEP-LIMIT,QUASIQUOTE,STEPS,IF,FORM0,LET*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="EVENT-STEPS-RUNES+">event-steps-runes+</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-event-steps-runes_2B" data-sym="EVENT-STEPS-RUNES+" title="(defun event-steps-runes+ (form steps disables verbose-p ignored-runes state)
  (let* ((form0
          (if steps
              `(with-prover-step-limit ,steps ,form)
              form))
...">event-steps-runes+</a>
  (form steps disables verbose-p ignored-runes state)
  (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((form0 (if steps
         `(<a class="sym-link system" href="../../history-management.html#def-with-prover-step-limit" data-sym="WITH-PROVER-STEP-LIMIT">with-prover-step-limit</a> ,STEPS ,FORM)
         form)) (disable-form (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> disables `(<a class="sym-link system" href="../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (disable ,@DISABLES))))
      (new-form (<a class="sym-link local-def" href="#def-event-steps-runes-form" data-sym="EVENT-STEPS-RUNES-FORM" title="(defun event-steps-runes-form (disable-form form0 verbose-p ignored-runes)
  `(with-output :stack :push :off :all :gag-mode nil
                (progn
                 ,@(and disable-form
                        (list
...">event-steps-runes-form</a> disable-form
          form0
          verbose-p
          ignored-runes)))
    (<a class="sym-link system" href="../../axioms.html#def-er-progn" data-sym="ER-PROGN">er-progn</a> (trans-eval new-form 'event-steps state <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>)
      (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> (<a class="sym-link system" href="../../axioms.html#def-f-get-global" data-sym="F-GET-GLOBAL">f-get-global</a> 'our-steps state)
          (<a class="sym-link system" href="../../axioms.html#def-f-get-global" data-sym="F-GET-GLOBAL">f-get-global</a> 'our-runes state)
          (<a class="sym-link system" href="../../axioms.html#def-f-get-global" data-sym="F-GET-GLOBAL">f-get-global</a> 'our-time state))))))</pre>
  </div>

<div class="form-block constant" id="def-_2Arrv-levels_2A" data-defines="*RRV-LEVELS*" data-references="T,QUOTE,DEFCONST" data-used-by="MINIMAL-RUNES,REMOVABLE-RUNES,RRV" typeof="Code">
    <div class="form-header"><span class="form-name" property="name" data-sym="*RRV-LEVELS*">*rrv-levels*</span><span class="form-type">constant</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> <a class="sym-link local-def" href="#def-_2Arrv-levels_2A" data-sym="*RRV-LEVELS*" title="(defconst *rrv-levels* &#39;(nil :minimal :normal t))">*rrv-levels*</a> '(nil <span class="keyword">:minimal</span> <span class="keyword">:normal</span> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>))</pre>
  </div>

<div class="form-block macro" id="def-rrv" data-defines="RRV" data-references="STATE,T,VERBOSE-P,POSITION,>=,COND,QUASIQUOTE,*RRV-LEVELS*,MEMBER-EQ,XARGS,DECLARE,FORM,LEVEL,DEFMACRO" data-used-by="REMOVABLE-OR-MINIMAL-RUNES-FN,REMOVABLE-OR-MINIMAL-RUNES-LOOP,REMOVABLE-RUNES-PRINT-STATUS,REMOVABLE-RUNES-NEXT" typeof="Code">
    <div class="form-header"><span class="form-name" property="name" data-sym="RRV">rrv</span><span class="form-type">macro</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> <a class="sym-link local-def" href="#def-rrv" data-sym="RRV" title="(defmacro rrv (level form)
  (declare (xargs :guard (member-eq level *rrv-levels*)))
  `(cond
    ((&gt;= (position verbose-p *rrv-levels*) ,(position level *rrv-levels*))
     ,form)">rrv</a>
  (level form)
  (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-member-eq" data-sym="MEMBER-EQ">member-eq</a> level <a class="sym-link local-def" href="#def-_2Arrv-levels_2A" data-sym="*RRV-LEVELS*" title="(defconst *rrv-levels* &#39;(nil :minimal :normal t))">*rrv-levels*</a>)))
  `(<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-_3E_3D" data-sym="&gt;=">&gt;=</a> (<a class="sym-link system" href="../../axioms.html#def-position" data-sym="POSITION">position</a> verbose-p <a class="sym-link local-def" href="#def-_2Arrv-levels_2A" data-sym="*RRV-LEVELS*" title="(defconst *rrv-levels* &#39;(nil :minimal :normal t))">*rrv-levels*</a>)
       ,(POSITION LEVEL *RRV-LEVELS*)) ,FORM)
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> state)))</pre>
  </div>

<div class="form-block function" id="def-removable-runes-next" data-defines="REMOVABLE-RUNES-NEXT" data-references="CDR,PRINC$,RRV,PPROGN,>,EQL,OR,ABORT!,NULL,CDDR,TIME2,CADR,RUNES2,STEPS2,LET,CAR,CONS,EVENT-STEPS-RUNES+,STEPS/RUNES/TIME,ERP,MV-LET,T,LIST*,AND,VALUE,ENDP,COND,STATE,CHANNEL,IGNORED-RUNES,VERBOSE-P,DISABLES,BEST-TIME,BEST-USED,BEST-RUNE,RUNES,STEPS-BOUND,FORM,DEFUN" data-used-by="REMOVABLE-OR-MINIMAL-RUNES-LOOP" data-part-name="REMOVABLE-RUNES-NEXT" data-part-args="STATE,CHANNEL,IGNORED-RUNES,VERBOSE-P,DISABLES,BEST-TIME,BEST-USED,BEST-RUNE,RUNES,STEPS-BOUND,FORM" data-part-body="CDR,REMOVABLE-RUNES-NEXT,CHANNEL,PRINC$,RRV,PPROGN,>,EQL,OR,ABORT!,NULL,CDDR,TIME2,CADR,RUNES2,STEPS2,LET,IGNORED-RUNES,VERBOSE-P,DISABLES,CAR,CONS,FORM,EVENT-STEPS-RUNES+,STATE,STEPS/RUNES/TIME,ERP,MV-LET,T,BEST-TIME,BEST-USED,STEPS-BOUND,LIST*,BEST-RUNE,AND,VALUE,RUNES,ENDP,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="REMOVABLE-RUNES-NEXT">removable-runes-next</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-removable-runes-next" data-sym="REMOVABLE-RUNES-NEXT" title="(defun removable-runes-next
       (form steps-bound runes best-rune best-used best-time disables verbose-p
        ignored-runes channel state)
  (cond
   ((endp runes)
...">removable-runes-next</a>
  (form steps-bound
    runes
    best-rune
    best-used
    best-time
    disables
    verbose-p
    ignored-runes
    channel
    state)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> runes) (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> best-rune
          (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> steps-bound best-rune best-used best-time))))
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (erp steps/runes/time state)
        (<a class="sym-link local-def" href="#def-event-steps-runes_2B" data-sym="EVENT-STEPS-RUNES+" title="(defun event-steps-runes+ (form steps disables verbose-p ignored-runes state)
  (let* ((form0
          (if steps
              `(with-prover-step-limit ,steps ,form)
              form))
...">event-steps-runes+</a> form
          steps-bound
          (cons (car runes) disables)
          verbose-p
          ignored-runes
          state)
        (let ((steps2 (car steps/runes/time)) (runes2 (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> steps/runes/time))
            (time2 (<a class="sym-link system" href="../../axioms.html#def-cddr" data-sym="CDDR">cddr</a> steps/runes/time)))
          (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> steps2) (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-abort_21" data-sym="ABORT!">abort!</a>)))
            ((<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> erp (<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> steps2 <span class="keyword">:error</span>) (<a class="sym-link system" href="../../axioms.html#def-_3E" data-sym="&gt;">&gt;</a> steps2 steps-bound)) (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link local-def" href="#def-rrv" data-sym="RRV" title="(defmacro rrv (level form)
  (declare (xargs :guard (member-eq level *rrv-levels*)))
  `(cond
    ((&gt;= (position verbose-p *rrv-levels*) ,(position level *rrv-levels*))
     ,form)">rrv</a> <span class="keyword">:minimal</span> (<a class="sym-link system" href="../../axioms.html#def-princ_24" data-sym="PRINC$">princ$</a> #\. channel state))
                (<a class="sym-link local-def" href="#def-removable-runes-next" data-sym="REMOVABLE-RUNES-NEXT" title="(defun removable-runes-next
       (form steps-bound runes best-rune best-used best-time disables verbose-p
        ignored-runes channel state)
  (cond
   ((endp runes)
...">removable-runes-next</a> form
                  steps-bound
                  (cdr runes)
                  best-rune
                  best-used
                  best-time
                  disables
                  verbose-p
                  ignored-runes
                  channel
                  state)))
            (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link local-def" href="#def-rrv" data-sym="RRV" title="(defmacro rrv (level form)
  (declare (xargs :guard (member-eq level *rrv-levels*)))
  `(cond
    ((&gt;= (position verbose-p *rrv-levels*) ,(position level *rrv-levels*))
     ,form)">rrv</a> <span class="keyword">:minimal</span> (<a class="sym-link system" href="../../axioms.html#def-princ_24" data-sym="PRINC$">princ$</a> #\+ channel state))
                (<a class="sym-link local-def" href="#def-removable-runes-next" data-sym="REMOVABLE-RUNES-NEXT" title="(defun removable-runes-next
       (form steps-bound runes best-rune best-used best-time disables verbose-p
        ignored-runes channel state)
  (cond
   ((endp runes)
...">removable-runes-next</a> form
                  steps2
                  (cdr runes)
                  (car runes)
                  runes2
                  time2
                  disables
                  verbose-p
                  ignored-runes
                  channel
                  state)))))))))</pre>
  </div>

<div class="form-block function" id="def-newline-when-minimal-rrv" data-defines="NEWLINE-WHEN-MINIMAL-RRV" data-references="T,NEWLINE,EQ,COND,STATE,CHANNEL,VERBOSE-P,DEFUN" data-used-by="REMOVABLE-RUNES-PRINT-STATUS" data-part-name="NEWLINE-WHEN-MINIMAL-RRV" data-part-args="STATE,CHANNEL,VERBOSE-P" data-part-body="T,STATE,CHANNEL,NEWLINE,VERBOSE-P,EQ,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="NEWLINE-WHEN-MINIMAL-RRV">newline-when-minimal-rrv</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-newline-when-minimal-rrv" data-sym="NEWLINE-WHEN-MINIMAL-RRV" title="(defun newline-when-minimal-rrv (verbose-p channel state)
  (cond ((eq verbose-p :minimal) (newline channel state)) (t state)))">newline-when-minimal-rrv</a>
  (verbose-p channel state)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> verbose-p <span class="keyword">:minimal</span>) (<a class="sym-link system" href="../../basis-a.html#def-newline" data-sym="NEWLINE">newline</a> channel state))
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> state)))</pre>
  </div>

<div class="form-block function" id="def-removable-runes-print-status" data-defines="REMOVABLE-RUNES-PRINT-STATUS" data-references="NEWLINE-WHEN-MINIMAL-RRV,CONS,LIST,FMS,RRV,PPROGN,ASSERT$,RATIONAL-TO-DECIMAL-STRING,T,VALUE,NULL,COND,TIME-STRING,ERP,MV-LET,STATE,CHANNEL,VERBOSE-P,DISABLES,TIME,INIT-S,USED,R,S-OLD,S,DEFUN" data-used-by="REMOVABLE-OR-MINIMAL-RUNES-FN,REMOVABLE-OR-MINIMAL-RUNES-LOOP" data-part-name="REMOVABLE-RUNES-PRINT-STATUS" data-part-args="STATE,CHANNEL,VERBOSE-P,DISABLES,TIME,INIT-S,USED,R,S-OLD,S" data-part-body="DISABLES,INIT-S,S-OLD,USED,NEWLINE-WHEN-MINIMAL-RRV,CHANNEL,S,CONS,LIST,FMS,RRV,PPROGN,R,ASSERT$,TIME,RATIONAL-TO-DECIMAL-STRING,T,VALUE,VERBOSE-P,NULL,COND,STATE,TIME-STRING,ERP,MV-LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="REMOVABLE-RUNES-PRINT-STATUS">removable-runes-print-status</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-removable-runes-print-status" data-sym="REMOVABLE-RUNES-PRINT-STATUS" title="(defun removable-runes-print-status
       (s s-old r used init-s time disables verbose-p channel state)
  (mv-let (erp time-string state)
          (cond ((null verbose-p) (value nil))
                (t (rational-to-decimal-string time state)))
...">removable-runes-print-status</a>
  (s s-old
    r
    used
    init-s
    time
    disables
    verbose-p
    channel
    state)
  (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (erp time-string state)
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> verbose-p) (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> nil))
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (rational-to-decimal-string time state)))
    (<a class="sym-link system" href="../../axioms.html#def-assert_24" data-sym="ASSERT$">assert$</a> (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> erp)
      (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> r) (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link local-def" href="#def-rrv" data-sym="RRV" title="(defmacro rrv (level form)
  (declare (xargs :guard (member-eq level *rrv-levels*)))
  `(cond
    ((&gt;= (position verbose-p *rrv-levels*) ,(position level *rrv-levels*))
     ,form)">rrv</a> <span class="keyword">:minimal</span> (<a class="sym-link system" href="../../basis-a.html#def-fms" data-sym="FMS">fms</a> <span class="string">"New steps: ~x0 (initial attempt)~|Time: ~s1"</span>
                (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (cons #\0 s) (cons #\1 time-string))
                channel
                state
                nil))
            (<a class="sym-link local-def" href="#def-newline-when-minimal-rrv" data-sym="NEWLINE-WHEN-MINIMAL-RRV" title="(defun newline-when-minimal-rrv (verbose-p channel state)
  (cond ((eq verbose-p :minimal) (newline channel state)) (t state)))">newline-when-minimal-rrv</a> verbose-p channel state)
            (<a class="sym-link local-def" href="#def-rrv" data-sym="RRV" title="(defmacro rrv (level form)
  (declare (xargs :guard (member-eq level *rrv-levels*)))
  `(cond
    ((&gt;= (position verbose-p *rrv-levels*) ,(position level *rrv-levels*))
     ,form)">rrv</a> <span class="keyword">:normal</span> (<a class="sym-link system" href="../../basis-a.html#def-fms" data-sym="FMS">fms</a> <span class="string">"Used: ~y0"</span> (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (cons #\0 used)) channel state nil))))
        (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link local-def" href="#def-rrv" data-sym="RRV" title="(defmacro rrv (level form)
  (declare (xargs :guard (member-eq level *rrv-levels*)))
  `(cond
    ((&gt;= (position verbose-p *rrv-levels*) ,(position level *rrv-levels*))
     ,form)">rrv</a> <span class="keyword">:minimal</span> (<a class="sym-link system" href="../../basis-a.html#def-fms" data-sym="FMS">fms</a> <span class="string">"New steps: ~x0~|Old steps: ~x1 (Initially: ~
                          ~x2)~|Time: ~s3~|Removed: ~x4"</span>
                (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (cons #\0 s)
                  (cons #\1 s-old)
                  (cons #\2 init-s)
                  (cons #\3 time-string)
                  (cons #\4 r))
                channel
                state
                nil))
            (<a class="sym-link local-def" href="#def-rrv" data-sym="RRV" title="(defmacro rrv (level form)
  (declare (xargs :guard (member-eq level *rrv-levels*)))
  `(cond
    ((&gt;= (position verbose-p *rrv-levels*) ,(position level *rrv-levels*))
     ,form)">rrv</a> <span class="keyword">:normal</span> (<a class="sym-link system" href="../../basis-a.html#def-fms" data-sym="FMS">fms</a> <span class="string">"Removable:~|~y0Used:~|~y1"</span>
                (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (cons #\0 disables) (cons #\1 used))
                channel
                state
                nil))
            (<a class="sym-link local-def" href="#def-newline-when-minimal-rrv" data-sym="NEWLINE-WHEN-MINIMAL-RRV" title="(defun newline-when-minimal-rrv (verbose-p channel state)
  (cond ((eq verbose-p :minimal) (newline channel state)) (t state)))">newline-when-minimal-rrv</a> verbose-p channel state)))))))</pre>
  </div>

<div class="form-block function" id="def-removable-or-minimal-runes-loop" data-defines="REMOVABLE-OR-MINIMAL-RUNES-LOOP" data-references="REMOVE1-EQUAL,SET-DIFFERENCE-EQUAL,UNION-EQUAL,*,FLOOR,ZP,<=,MEMBER-EQUAL,AND,ASSERT$,REMOVABLE-RUNES-PRINT-STATUS,CONS,CDDDR,TIME,CADDR,USED,CADR,R,CAR,S,LET*,REMOVABLE-RUNES-NEXT,S/R/USED/TIME,ER-LET*,T,IF,VALUE,NEWLINE,RRV,PPROGN,ZEROP,NULL,OR,COND,FLG,STATE,CHANNEL,MULTIPLIER,IGNORED-RUNES,VERBOSE-P,SEEN,DISABLES,RUNES,INIT-STEPS,PREVIOUS-STEPS,STEPS-BOUND,FORM,DEFUN" data-used-by="REMOVABLE-OR-MINIMAL-RUNES-FN" data-part-name="REMOVABLE-OR-MINIMAL-RUNES-LOOP" data-part-args="FLG,STATE,CHANNEL,MULTIPLIER,IGNORED-RUNES,VERBOSE-P,SEEN,DISABLES,RUNES,INIT-STEPS,PREVIOUS-STEPS,STEPS-BOUND,FORM" data-part-body="REMOVE1-EQUAL,SET-DIFFERENCE-EQUAL,UNION-EQUAL,MULTIPLIER,*,FLOOR,REMOVABLE-OR-MINIMAL-RUNES-LOOP,ZP,<=,SEEN,MEMBER-EQUAL,AND,ASSERT$,INIT-STEPS,PREVIOUS-STEPS,REMOVABLE-RUNES-PRINT-STATUS,CONS,CDDDR,TIME,CADDR,USED,CADR,R,CAR,S,LET*,IGNORED-RUNES,VERBOSE-P,FORM,REMOVABLE-RUNES-NEXT,S/R/USED/TIME,ER-LET*,T,DISABLES,FLG,IF,VALUE,STATE,CHANNEL,NEWLINE,RRV,PPROGN,STEPS-BOUND,ZEROP,RUNES,NULL,OR,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="REMOVABLE-OR-MINIMAL-RUNES-LOOP">removable-or-minimal-runes-loop</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-removable-or-minimal-runes-loop" data-sym="REMOVABLE-OR-MINIMAL-RUNES-LOOP" title="(defun removable-or-minimal-runes-loop
       (form steps-bound previous-steps init-steps runes disables seen
        verbose-p ignored-runes multiplier channel state flg)
  (cond
   ((or (null runes) (zerop steps-bound))
...">removable-or-minimal-runes-loop</a>
  (form steps-bound
    previous-steps
    init-steps
    runes
    disables
    seen
    verbose-p
    ignored-runes
    multiplier
    channel
    state
    flg)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> runes) (zerop steps-bound)) (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link local-def" href="#def-rrv" data-sym="RRV" title="(defmacro rrv (level form)
  (declare (xargs :guard (member-eq level *rrv-levels*)))
  `(cond
    ((&gt;= (position verbose-p *rrv-levels*) ,(position level *rrv-levels*))
     ,form)">rrv</a> <span class="keyword">:minimal</span> (<a class="sym-link system" href="../../basis-a.html#def-newline" data-sym="NEWLINE">newline</a> channel state))
        (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (if flg
            disables
            runes))))
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((s/r/used/time (<a class="sym-link local-def" href="#def-removable-runes-next" data-sym="REMOVABLE-RUNES-NEXT" title="(defun removable-runes-next
       (form steps-bound runes best-rune best-used best-time disables verbose-p
        ignored-runes channel state)
  (cond
   ((endp runes)
...">removable-runes-next</a> form
             steps-bound
             runes
             nil
             nil
             nil
             disables
             verbose-p
             ignored-runes
             channel
             state)))
        (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> s/r/used/time) (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link local-def" href="#def-rrv" data-sym="RRV" title="(defmacro rrv (level form)
  (declare (xargs :guard (member-eq level *rrv-levels*)))
  `(cond
    ((&gt;= (position verbose-p *rrv-levels*) ,(position level *rrv-levels*))
     ,form)">rrv</a> <span class="keyword">:minimal</span> (<a class="sym-link system" href="../../basis-a.html#def-newline" data-sym="NEWLINE">newline</a> channel state))
              (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (if flg
                  disables
                  runes))))
          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((s (car s/r/used/time)) (r (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> s/r/used/time))
                (used (<a class="sym-link system" href="../../axioms.html#def-caddr" data-sym="CADDR">caddr</a> s/r/used/time))
                (time (<a class="sym-link system" href="../../axioms.html#def-cdddr" data-sym="CDDDR">cdddr</a> s/r/used/time))
                (disables (cons r disables)))
              (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link local-def" href="#def-removable-runes-print-status" data-sym="REMOVABLE-RUNES-PRINT-STATUS" title="(defun removable-runes-print-status
       (s s-old r used init-s time disables verbose-p channel state)
  (mv-let (erp time-string state)
          (cond ((null verbose-p) (value nil))
                (t (rational-to-decimal-string time state)))
...">removable-runes-print-status</a> s
                  previous-steps
                  r
                  used
                  init-steps
                  time
                  disables
                  verbose-p
                  channel
                  state)
                (<a class="sym-link system" href="../../axioms.html#def-assert_24" data-sym="ASSERT$">assert$</a> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> r seen) (<a class="sym-link system" href="../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> s steps-bound))
                  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-zp" data-sym="ZP">zp</a> s) (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (if flg
                          disables
                          used)))
                    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link local-def" href="#def-removable-or-minimal-runes-loop" data-sym="REMOVABLE-OR-MINIMAL-RUNES-LOOP" title="(defun removable-or-minimal-runes-loop
       (form steps-bound previous-steps init-steps runes disables seen
        verbose-p ignored-runes multiplier channel state flg)
  (cond
   ((or (null runes) (zerop steps-bound))
...">removable-or-minimal-runes-loop</a> form
                        (floor (<a class="sym-link system" href="../../axioms.html#def-_2A" data-sym="*">*</a> multiplier s) <span class="number">1</span>)
                        s
                        init-steps
                        (<a class="sym-link system" href="../../axioms.html#def-union-equal" data-sym="UNION-EQUAL">union-equal</a> (<a class="sym-link system" href="../../axioms.html#def-set-difference-equal" data-sym="SET-DIFFERENCE-EQUAL">set-difference-equal</a> used seen)
                          (<a class="sym-link system" href="../../axioms.html#def-remove1-equal" data-sym="REMOVE1-EQUAL">remove1-equal</a> r runes))
                        disables
                        (<a class="sym-link system" href="../../axioms.html#def-union-equal" data-sym="UNION-EQUAL">union-equal</a> used seen)
                        verbose-p
                        ignored-runes
                        multiplier
                        channel
                        state
                        flg))))))))))))</pre>
  </div>

<div class="form-block function" id="def-removable-or-minimal-runes-fn" data-defines="REMOVABLE-OR-MINIMAL-RUNES-FN" data-references="*,FLOOR,REMOVABLE-OR-MINIMAL-RUNES-LOOP,REMOVABLE-RUNES-PRINT-STATUS,IGNORE,DECLARE,LENGTH,PRINT-STRING-REPEAT,COL,MV-LET,RRV,PPROGN,T,SOFT,ER,EQL,NULL,OR,COND,CDDR,TIME2,CADR,RUNES2,CAR,VALUE,STEPS2,EVENT-STEPS-RUNES+,STEPS/RUNES/TIME,ER-LET*,W,NON-REMOVABLE-RUNES,IGNORED-RUNES,PROOFS-CO,CHANNEL,LET,FLG,STATE,CTX,MULTIPLIER,VERBOSE-P,FORM,DEFUN" data-used-by="REMOVABLE-RUNES,MINIMAL-RUNES-FN" data-part-name="REMOVABLE-OR-MINIMAL-RUNES-FN" data-part-args="FLG,STATE,CTX,MULTIPLIER,VERBOSE-P,FORM" data-part-body="FLG,MULTIPLIER,*,FLOOR,REMOVABLE-OR-MINIMAL-RUNES-LOOP,REMOVABLE-RUNES-PRINT-STATUS,IGNORE,DECLARE,LENGTH,PRINT-STRING-REPEAT,COL,MV-LET,RRV,PPROGN,T,CTX,SOFT,ER,EQL,NULL,OR,COND,CDDR,TIME2,CADR,RUNES2,CAR,VALUE,STEPS2,VERBOSE-P,FORM,EVENT-STEPS-RUNES+,STEPS/RUNES/TIME,ER-LET*,W,NON-REMOVABLE-RUNES,IGNORED-RUNES,STATE,PROOFS-CO,CHANNEL,LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="REMOVABLE-OR-MINIMAL-RUNES-FN">removable-or-minimal-runes-fn</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-removable-or-minimal-runes-fn" data-sym="REMOVABLE-OR-MINIMAL-RUNES-FN" title="(defun removable-or-minimal-runes-fn (form verbose-p multiplier ctx state flg)
  (let ((channel (proofs-co state))
        (ignored-runes (non-removable-runes (w state))))
    (er-let*
     ((steps/runes/time
...">removable-or-minimal-runes-fn</a>
  (form verbose-p multiplier ctx state flg)
  (let ((channel (<a class="sym-link system" href="../../basis-b.html#def-proofs-co" data-sym="PROOFS-CO">proofs-co</a> state)) (ignored-runes (<a class="sym-link local-def" href="#def-non-removable-runes" data-sym="NON-REMOVABLE-RUNES" title="(defun non-removable-runes (world)
  (append
   (list *fake-rune-for-anonymous-enabled-rule* *fake-rune-for-type-set*
         *fake-rune-for-linear*)
   (union-equal (theory &#39;definition-minimal-theory)">non-removable-runes</a> (<a class="sym-link system" href="../../axioms.html#def-w" data-sym="W">w</a> state))))
    (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((steps/runes/time (<a class="sym-link local-def" href="#def-event-steps-runes_2B" data-sym="EVENT-STEPS-RUNES+" title="(defun event-steps-runes+ (form steps disables verbose-p ignored-runes state)
  (let* ((form0
          (if steps
              `(with-prover-step-limit ,steps ,form)
              form))
...">event-steps-runes+</a> form
           nil
           nil
           verbose-p
           ignored-runes
           state)) (steps2 (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (car steps/runes/time)))
        (runes2 (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> steps/runes/time)))
        (time2 (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-cddr" data-sym="CDDR">cddr</a> steps/runes/time))))
      (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> steps2) (<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> steps2 <span class="keyword">:error</span>)) (<a class="sym-link system" href="../../axioms.html#def-er" data-sym="ER">er</a> soft
            ctx
            <span class="string">"REMOVABLE-RUNES failed because the following original event ~
                  failed:~x0"</span>
            form))
        (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link local-def" href="#def-rrv" data-sym="RRV" title="(defmacro rrv (level form)
  (declare (xargs :guard (member-eq level *rrv-levels*)))
  `(cond
    ((&gt;= (position verbose-p *rrv-levels*) ,(position level *rrv-levels*))
     ,form)">rrv</a> <span class="keyword">:minimal</span> (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (col state)
                (<a class="sym-link system" href="../../history-management.html#def-print-string-repeat" data-sym="PRINT-STRING-REPEAT">print-string-repeat</a> <span class="string">"-"</span> (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> runes2) <span class="number">0</span> channel state)
                (declare (ignore col))
                state))
            (<a class="sym-link local-def" href="#def-removable-runes-print-status" data-sym="REMOVABLE-RUNES-PRINT-STATUS" title="(defun removable-runes-print-status
       (s s-old r used init-s time disables verbose-p channel state)
  (mv-let (erp time-string state)
          (cond ((null verbose-p) (value nil))
                (t (rational-to-decimal-string time state)))
...">removable-runes-print-status</a> steps2
              nil
              nil
              runes2
              nil
              time2
              nil
              verbose-p
              channel
              state)
            (<a class="sym-link local-def" href="#def-removable-or-minimal-runes-loop" data-sym="REMOVABLE-OR-MINIMAL-RUNES-LOOP" title="(defun removable-or-minimal-runes-loop
       (form steps-bound previous-steps init-steps runes disables seen
        verbose-p ignored-runes multiplier channel state flg)
  (cond
   ((or (null runes) (zerop steps-bound))
...">removable-or-minimal-runes-loop</a> form
              (floor (<a class="sym-link system" href="../../axioms.html#def-_2A" data-sym="*">*</a> multiplier steps2) <span class="number">1</span>)
              steps2
              steps2
              runes2
              nil
              runes2
              verbose-p
              ignored-runes
              multiplier
              channel
              state
              flg)))))))</pre>
  </div>

<div class="form-block function" id="def-minimal-runes-fn" data-defines="MINIMAL-RUNES-FN" data-references="SET-DIFFERENCE-EQUAL,REMOVABLE-OR-MINIMAL-RUNES-FN,RUNES,CURRENT-THEORY,VALUE,W,WORLD,LET,IF,THEORY,ER-LET*,NAME,STATE,CTX,MULTIPLIER,VERBOSE-P,FORM,DEFUN" data-used-by="MINIMAL-RUNES" data-part-name="MINIMAL-RUNES-FN" data-part-args="NAME,STATE,CTX,MULTIPLIER,VERBOSE-P,FORM" data-part-body="SET-DIFFERENCE-EQUAL,CTX,MULTIPLIER,VERBOSE-P,FORM,REMOVABLE-OR-MINIMAL-RUNES-FN,RUNES,CURRENT-THEORY,VALUE,STATE,W,WORLD,LET,NAME,IF,THEORY,ER-LET*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="MINIMAL-RUNES-FN">minimal-runes-fn</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-minimal-runes-fn" data-sym="MINIMAL-RUNES-FN" title="(defun minimal-runes-fn (form verbose-p multiplier ctx state name)
  (er-let*
   ((theory
     (if name
         (let ((world (w state)))
...">minimal-runes-fn</a>
  (form verbose-p multiplier ctx state name)
  (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((theory (if name
         (let ((world (<a class="sym-link system" href="../../axioms.html#def-w" data-sym="W">w</a> state)))
           (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (current-theory name)))
         (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> nil))) (runes (<a class="sym-link local-def" href="#def-removable-or-minimal-runes-fn" data-sym="REMOVABLE-OR-MINIMAL-RUNES-FN" title="(defun removable-or-minimal-runes-fn (form verbose-p multiplier ctx state flg)
  (let ((channel (proofs-co state))
        (ignored-runes (non-removable-runes (w state))))
    (er-let*
     ((steps/runes/time
...">removable-or-minimal-runes-fn</a> form
          verbose-p
          multiplier
          ctx
          state
          nil)))
    (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (if name
        (<a class="sym-link system" href="../../axioms.html#def-set-difference-equal" data-sym="SET-DIFFERENCE-EQUAL">set-difference-equal</a> runes theory)
        runes))))</pre>
  </div>

<div class="form-block macro" id="def-removable-runes" data-defines="REMOVABLE-RUNES" data-references="T,STATE,MINIMIZE-THEORY,REMOVABLE-OR-MINIMAL-RUNES-FN,QUASIQUOTE,<,RATIONALP,*RRV-LEVELS*,MEMBER-EQ,AND,XARGS,DECLARE,MULTIPLIER,QUOTE,VERBOSE-P,&KEY,FORM,DEFMACRO" typeof="Code">
    <div class="form-header"><span class="form-name" property="name" data-sym="REMOVABLE-RUNES">removable-runes</span><span class="form-type">macro</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> <a class="sym-link local-def" href="#def-removable-runes" data-sym="REMOVABLE-RUNES" title="(defmacro removable-runes (form &amp;key (verbose-p &#39;:normal) (multiplier &#39;1))
  (declare
   (xargs :guard
    (and (member-eq verbose-p *rrv-levels*) (rationalp multiplier)
         (&lt; 0 multiplier))))
...">removable-runes</a>
  (form &amp;key (verbose-p '<span class="keyword">:normal</span>) (multiplier '<span class="number">1</span>))
  (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-member-eq" data-sym="MEMBER-EQ">member-eq</a> verbose-p <a class="sym-link local-def" href="#def-_2Arrv-levels_2A" data-sym="*RRV-LEVELS*" title="(defconst *rrv-levels* &#39;(nil :minimal :normal t))">*rrv-levels*</a>)
        (rationalp multiplier)
        (&lt; <span class="number">0</span> multiplier))))
  `(<a class="sym-link local-def" href="#def-removable-or-minimal-runes-fn" data-sym="REMOVABLE-OR-MINIMAL-RUNES-FN" title="(defun removable-or-minimal-runes-fn (form verbose-p multiplier ctx state flg)
  (let ((channel (proofs-co state))
        (ignored-runes (non-removable-runes (w state))))
    (er-let*
     ((steps/runes/time
...">removable-or-minimal-runes-fn</a> ',FORM
    ,VERBOSE-P
    ,MULTIPLIER
    'minimize-theory
    state
    <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>))</pre>
  </div>

<div class="form-block macro" id="def-minimal-runes" data-defines="MINIMAL-RUNES" data-references="STATE,MINIMIZE-THEORY,MINIMAL-RUNES-FN,QUASIQUOTE,<,RATIONALP,*RRV-LEVELS*,MEMBER-EQ,AND,XARGS,DECLARE,NAME,MULTIPLIER,QUOTE,VERBOSE-P,&KEY,FORM,DEFMACRO" typeof="Code">
    <div class="form-header"><span class="form-name" property="name" data-sym="MINIMAL-RUNES">minimal-runes</span><span class="form-type">macro</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> <a class="sym-link local-def" href="#def-minimal-runes" data-sym="MINIMAL-RUNES" title="(defmacro minimal-runes (form &amp;key (verbose-p &#39;:normal) (multiplier &#39;1) name)
  (declare
   (xargs :guard
    (and (member-eq verbose-p *rrv-levels*) (rationalp multiplier)
         (&lt; 0 multiplier))))
...">minimal-runes</a>
  (form &amp;key (verbose-p '<span class="keyword">:normal</span>) (multiplier '<span class="number">1</span>) name)
  (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-member-eq" data-sym="MEMBER-EQ">member-eq</a> verbose-p <a class="sym-link local-def" href="#def-_2Arrv-levels_2A" data-sym="*RRV-LEVELS*" title="(defconst *rrv-levels* &#39;(nil :minimal :normal t))">*rrv-levels*</a>)
        (rationalp multiplier)
        (&lt; <span class="number">0</span> multiplier))))
  `(<a class="sym-link local-def" href="#def-minimal-runes-fn" data-sym="MINIMAL-RUNES-FN" title="(defun minimal-runes-fn (form verbose-p multiplier ctx state name)
  (er-let*
   ((theory
     (if name
         (let ((world (w state)))
...">minimal-runes-fn</a> ',FORM
    ,VERBOSE-P
    ,MULTIPLIER
    'minimize-theory
    state
    ',NAME))</pre>
  </div>


  </main>
  
<script>
// ACL2 Book HTML Documentation - Interactive Features
// Generated by cert2 - build2 system

// State
let activeFilter = null;
let activePartFilter = null;
let activeNameFilter = null;
let currentFontSize = 14;

// Theme management
function getStoredTheme() {
  return localStorage.getItem('acl2-theme') || 'dark';
}

function setTheme(theme) {
  if (theme === 'light') {
    document.documentElement.setAttribute('data-theme', 'light');
    document.getElementById('theme-toggle').textContent = '🌙';
  } else {
    document.documentElement.removeAttribute('data-theme');
    document.getElementById('theme-toggle').textContent = '☀️';
  }
  localStorage.setItem('acl2-theme', theme);
}

function toggleTheme() {
  const current = getStoredTheme();
  setTheme(current === 'dark' ? 'light' : 'dark');
}

// Font size management
function getStoredFontSize() {
  return parseInt(localStorage.getItem('acl2-fontsize') || '14', 10);
}

function setFontSize(size) {
  size = Math.max(10, Math.min(24, size)); // Clamp between 10-24
  currentFontSize = size;
  document.body.style.fontSize = size + 'px';
  localStorage.setItem('acl2-fontsize', size.toString());
}

function increaseFontSize() {
  setFontSize(currentFontSize + 2);
}

function decreaseFontSize() {
  setFontSize(currentFontSize - 2);
}

// Get all form blocks
function getFormBlocks() {
  return document.querySelectorAll('.form-block');
}

// Clear all filters
function clearFilter() {
  activeFilter = null;
  activePartFilter = null;
  activeNameFilter = null;
  getFormBlocks().forEach(b => {
    b.classList.remove('hidden', 'dimmed');
  });
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  const status = document.querySelector('.filter-status');
  status.classList.remove('active');
  // Slide name filter back to original position
  document.querySelector('.controls-left').style.transform = '';
  // Clear the name filter input
  const nameInput = document.getElementById('name-filter');
  if (nameInput) nameInput.value = '';
}

// Show filter status and slide name filter right
function showFilterStatus(text) {
  const status = document.querySelector('.filter-status');
  status.classList.add('active');
  status.querySelector('.filter-text').textContent = text;
  // Slide name filter to the right to make room
  setTimeout(() => {
    const statusWidth = status.offsetWidth;
    document.querySelector('.controls-left').style.transform = `translateX(${statusWidth + 15}px)`;
  }, 10);
}

// Filter to show only forms that define or reference a symbol
function filterBySymbol(symName, showUsedBy) {
  clearFilter();
  activeFilter = symName;
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines;
    const references = (block.dataset.references || '').split(',');
    const usedBy = (block.dataset.usedBy || '').split(',');
    
    let show = false;
    if (showUsedBy) {
      // Show forms that USE this symbol
      show = references.includes(symName) || definesName === symName;
    } else {
      // Show forms that this symbol USES
      show = usedBy.includes(symName) || definesName === symName;
    }
    
    if (show) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering by: ${symName} (${visibleCount} items)`);
}

// Filter by defthm part (term, hints, rule-classes, etc.)
function filterByPart(formId, partName) {
  clearFilter();
  activePartFilter = { formId, partName };
  
  // Get the part's referenced symbols
  // data-part-term becomes dataset.partTerm, data-part-hints becomes dataset.partHints, etc.
  const block = document.getElementById(formId);
  const datasetKey = 'part' + partName.charAt(0).toUpperCase() + partName.slice(1).replace(/-([a-z])/g, (g) => g[1].toUpperCase());
  const partData = block.dataset[datasetKey];
  if (!partData) return;
  
  const partSyms = partData.split(',').filter(s => s);
  
  // Highlight the button
  block.querySelector(`.part-btn[data-part="${partName}"]`).classList.add('active');
  
  // Hide forms not referenced by this part
  getFormBlocks().forEach(b => {
    const definesName = b.dataset.defines;
    if (b.id === formId || partSyms.includes(definesName)) {
      b.classList.remove('hidden');
    } else {
      b.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering ${formId} :${partName} (${partSyms.length} references)`);
}

// Filter by name (substring or regex)
function filterByName(pattern, useRegex) {
  // Clear other filters but keep the input value
  activeFilter = null;
  activePartFilter = null;
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  
  if (!pattern || pattern.trim() === '') {
    // Empty pattern - show all
    activeNameFilter = null;
    getFormBlocks().forEach(b => b.classList.remove('hidden'));
    const status = document.querySelector('.filter-status');
    status.classList.remove('active');
    document.querySelector('.controls-left').style.transform = '';
    return;
  }
  
  activeNameFilter = pattern;
  
  let matcher;
  let isValidRegex = true;
  
  if (useRegex) {
    try {
      matcher = new RegExp(pattern, 'i');
    } catch (e) {
      // Invalid regex - show error in status and don't filter
      showFilterStatus(`Invalid regex: ${e.message}`);
      return;
    }
  } else {
    // Plain substring match (case-insensitive)
    const lowerPattern = pattern.toLowerCase();
    matcher = { test: (s) => s.toLowerCase().includes(lowerPattern) };
  }
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines || '';
    if (matcher.test(definesName)) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  const modeText = useRegex ? 'regex' : 'name';
  showFilterStatus(`Filtering by ${modeText}: "${pattern}" (${visibleCount} matches)`);
}

// Click on a name to show what references it
function handleNameClick(symName) {
  if (activeFilter === symName) {
    clearFilter();
  } else {
    filterBySymbol(symName, true);
  }
}

// Navigate to a definition (same file or different)
function navigateTo(symName, file) {
  if (file) {
    // External file - navigate
    window.location.href = file + '.html#def-' + symName.toLowerCase();
  } else {
    // Same file - scroll
    const target = document.getElementById('def-' + symName.toLowerCase());
    if (target) {
      target.scrollIntoView({ behavior: 'smooth', block: 'center' });
      target.classList.add('highlight');
      setTimeout(() => target.classList.remove('highlight'), 400);
    }
  }
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  // Part buttons
  document.querySelectorAll('.part-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const formId = btn.closest('.form-block').id;
      const partName = btn.dataset.part;
      if (activePartFilter && activePartFilter.formId === formId && 
          activePartFilter.partName === partName) {
        clearFilter();
      } else {
        filterByPart(formId, partName);
      }
    });
  });
  
  // Clear filter button
  document.querySelector('.clear-filter').addEventListener('click', clearFilter);
  
  // Name filter input
  const nameFilter = document.getElementById('name-filter');
  const regexToggle = document.getElementById('regex-toggle');
  
  let filterTimeout = null;
  nameFilter.addEventListener('input', () => {
    // Debounce the filter to avoid excessive updates while typing
    clearTimeout(filterTimeout);
    filterTimeout = setTimeout(() => {
      filterByName(nameFilter.value, regexToggle.checked);
    }, 150);
  });
  
  // Re-filter when regex toggle changes
  regexToggle.addEventListener('change', () => {
    if (nameFilter.value) {
      filterByName(nameFilter.value, regexToggle.checked);
    }
  });
  
  // Allow Escape key to clear filter when in input
  nameFilter.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      clearFilter();
      nameFilter.blur();
    }
  });
  
  // Symbol references (old span-based refs)
  document.querySelectorAll('.sym-ref').forEach(ref => {
    ref.addEventListener('click', (e) => {
      e.stopPropagation();
      const sym = ref.dataset.sym;
      const file = ref.dataset.file;
      if (file) {
        navigateTo(sym, file);
      } else {
        handleNameClick(sym);
      }
    });
  });
  
  // Symbol links (new anchor-based links)
  // These use standard <a> tags so navigation happens automatically
  // But we need to clear filters if target would be hidden
  document.querySelectorAll('.sym-link').forEach(link => {
    link.addEventListener('click', (e) => {
      const href = link.getAttribute('href');
      if (href && href.startsWith('#')) {
        // Local link - check if target is hidden by filter
        const targetId = href.substring(1);
        const target = document.getElementById(targetId);
        if (target) {
          // If target is hidden, clear the filter first
          if (target.classList.contains('hidden')) {
            clearFilter();
          }
          // Add highlight effect after a short delay
          setTimeout(() => {
            target.classList.add('highlight');
            setTimeout(() => target.classList.remove('highlight'), 400);
          }, 100);
        }
      }
      // For external links, default behavior handles navigation
    });
  });
  
  // Form names (show what uses them)
  document.querySelectorAll('.form-name').forEach(name => {
    name.addEventListener('click', (e) => {
      handleNameClick(name.dataset.sym);
    });
  });
  
  // Handle hash navigation (when arriving at page with #anchor)
  if (window.location.hash) {
    const target = document.querySelector(window.location.hash);
    if (target) {
      setTimeout(() => {
        target.scrollIntoView({ behavior: 'smooth', block: 'center' });
        target.classList.add('highlight');
        setTimeout(() => target.classList.remove('highlight'), 400);
      }, 200);
    }
  }
  
  // Initialize theme from storage
  setTheme(getStoredTheme());
  
  // Initialize font size from storage
  currentFontSize = getStoredFontSize();
  setFontSize(currentFontSize);
  
  // Theme toggle button
  document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
  
  // Font size buttons
  document.getElementById('font-larger').addEventListener('click', increaseFontSize);
  document.getElementById('font-smaller').addEventListener('click', decreaseFontSize);
});

</script>

</body>
</html>
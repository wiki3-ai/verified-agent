<!DOCTYPE html>
<html lang="en" vocab="http://schema.org/" typeof="SoftwareSourceCode">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>remove-hyps - ACL2 Book</title>
  <meta property="name" content="remove-hyps">
  <meta property="programmingLanguage" content="ACL2">
  
<style>
/* ACL2 Book HTML Documentation Styles */
/* Generated by cert2 - build2 system */

/* Dark theme (default) */
:root {
  --bg: #1e1e2e;
  --fg: #cdd6f4;
  --comment: #6c7086;
  --keyword: #cba6f7;
  --string: #a6e3a1;
  --function: #89b4fa;
  --type: #f9e2af;
  --link: #89dceb;
  --link-hover: #f5c2e7;
  --highlight: rgba(137, 180, 250, 0.2);
  --border: #313244;
  --block-bg: rgba(49, 50, 68, 0.5);
  --btn-bg: #313244;
  --btn-hover: rgba(137, 180, 250, 0.2);
}

/* Light theme */
[data-theme="light"] {
  --bg: #eff1f5;
  --fg: #4c4f69;
  --comment: #6c6f85;
  --keyword: #8839ef;
  --string: #40a02b;
  --function: #1e66f5;
  --type: #df8e1d;
  --link: #04a5e5;
  --link-hover: #ea76cb;
  --highlight: rgba(30, 102, 245, 0.15);
  --border: #ccd0da;
  --block-bg: rgba(204, 208, 218, 0.3);
  --btn-bg: #ccd0da;
  --btn-hover: rgba(30, 102, 245, 0.15);
}

body {
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  background: var(--bg);
  color: var(--fg);
  margin: 0;
  padding: 20px;
  line-height: 1.6;
  font-size: 14px;
  transition: background 0.1s, color 0.1s;
}

/* Controls toolbar */
.controls-left {
  position: fixed;
  top: 10px;
  left: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
  transition: transform 0.1s ease;
}

.controls-right {
  position: fixed;
  top: 10px;
  right: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
}

.control-btn {
  padding: 6px 12px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-family: inherit;
  font-size: 14px;
  transition: all 0.1s;
}

.control-btn:hover {
  background: var(--btn-hover);
  border-color: var(--link);
}

.name-filter {
  padding: 6px 10px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  font-family: inherit;
  font-size: 13px;
  width: 150px;
  transition: all 0.1s;
}

.name-filter:focus {
  outline: none;
  border-color: var(--link);
  width: 200px;
}

.name-filter::placeholder {
  color: var(--comment);
}

.regex-label {
  display: flex;
  align-items: center;
  gap: 4px;
  color: var(--comment);
  font-size: 12px;
  cursor: pointer;
}

.regex-label input {
  cursor: pointer;
}

.book-header {
  border-bottom: 2px solid var(--border);
  padding-bottom: 20px;
  margin-bottom: 20px;
}

.book-header h1 {
  color: var(--keyword);
  margin: 0;
}

.book-header .path {
  color: var(--comment);
  font-size: 0.9em;
}

.book-header .path .source-link {
  color: var(--comment);
  text-decoration: none;
}

.book-header .path .source-link:hover {
  color: var(--link);
  text-decoration: underline;
}

.form-block {
  margin: 10px 0;
  padding: 15px;
  background: var(--block-bg);
  border-radius: 8px;
  border-left: 3px solid var(--border);
}

.form-block.theorem { border-left-color: var(--keyword); }
.form-block.function { border-left-color: var(--function); }
.form-block.macro { border-left-color: var(--type); }
.form-block.include-book { border-left-color: var(--string); }

.form-block.hidden { display: none; }
.form-block.dimmed { opacity: 0.3; }

.form-block.highlight {
  animation: highlight-pulse 0.4s ease-out;
}

@keyframes highlight-pulse {
  0% { background: var(--highlight); box-shadow: 0 0 20px var(--link); }
  100% { background: rgba(49, 50, 68, 0.5); box-shadow: none; }
}

.form-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.form-name {
  color: var(--function);
  font-weight: bold;
  cursor: pointer;
}

.form-name:hover {
  color: var(--link-hover);
  text-decoration: underline;
}

.form-type {
  color: var(--comment);
  font-size: 0.85em;
}

pre.code {
  margin: 0;
  overflow-x: auto;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.sym-ref {
  color: var(--link);
  cursor: pointer;
  border-radius: 2px;
}

.sym-ref:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.sym-ref.local-def { color: var(--function); font-weight: bold; }
.sym-ref.external { color: var(--type); }

/* Symbol links (clickable hyperlinks) */
.sym-link {
  color: var(--link);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
  position: relative;
}

.sym-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

.sym-link.local-def {
  color: var(--function);
  font-weight: bold;
}

.sym-link.external {
  color: var(--type);
}

/* Tooltips using title attribute with custom styling */
.sym-link[title] {
  /* Browser will show title on hover */
}

/* Syntax highlighting in code blocks */
.keyword {
  color: var(--keyword);
}

.string {
  color: var(--string);
}

.number {
  color: #f77524; /* orange */
}

/* Include-book path links */
.include-path {
  color: var(--string);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
}

.include-path:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

/* Part buttons for defthm */
.part-buttons {
  display: flex;
  gap: 5px;
  margin: 10px 0;
  flex-wrap: wrap;
}

.part-btn {
  padding: 4px 10px;
  background: var(--border);
  border: 1px solid var(--comment);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-size: 0.85em;
  font-family: inherit;
}

.part-btn:hover {
  background: var(--highlight);
  border-color: var(--link);
}

.part-btn.active {
  background: var(--link);
  color: var(--bg);
  border-color: var(--link);
}

/* References panel */
.refs-panel {
  margin-top: 10px;
  padding: 10px;
  background: rgba(0,0,0,0.2);
  border-radius: 4px;
  display: none;
}

.refs-panel.visible { display: block; }

.refs-panel h4 {
  margin: 0 0 5px 0;
  color: var(--comment);
  font-size: 0.9em;
}

.refs-list {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

/* Included books section */
.includes-section {
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(49, 50, 68, 0.3);
  border-radius: 8px;
  border: 1px solid var(--border);
}

.includes-section h2 {
  margin: 0 0 10px 0;
  color: var(--comment);
  font-size: 1em;
  font-weight: normal;
}

.includes-list {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.include-link {
  padding: 6px 12px;
  background: var(--border);
  border-radius: 4px;
  color: var(--link);
  text-decoration: none;
  font-size: 0.9em;
  transition: all 0.1s;
}

.include-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.include-link.local {
  border-left: 2px solid var(--comment);
}

/* Filter status */
.filter-status {
  position: fixed;
  top: 10px;
  left: 20px;
  background: var(--bg);
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: 4px;
  z-index: 201;
  display: none;
  align-items: center;
  gap: 10px;
}

.filter-status.active {
  display: flex;
  align-items: center;
  gap: 10px;
}

.clear-filter {
  padding: 5px 15px;
  background: var(--keyword);
  color: var(--bg);
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

/* RDFa vocab indicator */
[vocab] { /* semantic web annotations present */ }

</style>

</head>
<body>
  <div class="controls-left">
    <input type="text" id="name-filter" class="name-filter" placeholder="Filter by name..." title="Filter definitions by name">
    <label class="regex-label"><input type="checkbox" id="regex-toggle"> regex</label>
  </div>

  <div class="controls-right">
    <button class="control-btn" id="theme-toggle" title="Toggle light/dark theme">☀️</button>
    <button class="control-btn" id="font-smaller" title="Decrease font size">A-</button>
    <button class="control-btn" id="font-larger" title="Increase font size">A+</button>
  </div>

  <div class="filter-status">
    <span class="filter-text">Filtering...</span>
    <button class="clear-filter">Clear Filter</button>
  </div>
  
  <div class="book-header">
    <h1 property="name">remove-hyps</h1>
    <div class="path"><a href="remove-hyps.lisp" class="source-link">books/tools/remove-hyps</a></div>
  </div>
  
  <main property="text">
  <div class="includes-section">
    <h2>Included Books</h2>
    <div class="includes-list">
      <a class="include-link" href="../xdoc/top.html" title="xdoc/top">top</a>
      <a class="include-link local" href="../arithmetic/top.html" title="arithmetic/top">top</a>
    </div>
  </div>

<div class="form-block other" id="form-0" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-in-package" data-sym="IN-PACKAGE">in-package</a> <span class="string">"ACL2"</span>)</pre>
  </div>

<div class="form-block include-book" id="form-1" typeof="Code">
    <div class="form-header"><span class="form-type">include-book</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../xdoc/top.html" title="Open xdoc/top">"xdoc/top"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block other" id="form-2" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc <a class="sym-link local-def" href="#def-remove-hyps" data-sym="REMOVE-HYPS" title="(defmacro remove-hyps (form &amp;optional verbose-p)
  (or
   (and (consp form) (member-eq (car form) &#39;(defthm defthmd thm))
        (mv-let (name form-without-name)
                (if (eq (car form) &#39;thm)
...">remove-hyps</a>
  <span class="keyword">:parents</span> (proof-automation debugging)
  <span class="keyword">:short</span> <span class="string">"Macro for defining a theorem with a minimal set of hypotheses"</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;For a call of @(tsee defthm), @(tsee defthmd), or @(tsee thm), the
 application of @(&#39;remove-hyps&#39;) attempts to produce a minimal set of
 hypotheses.  For example:&lt;/p&gt;

 @({
 (remove-hyps
  (defthm nth-append
    (implies (and (true-listp x)
                  (natp n)
                  (true-listp y))
             (equal (nth n (append x y))
                    (if (&lt; n (len x))
                        (nth n x)
                      (nth (- n (len x)) y))))
    :rule-classes nil))
 })

 &lt;p&gt;generates:&lt;/p&gt;

 @({
 (DEFTHM NTH-APPEND
   (IMPLIES (NATP N)
            (EQUAL (NTH N (APPEND X Y))
                   (IF (&lt; N (LEN X))
                       (NTH N X)
                     (NTH (- N (LEN X)) Y))))
   :RULE-CLASSES NIL)
 })

 &lt;p&gt;Note however that @(&#39;remove-hyps&#39;) works by removing one hypothesis at a
 time, with each resulting proof attempt made using a limited number of
 steps (see @(see with-prover-step-limit)) that depends on the number of steps
 taken before removing the hypothesis.  So if the removal of a hypothesis
 requires a proof that takes sufficiently many more steps than the original
 proof, or if two or more hypotheses must be removed together for the proof to
 succeed with fewer hypotheses, then the result will not have a minimal set of
 hypotheses.&lt;/p&gt;

 &lt;p&gt;Acceptable forms are as follows, where @(&#39;HYP&#39;) can be a conjunction of
 hypotheses, @(&#39;(and HYP1 ... HYPn)&#39;), and ``@(&#39;defthm NAME&#39;)&#39;&#39; may be
 replaced by ``@(&#39;defthmd NAME&#39;)&#39;&#39; or ``@(&#39;THM&#39;)&#39;&#39;.&lt;/p&gt;

 @({
 (defthm NAME (implies HYP CONCL) ...)
 (defthm NAME CONCL ...)
 (defthm NAME (let ... (implies HYP CONCL)) ...)
 (defthm NAME (let ... CONCL) ...)
 (defthm NAME (let* ... (implies HYP CONCL)) ...)
 (defthm NAME (let* ... CONCL) ...)
 })

 &lt;p&gt;Normally, before using @(&#39;remove-hyps&#39;), one succesfully submits the given
 call of @(&#39;defthm&#39;), @(&#39;defthmd&#39;), or @(&#39;thm&#39;).  Thus by default,
 @(&#39;remove-hyps&#39;) evaluates silently.  To see output from proof attempts, add a
 non-nil optional argument.  For example, for event @(&#39;E&#39;), use @(&#39;(remove-hyps
 E t)&#39;).&lt;/p&gt;

 &lt;p&gt;Unless there is an error (for example, due to malformed input), then in the
 case of a call of @(&#39;thm&#39;), the value returned is the keyword,
 @(&#39;:REMOVE-HYPS-COMPLETED&#39;); otherwise, the value returned is the name of the
 theorem.  (Technically, the value returned is an error triple with such a
 value; see @(see error-triple).)&lt;/p&gt;

 &lt;p&gt;Consider the case that a call of @(&#39;remove-hyps&#39;) is made in a context
 where proofs are normally skipped (see @(see ld-skip-proofsp)).  If this
 happens while including a certified book with @(tsee include-book), then
 proofs will indeed be skipped, because the earlier result of this
 @(&#39;remove-hyps&#39;) call was saved in the book&#39;s @(see certificate).  But
 otherwise, the tool temporarily turns off the skipping of proofs (that is,
 restores the act of doing proofs) while it tries to remove hypotheses, to
 avoid the undesirable situation that all hypotheses are removed merely because
 all proofs succeed when skipping proofs.&lt;/p&gt;

 &lt;p&gt;Finally, note that when @(&#39;remove-hyps&#39;) is applied to a call of
 @(&#39;defthm&#39;) or @(&#39;defthmd&#39;), then @(&#39;remove-hyps&#39;) will conclude by submitting
 the generated event to ACL2.  But since @(&#39;thm&#39;) does not modify the logical
 @(tsee world), @(&#39;remove-hyps&#39;) does not perform an extra such call at the end
 for calls of @(&#39;thm&#39;).&lt;/p&gt;"</span>)</pre>
  </div>

<div class="form-block other" id="form-3" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-set-state-ok" data-sym="SET-STATE-OK">set-state-ok</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>)</pre>
  </div>

<div class="form-block other" id="form-4" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-program" data-sym="PROGRAM">program</a>)</pre>
  </div>

<div class="form-block function" id="def-remove-hyps-formula-steps" data-defines="REMOVE-HYPS-FORMULA-STEPS" data-references="*,+,*DEFAULT-STEP-LIMIT*,MIN,STEPS,DEFUN" data-used-by="REMOVE-HYPS-FORMULA" data-part-name="REMOVE-HYPS-FORMULA-STEPS" data-part-args="STEPS" data-part-body="STEPS,*,+,*DEFAULT-STEP-LIMIT*,MIN" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="REMOVE-HYPS-FORMULA-STEPS">remove-hyps-formula-steps</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-remove-hyps-formula-steps" data-sym="REMOVE-HYPS-FORMULA-STEPS" title="(defun remove-hyps-formula-steps (steps)
  (min *default-step-limit* (+ 1000 (* 3 steps))))">remove-hyps-formula-steps</a>
  (steps)
  (min <a class="sym-link system" href="../../axioms.html#def-_2Adefault-step-limit_2A" data-sym="*DEFAULT-STEP-LIMIT*">*default-step-limit*</a> (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">1000</span> (<a class="sym-link system" href="../../axioms.html#def-_2A" data-sym="*">*</a> <span class="number">3</span> steps))))</pre>
  </div>

<div class="form-block function" id="def-dumb-implicate" data-defines="DUMB-IMPLICATE" data-references="AND,T,IMPLIES,QUASIQUOTE,CDR,NULL,COND,CONCL,HYPS,DEFUN" data-used-by="MAKE-DEFTHM" data-part-name="DUMB-IMPLICATE" data-part-args="CONCL,HYPS" data-part-body="AND,T,IMPLIES,QUASIQUOTE,CDR,CONCL,HYPS,NULL,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="DUMB-IMPLICATE">dumb-implicate</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-dumb-implicate" data-sym="DUMB-IMPLICATE" title="(defun dumb-implicate (hyps concl)
  (cond ((null hyps) concl) ((null (cdr hyps)) `(implies ,(car hyps) ,concl))
        (t `(implies (and ,@hyps) ,concl))))">dumb-implicate</a>
  (hyps concl)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> hyps) concl)
    ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> (cdr hyps)) `(<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> ,(CAR HYPS) ,CONCL))
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> `(<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> ,@HYPS) ,CONCL))))</pre>
  </div>

<div class="form-block function" id="def-make-defthm" data-defines="MAKE-DEFTHM" data-references="THM,QUOTE,EQ,ASSERT$,NULL,IGNORABLE,DECLARE,QUASIQUOTE,IF,FORM,DUMB-IMPLICATE,FORM0,LET*,BINDINGS,LET/LET*,KWD-ALIST,CONCL,HYPS,NAME,DEFT,DEFUN" data-used-by="REMOVE-HYPS-FORMULA" data-part-name="MAKE-DEFTHM" data-part-args="BINDINGS,LET/LET*,KWD-ALIST,CONCL,HYPS,NAME,DEFT" data-part-body="THM,QUOTE,DEFT,EQ,ASSERT$,NAME,NULL,IGNORABLE,DECLARE,QUASIQUOTE,BINDINGS,IF,FORM,CONCL,HYPS,DUMB-IMPLICATE,FORM0,LET*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="MAKE-DEFTHM">make-defthm</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-make-defthm" data-sym="MAKE-DEFTHM" title="(defun make-defthm (deft name hyps concl kwd-alist let/let* bindings)
  (let* ((form0 (dumb-implicate hyps concl))
         (form
          (if bindings
              `(,let/let* ,bindings
...">make-defthm</a>
  (deft name hyps concl kwd-alist let/let* bindings)
  (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((form0 (<a class="sym-link local-def" href="#def-dumb-implicate" data-sym="DUMB-IMPLICATE" title="(defun dumb-implicate (hyps concl)
  (cond ((null hyps) concl) ((null (cdr hyps)) `(implies ,(car hyps) ,concl))
        (t `(implies (and ,@hyps) ,concl))))">dumb-implicate</a> hyps concl)) (form (if bindings
          `(,LET/LET* ,BINDINGS
            (declare (ignorable ,@(STRIP-CARS BINDINGS)))
            ,FORM0)
          form0)))
    (if (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> name)
      (<a class="sym-link system" href="../../axioms.html#def-assert_24" data-sym="ASSERT$">assert$</a> (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> deft '<a class="sym-link system" href="../../defthm.html#def-thm" data-sym="THM">thm</a>) `(<a class="sym-link system" href="../../defthm.html#def-thm" data-sym="THM">thm</a> ,FORM ,@KWD-ALIST))
      `(,DEFT ,NAME ,FORM ,@KWD-ALIST))))</pre>
  </div>

<div class="form-block function" id="def-event-steps" data-defines="EVENT-STEPS" data-references="F-GET-GLOBAL,T,TRANS-EVAL,ER-PROGN,*BAD*,DEFCONST,LAST-PROVER-STEPS,OR,VALUE-TRIPLE,VALUE,OUR-STEPS,QUOTE,F-PUT-GLOBAL,PPROGN,MAKE-EVENT,PROGN,WITH-OUTPUT,QUASIQUOTE,NEW-FORM,LET,STATE,EXTRA-FORMS,VERBOSE-P,FORM,DEFUN" data-used-by="REMOVE-HYPS-FORMULA,REMOVE-HYPS-FORMULA-1" data-part-name="EVENT-STEPS" data-part-args="STATE,EXTRA-FORMS,VERBOSE-P,FORM" data-part-body="F-GET-GLOBAL,T,EVENT-STEPS,TRANS-EVAL,ER-PROGN,*BAD*,DEFCONST,LAST-PROVER-STEPS,OR,VALUE-TRIPLE,VALUE,STATE,OUR-STEPS,QUOTE,F-PUT-GLOBAL,PPROGN,MAKE-EVENT,PROGN,WITH-OUTPUT,QUASIQUOTE,NEW-FORM,LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="EVENT-STEPS">event-steps</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-event-steps" data-sym="EVENT-STEPS" title="(defun event-steps (form verbose-p extra-forms state)
  (let ((new-form
         `(with-output :stack :push :off :all :gag-mode nil
                       (progn
                        (make-event
...">event-steps</a>
  (form verbose-p extra-forms state)
  (let ((new-form `(<a class="sym-link system" href="../../axioms.html#def-with-output" data-sym="WITH-OUTPUT">with-output</a> <span class="keyword">:stack</span> <span class="keyword">:push</span> <span class="keyword">:off</span> <span class="keyword">:all</span> <span class="keyword">:gag-mode</span> nil
         (<a class="sym-link system" href="../../axioms.html#def-progn" data-sym="PROGN">progn</a> (<a class="sym-link system" href="../../axioms.html#def-make-event" data-sym="MAKE-EVENT">make-event</a> (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link system" href="../../axioms.html#def-f-put-global" data-sym="F-PUT-GLOBAL">f-put-global</a> 'our-steps nil state)
               (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> '(<a class="sym-link system" href="../../axioms.html#def-value-triple" data-sym="VALUE-TRIPLE">value-triple</a> nil))))
           ,(IF VERBOSE-P
     `(WITH-OUTPUT :STACK :POP ,FORM)
     FORM)
           (<a class="sym-link system" href="../../axioms.html#def-make-event" data-sym="MAKE-EVENT">make-event</a> (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link system" href="../../axioms.html#def-f-put-global" data-sym="F-PUT-GLOBAL">f-put-global</a> 'our-steps
                 (<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../history-management.html#def-last-prover-steps" data-sym="LAST-PROVER-STEPS">last-prover-steps</a> state) <span class="number">1</span>)
                 state)
               ,@EXTRA-FORMS
               (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> '(<a class="sym-link system" href="../../axioms.html#def-value-triple" data-sym="VALUE-TRIPLE">value-triple</a> nil))))
           (<a class="sym-link system" href="../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> *bad*)))))
    (<a class="sym-link system" href="../../axioms.html#def-er-progn" data-sym="ER-PROGN">er-progn</a> (trans-eval new-form '<a class="sym-link local-def" href="#def-event-steps" data-sym="EVENT-STEPS" title="(defun event-steps (form verbose-p extra-forms state)
  (let ((new-form
         `(with-output :stack :push :off :all :gag-mode nil
                       (progn
                        (make-event
...">event-steps</a> state <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>)
      (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-f-get-global" data-sym="F-GET-GLOBAL">f-get-global</a> 'our-steps state)))))</pre>
  </div>

<div class="form-block function" id="def-remove-hyps-formula-1" data-defines="REMOVE-HYPS-FORMULA-1" data-references="NULL,EVENT-STEPS,ER-LET*,WITH-PROVER-STEP-LIMIT,QUASIQUOTE,FORM,LET,T,CDR,CONS,SYNP,BIND-FREE,SYNTAXP,QUOTE,CAAR,MEMBER-EQ,CAR,CONSP,AND,REVERSE,VALUE,ENDP,COND,STATE,VERBOSE-P,STEPS,BINDINGS,LET/LET*,KWD-ALIST,CONCL,REST-HYPS,REV-INIT-HYPS,NAME,DEFUN" data-used-by="REMOVE-HYPS-FORMULA" data-part-name="REMOVE-HYPS-FORMULA-1" data-part-args="STATE,VERBOSE-P,STEPS,BINDINGS,LET/LET*,KWD-ALIST,CONCL,REST-HYPS,REV-INIT-HYPS,NAME" data-part-body="NULL,EVENT-STEPS,ER-LET*,WITH-PROVER-STEP-LIMIT,QUASIQUOTE,FORM,LET,T,STATE,VERBOSE-P,STEPS,BINDINGS,LET/LET*,KWD-ALIST,CONCL,CDR,CONS,NAME,REMOVE-HYPS-FORMULA-1,SYNP,BIND-FREE,SYNTAXP,QUOTE,CAAR,MEMBER-EQ,CAR,CONSP,AND,REV-INIT-HYPS,REVERSE,VALUE,REST-HYPS,ENDP,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="REMOVE-HYPS-FORMULA-1">remove-hyps-formula-1</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-remove-hyps-formula-1" data-sym="REMOVE-HYPS-FORMULA-1" title="(defun remove-hyps-formula-1
       (name rev-init-hyps rest-hyps concl kwd-alist let/let* bindings steps
        verbose-p state)
  (cond ((endp rest-hyps) (value (reverse rev-init-hyps)))
        ((and (consp (car rest-hyps))
...">remove-hyps-formula-1</a>
  (name rev-init-hyps
    rest-hyps
    concl
    kwd-alist
    let/let*
    bindings
    steps
    verbose-p
    state)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> rest-hyps) (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-reverse" data-sym="REVERSE">reverse</a> rev-init-hyps)))
    ((<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (consp (car rest-hyps))
       (<a class="sym-link system" href="../../axioms.html#def-member-eq" data-sym="MEMBER-EQ">member-eq</a> (<a class="sym-link system" href="../../axioms.html#def-caar" data-sym="CAAR">caar</a> rest-hyps) '(<a class="sym-link system" href="../../axioms.html#def-syntaxp" data-sym="SYNTAXP">syntaxp</a> <a class="sym-link system" href="../../axioms.html#def-bind-free" data-sym="BIND-FREE">bind-free</a> <a class="sym-link system" href="../../axioms.html#def-synp" data-sym="SYNP">synp</a>))) (<a class="sym-link local-def" href="#def-remove-hyps-formula-1" data-sym="REMOVE-HYPS-FORMULA-1" title="(defun remove-hyps-formula-1
       (name rev-init-hyps rest-hyps concl kwd-alist let/let* bindings steps
        verbose-p state)
  (cond ((endp rest-hyps) (value (reverse rev-init-hyps)))
        ((and (consp (car rest-hyps))
...">remove-hyps-formula-1</a> name
        (cons (car rest-hyps) rev-init-hyps)
        (cdr rest-hyps)
        concl
        kwd-alist
        let/let*
        bindings
        steps
        verbose-p
        state))
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (let ((form `(<a class="sym-link system" href="../../history-management.html#def-with-prover-step-limit" data-sym="WITH-PROVER-STEP-LIMIT">with-prover-step-limit</a> ,STEPS
             ,(MAKE-DEFTHM &#39;DEFTHM NAME (REVAPPEND REV-INIT-HYPS (CDR REST-HYPS)) CONCL
  KWD-ALIST LET/LET* BINDINGS))))
        (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((<a class="sym-link local-def" href="#def-event-steps" data-sym="EVENT-STEPS" title="(defun event-steps (form verbose-p extra-forms state)
  (let ((new-form
         `(with-output :stack :push :off :all :gag-mode nil
                       (progn
                        (make-event
...">event-steps</a> (<a class="sym-link local-def" href="#def-event-steps" data-sym="EVENT-STEPS" title="(defun event-steps (form verbose-p extra-forms state)
  (let ((new-form
         `(with-output :stack :push :off :all :gag-mode nil
                       (progn
                        (make-event
...">event-steps</a> form verbose-p nil state)))
          (<a class="sym-link local-def" href="#def-remove-hyps-formula-1" data-sym="REMOVE-HYPS-FORMULA-1" title="(defun remove-hyps-formula-1
       (name rev-init-hyps rest-hyps concl kwd-alist let/let* bindings steps
        verbose-p state)
  (cond ((endp rest-hyps) (value (reverse rev-init-hyps)))
        ((and (consp (car rest-hyps))
...">remove-hyps-formula-1</a> name
            (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> <a class="sym-link local-def" href="#def-event-steps" data-sym="EVENT-STEPS" title="(defun event-steps (form verbose-p extra-forms state)
  (let ((new-form
         `(with-output :stack :push :off :all :gag-mode nil
                       (progn
                        (make-event
...">event-steps</a>) (cons (car rest-hyps) rev-init-hyps))
              (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> rev-init-hyps))
            (cdr rest-hyps)
            concl
            kwd-alist
            let/let*
            bindings
            steps
            verbose-p
            state))))))</pre>
  </div>

<div class="form-block function" id="def-remove-hyps-formula" data-defines="REMOVE-HYPS-FORMULA" data-references="MAKE-DEFTHM,LENGTH,EQUAL,VALUE,REMOVE-HYPS-FORMULA-STEPS,REMOVE-HYPS-FORMULA-1,FINAL-HYPS,SOFT,ER,COND,DEFTHM,QUASIQUOTE,EVENT-STEPS,STEPS,ER-LET*,APPEND,W,REMOVE-HYPS-NAME,GEN-NEW-NAME,MV,IF,NULL,THM,QUOTE,CAR,EQ,IFF,ASSERT$,KWD-ALIST+,NAME2,THMP,MV-LET,T,DO-PROOFS?,STATE,CTX,VERBOSE-P,BINDINGS,LET/LET*,KWD-ALIST,CONCL,HYPS,NAME,FORM,DEFUN" data-used-by="REMOVE-HYPS-FN" data-part-name="REMOVE-HYPS-FORMULA" data-part-args="STATE,CTX,VERBOSE-P,BINDINGS,LET/LET*,KWD-ALIST,CONCL,HYPS,NAME,FORM" data-part-body="MAKE-DEFTHM,LENGTH,EQUAL,VALUE,REMOVE-HYPS-FORMULA-STEPS,BINDINGS,LET/LET*,CONCL,HYPS,REMOVE-HYPS-FORMULA-1,FINAL-HYPS,CTX,SOFT,ER,COND,VERBOSE-P,DEFTHM,QUASIQUOTE,EVENT-STEPS,STEPS,ER-LET*,KWD-ALIST,APPEND,STATE,W,REMOVE-HYPS-NAME,GEN-NEW-NAME,MV,IF,NAME,NULL,THM,QUOTE,FORM,CAR,EQ,IFF,ASSERT$,KWD-ALIST+,NAME2,THMP,MV-LET,T,DO-PROOFS?" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="REMOVE-HYPS-FORMULA">remove-hyps-formula</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-remove-hyps-formula" data-sym="REMOVE-HYPS-FORMULA" title="(defun remove-hyps-formula
       (form name hyps concl kwd-alist let/let* bindings verbose-p ctx state)
  (do-proofs? t nil
              (mv-let (thmp name2 kwd-alist+)
                      (assert$ (iff (eq (car form) &#39;thm) (null name))
...">remove-hyps-formula</a>
  (form name
    hyps
    concl
    kwd-alist
    let/let*
    bindings
    verbose-p
    ctx
    state)
  (do-proofs? <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>
    nil
    (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (thmp name2 kwd-alist+)
      (<a class="sym-link system" href="../../axioms.html#def-assert_24" data-sym="ASSERT$">assert$</a> (<a class="sym-link system" href="../../axioms.html#def-iff" data-sym="IFF">iff</a> (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (car form) '<a class="sym-link system" href="../../defthm.html#def-thm" data-sym="THM">thm</a>) (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> name))
        (if (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> name)
          (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>
            (gen-new-name 'remove-hyps-name (<a class="sym-link system" href="../../axioms.html#def-w" data-sym="W">w</a> state))
            (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> kwd-alist '(<span class="keyword">:rule-classes</span> nil)))
          (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil name kwd-alist)))
      (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((steps (<a class="sym-link local-def" href="#def-event-steps" data-sym="EVENT-STEPS" title="(defun event-steps (form verbose-p extra-forms state)
  (let ((new-form
         `(with-output :stack :push :off :all :gag-mode nil
                       (progn
                        (make-event
...">event-steps</a> (if thmp
               `(<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,NAME2 ,@(CDR FORM) <span class="keyword">:rule-classes</span> nil)
               form)
             verbose-p
             nil
             state)))
        (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> steps) (<a class="sym-link system" href="../../axioms.html#def-er" data-sym="ER">er</a> soft ctx <span class="string">"Original theorem failed!"</span>))
          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((final-hyps (<a class="sym-link local-def" href="#def-remove-hyps-formula-1" data-sym="REMOVE-HYPS-FORMULA-1" title="(defun remove-hyps-formula-1
       (name rev-init-hyps rest-hyps concl kwd-alist let/let* bindings steps
        verbose-p state)
  (cond ((endp rest-hyps) (value (reverse rev-init-hyps)))
        ((and (consp (car rest-hyps))
...">remove-hyps-formula-1</a> name2
                   nil
                   hyps
                   concl
                   kwd-alist+
                   let/let*
                   bindings
                   (<a class="sym-link local-def" href="#def-remove-hyps-formula-steps" data-sym="REMOVE-HYPS-FORMULA-STEPS" title="(defun remove-hyps-formula-steps (steps)
  (min *default-step-limit* (+ 1000 (* 3 steps))))">remove-hyps-formula-steps</a> steps)
                   verbose-p
                   state)))
              (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (if (equal (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> hyps) (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> final-hyps))
                  nil
                  (<a class="sym-link local-def" href="#def-make-defthm" data-sym="MAKE-DEFTHM" title="(defun make-defthm (deft name hyps concl kwd-alist let/let* bindings)
  (let* ((form0 (dumb-implicate hyps concl))
         (form
          (if bindings
              `(,let/let* ,bindings
...">make-defthm</a> (car form)
                    name
                    final-hyps
                    concl
                    kwd-alist
                    let/let*
                    bindings))))))))))</pre>
  </div>

<div class="form-block function" id="def-remove-hyps-fn" data-defines="REMOVE-HYPS-FN" data-references="OR,WITH-OUTPUT,VALUE-TRIPLE,T,STANDARD-CO,IF,CONS,LIST,FMS,NULL,COND,PPROGN,THM,CAR,EQ,VALUE,THMP,STATE,REMOVE-HYPS,QUOTE,REMOVE-HYPS-FORMULA,NEW-FORM,ER-LET*,MAKE-EVENT,QUASIQUOTE,VERBOSE-P,BINDINGS,LET/LET*,KWD-ALIST,CONCL,HYPS,NAME,FORM,DEFUN" data-used-by="REMOVE-HYPS" data-part-name="REMOVE-HYPS-FN" data-part-args="VERBOSE-P,BINDINGS,LET/LET*,KWD-ALIST,CONCL,HYPS,NAME,FORM" data-part-body="OR,WITH-OUTPUT,VALUE-TRIPLE,T,STANDARD-CO,IF,CONS,LIST,FMS,NULL,COND,PPROGN,THM,CAR,EQ,VALUE,THMP,STATE,REMOVE-HYPS,QUOTE,REMOVE-HYPS-FORMULA,NEW-FORM,ER-LET*,MAKE-EVENT,QUASIQUOTE" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="REMOVE-HYPS-FN">remove-hyps-fn</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-remove-hyps-fn" data-sym="REMOVE-HYPS-FN" title="(defun remove-hyps-fn
       (form name hyps concl kwd-alist let/let* bindings verbose-p)
  `(make-event
    (er-let*
     ((new-form
...">remove-hyps-fn</a>
  (form name hyps concl kwd-alist let/let* bindings verbose-p)
  `(<a class="sym-link system" href="../../axioms.html#def-make-event" data-sym="MAKE-EVENT">make-event</a> (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((new-form (<a class="sym-link local-def" href="#def-remove-hyps-formula" data-sym="REMOVE-HYPS-FORMULA" title="(defun remove-hyps-formula
       (form name hyps concl kwd-alist let/let* bindings verbose-p ctx state)
  (do-proofs? t nil
              (mv-let (thmp name2 kwd-alist+)
                      (assert$ (iff (eq (car form) &#39;thm) (null name))
...">remove-hyps-formula</a> ',FORM
           ',NAME
           ',HYPS
           ',CONCL
           ',KWD-ALIST
           ',LET/LET*
           ',BINDINGS
           ',VERBOSE-P
           '<a class="sym-link local-def" href="#def-remove-hyps" data-sym="REMOVE-HYPS" title="(defmacro remove-hyps (form &amp;optional verbose-p)
  (or
   (and (consp form) (member-eq (car form) &#39;(defthm defthmd thm))
        (mv-let (name form-without-name)
                (if (eq (car form) &#39;thm)
...">remove-hyps</a>
           state)) (thmp (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (car ',FORM) '<a class="sym-link system" href="../../defthm.html#def-thm" data-sym="THM">thm</a>))))
      (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> new-form) (<a class="sym-link system" href="../../basis-a.html#def-fms" data-sym="FMS">fms</a> <span class="string">"Note: REMOVE-HYPS left its input unchanged.~|~@0"</span>
              (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (cons #\0
                  (if thmp
                    <span class="string">""</span>
                    <span class="string">"Now silently submitting the original ~
                                         form.~|"</span>)))
              (<a class="sym-link system" href="../../basis-a.html#def-standard-co" data-sym="STANDARD-CO">standard-co</a> state)
              state
              nil))
          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../basis-a.html#def-fms" data-sym="FMS">fms</a> <span class="string">"New form from REMOVE-HYPS:~|~%~x0~|~%~@1"</span>
              (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (cons #\0 new-form)
                (cons #\1
                  (if thmp
                    <span class="string">""</span>
                    <span class="string">"Now silently submitting the new ~
                                           form (above).~|"</span>)))
              (<a class="sym-link system" href="../../basis-a.html#def-standard-co" data-sym="STANDARD-CO">standard-co</a> state)
              state
              nil)))
        (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (if thmp
            '(<a class="sym-link system" href="../../axioms.html#def-value-triple" data-sym="VALUE-TRIPLE">value-triple</a> <span class="keyword">:remove-hyps-completed</span>)
            (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> '<a class="sym-link system" href="../../axioms.html#def-with-output" data-sym="WITH-OUTPUT">with-output</a>
              <span class="keyword">:off</span> <span class="keyword">:all</span> <span class="keyword">:gag-mode</span> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>
              (<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> new-form ',FORM))))))))</pre>
  </div>

<div class="form-block macro" id="def-remove-hyps" data-defines="REMOVE-HYPS" data-references="SOFT,ER,QUASIQUOTE,&,B*,LET*,BINDINGS,LET/LET*,REMOVE-HYPS-FN,LIST,HYPS,LET,KWD-ALIST,CONCL,HYP,IMPLIES,CASE-MATCH,CDDR,CADR,CDR,MV,EQ,IF,FORM-WITHOUT-NAME,NAME,MV-LET,THM,DEFTHMD,DEFTHM,QUOTE,CAR,MEMBER-EQ,CONSP,AND,OR,VERBOSE-P,&OPTIONAL,FORM,DEFMACRO" data-used-by="REMOVE-HYPS-FN" typeof="Code">
    <div class="form-header"><span class="form-name" property="name" data-sym="REMOVE-HYPS">remove-hyps</span><span class="form-type">macro</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> <a class="sym-link local-def" href="#def-remove-hyps" data-sym="REMOVE-HYPS" title="(defmacro remove-hyps (form &amp;optional verbose-p)
  (or
   (and (consp form) (member-eq (car form) &#39;(defthm defthmd thm))
        (mv-let (name form-without-name)
                (if (eq (car form) &#39;thm)
...">remove-hyps</a>
  (form &amp;optional verbose-p)
  (<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (consp form)
      (<a class="sym-link system" href="../../axioms.html#def-member-eq" data-sym="MEMBER-EQ">member-eq</a> (car form) '(<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> <a class="sym-link system" href="../../axioms.html#def-defthmd" data-sym="DEFTHMD">defthmd</a> <a class="sym-link system" href="../../defthm.html#def-thm" data-sym="THM">thm</a>))
      (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (name form-without-name)
        (if (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (car form) '<a class="sym-link system" href="../../defthm.html#def-thm" data-sym="THM">thm</a>)
          (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil (cdr form))
          (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> form) (<a class="sym-link system" href="../../axioms.html#def-cddr" data-sym="CDDR">cddr</a> form)))
        (<a class="sym-link system" href="../../basis-a.html#def-case-match" data-sym="CASE-MATCH">case-match</a> form-without-name
          ((('<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> hyp concl) . kwd-alist) (let ((hyps (if (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (consp hyp) (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (car hyp) '<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a>))
                   (cdr hyp)
                   (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> hyp))))
              (<a class="sym-link local-def" href="#def-remove-hyps-fn" data-sym="REMOVE-HYPS-FN" title="(defun remove-hyps-fn
       (form name hyps concl kwd-alist let/let* bindings verbose-p)
  `(make-event
    (er-let*
     ((new-form
...">remove-hyps-fn</a> form
                name
                hyps
                concl
                kwd-alist
                nil
                nil
                verbose-p)))
          (((let/let* bindings ('<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> hyp concl)) . kwd-alist) (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-member-eq" data-sym="MEMBER-EQ">member-eq</a> let/let*
                '(let <a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a>
                  b*))
              (let ((hyps (if (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (consp hyp) (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (car hyp) '<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a>))
                     (cdr hyp)
                     (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> hyp))))
                (<a class="sym-link local-def" href="#def-remove-hyps-fn" data-sym="REMOVE-HYPS-FN" title="(defun remove-hyps-fn
       (form name hyps concl kwd-alist let/let* bindings verbose-p)
  `(make-event
    (er-let*
     ((new-form
...">remove-hyps-fn</a> form
                  name
                  hyps
                  concl
                  kwd-alist
                  let/let*
                  bindings
                  verbose-p))))
          (&amp; nil))))
    `(<a class="sym-link system" href="../../axioms.html#def-er" data-sym="ER">er</a> soft
      '<a class="sym-link local-def" href="#def-remove-hyps" data-sym="REMOVE-HYPS" title="(defmacro remove-hyps (form &amp;optional verbose-p)
  (or
   (and (consp form) (member-eq (car form) &#39;(defthm defthmd thm))
        (mv-let (name form-without-name)
                (if (eq (car form) &#39;thm)
...">remove-hyps</a>
      <span class="string">"Illegal argument to remove-hyps:~|~%~y0"</span>
      ',FORM)))</pre>
  </div>

<div class="form-block other" id="form-13" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-logic" data-sym="LOGIC">logic</a>)</pre>
  </div>

<div class="form-block local" id="form-14" typeof="Code">
    <div class="form-header"><span class="form-type">local</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../arithmetic/top.html" title="Open arithmetic/top">"arithmetic/top"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>))</pre>
  </div>

<div class="form-block local" id="form-15" typeof="Code">
    <div class="form-header"><span class="form-type">local</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link local-def" href="#def-remove-hyps" data-sym="REMOVE-HYPS" title="(defmacro remove-hyps (form &amp;optional verbose-p)
  (or
   (and (consp form) (member-eq (car form) &#39;(defthm defthmd thm))
        (mv-let (name form-without-name)
                (if (eq (car form) &#39;thm)
...">remove-hyps</a> (<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> nth-append
      (<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> x) (<a class="sym-link system" href="../../axioms.html#def-natp" data-sym="NATP">natp</a> n) (<a class="sym-link system" href="../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> y))
        (equal (<a class="sym-link system" href="../../axioms.html#def-nth" data-sym="NTH">nth</a> n (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> x y))
          (if (&lt; n (<a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> x))
            (<a class="sym-link system" href="../../axioms.html#def-nth" data-sym="NTH">nth</a> n x)
            (<a class="sym-link system" href="../../axioms.html#def-nth" data-sym="NTH">nth</a> (<a class="sym-link system" href="../../axioms.html#def--" data-sym="-">-</a> n (<a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> x)) y))))
      <span class="keyword">:rule-classes</span> nil)))</pre>
  </div>

<div class="form-block other" id="form-16" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-set-enforce-redundancy" data-sym="SET-ENFORCE-REDUNDANCY">set-enforce-redundancy</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>)</pre>
  </div>

<div class="form-block local" id="form-17" typeof="Code">
    <div class="form-header"><span class="form-type">local</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> nth-append
    (<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../axioms.html#def-natp" data-sym="NATP">natp</a> n)
      (equal (<a class="sym-link system" href="../../axioms.html#def-nth" data-sym="NTH">nth</a> n (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> x y))
        (if (&lt; n (<a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> x))
          (<a class="sym-link system" href="../../axioms.html#def-nth" data-sym="NTH">nth</a> n x)
          (<a class="sym-link system" href="../../axioms.html#def-nth" data-sym="NTH">nth</a> (<a class="sym-link system" href="../../axioms.html#def--" data-sym="-">-</a> n (<a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> x)) y))))
    <span class="keyword">:rule-classes</span> nil))</pre>
  </div>

<div class="form-block other" id="form-18" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-set-enforce-redundancy" data-sym="SET-ENFORCE-REDUNDANCY">set-enforce-redundancy</a> nil)</pre>
  </div>

<div class="form-block local" id="form-19" typeof="Code">
    <div class="form-header"><span class="form-type">local</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link local-def" href="#def-remove-hyps" data-sym="REMOVE-HYPS" title="(defmacro remove-hyps (form &amp;optional verbose-p)
  (or
   (and (consp form) (member-eq (car form) &#39;(defthm defthmd thm))
        (mv-let (name form-without-name)
                (if (eq (car form) &#39;thm)
...">remove-hyps</a> (<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> nth-append-alt
      (<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> x) (<a class="sym-link system" href="../../axioms.html#def-natp" data-sym="NATP">natp</a> n) (<a class="sym-link system" href="../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> y))
        (equal (<a class="sym-link system" href="../../axioms.html#def-nth" data-sym="NTH">nth</a> n (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> x y))
          (if (<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../axioms.html#def-natp" data-sym="NATP">natp</a> n))
            (car (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> x y))
            (if (&lt; n (<a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> x))
              (<a class="sym-link system" href="../../axioms.html#def-nth" data-sym="NTH">nth</a> n x)
              (<a class="sym-link system" href="../../axioms.html#def-nth" data-sym="NTH">nth</a> (<a class="sym-link system" href="../../axioms.html#def--" data-sym="-">-</a> n (<a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> x)) y)))))
      <span class="keyword">:rule-classes</span> nil)))</pre>
  </div>

<div class="form-block other" id="form-20" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-set-enforce-redundancy" data-sym="SET-ENFORCE-REDUNDANCY">set-enforce-redundancy</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>)</pre>
  </div>

<div class="form-block local" id="form-21" typeof="Code">
    <div class="form-header"><span class="form-type">local</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> nth-append-alt
    (equal (<a class="sym-link system" href="../../axioms.html#def-nth" data-sym="NTH">nth</a> n (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> x y))
      (if (<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../axioms.html#def-natp" data-sym="NATP">natp</a> n))
        (car (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> x y))
        (if (&lt; n (<a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> x))
          (<a class="sym-link system" href="../../axioms.html#def-nth" data-sym="NTH">nth</a> n x)
          (<a class="sym-link system" href="../../axioms.html#def-nth" data-sym="NTH">nth</a> (<a class="sym-link system" href="../../axioms.html#def--" data-sym="-">-</a> n (<a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> x)) y))))
    <span class="keyword">:rule-classes</span> nil))</pre>
  </div>

<div class="form-block other" id="form-22" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-set-enforce-redundancy" data-sym="SET-ENFORCE-REDUNDANCY">set-enforce-redundancy</a> nil)</pre>
  </div>

<div class="form-block local" id="form-23" typeof="Code">
    <div class="form-header"><span class="form-type">local</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link local-def" href="#def-remove-hyps" data-sym="REMOVE-HYPS" title="(defmacro remove-hyps (form &amp;optional verbose-p)
  (or
   (and (consp form) (member-eq (car form) &#39;(defthm defthmd thm))
        (mv-let (name form-without-name)
                (if (eq (car form) &#39;thm)
...">remove-hyps</a> (<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> nth-append-alt-2
      (let ((xx x))
        (<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> xx) (<a class="sym-link system" href="../../axioms.html#def-natp" data-sym="NATP">natp</a> n) (<a class="sym-link system" href="../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> y))
          (equal (<a class="sym-link system" href="../../axioms.html#def-nth" data-sym="NTH">nth</a> n (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> xx y))
            (if (&lt; n (<a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> x))
              (<a class="sym-link system" href="../../axioms.html#def-nth" data-sym="NTH">nth</a> n x)
              (<a class="sym-link system" href="../../axioms.html#def-nth" data-sym="NTH">nth</a> (<a class="sym-link system" href="../../axioms.html#def--" data-sym="-">-</a> n (<a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> xx)) y)))))
      <span class="keyword">:hints</span> ((<span class="string">"Goal&#39;"</span> <span class="keyword">:induct</span> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>)))))</pre>
  </div>

<div class="form-block other" id="form-24" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-set-enforce-redundancy" data-sym="SET-ENFORCE-REDUNDANCY">set-enforce-redundancy</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>)</pre>
  </div>

<div class="form-block local" id="form-25" typeof="Code">
    <div class="form-header"><span class="form-type">local</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> nth-append-alt-2
    (let ((xx x))
      (declare (ignorable xx))
      (<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../axioms.html#def-natp" data-sym="NATP">natp</a> n)
        (equal (<a class="sym-link system" href="../../axioms.html#def-nth" data-sym="NTH">nth</a> n (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> xx y))
          (if (&lt; n (<a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> x))
            (<a class="sym-link system" href="../../axioms.html#def-nth" data-sym="NTH">nth</a> n x)
            (<a class="sym-link system" href="../../axioms.html#def-nth" data-sym="NTH">nth</a> (<a class="sym-link system" href="../../axioms.html#def--" data-sym="-">-</a> n (<a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> xx)) y)))))
    <span class="keyword">:hints</span> ((<span class="string">"Goal&#39;"</span> <span class="keyword">:induct</span> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>))))</pre>
  </div>


  </main>
  
<script>
// ACL2 Book HTML Documentation - Interactive Features
// Generated by cert2 - build2 system

// State
let activeFilter = null;
let activePartFilter = null;
let activeNameFilter = null;
let currentFontSize = 14;

// Theme management
function getStoredTheme() {
  return localStorage.getItem('acl2-theme') || 'dark';
}

function setTheme(theme) {
  if (theme === 'light') {
    document.documentElement.setAttribute('data-theme', 'light');
    document.getElementById('theme-toggle').textContent = '🌙';
  } else {
    document.documentElement.removeAttribute('data-theme');
    document.getElementById('theme-toggle').textContent = '☀️';
  }
  localStorage.setItem('acl2-theme', theme);
}

function toggleTheme() {
  const current = getStoredTheme();
  setTheme(current === 'dark' ? 'light' : 'dark');
}

// Font size management
function getStoredFontSize() {
  return parseInt(localStorage.getItem('acl2-fontsize') || '14', 10);
}

function setFontSize(size) {
  size = Math.max(10, Math.min(24, size)); // Clamp between 10-24
  currentFontSize = size;
  document.body.style.fontSize = size + 'px';
  localStorage.setItem('acl2-fontsize', size.toString());
}

function increaseFontSize() {
  setFontSize(currentFontSize + 2);
}

function decreaseFontSize() {
  setFontSize(currentFontSize - 2);
}

// Get all form blocks
function getFormBlocks() {
  return document.querySelectorAll('.form-block');
}

// Clear all filters
function clearFilter() {
  activeFilter = null;
  activePartFilter = null;
  activeNameFilter = null;
  getFormBlocks().forEach(b => {
    b.classList.remove('hidden', 'dimmed');
  });
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  const status = document.querySelector('.filter-status');
  status.classList.remove('active');
  // Slide name filter back to original position
  document.querySelector('.controls-left').style.transform = '';
  // Clear the name filter input
  const nameInput = document.getElementById('name-filter');
  if (nameInput) nameInput.value = '';
}

// Show filter status and slide name filter right
function showFilterStatus(text) {
  const status = document.querySelector('.filter-status');
  status.classList.add('active');
  status.querySelector('.filter-text').textContent = text;
  // Slide name filter to the right to make room
  setTimeout(() => {
    const statusWidth = status.offsetWidth;
    document.querySelector('.controls-left').style.transform = `translateX(${statusWidth + 15}px)`;
  }, 10);
}

// Filter to show only forms that define or reference a symbol
function filterBySymbol(symName, showUsedBy) {
  clearFilter();
  activeFilter = symName;
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines;
    const references = (block.dataset.references || '').split(',');
    const usedBy = (block.dataset.usedBy || '').split(',');
    
    let show = false;
    if (showUsedBy) {
      // Show forms that USE this symbol
      show = references.includes(symName) || definesName === symName;
    } else {
      // Show forms that this symbol USES
      show = usedBy.includes(symName) || definesName === symName;
    }
    
    if (show) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering by: ${symName} (${visibleCount} items)`);
}

// Filter by defthm part (term, hints, rule-classes, etc.)
function filterByPart(formId, partName) {
  clearFilter();
  activePartFilter = { formId, partName };
  
  // Get the part's referenced symbols
  // data-part-term becomes dataset.partTerm, data-part-hints becomes dataset.partHints, etc.
  const block = document.getElementById(formId);
  const datasetKey = 'part' + partName.charAt(0).toUpperCase() + partName.slice(1).replace(/-([a-z])/g, (g) => g[1].toUpperCase());
  const partData = block.dataset[datasetKey];
  if (!partData) return;
  
  const partSyms = partData.split(',').filter(s => s);
  
  // Highlight the button
  block.querySelector(`.part-btn[data-part="${partName}"]`).classList.add('active');
  
  // Hide forms not referenced by this part
  getFormBlocks().forEach(b => {
    const definesName = b.dataset.defines;
    if (b.id === formId || partSyms.includes(definesName)) {
      b.classList.remove('hidden');
    } else {
      b.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering ${formId} :${partName} (${partSyms.length} references)`);
}

// Filter by name (substring or regex)
function filterByName(pattern, useRegex) {
  // Clear other filters but keep the input value
  activeFilter = null;
  activePartFilter = null;
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  
  if (!pattern || pattern.trim() === '') {
    // Empty pattern - show all
    activeNameFilter = null;
    getFormBlocks().forEach(b => b.classList.remove('hidden'));
    const status = document.querySelector('.filter-status');
    status.classList.remove('active');
    document.querySelector('.controls-left').style.transform = '';
    return;
  }
  
  activeNameFilter = pattern;
  
  let matcher;
  let isValidRegex = true;
  
  if (useRegex) {
    try {
      matcher = new RegExp(pattern, 'i');
    } catch (e) {
      // Invalid regex - show error in status and don't filter
      showFilterStatus(`Invalid regex: ${e.message}`);
      return;
    }
  } else {
    // Plain substring match (case-insensitive)
    const lowerPattern = pattern.toLowerCase();
    matcher = { test: (s) => s.toLowerCase().includes(lowerPattern) };
  }
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines || '';
    if (matcher.test(definesName)) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  const modeText = useRegex ? 'regex' : 'name';
  showFilterStatus(`Filtering by ${modeText}: "${pattern}" (${visibleCount} matches)`);
}

// Click on a name to show what references it
function handleNameClick(symName) {
  if (activeFilter === symName) {
    clearFilter();
  } else {
    filterBySymbol(symName, true);
  }
}

// Navigate to a definition (same file or different)
function navigateTo(symName, file) {
  if (file) {
    // External file - navigate
    window.location.href = file + '.html#def-' + symName.toLowerCase();
  } else {
    // Same file - scroll
    const target = document.getElementById('def-' + symName.toLowerCase());
    if (target) {
      target.scrollIntoView({ behavior: 'smooth', block: 'center' });
      target.classList.add('highlight');
      setTimeout(() => target.classList.remove('highlight'), 400);
    }
  }
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  // Part buttons
  document.querySelectorAll('.part-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const formId = btn.closest('.form-block').id;
      const partName = btn.dataset.part;
      if (activePartFilter && activePartFilter.formId === formId && 
          activePartFilter.partName === partName) {
        clearFilter();
      } else {
        filterByPart(formId, partName);
      }
    });
  });
  
  // Clear filter button
  document.querySelector('.clear-filter').addEventListener('click', clearFilter);
  
  // Name filter input
  const nameFilter = document.getElementById('name-filter');
  const regexToggle = document.getElementById('regex-toggle');
  
  let filterTimeout = null;
  nameFilter.addEventListener('input', () => {
    // Debounce the filter to avoid excessive updates while typing
    clearTimeout(filterTimeout);
    filterTimeout = setTimeout(() => {
      filterByName(nameFilter.value, regexToggle.checked);
    }, 150);
  });
  
  // Re-filter when regex toggle changes
  regexToggle.addEventListener('change', () => {
    if (nameFilter.value) {
      filterByName(nameFilter.value, regexToggle.checked);
    }
  });
  
  // Allow Escape key to clear filter when in input
  nameFilter.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      clearFilter();
      nameFilter.blur();
    }
  });
  
  // Symbol references (old span-based refs)
  document.querySelectorAll('.sym-ref').forEach(ref => {
    ref.addEventListener('click', (e) => {
      e.stopPropagation();
      const sym = ref.dataset.sym;
      const file = ref.dataset.file;
      if (file) {
        navigateTo(sym, file);
      } else {
        handleNameClick(sym);
      }
    });
  });
  
  // Symbol links (new anchor-based links)
  // These use standard <a> tags so navigation happens automatically
  // But we need to clear filters if target would be hidden
  document.querySelectorAll('.sym-link').forEach(link => {
    link.addEventListener('click', (e) => {
      const href = link.getAttribute('href');
      if (href && href.startsWith('#')) {
        // Local link - check if target is hidden by filter
        const targetId = href.substring(1);
        const target = document.getElementById(targetId);
        if (target) {
          // If target is hidden, clear the filter first
          if (target.classList.contains('hidden')) {
            clearFilter();
          }
          // Add highlight effect after a short delay
          setTimeout(() => {
            target.classList.add('highlight');
            setTimeout(() => target.classList.remove('highlight'), 400);
          }, 100);
        }
      }
      // For external links, default behavior handles navigation
    });
  });
  
  // Form names (show what uses them)
  document.querySelectorAll('.form-name').forEach(name => {
    name.addEventListener('click', (e) => {
      handleNameClick(name.dataset.sym);
    });
  });
  
  // Handle hash navigation (when arriving at page with #anchor)
  if (window.location.hash) {
    const target = document.querySelector(window.location.hash);
    if (target) {
      setTimeout(() => {
        target.scrollIntoView({ behavior: 'smooth', block: 'center' });
        target.classList.add('highlight');
        setTimeout(() => target.classList.remove('highlight'), 400);
      }, 200);
    }
  }
  
  // Initialize theme from storage
  setTheme(getStoredTheme());
  
  // Initialize font size from storage
  currentFontSize = getStoredFontSize();
  setFontSize(currentFontSize);
  
  // Theme toggle button
  document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
  
  // Font size buttons
  document.getElementById('font-larger').addEventListener('click', increaseFontSize);
  document.getElementById('font-smaller').addEventListener('click', decreaseFontSize);
});

</script>

</body>
</html>
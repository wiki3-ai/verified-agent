<!DOCTYPE html>
<html lang="en" vocab="http://schema.org/" typeof="SoftwareSourceCode">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>clone - ACL2 Book</title>
  <meta property="name" content="clone">
  <meta property="programmingLanguage" content="ACL2">
  
<style>
/* ACL2 Book HTML Documentation Styles */
/* Generated by cert2 - build2 system */

/* Dark theme (default) */
:root {
  --bg: #1e1e2e;
  --fg: #cdd6f4;
  --comment: #6c7086;
  --keyword: #cba6f7;
  --string: #a6e3a1;
  --function: #89b4fa;
  --type: #f9e2af;
  --link: #89dceb;
  --link-hover: #f5c2e7;
  --highlight: rgba(137, 180, 250, 0.2);
  --border: #313244;
  --block-bg: rgba(49, 50, 68, 0.5);
  --btn-bg: #313244;
  --btn-hover: rgba(137, 180, 250, 0.2);
}

/* Light theme */
[data-theme="light"] {
  --bg: #eff1f5;
  --fg: #4c4f69;
  --comment: #6c6f85;
  --keyword: #8839ef;
  --string: #40a02b;
  --function: #1e66f5;
  --type: #df8e1d;
  --link: #04a5e5;
  --link-hover: #ea76cb;
  --highlight: rgba(30, 102, 245, 0.15);
  --border: #ccd0da;
  --block-bg: rgba(204, 208, 218, 0.3);
  --btn-bg: #ccd0da;
  --btn-hover: rgba(30, 102, 245, 0.15);
}

body {
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  background: var(--bg);
  color: var(--fg);
  margin: 0;
  padding: 20px;
  line-height: 1.6;
  font-size: 14px;
  transition: background 0.1s, color 0.1s;
}

/* Controls toolbar */
.controls-left {
  position: fixed;
  top: 10px;
  left: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
  transition: transform 0.1s ease;
}

.controls-right {
  position: fixed;
  top: 10px;
  right: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
}

.control-btn {
  padding: 6px 12px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-family: inherit;
  font-size: 14px;
  transition: all 0.1s;
}

.control-btn:hover {
  background: var(--btn-hover);
  border-color: var(--link);
}

.name-filter {
  padding: 6px 10px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  font-family: inherit;
  font-size: 13px;
  width: 150px;
  transition: all 0.1s;
}

.name-filter:focus {
  outline: none;
  border-color: var(--link);
  width: 200px;
}

.name-filter::placeholder {
  color: var(--comment);
}

.regex-label {
  display: flex;
  align-items: center;
  gap: 4px;
  color: var(--comment);
  font-size: 12px;
  cursor: pointer;
}

.regex-label input {
  cursor: pointer;
}

.book-header {
  border-bottom: 2px solid var(--border);
  padding-bottom: 20px;
  margin-bottom: 20px;
}

.book-header h1 {
  color: var(--keyword);
  margin: 0;
}

.book-header .path {
  color: var(--comment);
  font-size: 0.9em;
}

.book-header .path .source-link {
  color: var(--comment);
  text-decoration: none;
}

.book-header .path .source-link:hover {
  color: var(--link);
  text-decoration: underline;
}

.form-block {
  margin: 10px 0;
  padding: 15px;
  background: var(--block-bg);
  border-radius: 8px;
  border-left: 3px solid var(--border);
}

.form-block.theorem { border-left-color: var(--keyword); }
.form-block.function { border-left-color: var(--function); }
.form-block.macro { border-left-color: var(--type); }
.form-block.include-book { border-left-color: var(--string); }

.form-block.hidden { display: none; }
.form-block.dimmed { opacity: 0.3; }

.form-block.highlight {
  animation: highlight-pulse 0.4s ease-out;
}

@keyframes highlight-pulse {
  0% { background: var(--highlight); box-shadow: 0 0 20px var(--link); }
  100% { background: rgba(49, 50, 68, 0.5); box-shadow: none; }
}

.form-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.form-name {
  color: var(--function);
  font-weight: bold;
  cursor: pointer;
}

.form-name:hover {
  color: var(--link-hover);
  text-decoration: underline;
}

.form-type {
  color: var(--comment);
  font-size: 0.85em;
}

pre.code {
  margin: 0;
  overflow-x: auto;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.sym-ref {
  color: var(--link);
  cursor: pointer;
  border-radius: 2px;
}

.sym-ref:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.sym-ref.local-def { color: var(--function); font-weight: bold; }
.sym-ref.external { color: var(--type); }

/* Symbol links (clickable hyperlinks) */
.sym-link {
  color: var(--link);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
  position: relative;
}

.sym-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

.sym-link.local-def {
  color: var(--function);
  font-weight: bold;
}

.sym-link.external {
  color: var(--type);
}

/* Tooltips using title attribute with custom styling */
.sym-link[title] {
  /* Browser will show title on hover */
}

/* Syntax highlighting in code blocks */
.keyword {
  color: var(--keyword);
}

.string {
  color: var(--string);
}

.number {
  color: #f77524; /* orange */
}

/* Include-book path links */
.include-path {
  color: var(--string);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
}

.include-path:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

/* Part buttons for defthm */
.part-buttons {
  display: flex;
  gap: 5px;
  margin: 10px 0;
  flex-wrap: wrap;
}

.part-btn {
  padding: 4px 10px;
  background: var(--border);
  border: 1px solid var(--comment);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-size: 0.85em;
  font-family: inherit;
}

.part-btn:hover {
  background: var(--highlight);
  border-color: var(--link);
}

.part-btn.active {
  background: var(--link);
  color: var(--bg);
  border-color: var(--link);
}

/* References panel */
.refs-panel {
  margin-top: 10px;
  padding: 10px;
  background: rgba(0,0,0,0.2);
  border-radius: 4px;
  display: none;
}

.refs-panel.visible { display: block; }

.refs-panel h4 {
  margin: 0 0 5px 0;
  color: var(--comment);
  font-size: 0.9em;
}

.refs-list {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

/* Included books section */
.includes-section {
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(49, 50, 68, 0.3);
  border-radius: 8px;
  border: 1px solid var(--border);
}

.includes-section h2 {
  margin: 0 0 10px 0;
  color: var(--comment);
  font-size: 1em;
  font-weight: normal;
}

.includes-list {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.include-link {
  padding: 6px 12px;
  background: var(--border);
  border-radius: 4px;
  color: var(--link);
  text-decoration: none;
  font-size: 0.9em;
  transition: all 0.1s;
}

.include-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.include-link.local {
  border-left: 2px solid var(--comment);
}

/* Filter status */
.filter-status {
  position: fixed;
  top: 10px;
  left: 20px;
  background: var(--bg);
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: 4px;
  z-index: 201;
  display: none;
  align-items: center;
  gap: 10px;
}

.filter-status.active {
  display: flex;
  align-items: center;
  gap: 10px;
}

.clear-filter {
  padding: 5px 15px;
  background: var(--keyword);
  color: var(--bg);
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

/* RDFa vocab indicator */
[vocab] { /* semantic web annotations present */ }

</style>

</head>
<body>
  <div class="controls-left">
    <input type="text" id="name-filter" class="name-filter" placeholder="Filter by name..." title="Filter definitions by name">
    <label class="regex-label"><input type="checkbox" id="regex-toggle"> regex</label>
  </div>

  <div class="controls-right">
    <button class="control-btn" id="theme-toggle" title="Toggle light/dark theme">☀️</button>
    <button class="control-btn" id="font-smaller" title="Decrease font size">A-</button>
    <button class="control-btn" id="font-larger" title="Increase font size">A+</button>
  </div>

  <div class="filter-status">
    <span class="filter-text">Filtering...</span>
    <button class="clear-filter">Clear Filter</button>
  </div>
  
  <div class="book-header">
    <h1 property="name">clone</h1>
    <div class="path"><a href="clone.lisp" class="source-link">books/std/stobjs/clone</a></div>
  </div>
  
  <main property="text">
<div class="form-block other" id="form-0" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-in-package" data-sym="IN-PACKAGE">in-package</a> <span class="string">"STOBJS"</span>)</pre>
  </div>

<div class="form-block other" id="form-1" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../std/util/bstar.html" title="Open std/util/bstar">"std/util/bstar"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block other" id="form-2" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../tools/rulesets.html" title="Open tools/rulesets">"tools/rulesets"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block other" id="form-3" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../tools/templates.html" title="Open tools/templates">"tools/templates"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block other" id="form-4" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-program" data-sym="PROGRAM">program</a>)</pre>
  </div>

<div class="form-block other" id="form-5" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc <a class="sym-link local-def" href="#def-defstobj-clone" data-sym="DEFSTOBJ-CLONE" title="(defmacro stobjs::defstobj-clone
          (stobjs::newname stobjs::origname
           &amp;key stobjs::strsubst (stobjs::prefix &#39;&quot;&quot;) (stobjs::suffix &#39;&quot;&quot;)
           stobjs::pkg stobjs::exports)
  `(stobjs::make-event
...">defstobj-clone</a>
  <span class="keyword">:parents</span> (std/stobjs)
  <span class="keyword">:short</span> <span class="string">"Create a new stobj that is @(&#39;:congruent-to&#39;) an existing (concrete
or abstract) stobj, and can be given to functions that operate on the old
stobj."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;@(&#39;Defstobj-clone&#39;) lets you easily introduce a new @(see stobj)
that is @(&#39;:congruent-to&#39;) an existing stobj.  This allows you to have two (or
more) copies of a stobj that coexist simultaneously.&lt;/p&gt;

&lt;h3&gt;Basic Example&lt;/h3&gt;

&lt;p&gt;If you want to write an algorithm that operates on two bit arrays, you might
clone the @(see bitarr) to get a second stobj, @(&#39;bitarr2&#39;).  A minimal way to
do this is:&lt;/p&gt;

@({
    (defstobj-clone bitarr2 bitarr :suffix &quot;2&quot;)
})

&lt;p&gt;This introduces:&lt;/p&gt;

&lt;ul&gt;

&lt;li&gt;A new stobj, @(&#39;bitarr2&#39;), which is congruent to @(&#39;bitarr&#39;), and&lt;/li&gt;

&lt;li&gt;New functions that are basically renamed @(&#39;bitarr&#39;) operations.  In
particular, whereas @(&#39;bitarr&#39;) has operations like @(&#39;get-bit&#39;) and
@(&#39;set-bit&#39;), we&#39;ll get new functions named @(&#39;get-bit2&#39;) and
@(&#39;set-bit2&#39;).&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;Usually you can just &lt;b&gt;ignore&lt;/b&gt; these new functions.  They are added only
because of the way that ACL2 stobj definition works and, strictly speaking, are
not really necessary for anything else because you can still use the original
stobj&#39;s functions on the new stobj.&lt;/p&gt;

&lt;p&gt;Ignoring the new functions is particularly useful when you have already
built up more complex functionality on top of a stobj.  That is, if you&#39;ve
implemented functions like @(&#39;clear-range&#39;) and @(&#39;invert-range&#39;) or similar,
you can just use these on @(&#39;bitarr2&#39;) without reimplementing them.&lt;/p&gt;


&lt;h3&gt;Renaming Accessors&lt;/h3&gt;

&lt;p&gt;On the other hand, it may occasionally be useful for code clarity to rename
the new functions in some semantically meaningful way.  For instance, if your
cloned bit array will be used as a seen table, it may be convenient to use
operations like @(&#39;set-seen&#39;) instead of @(&#39;set-bit&#39;).&lt;/p&gt;

&lt;p&gt;To support using such semantically meaningful names, @(&#39;defstobj-clone&#39;) has
a variety of options.  Here is a contrived example that uses all of them:&lt;/p&gt;

@({
    (defstobj-clone fancy-bitarr bitarr
      :strsubst ((&quot;GET&quot; . &quot;FETCH&quot;)     ;; Substring replacements to make
                 (&quot;SET&quot; . &quot;INSTALL&quot;))  ;;   (capitalized per symbol names)
      :prefix &quot;MY-&quot;                      ;; Name prefix to add
      :suffix &quot;-FOR-JUSTICE&quot;             ;; Name suffix to add
      :pkg acl2::rewrite                   ;; Package for new symbols
                                           ;;   default: new stobj name
      )
})

&lt;p&gt;The result is to define new analogues of the @(&#39;bitarr&#39;) functions with the
following names:&lt;/p&gt;

@({
      bitarrp       --&gt;  fancy-bitarrp
      create-bitarr --&gt;  create-fancy-bitarr
      bits-length   --&gt;  my-bits-length-for-justice
      get-bit       --&gt;  my-fetch-bit-for-justice
      set-bit       --&gt;  my-install-bit-for-justice
      resize-bits   --&gt;  my-resize-bits-for-justice
})


&lt;h3&gt;Alternate Syntax for Abstract Stobjs&lt;/h3&gt;

&lt;p&gt;For an abstract stobj, the accessors/updaters are known as &quot;exports&quot;.
Another way to specifying their names in the new stobj is to provide the
@(&#39;:exports&#39;) argument, which should be a list of symbols corresponding to the
exported functions from the original abstract stobj.  When this is provided,
the other keyword arguments are unused.  For example:&lt;/p&gt;

@({
    (defstobj-clone xx-bitarr bitarr
      :exports (xx-size xx-nth !xx-nth xx-resize))
})

&lt;p&gt;Defines a new @(&#39;xx-bitarr&#39;) stobj with:&lt;/p&gt;

@({
    bitarrp       --&gt; xx-bitarrp
    create-bitarr --&gt; create-xx-bitarr
    bits-length   --&gt; xx-size
    get-bit       --&gt; xx-nth
    set-bit       --&gt; !xx-nth
    resize-bits   --&gt; xx-resize
})"</span>)</pre>
  </div>

<div class="form-block function" id="def-clone-stobj-change-symbol" data-defines="CLONE-STOBJ-CHANGE-SYMBOL" data-references="OR,STRING,QUOTE,CONCATENATE,INTERN-IN-PACKAGE-OF-SYMBOL,SYMBOL-NAME,TMPL-STR-SUBLIS,PKG?,SUB,MV,PKG,STRSUBST,SUFFIX,PREFIX,LIST,B*,IF,RENAMING,SYM,DEFUN" data-used-by="CLONE-ABSSTOBJ-EXPORTS,CLONE-BASE-STOBJ-FN,CLONE-STOBJ-PROCESS-FIELDS,CLONE-STOBJ-PROCESS-RENAME-ALIST" data-part-name="CLONE-STOBJ-CHANGE-SYMBOL" data-part-args="RENAMING,SYM" data-part-body="OR,STRING,QUOTE,CONCATENATE,INTERN-IN-PACKAGE-OF-SYMBOL,SYM,SYMBOL-NAME,TMPL-STR-SUBLIS,PKG?,SUB,MV,PKG,STRSUBST,SUFFIX,PREFIX,LIST,B*,RENAMING,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="CLONE-STOBJ-CHANGE-SYMBOL">clone-stobj-change-symbol</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-clone-stobj-change-symbol" data-sym="CLONE-STOBJ-CHANGE-SYMBOL" title="(defun stobjs::clone-stobj-change-symbol (stobjs::sym stobjs::renaming)
  (if stobjs::renaming
      (stobjs::b*
       (((list stobjs::prefix stobjs::suffix stobjs::strsubst stobjs::pkg)
         stobjs::renaming)
...">clone-stobj-change-symbol</a>
  (sym renaming)
  (if renaming
    (b* (((<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> prefix
          suffix
          strsubst
          pkg) renaming) ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> sub pkg?) (tmpl-str-sublis strsubst (symbol-name sym))))
      (intern-in-package-of-symbol (<a class="sym-link system" href="../../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../../axioms.html#def-string" data-sym="STRING">string</a>
          prefix
          sub
          suffix)
        (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> pkg? pkg)))
    sym))</pre>
  </div>

<div class="form-block function" id="def-clone-stobj-process-rename-alist" data-defines="CLONE-STOBJ-PROCESS-RENAME-ALIST" data-references="CDR,CADAR,CAAR,CLONE-STOBJ-CHANGE-SYMBOL,LIST,CONS,ATOM,IF,RENAMING,RENAME-ALIST,DEFUN" data-part-name="CLONE-STOBJ-PROCESS-RENAME-ALIST" data-part-args="RENAMING,RENAME-ALIST" data-part-body="CDR,CLONE-STOBJ-PROCESS-RENAME-ALIST,CADAR,RENAMING,CAAR,CLONE-STOBJ-CHANGE-SYMBOL,LIST,CONS,RENAME-ALIST,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="CLONE-STOBJ-PROCESS-RENAME-ALIST">clone-stobj-process-rename-alist</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-clone-stobj-process-rename-alist" data-sym="CLONE-STOBJ-PROCESS-RENAME-ALIST" title="(defun stobjs::clone-stobj-process-rename-alist
       (stobjs::rename-alist stobjs::renaming)
  (if (atom stobjs::rename-alist)
      nil
      (cons
...">clone-stobj-process-rename-alist</a>
  (rename-alist renaming)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> rename-alist)
    nil
    (cons (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> (<a class="sym-link local-def" href="#def-clone-stobj-change-symbol" data-sym="CLONE-STOBJ-CHANGE-SYMBOL" title="(defun stobjs::clone-stobj-change-symbol (stobjs::sym stobjs::renaming)
  (if stobjs::renaming
      (stobjs::b*
       (((list stobjs::prefix stobjs::suffix stobjs::strsubst stobjs::pkg)
         stobjs::renaming)
...">clone-stobj-change-symbol</a> (<a class="sym-link system" href="../../../axioms.html#def-caar" data-sym="CAAR">caar</a> rename-alist)
          renaming)
        (<a class="sym-link local-def" href="#def-clone-stobj-change-symbol" data-sym="CLONE-STOBJ-CHANGE-SYMBOL" title="(defun stobjs::clone-stobj-change-symbol (stobjs::sym stobjs::renaming)
  (if stobjs::renaming
      (stobjs::b*
       (((list stobjs::prefix stobjs::suffix stobjs::strsubst stobjs::pkg)
         stobjs::renaming)
...">clone-stobj-change-symbol</a> (<a class="sym-link system" href="../../../axioms.html#def-cadar" data-sym="CADAR">cadar</a> rename-alist)
          renaming))
      (<a class="sym-link local-def" href="#def-clone-stobj-process-rename-alist" data-sym="CLONE-STOBJ-PROCESS-RENAME-ALIST" title="(defun stobjs::clone-stobj-process-rename-alist
       (stobjs::rename-alist stobjs::renaming)
  (if (atom stobjs::rename-alist)
      nil
      (cons
...">clone-stobj-process-rename-alist</a> (cdr rename-alist)
        renaming))))</pre>
  </div>

<div class="form-block function" id="def-clone-stobj-process-fields" data-defines="CLONE-STOBJ-PROCESS-FIELDS" data-references="CDR,CDAR,CAAR,CLONE-STOBJ-CHANGE-SYMBOL,CAR,CONSP,CONS,ATOM,IF,RENAMING,FIELDS,DEFUN" data-used-by="CLONE-STOBJ-PROCESS-ARGS" data-part-name="CLONE-STOBJ-PROCESS-FIELDS" data-part-args="RENAMING,FIELDS" data-part-body="CDR,CLONE-STOBJ-PROCESS-FIELDS,CDAR,RENAMING,CAAR,CLONE-STOBJ-CHANGE-SYMBOL,CAR,CONSP,CONS,FIELDS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="CLONE-STOBJ-PROCESS-FIELDS">clone-stobj-process-fields</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-clone-stobj-process-fields" data-sym="CLONE-STOBJ-PROCESS-FIELDS" title="(defun stobjs::clone-stobj-process-fields (stobjs::fields stobjs::renaming)
  (if (atom stobjs::fields)
      nil
      (cons
       (if (consp (car stobjs::fields))
...">clone-stobj-process-fields</a>
  (fields renaming)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fields)
    nil
    (cons (if (consp (car fields))
        (cons (<a class="sym-link local-def" href="#def-clone-stobj-change-symbol" data-sym="CLONE-STOBJ-CHANGE-SYMBOL" title="(defun stobjs::clone-stobj-change-symbol (stobjs::sym stobjs::renaming)
  (if stobjs::renaming
      (stobjs::b*
       (((list stobjs::prefix stobjs::suffix stobjs::strsubst stobjs::pkg)
         stobjs::renaming)
...">clone-stobj-change-symbol</a> (<a class="sym-link system" href="../../../axioms.html#def-caar" data-sym="CAAR">caar</a> fields)
            renaming)
          (<a class="sym-link system" href="../../../axioms.html#def-cdar" data-sym="CDAR">cdar</a> fields))
        (<a class="sym-link local-def" href="#def-clone-stobj-change-symbol" data-sym="CLONE-STOBJ-CHANGE-SYMBOL" title="(defun stobjs::clone-stobj-change-symbol (stobjs::sym stobjs::renaming)
  (if stobjs::renaming
      (stobjs::b*
       (((list stobjs::prefix stobjs::suffix stobjs::strsubst stobjs::pkg)
         stobjs::renaming)
...">clone-stobj-change-symbol</a> (car fields)
          renaming))
      (<a class="sym-link local-def" href="#def-clone-stobj-process-fields" data-sym="CLONE-STOBJ-PROCESS-FIELDS" title="(defun stobjs::clone-stobj-process-fields (stobjs::fields stobjs::renaming)
  (if (atom stobjs::fields)
      nil
      (cons
       (if (consp (car stobjs::fields))
...">clone-stobj-process-fields</a> (cdr fields)
        renaming))))</pre>
  </div>

<div class="form-block function" id="def-keep-nonbool-symbols" data-defines="KEEP-NONBOOL-SYMBOLS" data-references="CDR,CONS,SYMBOLP,T,EQ,NOT,AND,CAR,K,LET*,ATOM,IF,X,DEFUN" data-used-by="STOBJ-FIELD-TEMPLATE-FNNAMES" data-part-name="KEEP-NONBOOL-SYMBOLS" data-part-args="X" data-part-body="CDR,KEEP-NONBOOL-SYMBOLS,CONS,SYMBOLP,T,EQ,NOT,AND,CAR,K,LET*,X,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="KEEP-NONBOOL-SYMBOLS">keep-nonbool-symbols</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-keep-nonbool-symbols" data-sym="KEEP-NONBOOL-SYMBOLS" title="(defun stobjs::keep-nonbool-symbols (stobjs::x)
  (if (atom stobjs::x)
      nil
      (let* ((stobjs::k (car stobjs::x)))
        (if (and stobjs::k (not (eq stobjs::k t)) (symbolp stobjs::k))
...">keep-nonbool-symbols</a>
  (x)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    nil
    (<a class="sym-link system" href="../../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((k (car x)))
      (if (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> k (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> k <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)) (symbolp k))
        (cons k
          (<a class="sym-link local-def" href="#def-keep-nonbool-symbols" data-sym="KEEP-NONBOOL-SYMBOLS" title="(defun stobjs::keep-nonbool-symbols (stobjs::x)
  (if (atom stobjs::x)
      nil
      (let* ((stobjs::k (car stobjs::x)))
        (if (and stobjs::k (not (eq stobjs::k t)) (symbolp stobjs::k))
...">keep-nonbool-symbols</a> (cdr x)))
        (<a class="sym-link local-def" href="#def-keep-nonbool-symbols" data-sym="KEEP-NONBOOL-SYMBOLS" title="(defun stobjs::keep-nonbool-symbols (stobjs::x)
  (if (atom stobjs::x)
      nil
      (let* ((stobjs::k (car stobjs::x)))
        (if (and stobjs::k (not (eq stobjs::k t)) (symbolp stobjs::k))
...">keep-nonbool-symbols</a> (cdr x))))))</pre>
  </div>

<div class="form-block function" id="def-stobj-field-template-fnnames" data-defines="STOBJ-FIELD-TEMPLATE-FNNAMES" data-references="CDR,CDDDAR,KEEP-NONBOOL-SYMBOLS,APPEND,CAAR,CONS,ATOM,IF,FIELD-TEMPLATES,DEFUN" data-used-by="STOBJ-TEMPLATE-FNNAMES" data-part-name="STOBJ-FIELD-TEMPLATE-FNNAMES" data-part-args="FIELD-TEMPLATES" data-part-body="CDR,STOBJ-FIELD-TEMPLATE-FNNAMES,CDDDAR,KEEP-NONBOOL-SYMBOLS,APPEND,CAAR,CONS,FIELD-TEMPLATES,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="STOBJ-FIELD-TEMPLATE-FNNAMES">stobj-field-template-fnnames</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-stobj-field-template-fnnames" data-sym="STOBJ-FIELD-TEMPLATE-FNNAMES" title="(defun stobjs::stobj-field-template-fnnames (stobjs::field-templates)
  (if (atom stobjs::field-templates)
      nil
      (cons (caar stobjs::field-templates)
            (append
...">stobj-field-template-fnnames</a>
  (field-templates)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> field-templates)
    nil
    (cons (<a class="sym-link system" href="../../../axioms.html#def-caar" data-sym="CAAR">caar</a> field-templates)
      (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link local-def" href="#def-keep-nonbool-symbols" data-sym="KEEP-NONBOOL-SYMBOLS" title="(defun stobjs::keep-nonbool-symbols (stobjs::x)
  (if (atom stobjs::x)
      nil
      (let* ((stobjs::k (car stobjs::x)))
        (if (and stobjs::k (not (eq stobjs::k t)) (symbolp stobjs::k))
...">keep-nonbool-symbols</a> (<a class="sym-link system" href="../../../axioms.html#def-cdddar" data-sym="CDDDAR">cdddar</a> field-templates))
        (<a class="sym-link local-def" href="#def-stobj-field-template-fnnames" data-sym="STOBJ-FIELD-TEMPLATE-FNNAMES" title="(defun stobjs::stobj-field-template-fnnames (stobjs::field-templates)
  (if (atom stobjs::field-templates)
      nil
      (cons (caar stobjs::field-templates)
            (append
...">stobj-field-template-fnnames</a> (cdr field-templates))))))</pre>
  </div>

<div class="form-block function" id="def-stobj-template-fnnames" data-defines="STOBJ-TEMPLATE-FNNAMES" data-references="CADDR,STOBJ-FIELD-TEMPLATE-FNNAMES,CADR,CAR,LIST*,TEMPLATE,DEFUN" data-part-name="STOBJ-TEMPLATE-FNNAMES" data-part-args="TEMPLATE" data-part-body="CADDR,STOBJ-FIELD-TEMPLATE-FNNAMES,CADR,TEMPLATE,CAR,LIST*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="STOBJ-TEMPLATE-FNNAMES">stobj-template-fnnames</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-stobj-template-fnnames" data-sym="STOBJ-TEMPLATE-FNNAMES" title="(defun stobjs::stobj-template-fnnames (stobjs::template)
  (list* (car stobjs::template) (cadr stobjs::template)
         (stobjs::stobj-field-template-fnnames (caddr stobjs::template))))">stobj-template-fnnames</a>
  (template)
  (<a class="sym-link system" href="../../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> (car template)
    (<a class="sym-link system" href="../../../axioms.html#def-cadr" data-sym="CADR">cadr</a> template)
    (<a class="sym-link local-def" href="#def-stobj-field-template-fnnames" data-sym="STOBJ-FIELD-TEMPLATE-FNNAMES" title="(defun stobjs::stobj-field-template-fnnames (stobjs::field-templates)
  (if (atom stobjs::field-templates)
      nil
      (cons (caar stobjs::field-templates)
            (append
...">stobj-field-template-fnnames</a> (<a class="sym-link system" href="../../../axioms.html#def-caddr" data-sym="CADDR">caddr</a> template))))</pre>
  </div>

<div class="form-block function" id="def-clone-stobj-process-args" data-defines="CLONE-STOBJ-PROCESS-ARGS" data-references="CDR,LIST,AND,APPEND,CLONE-STOBJ-PROCESS-FIELDS,FIELDS,ASSOC-EQ,INLINE,DEFSTOBJ-CLONE,QUOTE,HARD?,ER,WHEN,*DEFSTOBJ-KEYWORDS*,PARTITION-REST-AND-KEYWORD-ARGS,KEY-ALIST,FIELD-DESCRIPTORS,ERP,MV,B*,RENAMING,ARGS,STOBJNAME,DEFUN" data-used-by="CLONE-BASE-STOBJ-FN" data-part-name="CLONE-STOBJ-PROCESS-ARGS" data-part-args="RENAMING,ARGS,STOBJNAME" data-part-body="STOBJNAME,CDR,LIST,AND,APPEND,RENAMING,CLONE-STOBJ-PROCESS-FIELDS,FIELDS,ASSOC-EQ,INLINE,DEFSTOBJ-CLONE,QUOTE,HARD?,ER,WHEN,*DEFSTOBJ-KEYWORDS*,ARGS,PARTITION-REST-AND-KEYWORD-ARGS,KEY-ALIST,FIELD-DESCRIPTORS,ERP,MV,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="CLONE-STOBJ-PROCESS-ARGS">clone-stobj-process-args</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-clone-stobj-process-args" data-sym="CLONE-STOBJ-PROCESS-ARGS" title="(defun stobjs::clone-stobj-process-args
       (stobjs::stobjname stobjs::args stobjs::renaming)
  (stobjs::b*
   (((stobjs::mv stobjs::erp stobjs::field-descriptors stobjs::key-alist)
     (partition-rest-and-keyword-args stobjs::args *defstobj-keywords*))
...">clone-stobj-process-args</a>
  (stobjname <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a> renaming)
  (b* (((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> erp
        field-descriptors
        key-alist) (<a class="sym-link system" href="../../../basis-a.html#def-partition-rest-and-keyword-args" data-sym="PARTITION-REST-AND-KEYWORD-ARGS">partition-rest-and-keyword-args</a> <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>
         <a class="sym-link system" href="../../../basis-a.html#def-_2Adefstobj-keywords_2A" data-sym="*DEFSTOBJ-KEYWORDS*">*defstobj-keywords*</a>)) ((when erp) (<a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> hard?
          '<a class="sym-link local-def" href="#def-defstobj-clone" data-sym="DEFSTOBJ-CLONE" title="(defmacro stobjs::defstobj-clone
          (stobjs::newname stobjs::origname
           &amp;key stobjs::strsubst (stobjs::prefix &#39;&quot;&quot;) (stobjs::suffix &#39;&quot;&quot;)
           stobjs::pkg stobjs::exports)
  `(stobjs::make-event
...">defstobj-clone</a>
          <span class="string">"The stobj to be cloned had bad keyword args~%"</span>))
      (inline (<a class="sym-link system" href="../../../axioms.html#def-assoc-eq" data-sym="ASSOC-EQ">assoc-eq</a> <span class="keyword">:inline</span> key-alist))
      (fields (<a class="sym-link local-def" href="#def-clone-stobj-process-fields" data-sym="CLONE-STOBJ-PROCESS-FIELDS" title="(defun stobjs::clone-stobj-process-fields (stobjs::fields stobjs::renaming)
  (if (atom stobjs::fields)
      nil
      (cons
       (if (consp (car stobjs::fields))
...">clone-stobj-process-fields</a> field-descriptors
          renaming)))
    (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> fields
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> inline (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> <span class="keyword">:inline</span> (cdr inline)))
      (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> <span class="keyword">:congruent-to</span> stobjname))))</pre>
  </div>

<div class="form-block function" id="def-clone-stobj-rewrite" data-defines="CLONE-STOBJ-REWRITE" data-references="ADD-TO-RULESET!,LOCAL,CLONE-STOBJ-TMP-RULES,E/D**,STABLE-UNDER-SIMPLIFICATIONP,AND,EQUAL,DEFTHM,QUASIQUOTE,SYMBOL-NAME,STRING,QUOTE,CONCATENATE,INTERN-IN-PACKAGE-OF-SYMBOL,THMNAME,LET,FORMALS,OLDFN,NEWFN,DEFUN" data-used-by="CLONE-STOBJ-REWRITES" data-part-name="CLONE-STOBJ-REWRITE" data-part-args="FORMALS,OLDFN,NEWFN" data-part-body="ADD-TO-RULESET!,LOCAL,CLONE-STOBJ-TMP-RULES,E/D**,STABLE-UNDER-SIMPLIFICATIONP,AND,EQUAL,DEFTHM,QUASIQUOTE,OLDFN,NEWFN,SYMBOL-NAME,STRING,QUOTE,CONCATENATE,INTERN-IN-PACKAGE-OF-SYMBOL,THMNAME,LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="CLONE-STOBJ-REWRITE">clone-stobj-rewrite</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-clone-stobj-rewrite" data-sym="CLONE-STOBJ-REWRITE" title="(defun stobjs::clone-stobj-rewrite
       (stobjs::newfn stobjs::oldfn stobjs::formals)
  (let ((stobjs::thmname
         (stobjs::intern-in-package-of-symbol
          (concatenate &#39;string (symbol-name stobjs::newfn) &quot;-IS-&quot;
...">clone-stobj-rewrite</a>
  (newfn oldfn <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)
  (let ((thmname (intern-in-package-of-symbol (<a class="sym-link system" href="../../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../../axioms.html#def-string" data-sym="STRING">string</a>
           (symbol-name newfn)
           <span class="string">"-IS-"</span>
           (symbol-name oldfn))
         newfn)))
    `((<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,STOBJS::THMNAME
       (equal (,STOBJS::NEWFN . ,STOBJS::FORMALS)
         (,STOBJS::OLDFN . ,STOBJS::FORMALS))
       <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:in-theory</span> '(,STOBJS::NEWFN ,STOBJS::OLDFN)) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp
           '(<span class="keyword">:in-theory</span> (e/d** (clone-stobj-tmp-rules))))
         (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp
           '(<span class="keyword">:in-theory</span> '(,STOBJS::NEWFN ,STOBJS::OLDFN (<span class="keyword">:induction</span> ,STOBJS::NEWFN)))))) (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (add-to-ruleset! clone-stobj-tmp-rules
          ,STOBJS::THMNAME)))))</pre>
  </div>

<div class="form-block function" id="def-clone-stobj-rewrites" data-defines="CLONE-STOBJ-REWRITES" data-references="CDR,CLONE-STOBJ-REWRITE,APPEND,OLDFN,CADAR,FORMALS,CAAR,NEWFN,ATOM,WHEN,B*,OLD,NEW,DEFUN" data-used-by="CLONE-BASE-STOBJ-FN" data-part-name="CLONE-STOBJ-REWRITES" data-part-args="OLD,NEW" data-part-body="CDR,CLONE-STOBJ-REWRITES,CLONE-STOBJ-REWRITE,APPEND,OLD,OLDFN,CADAR,FORMALS,CAAR,NEWFN,NEW,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="CLONE-STOBJ-REWRITES">clone-stobj-rewrites</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-clone-stobj-rewrites" data-sym="CLONE-STOBJ-REWRITES" title="(defun stobjs::clone-stobj-rewrites (stobjs::new stobjs::old)
  (stobjs::b*
   (((when (atom stobjs::new)) nil) (stobjs::newfn (caar stobjs::new))
    (stobjs::formals (cadar stobjs::new)) (stobjs::oldfn (caar stobjs::old)))
   (append
...">clone-stobj-rewrites</a>
  (new old)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> new)) nil) (newfn (<a class="sym-link system" href="../../../axioms.html#def-caar" data-sym="CAAR">caar</a> new))
      (<a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> (<a class="sym-link system" href="../../../axioms.html#def-cadar" data-sym="CADAR">cadar</a> new))
      (oldfn (<a class="sym-link system" href="../../../axioms.html#def-caar" data-sym="CAAR">caar</a> old)))
    (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link local-def" href="#def-clone-stobj-rewrite" data-sym="CLONE-STOBJ-REWRITE" title="(defun stobjs::clone-stobj-rewrite
       (stobjs::newfn stobjs::oldfn stobjs::formals)
  (let ((stobjs::thmname
         (stobjs::intern-in-package-of-symbol
          (concatenate &#39;string (symbol-name stobjs::newfn) &quot;-IS-&quot;
...">clone-stobj-rewrite</a> newfn
        oldfn
        <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)
      (<a class="sym-link local-def" href="#def-clone-stobj-rewrites" data-sym="CLONE-STOBJ-REWRITES" title="(defun stobjs::clone-stobj-rewrites (stobjs::new stobjs::old)
  (stobjs::b*
   (((when (atom stobjs::new)) nil) (stobjs::newfn (caar stobjs::new))
    (stobjs::formals (cadar stobjs::new)) (stobjs::oldfn (caar stobjs::old)))
   (append
...">clone-stobj-rewrites</a> (cdr new)
        (cdr old)))))</pre>
  </div>

<div class="form-block function" id="def-clone-base-stobj-fn" data-defines="CLONE-BASE-STOBJ-FN" data-references="CLONE-STOBJ-REWRITES,CLONE-STOBJ-TMP-RULES,DEF-RULESET!,LOCAL,DEFSTOBJ,QUASIQUOTE,ENCAPSULATE,NEW-DEFS,DEFSTOBJ-AXIOMATIC-DEFS,OLD-DEFS,NEW-TEMPLATE,DEFSTOBJ-TEMPLATE,OLD-TEMPLATE,CLONE-STOBJ-PROCESS-ARGS,NEW-ARGS,CLONE-STOBJ-CHANGE-SYMBOL,OR,ARGS,&,LIST*,DEFSTOBJ,CAR,EQ,NOT,CDDAR,ACCESS-EVENT-TUPLE-FORM,EVENT,DEFSTOBJ-CLONE,QUOTE,HARD?,ER,NULL,WHEN,DECODE-LOGICAL-NAME,EV-WRLD,B*,WRLD,RENAMING,NAME,STOBJNAME,DEFUN" data-used-by="CLONE-STOBJ-FN" data-part-name="CLONE-BASE-STOBJ-FN" data-part-args="WRLD,RENAMING,NAME,STOBJNAME" data-part-body="CLONE-STOBJ-REWRITES,CLONE-STOBJ-TMP-RULES,DEF-RULESET!,LOCAL,DEFSTOBJ,QUASIQUOTE,ENCAPSULATE,NEW-DEFS,DEFSTOBJ-AXIOMATIC-DEFS,OLD-DEFS,NEW-TEMPLATE,DEFSTOBJ-TEMPLATE,OLD-TEMPLATE,CLONE-STOBJ-PROCESS-ARGS,NEW-ARGS,RENAMING,CLONE-STOBJ-CHANGE-SYMBOL,OR,NAME,ARGS,&,LIST*,DEFSTOBJ,CAR,EQ,NOT,CDDAR,ACCESS-EVENT-TUPLE-FORM,EVENT,DEFSTOBJ-CLONE,QUOTE,HARD?,ER,NULL,WHEN,WRLD,STOBJNAME,DECODE-LOGICAL-NAME,EV-WRLD,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="CLONE-BASE-STOBJ-FN">clone-base-stobj-fn</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-clone-base-stobj-fn" data-sym="CLONE-BASE-STOBJ-FN" title="(defun stobjs::clone-base-stobj-fn
       (stobjs::stobjname stobjs::name stobjs::renaming stobjs::wrld)
  (stobjs::b*
   ((stobjs::ev-wrld (decode-logical-name stobjs::stobjname stobjs::wrld))
    ((when (null stobjs::ev-wrld))
...">clone-base-stobj-fn</a>
  (stobjname name
    renaming
    wrld)
  (b* ((ev-wrld (<a class="sym-link system" href="../../../rewrite.html#def-decode-logical-name" data-sym="DECODE-LOGICAL-NAME">decode-logical-name</a> stobjname wrld)) ((when (<a class="sym-link system" href="../../../axioms.html#def-null" data-sym="NULL">null</a> ev-wrld)) (<a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> hard?
          '<a class="sym-link local-def" href="#def-defstobj-clone" data-sym="DEFSTOBJ-CLONE" title="(defmacro stobjs::defstobj-clone
          (stobjs::newname stobjs::origname
           &amp;key stobjs::strsubst (stobjs::prefix &#39;&quot;&quot;) (stobjs::suffix &#39;&quot;&quot;)
           stobjs::pkg stobjs::exports)
  `(stobjs::make-event
...">defstobj-clone</a>
          <span class="string">"Unrecognized stobjname: ~x0~%"</span>
          stobjname))
      (event (access-event-tuple-form (<a class="sym-link system" href="../../../axioms.html#def-cddar" data-sym="CDDAR">cddar</a> ev-wrld)))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (car event) '<a class="sym-link system" href="../../../axioms.html#def-defstobj" data-sym="DEFSTOBJ">defstobj</a>))) (<a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> hard?
          '<a class="sym-link local-def" href="#def-defstobj-clone" data-sym="DEFSTOBJ-CLONE" title="(defmacro stobjs::defstobj-clone
          (stobjs::newname stobjs::origname
           &amp;key stobjs::strsubst (stobjs::prefix &#39;&quot;&quot;) (stobjs::suffix &#39;&quot;&quot;)
           stobjs::pkg stobjs::exports)
  `(stobjs::make-event
...">defstobj-clone</a>
          <span class="string">"The event named ~x0 is not a defstobj event~%"</span>
          stobjname))
      ((<a class="sym-link system" href="../../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> &amp; &amp; <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>) event)
      (name (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> name
          (<a class="sym-link local-def" href="#def-clone-stobj-change-symbol" data-sym="CLONE-STOBJ-CHANGE-SYMBOL" title="(defun stobjs::clone-stobj-change-symbol (stobjs::sym stobjs::renaming)
  (if stobjs::renaming
      (stobjs::b*
       (((list stobjs::prefix stobjs::suffix stobjs::strsubst stobjs::pkg)
         stobjs::renaming)
...">clone-stobj-change-symbol</a> stobjname
            renaming)))
      (new-args (<a class="sym-link local-def" href="#def-clone-stobj-process-args" data-sym="CLONE-STOBJ-PROCESS-ARGS" title="(defun stobjs::clone-stobj-process-args
       (stobjs::stobjname stobjs::args stobjs::renaming)
  (stobjs::b*
   (((stobjs::mv stobjs::erp stobjs::field-descriptors stobjs::key-alist)
     (partition-rest-and-keyword-args stobjs::args *defstobj-keywords*))
...">clone-stobj-process-args</a> stobjname
          <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>
          renaming))
      (old-template (<a class="sym-link system" href="../../../basis-a.html#def-defstobj-template" data-sym="DEFSTOBJ-TEMPLATE">defstobj-template</a> stobjname
          <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>
          wrld))
      (new-template (<a class="sym-link system" href="../../../basis-a.html#def-defstobj-template" data-sym="DEFSTOBJ-TEMPLATE">defstobj-template</a> name
          new-args
          wrld))
      (old-defs (defstobj-axiomatic-defs stobjname
          old-template
          wrld))
      (new-defs (defstobj-axiomatic-defs name
          new-template
          wrld)))
    (<a class="sym-link system" href="../../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> '<a class="sym-link system" href="../../../axioms.html#def-encapsulate" data-sym="ENCAPSULATE">encapsulate</a>
      nil
      `(<a class="sym-link system" href="../../../axioms.html#def-defstobj" data-sym="DEFSTOBJ">defstobj</a> ,STOBJS::NAME . ,STOBJS::NEW-ARGS)
      '(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (def-ruleset! clone-stobj-tmp-rules nil))
      (<a class="sym-link local-def" href="#def-clone-stobj-rewrites" data-sym="CLONE-STOBJ-REWRITES" title="(defun stobjs::clone-stobj-rewrites (stobjs::new stobjs::old)
  (stobjs::b*
   (((when (atom stobjs::new)) nil) (stobjs::newfn (caar stobjs::new))
    (stobjs::formals (cadar stobjs::new)) (stobjs::oldfn (caar stobjs::old)))
   (append
...">clone-stobj-rewrites</a> new-defs
        old-defs))))</pre>
  </div>

<div class="form-block function" id="def-clone-absstobj-exports" data-defines="CLONE-ABSSTOBJ-EXPORTS" data-references="QUASIQUOTE,CONS,UNPROTECTED-EXPORT-P,PROTECT,UPDATER-EXPORT-LOOKUP,AND,CLONE-STOBJ-CHANGE-SYMBOL,CDR,IF,NEW-SYM,ASSOC-EQ,NAME-EXPORT-LOOKUP,CAR,UPDATER,EXEC,LOGIC,NAME,LIST*,ATOM,WHEN,B*,WORLD,FOUNDATION,RENAMING,EXPORTS,ABSSTOBJ-TUPLES,DEFUN" data-part-name="CLONE-ABSSTOBJ-EXPORTS" data-part-args="WORLD,FOUNDATION,RENAMING,EXPORTS,ABSSTOBJ-TUPLES" data-part-body="CLONE-ABSSTOBJ-EXPORTS,QUASIQUOTE,CONS,WORLD,FOUNDATION,UNPROTECTED-EXPORT-P,PROTECT,UPDATER-EXPORT-LOOKUP,AND,RENAMING,CLONE-STOBJ-CHANGE-SYMBOL,CDR,IF,NEW-SYM,EXPORTS,ASSOC-EQ,NAME-EXPORT-LOOKUP,CAR,UPDATER,EXEC,LOGIC,NAME,LIST*,ABSSTOBJ-TUPLES,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="CLONE-ABSSTOBJ-EXPORTS">clone-absstobj-exports</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-clone-absstobj-exports" data-sym="CLONE-ABSSTOBJ-EXPORTS" title="(defun stobjs::clone-absstobj-exports
       (stobjs::absstobj-tuples stobjs::exports stobjs::renaming
        stobjs::foundation stobjs::world)
  (stobjs::b*
   (((when (atom stobjs::absstobj-tuples)) nil)
...">clone-absstobj-exports</a>
  (absstobj-tuples exports
    renaming
    foundation
    world)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> absstobj-tuples)) nil) ((<a class="sym-link system" href="../../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> name
         <a class="sym-link system" href="../../../axioms.html#def-logic" data-sym="LOGIC">logic</a>
         exec
         updater) (car absstobj-tuples))
      (name-export-lookup (<a class="sym-link system" href="../../../axioms.html#def-assoc-eq" data-sym="ASSOC-EQ">assoc-eq</a> name exports))
      (new-sym (if name-export-lookup
          (cdr name-export-lookup)
          (<a class="sym-link local-def" href="#def-clone-stobj-change-symbol" data-sym="CLONE-STOBJ-CHANGE-SYMBOL" title="(defun stobjs::clone-stobj-change-symbol (stobjs::sym stobjs::renaming)
  (if stobjs::renaming
      (stobjs::b*
       (((list stobjs::prefix stobjs::suffix stobjs::strsubst stobjs::pkg)
         stobjs::renaming)
...">clone-stobj-change-symbol</a> name
            renaming)))
      (updater (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> updater
          (b* ((updater-export-lookup (<a class="sym-link system" href="../../../axioms.html#def-assoc-eq" data-sym="ASSOC-EQ">assoc-eq</a> updater exports)))
            (if updater-export-lookup
              (cdr updater-export-lookup)
              (<a class="sym-link local-def" href="#def-clone-stobj-change-symbol" data-sym="CLONE-STOBJ-CHANGE-SYMBOL" title="(defun stobjs::clone-stobj-change-symbol (stobjs::sym stobjs::renaming)
  (if stobjs::renaming
      (stobjs::b*
       (((list stobjs::prefix stobjs::suffix stobjs::strsubst stobjs::pkg)
         stobjs::renaming)
...">clone-stobj-change-symbol</a> updater
                renaming)))))
      (protect (unprotected-export-p foundation
          exec
          world)))
    (cons `(,STOBJS::NEW-SYM <span class="keyword">:logic</span> ,STOBJS::LOGIC
        <span class="keyword">:exec</span> ,STOBJS::EXEC
        ,@(AND STOBJS::UPDATER `(:UPDATER ,STOBJS::UPDATER))
        <span class="keyword">:protect</span> ,STOBJS::PROTECT)
      (<a class="sym-link local-def" href="#def-clone-absstobj-exports" data-sym="CLONE-ABSSTOBJ-EXPORTS" title="(defun stobjs::clone-absstobj-exports
       (stobjs::absstobj-tuples stobjs::exports stobjs::renaming
        stobjs::foundation stobjs::world)
  (stobjs::b*
   (((when (atom stobjs::absstobj-tuples)) nil)
...">clone-absstobj-exports</a> (cdr absstobj-tuples)
        exports
        renaming
        foundation
        world))))</pre>
  </div>

<div class="form-block function" id="def-clone-absstobj-fn" data-defines="CLONE-ABSSTOBJ-FN" data-references="DEFABSSTOBJ,RECOGNIZER,DEFSTOBJ-FNNAME,CREATOR,EXPORT-ABSSTOBJ-TUPLES,STRIP-CARS,PAIRLIS$,AND,EXPORTS,?EXPORTS,?CREATE,STOBJ-PROPERTY,ACCESS,?PRED,QUASIQUOTE,STOBJ,STOBJ-INFO,ABSSTOBJ-INFO,QUOTE,FGETPROP,ABS-INFO,B*,WORLD,USER-EXPORTS,RENAMING,NAME,STOBJNAME,DEFUN" data-used-by="CLONE-STOBJ-FN" data-part-name="CLONE-ABSSTOBJ-FN" data-part-args="WORLD,USER-EXPORTS,RENAMING,NAME,STOBJNAME" data-part-body="DEFABSSTOBJ,RECOGNIZER,NAME,DEFSTOBJ-FNNAME,CREATOR,EXPORT-ABSSTOBJ-TUPLES,STRIP-CARS,PAIRLIS$,USER-EXPORTS,AND,EXPORTS,?EXPORTS,?CREATE,STOBJ-PROPERTY,ACCESS,?PRED,QUASIQUOTE,STOBJ,STOBJ-INFO,WORLD,ABSSTOBJ-INFO,QUOTE,STOBJNAME,FGETPROP,ABS-INFO,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="CLONE-ABSSTOBJ-FN">clone-absstobj-fn</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-clone-absstobj-fn" data-sym="CLONE-ABSSTOBJ-FN" title="(defun stobjs::clone-absstobj-fn
       (stobjs::stobjname stobjs::name stobjs::renaming stobjs::user-exports
        stobjs::world)
  (stobjs::b*
   ((stobjs::abs-info
...">clone-absstobj-fn</a>
  (stobjname name
    renaming
    user-exports
    world)
  (b* ((abs-info (<a class="sym-link system" href="../../../axioms.html#def-fgetprop" data-sym="FGETPROP">fgetprop</a> stobjname
         'absstobj-info
         nil
         world)) (stobj-info (<a class="sym-link system" href="../../../axioms.html#def-fgetprop" data-sym="FGETPROP">fgetprop</a> stobjname
          'stobj
          nil
          world))
      (`(,STOBJS::FOUNDATION (,STOBJS::?!RECOG-NAME ,STOBJS::RECOG-LOGIC
           ,STOBJS::RECOG-EXEC)
         (,STOBJS::?!CREATOR-NAME ,STOBJS::CREATE-LOGIC
           ,STOBJS::CREATE-EXEC) . ,STOBJS::EXPORT-ABSSTOBJ-TUPLES) abs-info)
      (?pred (<a class="sym-link system" href="../../../axioms.html#def-access" data-sym="ACCESS">access</a> stobj-property
          stobj-info
          <span class="keyword">:recognizer</span>))
      (?create (<a class="sym-link system" href="../../../axioms.html#def-access" data-sym="ACCESS">access</a> stobj-property stobj-info <span class="keyword">:creator</span>))
      (?exports (<a class="sym-link system" href="../../../axioms.html#def-access" data-sym="ACCESS">access</a> stobj-property stobj-info <span class="keyword">:names</span>))
      (exports (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> user-exports
          (<a class="sym-link system" href="../../../axioms.html#def-pairlis_24" data-sym="PAIRLIS$">pairlis$</a> (<a class="sym-link system" href="../../../axioms.html#def-strip-cars" data-sym="STRIP-CARS">strip-cars</a> export-absstobj-tuples)
            user-exports)))
      (creator (<a class="sym-link system" href="../../../basis-a.html#def-defstobj-fnname" data-sym="DEFSTOBJ-FNNAME">defstobj-fnname</a> name <span class="keyword">:creator</span> <span class="keyword">:top</span> nil))
      (recognizer (<a class="sym-link system" href="../../../basis-a.html#def-defstobj-fnname" data-sym="DEFSTOBJ-FNNAME">defstobj-fnname</a> name <span class="keyword">:recognizer</span> <span class="keyword">:top</span> nil)))
    `(defabsstobj ,STOBJS::NAME
      <span class="keyword">:foundation</span> ,STOBJS::FOUNDATION
      <span class="keyword">:recognizer</span> (,STOBJS::RECOGNIZER <span class="keyword">:logic</span> ,STOBJS::RECOG-LOGIC
        <span class="keyword">:exec</span> ,STOBJS::RECOG-EXEC)
      <span class="keyword">:creator</span> (,STOBJS::CREATOR <span class="keyword">:logic</span> ,STOBJS::CREATE-LOGIC
        <span class="keyword">:exec</span> ,STOBJS::CREATE-EXEC)
      <span class="keyword">:exports</span> ,(STOBJS::CLONE-ABSSTOBJ-EXPORTS STOBJS::EXPORT-ABSSTOBJ-TUPLES STOBJS::EXPORTS
  STOBJS::RENAMING STOBJS::FOUNDATION STOBJS::WORLD)
      <span class="keyword">:congruent-to</span> ,STOBJS::STOBJNAME)))</pre>
  </div>

<div class="form-block function" id="def-clone-stobj-fn" data-defines="CLONE-STOBJ-FN" data-references="CLONE-BASE-STOBJ-FN,CLONE-ABSSTOBJ-FN,IF,DEFSTOBJ-CLONE,HARD?,ER,UNLESS,LIST,RENAMING,OR,ABSSTOBJ-INFO,ABSSTOBJP,STOBJ,QUOTE,FGETPROP,STOBJP,B*,EQUAL,NOT,SYMBOLP,SYMBOL-LISTP,STRIP-CDRS,STRIP-CARS,STRING-LISTP,ALISTP,STRINGP,AND,XARGS,DECLARE,WORLD,EXPORTS,PKG,STRSUBST,SUFFIX,PREFIX,NAME,STOBJNAME,DEFUN" data-used-by="DEFSTOBJ-CLONE" data-part-name="CLONE-STOBJ-FN" data-part-args="WORLD,EXPORTS,PKG,STRSUBST,SUFFIX,PREFIX,NAME,STOBJNAME" data-part-declare="EQUAL,NOT,PKG,SYMBOLP,EXPORTS,SYMBOL-LISTP,STRIP-CDRS,STRIP-CARS,STRING-LISTP,STRSUBST,ALISTP,SUFFIX,PREFIX,STRINGP,AND,XARGS,DECLARE" data-part-body="CLONE-BASE-STOBJ-FN,CLONE-ABSSTOBJ-FN,IF,DEFSTOBJ-CLONE,HARD?,ER,UNLESS,STRSUBST,SUFFIX,PREFIX,LIST,EXPORTS,NOT,AND,RENAMING,NAME,OR,PKG,ABSSTOBJ-INFO,ABSSTOBJP,WORLD,STOBJ,QUOTE,STOBJNAME,FGETPROP,STOBJP,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="CLONE-STOBJ-FN">clone-stobj-fn</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-clone-stobj-fn" data-sym="CLONE-STOBJ-FN" title="(defun stobjs::clone-stobj-fn
       (stobjs::stobjname stobjs::name stobjs::prefix stobjs::suffix
        stobjs::strsubst stobjs::pkg stobjs::exports stobjs::world)
  (declare
   (stobjs::xargs :guard
...">clone-stobj-fn</a>
  (stobjname name
    prefix
    suffix
    strsubst
    pkg
    exports
    world)
  (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (stringp prefix)
        (stringp suffix)
        (<a class="sym-link system" href="../../../axioms.html#def-alistp" data-sym="ALISTP">alistp</a> strsubst)
        (<a class="sym-link system" href="../../../axioms.html#def-string-listp" data-sym="STRING-LISTP">string-listp</a> (<a class="sym-link system" href="../../../axioms.html#def-strip-cars" data-sym="STRIP-CARS">strip-cars</a> strsubst))
        (<a class="sym-link system" href="../../../axioms.html#def-string-listp" data-sym="STRING-LISTP">string-listp</a> (<a class="sym-link system" href="../../../axioms.html#def-strip-cdrs" data-sym="STRIP-CDRS">strip-cdrs</a> strsubst))
        (<a class="sym-link system" href="../../../axioms.html#def-symbol-listp" data-sym="SYMBOL-LISTP">symbol-listp</a> exports)
        (symbolp pkg)
        (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal prefix <span class="string">""</span>)
            (equal suffix <span class="string">""</span>)
            (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> strsubst)
            (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> exports)
            (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> pkg))))))
  (b* ((<a class="sym-link system" href="../../../basis-a.html#def-stobjp" data-sym="STOBJP">stobjp</a> (<a class="sym-link system" href="../../../axioms.html#def-fgetprop" data-sym="FGETPROP">fgetprop</a> stobjname
         'stobj
         nil
         world)) (absstobjp (<a class="sym-link system" href="../../../axioms.html#def-fgetprop" data-sym="FGETPROP">fgetprop</a> stobjname
          'absstobj-info
          nil
          world))
      (pkg (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> pkg name))
      (renaming (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> exports)
          (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> prefix
            suffix
            strsubst
            pkg)))
      ((unless <a class="sym-link system" href="../../../basis-a.html#def-stobjp" data-sym="STOBJP">stobjp</a>) (<a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> hard?
          '<a class="sym-link local-def" href="#def-defstobj-clone" data-sym="DEFSTOBJ-CLONE" title="(defmacro stobjs::defstobj-clone
          (stobjs::newname stobjs::origname
           &amp;key stobjs::strsubst (stobjs::prefix &#39;&quot;&quot;) (stobjs::suffix &#39;&quot;&quot;)
           stobjs::pkg stobjs::exports)
  `(stobjs::make-event
...">defstobj-clone</a>
          <span class="string">"~x0 is not a stobj~%"</span>
          stobjname)))
    (if absstobjp
      (<a class="sym-link local-def" href="#def-clone-absstobj-fn" data-sym="CLONE-ABSSTOBJ-FN" title="(defun stobjs::clone-absstobj-fn
       (stobjs::stobjname stobjs::name stobjs::renaming stobjs::user-exports
        stobjs::world)
  (stobjs::b*
   ((stobjs::abs-info
...">clone-absstobj-fn</a> stobjname
        name
        renaming
        exports
        world)
      (if exports
        (<a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> hard?
          '<a class="sym-link local-def" href="#def-defstobj-clone" data-sym="DEFSTOBJ-CLONE" title="(defmacro stobjs::defstobj-clone
          (stobjs::newname stobjs::origname
           &amp;key stobjs::strsubst (stobjs::prefix &#39;&quot;&quot;) (stobjs::suffix &#39;&quot;&quot;)
           stobjs::pkg stobjs::exports)
  `(stobjs::make-event
...">defstobj-clone</a>
          <span class="string">":Exports is not supported for concrete stobjs"</span>)
        (<a class="sym-link local-def" href="#def-clone-base-stobj-fn" data-sym="CLONE-BASE-STOBJ-FN" title="(defun stobjs::clone-base-stobj-fn
       (stobjs::stobjname stobjs::name stobjs::renaming stobjs::wrld)
  (stobjs::b*
   ((stobjs::ev-wrld (decode-logical-name stobjs::stobjname stobjs::wrld))
    ((when (null stobjs::ev-wrld))
...">clone-base-stobj-fn</a> stobjname
          name
          renaming
          world)))))</pre>
  </div>

<div class="form-block macro" id="def-defstobj-clone" data-defines="DEFSTOBJ-CLONE" data-references="STATE,W,CLONE-STOBJ-FN,MAKE-EVENT,QUASIQUOTE,EXPORTS,PKG,SUFFIX,QUOTE,PREFIX,STRSUBST,&KEY,ORIGNAME,NEWNAME,DEFMACRO" data-used-by="CLONE-STOBJ-FN,CLONE-BASE-STOBJ-FN,CLONE-STOBJ-PROCESS-ARGS" typeof="Code">
    <div class="form-header"><span class="form-name" property="name" data-sym="DEFSTOBJ-CLONE">defstobj-clone</span><span class="form-type">macro</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> <a class="sym-link local-def" href="#def-defstobj-clone" data-sym="DEFSTOBJ-CLONE" title="(defmacro stobjs::defstobj-clone
          (stobjs::newname stobjs::origname
           &amp;key stobjs::strsubst (stobjs::prefix &#39;&quot;&quot;) (stobjs::suffix &#39;&quot;&quot;)
           stobjs::pkg stobjs::exports)
  `(stobjs::make-event
...">defstobj-clone</a>
  (newname origname
    &amp;key
    strsubst
    (prefix '<span class="string">""</span>)
    (suffix '<span class="string">""</span>)
    pkg
    exports)
  `(<a class="sym-link system" href="../../../axioms.html#def-make-event" data-sym="MAKE-EVENT">make-event</a> (<a class="sym-link local-def" href="#def-clone-stobj-fn" data-sym="CLONE-STOBJ-FN" title="(defun stobjs::clone-stobj-fn
       (stobjs::stobjname stobjs::name stobjs::prefix stobjs::suffix
        stobjs::strsubst stobjs::pkg stobjs::exports stobjs::world)
  (declare
   (stobjs::xargs :guard
...">clone-stobj-fn</a> ',STOBJS::ORIGNAME
      ',STOBJS::NEWNAME
      ',STOBJS::PREFIX
      ',STOBJS::SUFFIX
      ',STOBJS::STRSUBST
      ',STOBJS::PKG
      ',STOBJS::EXPORTS
      (<a class="sym-link system" href="../../../axioms.html#def-w" data-sym="W">w</a> state))))</pre>
  </div>


  </main>
  
<script>
// ACL2 Book HTML Documentation - Interactive Features
// Generated by cert2 - build2 system

// State
let activeFilter = null;
let activePartFilter = null;
let activeNameFilter = null;
let currentFontSize = 14;

// Theme management
function getStoredTheme() {
  return localStorage.getItem('acl2-theme') || 'dark';
}

function setTheme(theme) {
  if (theme === 'light') {
    document.documentElement.setAttribute('data-theme', 'light');
    document.getElementById('theme-toggle').textContent = '🌙';
  } else {
    document.documentElement.removeAttribute('data-theme');
    document.getElementById('theme-toggle').textContent = '☀️';
  }
  localStorage.setItem('acl2-theme', theme);
}

function toggleTheme() {
  const current = getStoredTheme();
  setTheme(current === 'dark' ? 'light' : 'dark');
}

// Font size management
function getStoredFontSize() {
  return parseInt(localStorage.getItem('acl2-fontsize') || '14', 10);
}

function setFontSize(size) {
  size = Math.max(10, Math.min(24, size)); // Clamp between 10-24
  currentFontSize = size;
  document.body.style.fontSize = size + 'px';
  localStorage.setItem('acl2-fontsize', size.toString());
}

function increaseFontSize() {
  setFontSize(currentFontSize + 2);
}

function decreaseFontSize() {
  setFontSize(currentFontSize - 2);
}

// Get all form blocks
function getFormBlocks() {
  return document.querySelectorAll('.form-block');
}

// Clear all filters
function clearFilter() {
  activeFilter = null;
  activePartFilter = null;
  activeNameFilter = null;
  getFormBlocks().forEach(b => {
    b.classList.remove('hidden', 'dimmed');
  });
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  const status = document.querySelector('.filter-status');
  status.classList.remove('active');
  // Slide name filter back to original position
  document.querySelector('.controls-left').style.transform = '';
  // Clear the name filter input
  const nameInput = document.getElementById('name-filter');
  if (nameInput) nameInput.value = '';
}

// Show filter status and slide name filter right
function showFilterStatus(text) {
  const status = document.querySelector('.filter-status');
  status.classList.add('active');
  status.querySelector('.filter-text').textContent = text;
  // Slide name filter to the right to make room
  setTimeout(() => {
    const statusWidth = status.offsetWidth;
    document.querySelector('.controls-left').style.transform = `translateX(${statusWidth + 15}px)`;
  }, 10);
}

// Filter to show only forms that define or reference a symbol
function filterBySymbol(symName, showUsedBy) {
  clearFilter();
  activeFilter = symName;
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines;
    const references = (block.dataset.references || '').split(',');
    const usedBy = (block.dataset.usedBy || '').split(',');
    
    let show = false;
    if (showUsedBy) {
      // Show forms that USE this symbol
      show = references.includes(symName) || definesName === symName;
    } else {
      // Show forms that this symbol USES
      show = usedBy.includes(symName) || definesName === symName;
    }
    
    if (show) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering by: ${symName} (${visibleCount} items)`);
}

// Filter by defthm part (term, hints, rule-classes, etc.)
function filterByPart(formId, partName) {
  clearFilter();
  activePartFilter = { formId, partName };
  
  // Get the part's referenced symbols
  // data-part-term becomes dataset.partTerm, data-part-hints becomes dataset.partHints, etc.
  const block = document.getElementById(formId);
  const datasetKey = 'part' + partName.charAt(0).toUpperCase() + partName.slice(1).replace(/-([a-z])/g, (g) => g[1].toUpperCase());
  const partData = block.dataset[datasetKey];
  if (!partData) return;
  
  const partSyms = partData.split(',').filter(s => s);
  
  // Highlight the button
  block.querySelector(`.part-btn[data-part="${partName}"]`).classList.add('active');
  
  // Hide forms not referenced by this part
  getFormBlocks().forEach(b => {
    const definesName = b.dataset.defines;
    if (b.id === formId || partSyms.includes(definesName)) {
      b.classList.remove('hidden');
    } else {
      b.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering ${formId} :${partName} (${partSyms.length} references)`);
}

// Filter by name (substring or regex)
function filterByName(pattern, useRegex) {
  // Clear other filters but keep the input value
  activeFilter = null;
  activePartFilter = null;
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  
  if (!pattern || pattern.trim() === '') {
    // Empty pattern - show all
    activeNameFilter = null;
    getFormBlocks().forEach(b => b.classList.remove('hidden'));
    const status = document.querySelector('.filter-status');
    status.classList.remove('active');
    document.querySelector('.controls-left').style.transform = '';
    return;
  }
  
  activeNameFilter = pattern;
  
  let matcher;
  let isValidRegex = true;
  
  if (useRegex) {
    try {
      matcher = new RegExp(pattern, 'i');
    } catch (e) {
      // Invalid regex - show error in status and don't filter
      showFilterStatus(`Invalid regex: ${e.message}`);
      return;
    }
  } else {
    // Plain substring match (case-insensitive)
    const lowerPattern = pattern.toLowerCase();
    matcher = { test: (s) => s.toLowerCase().includes(lowerPattern) };
  }
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines || '';
    if (matcher.test(definesName)) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  const modeText = useRegex ? 'regex' : 'name';
  showFilterStatus(`Filtering by ${modeText}: "${pattern}" (${visibleCount} matches)`);
}

// Click on a name to show what references it
function handleNameClick(symName) {
  if (activeFilter === symName) {
    clearFilter();
  } else {
    filterBySymbol(symName, true);
  }
}

// Navigate to a definition (same file or different)
function navigateTo(symName, file) {
  if (file) {
    // External file - navigate
    window.location.href = file + '.html#def-' + symName.toLowerCase();
  } else {
    // Same file - scroll
    const target = document.getElementById('def-' + symName.toLowerCase());
    if (target) {
      target.scrollIntoView({ behavior: 'smooth', block: 'center' });
      target.classList.add('highlight');
      setTimeout(() => target.classList.remove('highlight'), 400);
    }
  }
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  // Part buttons
  document.querySelectorAll('.part-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const formId = btn.closest('.form-block').id;
      const partName = btn.dataset.part;
      if (activePartFilter && activePartFilter.formId === formId && 
          activePartFilter.partName === partName) {
        clearFilter();
      } else {
        filterByPart(formId, partName);
      }
    });
  });
  
  // Clear filter button
  document.querySelector('.clear-filter').addEventListener('click', clearFilter);
  
  // Name filter input
  const nameFilter = document.getElementById('name-filter');
  const regexToggle = document.getElementById('regex-toggle');
  
  let filterTimeout = null;
  nameFilter.addEventListener('input', () => {
    // Debounce the filter to avoid excessive updates while typing
    clearTimeout(filterTimeout);
    filterTimeout = setTimeout(() => {
      filterByName(nameFilter.value, regexToggle.checked);
    }, 150);
  });
  
  // Re-filter when regex toggle changes
  regexToggle.addEventListener('change', () => {
    if (nameFilter.value) {
      filterByName(nameFilter.value, regexToggle.checked);
    }
  });
  
  // Allow Escape key to clear filter when in input
  nameFilter.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      clearFilter();
      nameFilter.blur();
    }
  });
  
  // Symbol references (old span-based refs)
  document.querySelectorAll('.sym-ref').forEach(ref => {
    ref.addEventListener('click', (e) => {
      e.stopPropagation();
      const sym = ref.dataset.sym;
      const file = ref.dataset.file;
      if (file) {
        navigateTo(sym, file);
      } else {
        handleNameClick(sym);
      }
    });
  });
  
  // Symbol links (new anchor-based links)
  // These use standard <a> tags so navigation happens automatically
  // But we need to clear filters if target would be hidden
  document.querySelectorAll('.sym-link').forEach(link => {
    link.addEventListener('click', (e) => {
      const href = link.getAttribute('href');
      if (href && href.startsWith('#')) {
        // Local link - check if target is hidden by filter
        const targetId = href.substring(1);
        const target = document.getElementById(targetId);
        if (target) {
          // If target is hidden, clear the filter first
          if (target.classList.contains('hidden')) {
            clearFilter();
          }
          // Add highlight effect after a short delay
          setTimeout(() => {
            target.classList.add('highlight');
            setTimeout(() => target.classList.remove('highlight'), 400);
          }, 100);
        }
      }
      // For external links, default behavior handles navigation
    });
  });
  
  // Form names (show what uses them)
  document.querySelectorAll('.form-name').forEach(name => {
    name.addEventListener('click', (e) => {
      handleNameClick(name.dataset.sym);
    });
  });
  
  // Handle hash navigation (when arriving at page with #anchor)
  if (window.location.hash) {
    const target = document.querySelector(window.location.hash);
    if (target) {
      setTimeout(() => {
        target.scrollIntoView({ behavior: 'smooth', block: 'center' });
        target.classList.add('highlight');
        setTimeout(() => target.classList.remove('highlight'), 400);
      }, 200);
    }
  }
  
  // Initialize theme from storage
  setTheme(getStoredTheme());
  
  // Initialize font size from storage
  currentFontSize = getStoredFontSize();
  setFontSize(currentFontSize);
  
  // Theme toggle button
  document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
  
  // Font size buttons
  document.getElementById('font-larger').addEventListener('click', increaseFontSize);
  document.getElementById('font-smaller').addEventListener('click', decreaseFontSize);
});

</script>

</body>
</html>
<!DOCTYPE html>
<html lang="en" vocab="http://schema.org/" typeof="SoftwareSourceCode">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>sbitsets - ACL2 Book</title>
  <meta property="name" content="sbitsets">
  <meta property="programmingLanguage" content="ACL2">
  
<style>
/* ACL2 Book HTML Documentation Styles */
/* Generated by cert2 - build2 system */

/* Dark theme (default) */
:root {
  --bg: #1e1e2e;
  --fg: #cdd6f4;
  --comment: #6c7086;
  --keyword: #cba6f7;
  --string: #a6e3a1;
  --function: #89b4fa;
  --type: #f9e2af;
  --link: #89dceb;
  --link-hover: #f5c2e7;
  --highlight: rgba(137, 180, 250, 0.2);
  --border: #313244;
  --block-bg: rgba(49, 50, 68, 0.5);
  --btn-bg: #313244;
  --btn-hover: rgba(137, 180, 250, 0.2);
}

/* Light theme */
[data-theme="light"] {
  --bg: #eff1f5;
  --fg: #4c4f69;
  --comment: #6c6f85;
  --keyword: #8839ef;
  --string: #40a02b;
  --function: #1e66f5;
  --type: #df8e1d;
  --link: #04a5e5;
  --link-hover: #ea76cb;
  --highlight: rgba(30, 102, 245, 0.15);
  --border: #ccd0da;
  --block-bg: rgba(204, 208, 218, 0.3);
  --btn-bg: #ccd0da;
  --btn-hover: rgba(30, 102, 245, 0.15);
}

body {
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  background: var(--bg);
  color: var(--fg);
  margin: 0;
  padding: 20px;
  line-height: 1.6;
  font-size: 14px;
  transition: background 0.1s, color 0.1s;
}

/* Controls toolbar */
.controls-left {
  position: fixed;
  top: 10px;
  left: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
  transition: transform 0.1s ease;
}

.controls-right {
  position: fixed;
  top: 10px;
  right: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
}

.control-btn {
  padding: 6px 12px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-family: inherit;
  font-size: 14px;
  transition: all 0.1s;
}

.control-btn:hover {
  background: var(--btn-hover);
  border-color: var(--link);
}

.name-filter {
  padding: 6px 10px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  font-family: inherit;
  font-size: 13px;
  width: 150px;
  transition: all 0.1s;
}

.name-filter:focus {
  outline: none;
  border-color: var(--link);
  width: 200px;
}

.name-filter::placeholder {
  color: var(--comment);
}

.regex-label {
  display: flex;
  align-items: center;
  gap: 4px;
  color: var(--comment);
  font-size: 12px;
  cursor: pointer;
}

.regex-label input {
  cursor: pointer;
}

.book-header {
  border-bottom: 2px solid var(--border);
  padding-bottom: 20px;
  margin-bottom: 20px;
}

.book-header h1 {
  color: var(--keyword);
  margin: 0;
}

.book-header .path {
  color: var(--comment);
  font-size: 0.9em;
}

.book-header .path .source-link {
  color: var(--comment);
  text-decoration: none;
}

.book-header .path .source-link:hover {
  color: var(--link);
  text-decoration: underline;
}

.form-block {
  margin: 10px 0;
  padding: 15px;
  background: var(--block-bg);
  border-radius: 8px;
  border-left: 3px solid var(--border);
}

.form-block.theorem { border-left-color: var(--keyword); }
.form-block.function { border-left-color: var(--function); }
.form-block.macro { border-left-color: var(--type); }
.form-block.include-book { border-left-color: var(--string); }

.form-block.hidden { display: none; }
.form-block.dimmed { opacity: 0.3; }

.form-block.highlight {
  animation: highlight-pulse 0.4s ease-out;
}

@keyframes highlight-pulse {
  0% { background: var(--highlight); box-shadow: 0 0 20px var(--link); }
  100% { background: rgba(49, 50, 68, 0.5); box-shadow: none; }
}

.form-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.form-name {
  color: var(--function);
  font-weight: bold;
  cursor: pointer;
}

.form-name:hover {
  color: var(--link-hover);
  text-decoration: underline;
}

.form-type {
  color: var(--comment);
  font-size: 0.85em;
}

pre.code {
  margin: 0;
  overflow-x: auto;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.sym-ref {
  color: var(--link);
  cursor: pointer;
  border-radius: 2px;
}

.sym-ref:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.sym-ref.local-def { color: var(--function); font-weight: bold; }
.sym-ref.external { color: var(--type); }

/* Symbol links (clickable hyperlinks) */
.sym-link {
  color: var(--link);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
  position: relative;
}

.sym-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

.sym-link.local-def {
  color: var(--function);
  font-weight: bold;
}

.sym-link.external {
  color: var(--type);
}

/* Tooltips using title attribute with custom styling */
.sym-link[title] {
  /* Browser will show title on hover */
}

/* Syntax highlighting in code blocks */
.keyword {
  color: var(--keyword);
}

.string {
  color: var(--string);
}

.number {
  color: #f77524; /* orange */
}

/* Include-book path links */
.include-path {
  color: var(--string);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
}

.include-path:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

/* Part buttons for defthm */
.part-buttons {
  display: flex;
  gap: 5px;
  margin: 10px 0;
  flex-wrap: wrap;
}

.part-btn {
  padding: 4px 10px;
  background: var(--border);
  border: 1px solid var(--comment);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-size: 0.85em;
  font-family: inherit;
}

.part-btn:hover {
  background: var(--highlight);
  border-color: var(--link);
}

.part-btn.active {
  background: var(--link);
  color: var(--bg);
  border-color: var(--link);
}

/* References panel */
.refs-panel {
  margin-top: 10px;
  padding: 10px;
  background: rgba(0,0,0,0.2);
  border-radius: 4px;
  display: none;
}

.refs-panel.visible { display: block; }

.refs-panel h4 {
  margin: 0 0 5px 0;
  color: var(--comment);
  font-size: 0.9em;
}

.refs-list {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

/* Included books section */
.includes-section {
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(49, 50, 68, 0.3);
  border-radius: 8px;
  border: 1px solid var(--border);
}

.includes-section h2 {
  margin: 0 0 10px 0;
  color: var(--comment);
  font-size: 1em;
  font-weight: normal;
}

.includes-list {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.include-link {
  padding: 6px 12px;
  background: var(--border);
  border-radius: 4px;
  color: var(--link);
  text-decoration: none;
  font-size: 0.9em;
  transition: all 0.1s;
}

.include-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.include-link.local {
  border-left: 2px solid var(--comment);
}

/* Filter status */
.filter-status {
  position: fixed;
  top: 10px;
  left: 20px;
  background: var(--bg);
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: 4px;
  z-index: 201;
  display: none;
  align-items: center;
  gap: 10px;
}

.filter-status.active {
  display: flex;
  align-items: center;
  gap: 10px;
}

.clear-filter {
  padding: 5px 15px;
  background: var(--keyword);
  color: var(--bg);
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

/* RDFa vocab indicator */
[vocab] { /* semantic web annotations present */ }

</style>

</head>
<body>
  <div class="controls-left">
    <input type="text" id="name-filter" class="name-filter" placeholder="Filter by name..." title="Filter definitions by name">
    <label class="regex-label"><input type="checkbox" id="regex-toggle"> regex</label>
  </div>

  <div class="controls-right">
    <button class="control-btn" id="theme-toggle" title="Toggle light/dark theme">☀️</button>
    <button class="control-btn" id="font-smaller" title="Decrease font size">A-</button>
    <button class="control-btn" id="font-larger" title="Increase font size">A+</button>
  </div>

  <div class="filter-status">
    <span class="filter-text">Filtering...</span>
    <button class="clear-filter">Clear Filter</button>
  </div>
  
  <div class="book-header">
    <h1 property="name">sbitsets</h1>
    <div class="path"><a href="sbitsets.lisp" class="source-link">books/std/bitsets/sbitsets</a></div>
  </div>
  
  <main property="text">
<div class="form-block other" id="form-0" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-in-package" data-sym="IN-PACKAGE">in-package</a> <span class="string">"BITSETS"</span>)</pre>
  </div>

<div class="form-block other" id="form-1" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="bits-between.html" title="Open bits-between">"bits-between"</a>)</pre>
  </div>

<div class="form-block other" id="form-2" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../centaur/bitops/equal-by-logbitp.html" title="Open centaur/bitops/equal-by-logbitp">"centaur/bitops/equal-by-logbitp"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>))</pre>
  </div>

<div class="form-block other" id="form-3" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../centaur/bitops/ihs-extensions.html" title="Open centaur/bitops/ihs-extensions">"centaur/bitops/ihs-extensions"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>))</pre>
  </div>

<div class="form-block other" id="form-4" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../centaur/misc/equal-sets.html" title="Open centaur/misc/equal-sets">"centaur/misc/equal-sets"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>))</pre>
  </div>

<div class="form-block other" id="form-5" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../std/lists/revappend.html" title="Open std/lists/revappend">"std/lists/revappend"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>))</pre>
  </div>

<div class="form-block other" id="form-6" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../std/lists/rev.html" title="Open std/lists/rev">"std/lists/rev"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>))</pre>
  </div>

<div class="form-block other" id="form-7" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../std/lists/append.html" title="Open std/lists/append">"std/lists/append"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>))</pre>
  </div>

<div class="form-block other" id="form-8" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../ihs/quotient-remainder-lemmas.html" title="Open ihs/quotient-remainder-lemmas">"ihs/quotient-remainder-lemmas"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>))</pre>
  </div>

<div class="form-block other" id="form-9" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable* definitions
      expensive-rules
      ash-1-removal)))</pre>
  </div>

<div class="form-block other" id="form-10" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc sbitsets
  <span class="keyword">:parents</span> (std/bitsets)
  <span class="keyword">:short</span> <span class="string">"Sparse bitsets library: an alternative to @(see bitsets) for
representing finite sets of natural numbers."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;h3&gt;Introduction&lt;/h3&gt;

&lt;p&gt;In the ordinary @(see bitsets) library, sets of natural numbers are encoded
as bignums.  This is perfectly fine when the set elements are relatively small,
but it is not an efficient way to deal with sets of large numbers.  For
instance, trying to insert a number like 2^30 into an ordinary bitset will
probably kill your Lisp.&lt;/p&gt;

&lt;p&gt;Sparse bitsets are a more forgiving alternative.  They can handle very large
set elements, but still achieve bitset-like efficiencies in many cases.&lt;/p&gt;

&lt;p&gt;Sparse bitsets are represented as ordered lists of @(&#39;(offset . block)&#39;)
pairs.  Loosely speaking, each such pair in the set @(&#39;X&#39;) means that:&lt;/p&gt;

@({
  offset*blocksize + 0             \in X  iff  (logbitp 0 block)
  offset*blocksize + 1             \in X  iff  (logbitp 1 block)
    ...
  offset*blocksize + (blocksize-1) \in X  iff  (logbitp (blocksize-1) block)
})

&lt;p&gt;The @(&#39;blocksize&#39;) is a some constant determined by @(see
*sbitset-block-size*).  We&#39;ll assume it is 60 (which makes each @(&#39;block&#39;) a
fixnum on 64-bit CCL).&lt;/p&gt;

&lt;h4&gt;Efficiency Considerations&lt;/h4&gt;

&lt;p&gt;Sparse bitsets are essentially a hybrid of ordered sets and bitsets, and
their efficiency characteristics are very data dependent.&lt;/p&gt;

&lt;p&gt;Sparse bitsets perform best on sets that have &quot;clusters&quot; of nearby
members, perhaps separated by wide gaps.  Here, sparse bitsets give you some of
the same benefits of bitsets, viz. word-at-a-time operations like union and the
space efficiency of using bit masks to represent the set members.&lt;/p&gt;

&lt;p&gt;For completely dense sets, e.g., all integers in @(&#39;[0, 1000]&#39;), sparse
bitsets are:&lt;/p&gt;

&lt;ul&gt;

&lt;li&gt;Better than ordered sets, because they get to compress nearby elements into
 bitmasks and use word-at-a-time operations.&lt;/li&gt;

&lt;li&gt;Somewhat worse than ordinary bitsets.  They are less space efficient due to
 the conses and offset numbers.  They are also more expensive for membership
 testing: regular bitsets can basically use O(1) array indexing via @(see
 logbitp), while sparse bitsets must use an O(n) search for the right
 pair.&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;For &quot;cluster-free&quot; sets where the elements are so far apart that they
never fall into the same block, sparse bitsets are:&lt;/p&gt;

&lt;ul&gt;

&lt;li&gt;Better than bitsets, which perform badly here since they can have large
segments of 0 bits that waste space and take time to process during set
operations.&lt;/li&gt;

&lt;li&gt;Somewhat worse than ordered sets.  For instance, a set like {0, 60, 120}
would be encoded as @(&#39;((0 . 1) (1 . 1) (2 . 1))&#39;), which is similar to its
ordered set representation except for the additional overhead of using @(&#39;(1
. 1)&#39;) to represent 60, etc.&lt;/li&gt;

&lt;/ul&gt;


&lt;h3&gt;Sparse Bitset Operations&lt;/h3&gt;

&lt;p&gt;Convention:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;@(&#39;a, b, ...&#39;) denote set elements&lt;/li&gt;
&lt;li&gt;@(&#39;X, Y, ...&#39;) denote sets.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Valid sparse bitsets are recognized by @(see sbitsetp), and there is a
standard fixing function, @(see sbitset-fix).&lt;/p&gt;

&lt;p&gt;We intend to eventually implement sparse analogues for all of the functions
in the @(see bitsets) library, and analogues for the bitset @(see reasoning)
techniques.  For now we have only finished a few of these operations:&lt;/p&gt;

&lt;h5&gt;Sparse Bitset Construtors&lt;/h5&gt;

&lt;dl&gt;

&lt;dt&gt;@(&#39;(sbitset-singleton a)&#39;)&lt;/dt&gt;
&lt;dd&gt;Constructs the set @(&#39;{a}&#39;)&lt;/dd&gt;

&lt;dt&gt;@(&#39;(sbitset-union X Y ...)&#39;)&lt;/dt&gt;
&lt;dd&gt;Constructs the set @(&#39;X U Y U ...&#39;)&lt;/dd&gt;

&lt;dt&gt;@(&#39;(sbitset-intersect X Y ...)&#39;)&lt;/dt&gt;
&lt;dd&gt;Constructs the set @(&#39;X \intersect Y \intersect ...&#39;)&lt;/dd&gt;

&lt;dt&gt;@(&#39;(sbitset-difference X Y)&#39;)&lt;/dt&gt;
&lt;dd&gt;Constructs the set @(&#39;X - Y&#39;)&lt;/dd&gt;

&lt;/dl&gt;

&lt;h5&gt;Inspecting Sparse Bitsets&lt;/h5&gt;

&lt;dl&gt;
&lt;dt&gt;Todo&lt;/dt&gt;
&lt;/dl&gt;

&lt;h5&gt;Enumerating Sparse Bitset Members&lt;/h5&gt;

&lt;dl&gt;
&lt;dt&gt;@(&#39;(sbitset-members X)&#39;)&lt;/dt&gt;
&lt;dd&gt;Constructs an ordinary ordered set with the elements of X.&lt;/dd&gt;
&lt;dd&gt;Important in @(see reasoning) about sparse bitsets.&lt;/dd&gt;
&lt;/dl&gt;"</span>)</pre>
  </div>

<div class="form-block other" id="form-11" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection *sbitset-block-size*
  <span class="keyword">:parents</span> (sbitset-pairp)
  <span class="keyword">:short</span> <span class="string">"Size of each block in an sparse bitset."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;The block size can be any positive number, but for good performance
you probably want to use the maximal number such that:&lt;/p&gt;

@({
 (fixnump (1- (expt 2 *sbitset-block-size*))) = T
})

&lt;p&gt;On CCL and SBCL, 60 is the right number.  For other Lisps, 60 is logically
fine, but other numbers may give you better performance.&lt;/p&gt;

&lt;p&gt;Note: if you change this, you may wish to also write a corresponding,
optimized version of @(see sbitset-pair-members).&lt;/p&gt;"</span>
  (<a class="sym-link system" href="../../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> *sbitset-block-size* <span class="number">60</span>))</pre>
  </div>

<div class="form-block other" id="form-12" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> floor-is-nonnegative-integer-quotient
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> a) (<a class="sym-link system" href="../../../axioms.html#def-posp" data-sym="POSP">posp</a> b))
      (equal (floor a b)
        (<a class="sym-link system" href="../../../axioms.html#def-nonnegative-integer-quotient" data-sym="NONNEGATIVE-INTEGER-QUOTIENT">nonnegative-integer-quotient</a> a
          b)))))</pre>
  </div>

<div class="form-block other" id="form-13" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (disable truncate)))</pre>
  </div>

<div class="form-block other" id="form-14" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> truncate-is-nonnegative-integer-quotient
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> a) (<a class="sym-link system" href="../../../axioms.html#def-posp" data-sym="POSP">posp</a> b))
      (equal (truncate a b)
        (<a class="sym-link system" href="../../../axioms.html#def-nonnegative-integer-quotient" data-sym="NONNEGATIVE-INTEGER-QUOTIENT">nonnegative-integer-quotient</a> a
          b)))))</pre>
  </div>

<div class="form-block other" id="form-15" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-encapsulate" data-sym="ENCAPSULATE">encapsulate</a> nil
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> niq-ind
        (a b c)
        (declare (xargs <span class="keyword">:measure</span> (<a class="sym-link system" href="../../../axioms.html#def-nonnegative-integer-quotient" data-sym="NONNEGATIVE-INTEGER-QUOTIENT">nonnegative-integer-quotient</a> c
              a)))
        (if (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> a) <span class="number">0</span>)
            (&lt; (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> c) a))
          b
          (niq-ind a
            (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> b <span class="number">1</span>)
            (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> c a)))))
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> niq-lemma
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-posp" data-sym="POSP">posp</a> a)
          (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> b)
          (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> c))
        (equal (equal (<a class="sym-link system" href="../../../axioms.html#def-nonnegative-integer-quotient" data-sym="NONNEGATIVE-INTEGER-QUOTIENT">nonnegative-integer-quotient</a> c
              a)
            b)
          (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> (<a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a> a b) c)
            (&lt; c (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> a (<a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a> a b))))))
      <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:induct</span> (niq-ind a b c)) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp '(<span class="keyword">:nonlinearp</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>))))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../arithmetic-3/bind-free/top.html" title="Open arithmetic-3/bind-free/top">"arithmetic-3/bind-free/top"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (disable cancel-mod-+-basic)))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l0
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (integerp a)
            (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> size)
            (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> (<a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a> size offset) a)
            (&lt; a
              (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> size (<a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a> size offset)))
            (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> offset))
          (equal (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> a (<a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a> (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> size) offset))
            (mod a size)))
        <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable mod) <span class="keyword">:do-not-induct</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>))))
    (<a class="sym-link system" href="../../../axioms.html#def-make-event" data-sym="MAKE-EVENT">make-event</a> `(<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> mod-blocksize-nonsense
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (integerp a)
            (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> (<a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a> ,BITSETS::*SBITSET-BLOCK-SIZE* offset)
              a)
            (&lt; a
              (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> ,BITSETS::*SBITSET-BLOCK-SIZE*
                (<a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a> ,BITSETS::*SBITSET-BLOCK-SIZE* offset)))
            (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> offset))
          (equal (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> a
              (<a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a> ,(- BITSETS::*SBITSET-BLOCK-SIZE*) offset))
            (mod a ,BITSETS::*SBITSET-BLOCK-SIZE*)))))))</pre>
  </div>

<div class="form-block other" id="form-16" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (disable logbitp-when-too-small
      expt-2-monotonic
      associativity-of-append)))</pre>
  </div>

<div class="form-block other" id="form-17" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> integer-listp-of-append
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> x)
        (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> y))
      (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> x y)))))</pre>
  </div>

<div class="form-block other" id="form-18" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> rassoc-append
    (equal (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> x (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> y z))
      (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> x y) z))))</pre>
  </div>

<div class="form-block other" id="form-19" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> dec-induct
    (n)
    (if (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> n)
      n
      (dec-induct (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> n)))))</pre>
  </div>

<div class="form-block other" id="form-20" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> integerp-of-car-when-integer-listp
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> x)
      (equal (integerp (car x)) (consp x)))))</pre>
  </div>

<div class="form-block other" id="form-21" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthmd" data-sym="DEFTHMD">defthmd</a> member-equal-is-in
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (setp x)
      (<a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a> (<a class="sym-link system" href="../../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> a x)
        (in a x)))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable in-to-member)))))</pre>
  </div>

<div class="form-block other" id="form-22" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-make-event" data-sym="MAKE-EVENT">make-event</a> `(<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> expt-2-monotonic-specialized-for-block-size
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (&lt; a ,BITSETS::*SBITSET-BLOCK-SIZE*)
          (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> a))
        (&lt; (expt <span class="number">2</span> a)
          ,(EXPT 2 BITSETS::*SBITSET-BLOCK-SIZE*)))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:use</span> ((<span class="keyword">:instance</span> expt-2-monotonic
            (a a)
            (b ,BITSETS::*SBITSET-BLOCK-SIZE*))))))))</pre>
  </div>

<div class="form-block other" id="form-23" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (defsection add-to-each
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> consp-of-add-to-each
      (equal (consp (add-to-each offset x))
        (consp x))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable add-to-each))))
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> integer-listp-of-add-to-each
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (integerp offset)
          (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> x))
        (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> (add-to-each offset x)))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable add-to-each))))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l0
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> a
              (add-to-each offset x))
            (integerp offset)
            (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> x))
          (integerp a))))
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> member-equal-add-to-each
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (integerp offset))
          (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> x)))
        (<a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a> (<a class="sym-link system" href="../../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> a
            (add-to-each offset x))
          (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (integerp a)
            (<a class="sym-link system" href="../../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> a offset)
              x)))))
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> no-duplicatesp-equal-of-add-to-each
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-no-duplicatesp-equal" data-sym="NO-DUPLICATESP-EQUAL">no-duplicatesp-equal</a> x)
          (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> x))
          (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (integerp offset)))
        (<a class="sym-link system" href="../../../axioms.html#def-no-duplicatesp-equal" data-sym="NO-DUPLICATESP-EQUAL">no-duplicatesp-equal</a> (add-to-each offset x))))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l1
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (integerp a) (integerp b))
          (equal (&lt;&lt; a b)
            (&lt; a b)))
        <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable &lt;&lt;
             <a class="sym-link system" href="../../../axioms.html#def-lexorder" data-sym="LEXORDER">lexorder</a>
             <a class="sym-link system" href="../../../axioms.html#def-alphorder" data-sym="ALPHORDER">alphorder</a>)))))
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> setp-of-add-to-each
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (integerp offset)
          (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> x)
          (setp x))
        (setp (add-to-each offset x)))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable* (<span class="keyword">:ruleset</span> primitive-rules)
           add-to-each))))))</pre>
  </div>

<div class="form-block other" id="form-24" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (defsection no-duplicatesp-equal-when-setp
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l0
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> a x)
            (&lt;&lt; a (car x)))
          (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (setp x)))
        <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> x)
           <span class="keyword">:in-theory</span> (enable* (<span class="keyword">:ruleset</span> primitive-rules)
             (<span class="keyword">:ruleset</span> order-rules))))))
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> no-duplicatesp-equal-when-setp
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (setp x)
        (<a class="sym-link system" href="../../../axioms.html#def-no-duplicatesp-equal" data-sym="NO-DUPLICATESP-EQUAL">no-duplicatesp-equal</a> x))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable* (<span class="keyword">:ruleset</span> primitive-rules)))))))</pre>
  </div>

<div class="form-block other" id="form-25" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (defsection append-is-union
    (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> max-int
      (x)
      (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) nil)
        ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> (cdr x)) (car x))
        (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (max (car x) (max-int (cdr x))))))
    (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> min-int
      (x)
      (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) nil)
        ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> (cdr x)) (car x))
        (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (min (car x) (min-int (cdr x))))))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l1
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-case-split" data-sym="CASE-SPLIT">case-split</a> (integerp a))
            (<a class="sym-link system" href="../../../axioms.html#def-case-split" data-sym="CASE-SPLIT">case-split</a> (integerp b)))
          (equal (&lt;&lt; a b)
            (&lt; a b)))
        <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable &lt;&lt;
             <a class="sym-link system" href="../../../axioms.html#def-lexorder" data-sym="LEXORDER">lexorder</a>
             <a class="sym-link system" href="../../../axioms.html#def-alphorder" data-sym="ALPHORDER">alphorder</a>)))))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l2
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> x)
            (setp x))
          (equal (min-int x)
            (if (consp x)
              (car x)
              nil)))
        <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable* (<span class="keyword">:ruleset</span> primitive-rules))))))
    (<a class="sym-link system" href="../../../axioms.html#def-defthmd" data-sym="DEFTHMD">defthmd</a> setp-of-append
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (&lt; (max-int x)
                (min-int y))
              (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
              (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> y)))
          (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> x))
          (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> y))
          (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (setp x))
          (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (setp y)))
        (setp (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> x y)))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable* (<span class="keyword">:ruleset</span> primitive-rules)))))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable setp-of-append)))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> in-of-append
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (&lt; (max-int x)
                  (min-int y))
                (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
                (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> y)))
            (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> x))
            (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> y))
            (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (setp x))
            (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (setp y)))
          (equal (in a (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> x y))
            (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (in a x)
              (in a y))))
        <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:use</span> ((<span class="keyword">:instance</span> member-equal-is-in
              (x (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> x y))) (<span class="keyword">:instance</span> member-equal-is-in
               (x x))
             (<span class="keyword">:instance</span> member-equal-is-in
               (x y)))))))
    (<a class="sym-link system" href="../../../axioms.html#def-defthmd" data-sym="DEFTHMD">defthmd</a> append-is-union
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (&lt; (max-int x)
                (min-int y))
              (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
              (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> y)))
          (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> x))
          (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> y))
          (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (setp x))
          (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (setp y)))
        (equal (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> x y)
          (union x y))))))</pre>
  </div>

<div class="form-block other" id="form-26" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (defsection consp-of-bits-between
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l1
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-posp" data-sym="POSP">posp</a> x)
          (logbitp (logbitp-mismatch x <span class="number">0</span>)
            x))
        <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (disable logbitp-mismatch-correct)
           <span class="keyword">:use</span> ((<span class="keyword">:instance</span> logbitp-mismatch-correct
              (a x)
              (b <span class="number">0</span>)))))))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l2
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-posp" data-sym="POSP">posp</a> x)
          (&lt; (logbitp-mismatch x <span class="number">0</span>)
            (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> x)))
        <span class="keyword">:rule-classes</span> ((<span class="keyword">:rewrite</span>) (<span class="keyword">:linear</span>))))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l3
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (&lt; x (expt <span class="number">2</span> n))
            (<a class="sym-link system" href="../../../axioms.html#def-posp" data-sym="POSP">posp</a> x)
            (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> n))
          (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> (logbitp-mismatch x <span class="number">0</span>) n))
        <span class="keyword">:rule-classes</span> ((<span class="keyword">:rewrite</span>) (<span class="keyword">:linear</span>))
        <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (disable integer-length-bounded-by-expt)
           <span class="keyword">:use</span> ((<span class="keyword">:instance</span> integer-length-bounded-by-expt
              (a x)))))))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l4
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-posp" data-sym="POSP">posp</a> x)
          (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> (logbitp-mismatch x <span class="number">0</span>)))
        <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable <a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a>)))
        <span class="keyword">:rule-classes</span> ((<span class="keyword">:rewrite</span>) (<span class="keyword">:type-prescription</span>))))
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> consp-of-bits-between
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (&lt; block (expt <span class="number">2</span> n))
          (<a class="sym-link system" href="../../../axioms.html#def-posp" data-sym="POSP">posp</a> block)
          (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> n))
        (consp (bits-between <span class="number">0</span> n block)))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (disable member-equal-of-bits-between)
         <span class="keyword">:use</span> ((<span class="keyword">:instance</span> member-equal-of-bits-between
            (a (logbitp-mismatch block <span class="number">0</span>))
            (n <span class="number">0</span>)
            (x block)
            (m n))))))))</pre>
  </div>

<div class="form-block macro" id="def-the-sbitset-block" data-defines="THE-SBITSET-BLOCK" data-references="UNSIGNED-BYTE,THE,QUASIQUOTE,X,DEFMACRO" typeof="Code">
    <div class="form-header"><span class="form-name" property="name" data-sym="THE-SBITSET-BLOCK">the-sbitset-block</span><span class="form-type">macro</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> <a class="sym-link local-def" href="#def-the-sbitset-block" data-sym="THE-SBITSET-BLOCK" title="(defmacro bitsets::the-sbitset-block (bitsets::x)
  `(the (unsigned-byte ,bitsets::*sbitset-block-size*) ,bitsets::x))">the-sbitset-block</a>
  (x)
  `(<a class="sym-link system" href="../../../axioms.html#def-the" data-sym="THE">the</a> (unsigned-byte ,BITSETS::*SBITSET-BLOCK-SIZE*)
    ,BITSETS::X))</pre>
  </div>

<div class="form-block other" id="form-28" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-make-event" data-sym="MAKE-EVENT">make-event</a> `(define sbitset-blockp
    (x)
    <span class="keyword">:returns</span> (bool <a class="sym-link system" href="../../../axioms.html#def-booleanp" data-sym="BOOLEANP">booleanp</a>
      <span class="keyword">:rule-classes</span> <span class="keyword">:type-prescription</span>)
    <span class="keyword">:parents</span> (sbitset-pairp)
    <span class="keyword">:short</span> <span class="string">"@(call sbitset-blockp) recognizes numbers that are valid as the
&lt;i&gt;block&lt;/i&gt; component of an @(see sbitset-pairp)."</span>
    <span class="keyword">:long</span> <span class="string">"&lt;p&gt;To ensure that sparse bitsets are canonical, we don&#39;t allow 0 as
a valid block.  The idea is that any block whose value is 0 should just be
omitted from the set.&lt;/p&gt;"</span>
    <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
    (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-posp" data-sym="POSP">posp</a> x)
        (&lt; x (expt <span class="number">2</span> *sbitset-block-size*)))
      <span class="keyword">:exec</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (integerp x)
        (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> <span class="number">1</span> x)
        (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> x ,(1- (EXPT 2 BITSETS::*SBITSET-BLOCK-SIZE*)))))
    ///
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-block-type
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (sbitset-blockp x)
        (<a class="sym-link system" href="../../../axioms.html#def-posp" data-sym="POSP">posp</a> x))
      <span class="keyword">:rule-classes</span> <span class="keyword">:compound-recognizer</span>)
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-block-upper-bound
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (sbitset-blockp x)
        (&lt; x (expt <span class="number">2</span> *sbitset-block-size*))))))</pre>
  </div>

<div class="form-block other" id="form-29" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define sbitset-pairp
  (x)
  <span class="keyword">:parents</span> (sbitsets)
  <span class="keyword">:returns</span> (pairp <a class="sym-link system" href="../../../axioms.html#def-booleanp" data-sym="BOOLEANP">booleanp</a>
    <span class="keyword">:rule-classes</span> <span class="keyword">:type-prescription</span>)
  <span class="keyword">:short</span> <span class="string">"@(call sbitset-pairp) recognizes a valid @(&#39;(offset . block)&#39;) pair
for sparse bitsets."</span>
  <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (consp x)
    (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> (car x))
    (sbitset-blockp (cdr x)))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> consp-when-sbitset-pairp
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (sbitset-pairp x)
      (consp x))
    <span class="keyword">:rule-classes</span> <span class="keyword">:compound-recognizer</span>))</pre>
  </div>

<div class="form-block other" id="form-30" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define sbitset-pair
  ((offset <a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> <span class="keyword">:type</span> unsigned-byte) (block sbitset-blockp))
  <span class="keyword">:returns</span> pair
  <span class="keyword">:parents</span> (sbitset-pairp)
  <span class="keyword">:short</span> <span class="string">"@(call sbitset-pair) constructs a @(&#39;(offset . block)&#39;) pair."</span>
  <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (cons offset block))</pre>
  </div>

<div class="form-block other" id="form-31" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define sbitset-pair-offset
  ((x sbitset-pairp))
  <span class="keyword">:parents</span> (sbitset-pairp)
  <span class="keyword">:returns</span> offset
  <span class="keyword">:short</span> <span class="string">"@(call sbitset-pair-offset) gets the @(&#39;offset&#39;) from an @(&#39;(offset
  . block)&#39;) pair."</span>
  <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (car x))</pre>
  </div>

<div class="form-block other" id="form-32" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define sbitset-pair-block
  ((x sbitset-pairp))
  <span class="keyword">:parents</span> (sbitset-pairp)
  <span class="keyword">:returns</span> block
  <span class="keyword">:short</span> <span class="string">"@(call sbitset-pair-block) gets the @(&#39;block&#39;) from an @(&#39;(offset
  . block)&#39;) pair."</span>
  <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (cdr x))</pre>
  </div>

<div class="form-block other" id="form-33" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection sbitset-pairp-basics
  <span class="keyword">:extension</span> sbitset-pairp
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable sbitset-pairp
        sbitset-pair
        sbitset-pair-offset
        sbitset-pair-block)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-pair-offset-of-sbitset-pair
    (equal (sbitset-pair-offset (sbitset-pair offset block))
      offset))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-pair-block-of-sbitset-pair
    (equal (sbitset-pair-block (sbitset-pair offset block))
      block))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-pair-offset-type
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-pairp x))
      (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> (sbitset-pair-offset x)))
    <span class="keyword">:rule-classes</span> <span class="keyword">:type-prescription</span>)
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-pair-block-type
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-pairp x))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (integerp (sbitset-pair-block x))
        (&lt; <span class="number">0</span> (sbitset-pair-block x))))
    <span class="keyword">:rule-classes</span> <span class="keyword">:type-prescription</span>)
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-pair-block-upper-bound
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-pairp x))
      (&lt; (sbitset-pair-block x)
        (expt <span class="number">2</span> *sbitset-block-size*)))
    <span class="keyword">:rule-classes</span> ((<span class="keyword">:rewrite</span>) (<span class="keyword">:linear</span>))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:use</span> ((<span class="keyword">:instance</span> sbitset-block-upper-bound
          (x (cdr x)))))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-pairp-of-sbitset-pair
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> offset))
        (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-blockp block)))
      (sbitset-pairp (sbitset-pair offset block))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-blockp-of-sbitset-pair-block
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-pairp x))
      (sbitset-blockp (sbitset-pair-block x)))))</pre>
  </div>

<div class="form-block other" id="form-34" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define sbitset-pair-members
  ((x sbitset-pairp))
  <span class="keyword">:returns</span> set
  <span class="keyword">:parents</span> (sbitset-members sbitset-pairp)
  <span class="keyword">:short</span> <span class="string">"@(call sbitset-pair-members) extracts the members of a single @(see
sbitset-pairp)."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;For instance, if the pair is @(&#39;(0 . 7)&#39;), we produce the set
@(&#39;{0, 1, 2}&#39;); if the set is @(&#39;(1 . 7)&#39;), we produce @(&#39;{60, 61, 62}&#39;).&lt;/p&gt;

&lt;p&gt;This serves as the logical definition we use to reason about member
extraction.&lt;/p&gt;

&lt;p&gt;Normally this function isn&#39;t executed.  When the block size is 32 or 60, we
can instead use the optimized @(see bits-0-31) or @(see 60bits-0-59) routines
instead.  But, if you change the block size to something else, this function
&lt;b&gt;will&lt;/b&gt; be executed and its performance will probably be bad.  In this
case, you might want to write a custom @(&#39;bits-0-32&#39;) style routine for your
block size.&lt;/p&gt;"</span>
  (add-to-each (<a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a> (sbitset-pair-offset x)
      *sbitset-block-size*)
    (bits-between <span class="number">0</span>
      *sbitset-block-size*
      (sbitset-pair-block x)))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-pair-members-of-nil
    (equal (sbitset-pair-members nil) nil))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> true-listp-of-sbitset-pair-members
    (<a class="sym-link system" href="../../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> (sbitset-pair-members x))
    <span class="keyword">:rule-classes</span> <span class="keyword">:type-prescription</span>)
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> integer-listp-of-sbitset-pair-members
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-pairp x))
      (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> (sbitset-pair-members x))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../arithmetic-3/bind-free/top.html" title="Open arithmetic-3/bind-free/top">"arithmetic-3/bind-free/top"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> member-equal-sbitset-pair-members
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-pairp x))
      (<a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a> (<a class="sym-link system" href="../../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> a
          (sbitset-pair-members x))
        (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> a)
          (equal (floor a *sbitset-block-size*)
            (sbitset-pair-offset x))
          (logbitp (mod a *sbitset-block-size*)
            (sbitset-pair-block x))))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> no-duplicatesp-equal-of-sbitset-pair-members
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-pairp x))
      (<a class="sym-link system" href="../../../axioms.html#def-no-duplicatesp-equal" data-sym="NO-DUPLICATESP-EQUAL">no-duplicatesp-equal</a> (sbitset-pair-members x))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> offsets-must-agree-when-sbitset-pair-members-intersect
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-pairp x))
        (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-pairp y))
        (<a class="sym-link system" href="../../../axioms.html#def-intersectp-equal" data-sym="INTERSECTP-EQUAL">intersectp-equal</a> (sbitset-pair-members x)
          (sbitset-pair-members y))
        (<a class="sym-link system" href="../../../axioms.html#def-syntaxp" data-sym="SYNTAXP">syntaxp</a> (term-order y x)))
      (equal (sbitset-pair-offset x)
        (sbitset-pair-offset y)))
    <span class="keyword">:hints</span> ((set-reasoning)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> consp-of-sbitset-pair-members
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-pairp x))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> (sbitset-pair-members x))
        (consp (sbitset-pair-members x))))
    <span class="keyword">:rule-classes</span> <span class="keyword">:type-prescription</span>)
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> setp-of-sbitset-pair-members
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-pairp a))
      (setp (sbitset-pair-members a))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> in-of-sbitset-pair-members
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-pairp x))
      (equal (in a
          (sbitset-pair-members x))
        (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> a)
          (equal (floor a *sbitset-block-size*)
            (sbitset-pair-offset x))
          (logbitp (mod a *sbitset-block-size*)
            (sbitset-pair-block x)))))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:use</span> ((<span class="keyword">:instance</span> member-equal-is-in
          (x (sbitset-pair-members x)))))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> emptyp-of-sbitset-pair-members
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-pairp x))
      (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (emptyp (sbitset-pair-members x))))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (e/d* ((<span class="keyword">:ruleset</span> primitive-rules))
         (sbitset-pair-members))))))</pre>
  </div>

<div class="form-block other" id="form-35" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (defsection sbitset-pair-members-bounds
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable sbitset-pair-members)))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> max-int-of-add-to-each
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (integerp offset))
            (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> x)))
          (equal (max-int (add-to-each offset x))
            (if (consp x)
              (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> offset (max-int x))
              nil)))
        <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> (add-to-each offset x)
           <span class="keyword">:in-theory</span> (enable add-to-each max-int)))))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> min-int-of-add-to-each
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (integerp offset))
            (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> x)))
          (equal (min-int (add-to-each offset x))
            (if (consp x)
              (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> offset (min-int x))
              nil)))
        <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> (add-to-each offset x)
           <span class="keyword">:in-theory</span> (enable add-to-each min-int)))))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> max-int-of-bits-between
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (consp (bits-between n m x))
            (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> n))
            (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> m))
            (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> n m)))
          (&lt; (max-int (bits-between n m x))
            m))
        <span class="keyword">:rule-classes</span> ((<span class="keyword">:rewrite</span>) (<span class="keyword">:linear</span>))
        <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> (bits-between n m x)
           <span class="keyword">:in-theory</span> (enable bits-between)))))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> min-int-of-bits-between
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (consp (bits-between n m x))
            (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> n))
            (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> m))
            (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> n m)))
          (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> n
            (min-int (bits-between n m x))))
        <span class="keyword">:rule-classes</span> ((<span class="keyword">:rewrite</span>) (<span class="keyword">:linear</span>))
        <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> (bits-between n m x)
           <span class="keyword">:in-theory</span> (enable bits-between)))))
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-pair-members-upper-bound
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-pairp x))
        (&lt; (max-int (sbitset-pair-members x))
          (<a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a> *sbitset-block-size*
            (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> (sbitset-pair-offset x) <span class="number">1</span>))))
      <span class="keyword">:rule-classes</span> ((<span class="keyword">:rewrite</span>) (<span class="keyword">:linear</span>)))
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-pair-members-lower-bound
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-pairp x))
        (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> (<a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a> *sbitset-block-size*
            (sbitset-pair-offset x))
          (min-int (sbitset-pair-members x))))
      <span class="keyword">:rule-classes</span> ((<span class="keyword">:rewrite</span>) (<span class="keyword">:linear</span>)))))</pre>
  </div>

<div class="form-block other" id="form-36" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define sbitsetp
  (x)
  <span class="keyword">:returns</span> bool
  <span class="keyword">:parents</span> (sbitsets)
  <span class="keyword">:short</span> <span class="string">"@(call sbitsetp) determines whether @(&#39;X&#39;) is a well-formed sparse
bitset."</span>
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> x)
    (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitset-pairp (<a class="sym-link system" href="../../../axioms.html#def-first" data-sym="FIRST">first</a> x))
      (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> (cdr x))
        (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (cdr x))
        (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitset-pairp (<a class="sym-link system" href="../../../axioms.html#def-second" data-sym="SECOND">second</a> x))
          (&lt; (sbitset-pair-offset (<a class="sym-link system" href="../../../axioms.html#def-first" data-sym="FIRST">first</a> x))
            (sbitset-pair-offset (<a class="sym-link system" href="../../../axioms.html#def-second" data-sym="SECOND">second</a> x)))))
      (sbitsetp (cdr x))))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> true-listp-when-sbitsetp
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (sbitsetp x)
      (<a class="sym-link system" href="../../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> x))
    <span class="keyword">:rule-classes</span> <span class="keyword">:compound-recognizer</span>)
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitsetp-when-atom
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
      (equal (sbitsetp x) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> x))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitsetp-of-cons
    (equal (sbitsetp (cons a x))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitset-pairp a)
        (sbitsetp x)
        (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
          (&lt; (sbitset-pair-offset a)
            (sbitset-pair-offset (<a class="sym-link system" href="../../../axioms.html#def-first" data-sym="FIRST">first</a> x)))))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-pairp-of-car
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (sbitsetp x)
      (equal (sbitset-pairp (car x))
        (consp x))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitsetp-of-cdr
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (sbitsetp x)
      (sbitsetp (cdr x))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-pairp-when-member-equal-of-sbitsetp
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> a x)
        (sbitsetp x))
      (sbitset-pairp a))
    <span class="keyword">:rule-classes</span> ((<span class="keyword">:rewrite</span>) (<span class="keyword">:rewrite</span> <span class="keyword">:corollary</span> (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x)
            (<a class="sym-link system" href="../../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> a x))
          (sbitset-pairp a))))))</pre>
  </div>

<div class="form-block other" id="form-37" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define sbitset-fix
  ((x sbitsetp))
  <span class="keyword">:parents</span> (sbitsets)
  <span class="keyword">:short</span> <span class="string">"@(call sbitset-fix) is a basic fixing function for sparse bitsets."</span>
  <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (if (sbitsetp x)
      x
      nil)
    <span class="keyword">:exec</span> x)
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> true-listp-of-sbitset-fix
    (<a class="sym-link system" href="../../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> (sbitset-fix x))
    <span class="keyword">:rule-classes</span> <span class="keyword">:type-prescription</span>)
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitsetp-of-sbitset-fix
    (sbitsetp (sbitset-fix x)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-fix-when-sbitsetp
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (sbitsetp x)
      (equal (sbitset-fix x) x))))</pre>
  </div>

<div class="form-block other" id="form-38" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection sbitset-members
  <span class="keyword">:parents</span> (sbitsets)
  <span class="keyword">:short</span> <span class="string">"@(call sbitset-members) converts a bitset into an ordinary, ordered
set."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;In the logic, we just call @(see sbitset-pair-members) on each
block to get the members.&lt;/p&gt;

&lt;p&gt;However, this function should typically be left disabled and you should not
reason about the underlying representation of sparse bitsets.&lt;/p&gt;

&lt;p&gt;For faster execution, when the block size is 32 or 60 we use a partially
unrolled inner loop for extracting the bits from each block.  This optimization
is not performed for other block sizes.&lt;/p&gt;"</span>
  (<a class="sym-link system" href="../../../axioms.html#def-make-event" data-sym="MAKE-EVENT">make-event</a> (b* ((fn (<a class="sym-link system" href="../../../axioms.html#def-case" data-sym="CASE">case</a> *sbitset-block-size*
           (<span class="number">60</span> '60bits-0-59)
           (<span class="number">32</span> 'bits-0-31)
           (otherwise nil))) (exec-def (if fn
            `(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> sbitset-members-exec
              (x acc)
              (declare (xargs <span class="keyword">:guard</span> (sbitsetp x)))
              (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
                acc
                (<a class="sym-link system" href="../../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((pair1 (car x)) (offset1 (sbitset-pair-offset pair1))
                    (block1 (sbitset-pair-block pair1)))
                  (,BITSETS::FN (<a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a> offset1 ,BITSETS::*SBITSET-BLOCK-SIZE*)
                    block1
                    (sbitset-members-exec (cdr x)
                      acc)))))
            `(<a class="sym-link system" href="../../../axioms.html#def-value-triple" data-sym="VALUE-TRIPLE">value-triple</a> <span class="keyword">:invisible</span>)))
        (logic-body `(if (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (sbitsetp x))
            nil
            (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
              nil
              (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (sbitset-pair-members (car x))
                (sbitset-members-aux (cdr x))))))
        (real-body (if fn
            `(<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> ,BITSETS::LOGIC-BODY
              <span class="keyword">:exec</span> (sbitset-members-exec x nil))
            logic-body))
        (remove-thm (if fn
            `(<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-members-exec-removal
              (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitsetp x))
                (equal (sbitset-members-exec x acc)
                  (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (sbitset-members-aux x)
                    acc)))
              <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable sbitset-pair-members))))
            `(<a class="sym-link system" href="../../../axioms.html#def-value-triple" data-sym="VALUE-TRIPLE">value-triple</a> <span class="keyword">:invisible</span>))))
      `(<a class="sym-link system" href="../../../axioms.html#def-encapsulate" data-sym="ENCAPSULATE">encapsulate</a> nil
        ,BITSETS::EXEC-DEF
        (<a class="sym-link system" href="../../../axioms.html#def-defund-inline" data-sym="DEFUND-INLINE">defund-inline</a> sbitset-members-aux
          (x)
          (declare (xargs <span class="keyword">:guard</span> (sbitsetp x)
              <span class="keyword">:verify-guards</span> nil))
          ,BITSETS::REAL-BODY)
        (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable sbitset-members-aux)))
        ,BITSETS::REMOVE-THM
        (<a class="sym-link system" href="../../../axioms.html#def-verify-guards" data-sym="VERIFY-GUARDS">verify-guards</a> sbitset-members-aux$inline))))
  (define sbitset-members
    ((x sbitsetp))
    <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
    <span class="keyword">:verify-guards</span> nil
    (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (if (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (sbitsetp x)) (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x))
        nil
        (union (sbitset-pair-members (car x))
          (sbitset-members (cdr x))))
      <span class="keyword">:exec</span> (sbitset-members-exec x nil)))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable sbitset-members
        sbitset-members-aux)))
  (defsection guard-verification
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l0
        (<a class="sym-link system" href="../../../axioms.html#def-integer-listp" data-sym="INTEGER-LISTP">integer-listp</a> (sbitset-members-aux x))))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l1
        (equal (consp (sbitset-members-aux x))
          (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x) (consp x)))))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l2
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (setp (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> x y))
          (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (setp (list-fix x))
            (setp y)))
        <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable* (<span class="keyword">:ruleset</span> primitive-rules))))))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l3
        (equal (min-int (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> x y))
          (if (consp x)
            (if (consp y)
              (min (min-int x)
                (min-int y))
              (min-int x))
            (if (consp y)
              (min-int y)
              nil)))
        <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable min-int <a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a>)))))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l4
        (setp (sbitset-members-aux x))
        <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable setp-of-append)))))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l5
        (equal (sbitset-members-aux x)
          (if (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (sbitsetp x)))
            nil
            (union (sbitset-pair-members (car x))
              (sbitset-members-aux (cdr x)))))
        <span class="keyword">:rule-classes</span> <span class="keyword">:definition</span> <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (<a class="sym-link system" href="../../../axioms.html#def-e_2Fd" data-sym="E/D">e/d</a> (append-is-union)
             (double-containment))))))
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-members-aux-removal
      (equal (sbitset-members-aux x)
        (sbitset-members x)))
    (<a class="sym-link system" href="../../../axioms.html#def-verify-guards_2B" data-sym="VERIFY-GUARDS+">verify-guards+</a> sbitset-members))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-members-default
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (sbitsetp a))
      (equal (sbitset-members a) nil)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-members-when-atom
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
      (equal (sbitset-members x) nil)))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l0
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
        (equal (setp x) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> x)))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable setp)))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> union-under-iff
      (<a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a> (union x y)
        (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (emptyp x))
          (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (emptyp y))))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable* (<span class="keyword">:ruleset</span> primitive-rules))))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-members-of-cons
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitsetp (cons a x)))
      (equal (sbitset-members (cons a x))
        (union (sbitset-pair-members a)
          (sbitset-members x)))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-members-of-sbitset-fix
    (equal (sbitset-members (sbitset-fix b))
      (sbitset-members b))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable sbitset-fix))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> true-listp-of-sbitset-members
    (<a class="sym-link system" href="../../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> (sbitset-members x))
    <span class="keyword">:rule-classes</span> <span class="keyword">:type-prescription</span>)
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> setp-of-sbitset-members
    (setp (sbitset-members x)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> no-duplicatesp-equal-of-sbitset-members
    (<a class="sym-link system" href="../../../axioms.html#def-no-duplicatesp-equal" data-sym="NO-DUPLICATESP-EQUAL">no-duplicatesp-equal</a> (sbitset-members x))))</pre>
  </div>

<div class="form-block other" id="form-39" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define sbitset-find
  ((offset <a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a>) (x sbitsetp))
  <span class="keyword">:parents</span> (in-of-sbitset-members)
  <span class="keyword">:short</span> <span class="string">"Helper definition; shouldn&#39;t be needed by users."</span>
  (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) nil)
    ((equal (sbitset-pair-offset (car x))
       offset) (car x))
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (sbitset-find offset (cdr x))))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-find-when-atom
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
      (equal (sbitset-find offset x)
        nil)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-find-of-cons
    (equal (sbitset-find offset
        (cons a x))
      (if (equal (sbitset-pair-offset a)
          offset)
        a
        (sbitset-find offset x))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> member-equal-of-sbitset-find
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (sbitset-find offset x)
      (<a class="sym-link system" href="../../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> (sbitset-find offset x)
        x)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-pairp-of-sbitset-find
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitsetp x))
      (equal (sbitset-pairp (sbitset-find offset x))
        (if (sbitset-find offset x)
          <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
          nil))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-pair-offset-of-sbitset-find
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (sbitsetp x)
      (equal (sbitset-pair-offset (sbitset-find offset x))
        (if (sbitset-find offset x)
          offset
          nil))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> natp-when-sbitset-find
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitset-find offset x)
        (sbitsetp x))
      (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> offset))
    <span class="keyword">:rule-classes</span> (<span class="keyword">:forward-chaining</span>)))</pre>
  </div>

<div class="form-block other" id="form-40" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection in-of-sbitset-members
  <span class="keyword">:parents</span> (sbitset-members)
  <span class="keyword">:short</span> <span class="string">"Low-level lemma to rewrite @(&#39;(in a (sbitset-members x))&#39;) into a
more structural form."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;This theorem is disabled by default and most users shouldn&#39;t enable
it.  It&#39;s only needed to prove properties about the basic sbitset
constructors.&lt;/p&gt;

&lt;p&gt;This is a little more complicated than in the basic bitset library, because
we have to go to the proper pair.&lt;/p&gt;"</span>
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l0
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x)
          (in a (sbitset-members x)))
        (sbitset-find (floor a *sbitset-block-size*)
          x))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (disable mod-blocksize-nonsense)
         <span class="keyword">:induct</span> (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> x)
         <span class="keyword">:expand</span> ((sbitset-members x))))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l1
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x)
          (&lt; offset
            (sbitset-pair-offset (car x))))
        (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (sbitset-find offset x)))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable sbitset-find)))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l2
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitset-pairp x)
          (in a
            (sbitset-pair-members x)))
        (equal (sbitset-pair-offset x)
          (floor a *sbitset-block-size*)))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l3
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (sbitsetp x)
        (equal (in a (sbitset-members x))
          (let ((pair (sbitset-find (floor a *sbitset-block-size*)
                 x)))
            (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> pair
              (in a
                (sbitset-pair-members pair))))))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> x)
         <span class="keyword">:expand</span> ((sbitset-members x) (<span class="keyword">:free</span> (n)
             (sbitset-find n x)))
         <span class="keyword">:in-theory</span> (disable in-of-sbitset-pair-members)
         <span class="keyword">:do-not</span> '(generalize fertilize)))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthmd" data-sym="DEFTHMD">defthmd</a> in-of-sbitset-members
    (equal (in a (sbitset-members x))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x)
        (let ((pair (sbitset-find (floor a *sbitset-block-size*)
               x)))
          (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> pair
            (in a
              (sbitset-pair-members pair))))))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:use</span> ((<span class="keyword">:instance</span> l3))))))</pre>
  </div>

<div class="form-block other" id="form-41" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable in-of-sbitset-members)))</pre>
  </div>

<div class="form-block other" id="form-42" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-make-event" data-sym="MAKE-EVENT">make-event</a> `(define sbitset-singleton-pair
    ((a <a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> <span class="keyword">:type</span> unsigned-byte))
    <span class="keyword">:returns</span> (pair sbitset-pairp)
    <span class="keyword">:parents</span> (sbitset-singleton)
    <span class="keyword">:short</span> <span class="string">"@(call sbitset-singleton-pair) creates a @(see sbitset-pairp) whose
only member is @(&#39;a&#39;)."</span>
    <span class="keyword">:guard-hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable sbitset-blockp)))
    <span class="keyword">:split-types</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
    <span class="keyword">:prepwork</span> ((<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable sbitset-blockp))) (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../arithmetic-3/bind-free/top.html" title="Open arithmetic-3/bind-free/top">"arithmetic-3/bind-free/top"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)))
    <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
    (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (let ((a (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> a)))
        (sbitset-pair (floor a *sbitset-block-size*)
          (expt <span class="number">2</span> (mod a *sbitset-block-size*))))
      <span class="keyword">:exec</span> (sbitset-pair (truncate a ,BITSETS::*SBITSET-BLOCK-SIZE*)
        (ash <span class="number">1</span> (rem a ,BITSETS::*SBITSET-BLOCK-SIZE*))))
    ///
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-pair-offset-of-sbitset-singleton-pair
      (equal (sbitset-pair-offset (sbitset-singleton-pair a))
        (floor (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> a)
          *sbitset-block-size*)))
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbiset-pair-block-of-sbitset-singleton-pair
      (equal (sbitset-pair-block (sbitset-singleton-pair a))
        (expt <span class="number">2</span>
          (mod (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> a)
            *sbitset-block-size*))))))</pre>
  </div>

<div class="form-block other" id="form-43" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define sbitset-singleton
  ((a <a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> <span class="keyword">:type</span> unsigned-byte))
  <span class="keyword">:parents</span> (sbitsets)
  <span class="keyword">:short</span> <span class="string">"@(call sbitset-singleton) constructs the singleton set @(&#39;{a}&#39;)."</span>
  <span class="keyword">:split-types</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  <span class="keyword">:returns</span> (sbitset sbitsetp)
  (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> (sbitset-singleton-pair a))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../arithmetic-3/bind-free/top.html" title="Open arithmetic-3/bind-free/top">"arithmetic-3/bind-free/top"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l0
      (equal (in a
          (sbitset-members (sbitset-singleton b)))
        (equal a (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> b)))
      <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:use</span> ((<span class="keyword">:instance</span> niq-lemma
            (c (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> b))
            (a <span class="number">60</span>)
            (b a)))
         <span class="keyword">:in-theory</span> (<a class="sym-link system" href="../../../axioms.html#def-e_2Fd" data-sym="E/D">e/d</a> (mod)
           (niq-lemma mod-blocksize-nonsense))))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-members-of-sbitset-singleton
    (equal (sbitset-members (sbitset-singleton a))
      (insert (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> a) nil))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (disable sbitset-singleton)))))</pre>
  </div>

<div class="form-block other" id="form-44" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-blockp-of-logior
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-blockp x))
        (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-blockp y)))
      (sbitset-blockp (<a class="sym-link system" href="../../../axioms.html#def-logior" data-sym="LOGIOR">logior</a> x y)))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (<a class="sym-link system" href="../../../axioms.html#def-e_2Fd" data-sym="E/D">e/d</a> (sbitset-blockp)
         (upper-bound-of-logior-for-naturals))
       <span class="keyword">:use</span> ((<span class="keyword">:instance</span> upper-bound-of-logior-for-naturals
          (x x)
          (y y)
          (n *sbitset-block-size*)))))))</pre>
  </div>

<div class="form-block other" id="form-45" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> equal-of-sbitset-pair
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-pairp x))
      (equal (equal (sbitset-pair offset block)
          x)
        (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal offset
            (sbitset-pair-offset x))
          (equal block (sbitset-pair-block x)))))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable sbitset-pair
         sbitset-pairp
         sbitset-pair-offset
         sbitset-pair-block)))))</pre>
  </div>

<div class="form-block other" id="form-46" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> lower-bound-of-first-offset-of-sbitset-find
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitset-find b x)
        (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> b a)
        (sbitsetp x))
      (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> (sbitset-pair-offset (car x))
        a))
    <span class="keyword">:rule-classes</span> ((<span class="keyword">:rewrite</span>) (<span class="keyword">:linear</span>))
    <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:in-theory</span> (enable sbitset-find)
       <span class="keyword">:do-not</span> '(generalize fertilize)))))</pre>
  </div>

<div class="form-block other" id="form-47" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection sbitset-union
  <span class="keyword">:parents</span> (sbitsets)
  <span class="keyword">:short</span> <span class="string">"@(&#39;(sbitset-union X Y ...)&#39;) constructs the set @(&#39;X U Y U ...&#39;)."</span>
  <span class="keyword">:long</span> <span class="string">"@(def sbitset-union)"</span>
  (define sbitset-union-exec
    ((x sbitsetp) (y sbitsetp))
    <span class="keyword">:measure</span> (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> x) (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> y))
    (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)) y) ((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> y)) x)
        (x1 (car x))
        (y1 (car y))
        ((<a class="sym-link system" href="../../../axioms.html#def-the" data-sym="THE">the</a> unsigned-byte x1.offset) (sbitset-pair-offset x1))
        ((<a class="sym-link system" href="../../../axioms.html#def-the" data-sym="THE">the</a> unsigned-byte y1.offset) (sbitset-pair-offset y1))
        ((when (&lt; x1.offset y1.offset)) (cons x1
            (sbitset-union-exec (cdr x) y)))
        ((unless (<a class="sym-link system" href="../../../axioms.html#def-eql" data-sym="EQL">eql</a> x1.offset y1.offset)) (cons y1
            (sbitset-union-exec x (cdr y))))
        (x1.block (sbitset-pair-block x1))
        (y1.block (sbitset-pair-block y1))
        (new-block (<a class="sym-link local-def" href="#def-the-sbitset-block" data-sym="THE-SBITSET-BLOCK" title="(defmacro bitsets::the-sbitset-block (bitsets::x)
  `(the (unsigned-byte ,bitsets::*sbitset-block-size*) ,bitsets::x))">the-sbitset-block</a> (<a class="sym-link system" href="../../../axioms.html#def-logior" data-sym="LOGIOR">logior</a> (<a class="sym-link local-def" href="#def-the-sbitset-block" data-sym="THE-SBITSET-BLOCK" title="(defmacro bitsets::the-sbitset-block (bitsets::x)
  `(the (unsigned-byte ,bitsets::*sbitset-block-size*) ,bitsets::x))">the-sbitset-block</a> x1.block)
              (<a class="sym-link local-def" href="#def-the-sbitset-block" data-sym="THE-SBITSET-BLOCK" title="(defmacro bitsets::the-sbitset-block (bitsets::x)
  `(the (unsigned-byte ,bitsets::*sbitset-block-size*) ,bitsets::x))">the-sbitset-block</a> y1.block))))
        (new-pair (sbitset-pair x1.offset
            new-block)))
      (cons new-pair
        (sbitset-union-exec (cdr x)
          (cdr y)))))
  (define sbitset-binary-union
    ((x sbitsetp) (y sbitsetp))
    <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
    (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (sbitset-union-exec (sbitset-fix x)
        (sbitset-fix y))
      <span class="keyword">:exec</span> (sbitset-union-exec x y)))
  (<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> sbitset-union
    (&amp;rest <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)
    (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>) nil)
      ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> (cdr <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)) (car <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>))
      (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../../axioms.html#def-xxxjoin" data-sym="XXXJOIN">xxxjoin</a> 'sbitset-binary-union
          <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>))))
  (<a class="sym-link system" href="../../../axioms.html#def-add-macro-alias" data-sym="ADD-MACRO-ALIAS">add-macro-alias</a> sbitset-union
    sbitset-binary-union$inline)
  (<a class="sym-link system" href="../../../axioms.html#def-add-macro-fn" data-sym="ADD-MACRO-FN">add-macro-fn</a> sbitset-union
    sbitset-binary-union$inline
    <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable sbitset-union-exec
        sbitset-union)))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> c0
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (&lt; a (sbitset-pair-offset x1))
          (&lt; a
            (sbitset-pair-offset (car y2)))
          (sbitset-pairp x1)
          (sbitsetp y2))
        (&lt; a
          (sbitset-pair-offset (car (sbitset-union-exec (cons x1 x2)
                y2)))))
      <span class="keyword">:rule-classes</span> ((<span class="keyword">:rewrite</span>) (<span class="keyword">:linear</span>))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> c1
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (&lt; a (sbitset-pair-offset y1))
          (&lt; a
            (sbitset-pair-offset (car x2)))
          (sbitsetp x2)
          (sbitset-pairp y1))
        (&lt; a
          (sbitset-pair-offset (car (sbitset-union-exec x2
                (cons y1 y2))))))
      <span class="keyword">:rule-classes</span> ((<span class="keyword">:rewrite</span>) (<span class="keyword">:linear</span>))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> c2
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (&lt; a
            (sbitset-pair-offset (car x2)))
          (&lt; a
            (sbitset-pair-offset (car y2)))
          (sbitset-pairp x1)
          (sbitsetp y2))
        (&lt; a
          (sbitset-pair-offset (car (sbitset-union-exec x2 y2)))))
      <span class="keyword">:rule-classes</span> ((<span class="keyword">:rewrite</span>) (<span class="keyword">:linear</span>))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitsetp-of-sbitset-union-exec
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x)
        (sbitsetp y))
      (sbitsetp (sbitset-union-exec x y)))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> (sbitset-union-exec x y)
       <span class="keyword">:do-not</span> '(generalize fertilize))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l0
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x)
          (sbitsetp y))
        (<a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a> (sbitset-find offset
            (sbitset-union-exec x y))
          (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (sbitset-find offset x)
            (sbitset-find offset y))))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> (sbitset-union-exec x y)
         <span class="keyword">:in-theory</span> (enable sbitset-union-exec)))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> m0
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x)
          (sbitsetp y))
        (equal (sbitset-find offset
            (sbitset-union-exec x y))
          (<a class="sym-link system" href="../../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((|X[OFFSET]| (sbitset-find offset x)) (|Y[OFFSET]| (sbitset-find offset y)))
            (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> |X[OFFSET]| |Y[OFFSET]|) (sbitset-pair offset
                  (<a class="sym-link system" href="../../../axioms.html#def-logior" data-sym="LOGIOR">logior</a> (sbitset-pair-block |X[OFFSET]|)
                    (sbitset-pair-block |Y[OFFSET]|))))
              (|X[OFFSET]|)
              (|Y[OFFSET]|)
              (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> nil)))))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> (sbitset-union-exec x y)
         <span class="keyword">:in-theory</span> (enable sbitset-union-exec
           sbitset-find)
         <span class="keyword">:do-not</span> '(generalize fertilize)))))
  (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (disable sbitset-union-exec))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> m1
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x)
          (sbitsetp y))
        (equal (in a
            (sbitset-members (sbitset-union-exec x y)))
          (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (in a (sbitset-members x))
            (in a (sbitset-members y)))))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-members-of-sbitset-union-exec
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x)
          (sbitsetp y))
        (equal (sbitset-members (sbitset-union-exec x y))
          (union (sbitset-members x)
            (sbitset-members y))))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable sbitset-union)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-of-sbitset-union
    (sbitsetp (sbitset-union x y)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-members-of-sbitset-union
    (equal (sbitset-members (sbitset-union x y))
      (union (sbitset-members x)
        (sbitset-members y)))))</pre>
  </div>

<div class="form-block other" id="form-48" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-blockp-of-logand
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-blockp x))
        (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-blockp y)))
      (equal (sbitset-blockp (<a class="sym-link system" href="../../../axioms.html#def-logand" data-sym="LOGAND">logand</a> x y))
        (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> (<a class="sym-link system" href="../../../axioms.html#def-logand" data-sym="LOGAND">logand</a> x y)))))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (<a class="sym-link system" href="../../../axioms.html#def-e_2Fd" data-sym="E/D">e/d</a> (sbitset-blockp)
         (unsigned-byte-p-of-logand-1 unsigned-byte-p-of-logand-2))
       <span class="keyword">:use</span> ((<span class="keyword">:instance</span> unsigned-byte-p-of-logand-1
          (x x)
          (y y)
          (n *sbitset-block-size*)))))))</pre>
  </div>

<div class="form-block other" id="form-49" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection sbitset-intersect
  <span class="keyword">:parents</span> (sbitsets)
  <span class="keyword">:short</span> <span class="string">"@(&#39;(sbitset-intersect X Y ...)&#39;) constructs the set @(&#39;X \intersect Y
\intersect ...&#39;)."</span>
  <span class="keyword">:long</span> <span class="string">"@(def sbitset-intersect)"</span>
  (define sbitset-intersect-exec
    ((x sbitsetp) (y sbitsetp))
    <span class="keyword">:measure</span> (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> x) (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> y))
    (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)) nil) ((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> y)) nil)
        (x1 (car x))
        (y1 (car y))
        ((<a class="sym-link system" href="../../../axioms.html#def-the" data-sym="THE">the</a> unsigned-byte x1.offset) (sbitset-pair-offset x1))
        ((<a class="sym-link system" href="../../../axioms.html#def-the" data-sym="THE">the</a> unsigned-byte y1.offset) (sbitset-pair-offset y1))
        ((when (&lt; x1.offset y1.offset)) (sbitset-intersect-exec (cdr x)
            y))
        ((unless (<a class="sym-link system" href="../../../axioms.html#def-eql" data-sym="EQL">eql</a> x1.offset y1.offset)) (sbitset-intersect-exec x
            (cdr y)))
        (x1.block (sbitset-pair-block x1))
        (y1.block (sbitset-pair-block y1))
        (new-block (<a class="sym-link local-def" href="#def-the-sbitset-block" data-sym="THE-SBITSET-BLOCK" title="(defmacro bitsets::the-sbitset-block (bitsets::x)
  `(the (unsigned-byte ,bitsets::*sbitset-block-size*) ,bitsets::x))">the-sbitset-block</a> (<a class="sym-link system" href="../../../axioms.html#def-logand" data-sym="LOGAND">logand</a> (<a class="sym-link local-def" href="#def-the-sbitset-block" data-sym="THE-SBITSET-BLOCK" title="(defmacro bitsets::the-sbitset-block (bitsets::x)
  `(the (unsigned-byte ,bitsets::*sbitset-block-size*) ,bitsets::x))">the-sbitset-block</a> x1.block)
              (<a class="sym-link local-def" href="#def-the-sbitset-block" data-sym="THE-SBITSET-BLOCK" title="(defmacro bitsets::the-sbitset-block (bitsets::x)
  `(the (unsigned-byte ,bitsets::*sbitset-block-size*) ,bitsets::x))">the-sbitset-block</a> y1.block))))
        ((when (<a class="sym-link system" href="../../../axioms.html#def-eql" data-sym="EQL">eql</a> <span class="number">0</span> (<a class="sym-link local-def" href="#def-the-sbitset-block" data-sym="THE-SBITSET-BLOCK" title="(defmacro bitsets::the-sbitset-block (bitsets::x)
  `(the (unsigned-byte ,bitsets::*sbitset-block-size*) ,bitsets::x))">the-sbitset-block</a> new-block))) (sbitset-intersect-exec (cdr x)
            (cdr y)))
        (new-pair (sbitset-pair x1.offset
            new-block)))
      (cons new-pair
        (sbitset-intersect-exec (cdr x)
          (cdr y)))))
  (define sbitset-binary-intersect
    ((x sbitsetp) (y sbitsetp))
    <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
    (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (sbitset-intersect-exec (sbitset-fix x)
        (sbitset-fix y))
      <span class="keyword">:exec</span> (sbitset-intersect-exec x y)))
  (<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> sbitset-intersect
    (&amp;rest <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)
    (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>) nil)
      ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> (cdr <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)) (car <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>))
      (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../../axioms.html#def-xxxjoin" data-sym="XXXJOIN">xxxjoin</a> 'sbitset-binary-intersect
          <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>))))
  (<a class="sym-link system" href="../../../axioms.html#def-add-macro-alias" data-sym="ADD-MACRO-ALIAS">add-macro-alias</a> sbitset-intersect
    sbitset-binary-intersect$inline)
  (<a class="sym-link system" href="../../../axioms.html#def-add-macro-fn" data-sym="ADD-MACRO-FN">add-macro-fn</a> sbitset-intersect
    sbitset-binary-intersect$inline
    <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable sbitset-intersect-exec
        sbitset-intersect)))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> c0
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitset-intersect-exec x2 y2)
          (&lt; (sbitset-pair-offset x1)
            (sbitset-pair-offset (car y2)))
          (sbitset-pairp x1)
          (sbitsetp x2)
          (sbitset-pairp y1)
          (sbitsetp y2))
        (&lt; (sbitset-pair-offset x1)
          (sbitset-pair-offset (car (sbitset-intersect-exec x2 y2)))))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitsetp-of-sbitset-intersect-exec
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x)
        (sbitsetp y))
      (sbitsetp (sbitset-intersect-exec x y)))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> (sbitset-intersect-exec x y)
       <span class="keyword">:do-not</span> '(generalize fertilize))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l0
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x)
          (sbitsetp y))
        (<a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a> (sbitset-find offset
            (sbitset-intersect-exec x y))
          (let ((a (sbitset-find offset x)) (b (sbitset-find offset y)))
            (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> a
              b
              (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> (<a class="sym-link system" href="../../../axioms.html#def-logand" data-sym="LOGAND">logand</a> (sbitset-pair-block a)
                    (sbitset-pair-block b))))))))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> (sbitset-intersect-exec x y)
         <span class="keyword">:in-theory</span> (enable sbitset-intersect-exec)))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> m0
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x)
          (sbitsetp y))
        (equal (sbitset-find offset
            (sbitset-intersect-exec x y))
          (<a class="sym-link system" href="../../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((a (sbitset-find offset x)) (b (sbitset-find offset y))
              (new-block (<a class="sym-link system" href="../../../axioms.html#def-logand" data-sym="LOGAND">logand</a> (sbitset-pair-block a)
                  (sbitset-pair-block b))))
            (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> a
              b
              (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> new-block))
              (sbitset-pair offset new-block)))))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> (sbitset-intersect-exec x y)
         <span class="keyword">:in-theory</span> (enable sbitset-intersect-exec
           sbitset-find)
         <span class="keyword">:do-not</span> '(generalize fertilize)))))
  (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (disable sbitset-intersect-exec))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> n0
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (logbitp a x)
          (equal (<a class="sym-link system" href="../../../axioms.html#def-logand" data-sym="LOGAND">logand</a> x y) <span class="number">0</span>))
        (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (logbitp a y)))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (disable logbitp-of-logand)
         <span class="keyword">:use</span> ((<span class="keyword">:instance</span> logbitp-of-logand
            (a a)
            (x x)
            (y y)))))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> m1
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x)
          (sbitsetp y))
        (equal (in a
            (sbitset-members (sbitset-intersect-exec x y)))
          (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (in a (sbitset-members x))
            (in a (sbitset-members y)))))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-members-of-sbitset-intersect-exec
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x)
          (sbitsetp y))
        (equal (sbitset-members (sbitset-intersect-exec x y))
          (intersect (sbitset-members x)
            (sbitset-members y))))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (disable (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a>))))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable sbitset-intersect)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-of-sbitset-intersect
    (sbitsetp (sbitset-intersect x y)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-members-of-sbitset-intersect
    (equal (sbitset-members (sbitset-intersect x y))
      (intersect (sbitset-members x)
        (sbitset-members y)))))</pre>
  </div>

<div class="form-block other" id="form-50" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-blockp-of-logandc2
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-blockp x))
        (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a> (sbitset-blockp y)))
      (equal (sbitset-blockp (<a class="sym-link system" href="../../../axioms.html#def-logand" data-sym="LOGAND">logand</a> x (lognot y)))
        (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> (<a class="sym-link system" href="../../../axioms.html#def-logand" data-sym="LOGAND">logand</a> x (lognot y))))))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (<a class="sym-link system" href="../../../axioms.html#def-e_2Fd" data-sym="E/D">e/d</a> (sbitset-blockp)
         (unsigned-byte-p-of-logand-1 unsigned-byte-p-of-logand-2))
       <span class="keyword">:use</span> ((<span class="keyword">:instance</span> unsigned-byte-p-of-logand-1
          (x x)
          (y (lognot y))
          (n *sbitset-block-size*)))))))</pre>
  </div>

<div class="form-block other" id="form-51" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define sbitset-difference
  ((x sbitsetp) (y sbitsetp))
  <span class="keyword">:returns</span> sbitset
  <span class="keyword">:parents</span> (sbitsets)
  <span class="keyword">:short</span> <span class="string">"@(&#39;(sbitset-difference X Y)&#39;) constructs the set @(&#39;X - Y&#39;)."</span>
  <span class="keyword">:prepwork</span> ((define sbitset-difference-exec
     ((x sbitsetp) (y sbitsetp))
     <span class="keyword">:measure</span> (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> x) (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> y))
     (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)) nil) ((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> y)) x)
         (x1 (car x))
         (y1 (car y))
         ((<a class="sym-link system" href="../../../axioms.html#def-the" data-sym="THE">the</a> unsigned-byte x1.offset) (sbitset-pair-offset x1))
         ((<a class="sym-link system" href="../../../axioms.html#def-the" data-sym="THE">the</a> unsigned-byte y1.offset) (sbitset-pair-offset y1))
         ((when (&lt; x1.offset y1.offset)) (cons (car x)
             (sbitset-difference-exec (cdr x)
               y)))
         ((unless (<a class="sym-link system" href="../../../axioms.html#def-eql" data-sym="EQL">eql</a> x1.offset y1.offset)) (sbitset-difference-exec x
             (cdr y)))
         (x1.block (sbitset-pair-block x1))
         (y1.block (sbitset-pair-block y1))
         (new-block (<a class="sym-link local-def" href="#def-the-sbitset-block" data-sym="THE-SBITSET-BLOCK" title="(defmacro bitsets::the-sbitset-block (bitsets::x)
  `(the (unsigned-byte ,bitsets::*sbitset-block-size*) ,bitsets::x))">the-sbitset-block</a> (<a class="sym-link system" href="../../../axioms.html#def-logandc2" data-sym="LOGANDC2">logandc2</a> (<a class="sym-link local-def" href="#def-the-sbitset-block" data-sym="THE-SBITSET-BLOCK" title="(defmacro bitsets::the-sbitset-block (bitsets::x)
  `(the (unsigned-byte ,bitsets::*sbitset-block-size*) ,bitsets::x))">the-sbitset-block</a> x1.block)
               (<a class="sym-link local-def" href="#def-the-sbitset-block" data-sym="THE-SBITSET-BLOCK" title="(defmacro bitsets::the-sbitset-block (bitsets::x)
  `(the (unsigned-byte ,bitsets::*sbitset-block-size*) ,bitsets::x))">the-sbitset-block</a> y1.block))))
         ((when (<a class="sym-link system" href="../../../axioms.html#def-eql" data-sym="EQL">eql</a> <span class="number">0</span> (<a class="sym-link local-def" href="#def-the-sbitset-block" data-sym="THE-SBITSET-BLOCK" title="(defmacro bitsets::the-sbitset-block (bitsets::x)
  `(the (unsigned-byte ,bitsets::*sbitset-block-size*) ,bitsets::x))">the-sbitset-block</a> new-block))) (sbitset-difference-exec (cdr x)
             (cdr y)))
         (new-pair (sbitset-pair x1.offset
             new-block)))
       (cons new-pair
         (sbitset-difference-exec (cdr x)
           (cdr y))))))
  <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (sbitset-difference-exec (sbitset-fix x)
      (sbitset-fix y))
    <span class="keyword">:exec</span> (sbitset-difference-exec x y))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable sbitset-difference-exec)))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> c1
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (&lt; a
            (sbitset-pair-offset (car x2)))
          (&lt; a
            (sbitset-pair-offset (car y2)))
          (sbitset-difference-exec x2 y2)
          (sbitsetp x2)
          (sbitsetp y2))
        (&lt; a
          (sbitset-pair-offset (car (sbitset-difference-exec x2 y2)))))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitsetp-of-sbitset-difference-exec
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x)
        (sbitsetp y))
      (sbitsetp (sbitset-difference-exec x y)))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> (sbitset-difference-exec x y)
       <span class="keyword">:do-not</span> '(generalize fertilize))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l0
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x)
          (sbitsetp y))
        (<a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a> (sbitset-find offset
            (sbitset-difference-exec x y))
          (<a class="sym-link system" href="../../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((a (sbitset-find offset x)) (b (sbitset-find offset y))
              (new-block (<a class="sym-link system" href="../../../axioms.html#def-logandc2" data-sym="LOGANDC2">logandc2</a> (sbitset-pair-block a)
                  (sbitset-pair-block b))))
            (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> a
              (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> b) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> new-block)))))))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> (sbitset-difference-exec x y)
         <span class="keyword">:in-theory</span> (enable sbitset-difference-exec)))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> m0
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x)
          (sbitsetp y))
        (equal (sbitset-find offset
            (sbitset-difference-exec x y))
          (<a class="sym-link system" href="../../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((a (sbitset-find offset x)) (b (sbitset-find offset y))
              (new-block (<a class="sym-link system" href="../../../axioms.html#def-logandc2" data-sym="LOGANDC2">logandc2</a> (sbitset-pair-block a)
                  (sbitset-pair-block b))))
            (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> a
              (if (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> b)
                a
                (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> new-block))
                  (sbitset-pair offset new-block)))))))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> (sbitset-difference-exec x y)
         <span class="keyword">:in-theory</span> (enable sbitset-difference-exec
           sbitset-find)
         <span class="keyword">:do-not</span> '(generalize fertilize)))))
  (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (disable sbitset-difference-exec))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> n0
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal (<a class="sym-link system" href="../../../axioms.html#def-logand" data-sym="LOGAND">logand</a> x (lognot y)) <span class="number">0</span>)
          (logbitp a x))
        (logbitp a y))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (disable logbitp-of-logand)
         <span class="keyword">:use</span> ((<span class="keyword">:instance</span> logbitp-of-logand
            (a a)
            (x x)
            (y (lognot y))))))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> m1
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x)
          (sbitsetp y))
        (equal (in a
            (sbitset-members (sbitset-difference-exec x y)))
          (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (in a (sbitset-members x))
            (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (in a (sbitset-members y))))))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-members-of-sbitset-difference-exec
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (sbitsetp x)
          (sbitsetp y))
        (equal (sbitset-members (sbitset-difference-exec x y))
          (difference (sbitset-members x)
            (sbitset-members y))))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (disable (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a>))))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable sbitset-difference)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-of-sbitset-difference
    (sbitsetp (sbitset-difference x y)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> sbitset-members-of-sbitset-difference
    (equal (sbitset-members (sbitset-difference x y))
      (difference (sbitset-members x)
        (sbitset-members y)))))</pre>
  </div>


  </main>
  
<script>
// ACL2 Book HTML Documentation - Interactive Features
// Generated by cert2 - build2 system

// State
let activeFilter = null;
let activePartFilter = null;
let activeNameFilter = null;
let currentFontSize = 14;

// Theme management
function getStoredTheme() {
  return localStorage.getItem('acl2-theme') || 'dark';
}

function setTheme(theme) {
  if (theme === 'light') {
    document.documentElement.setAttribute('data-theme', 'light');
    document.getElementById('theme-toggle').textContent = '🌙';
  } else {
    document.documentElement.removeAttribute('data-theme');
    document.getElementById('theme-toggle').textContent = '☀️';
  }
  localStorage.setItem('acl2-theme', theme);
}

function toggleTheme() {
  const current = getStoredTheme();
  setTheme(current === 'dark' ? 'light' : 'dark');
}

// Font size management
function getStoredFontSize() {
  return parseInt(localStorage.getItem('acl2-fontsize') || '14', 10);
}

function setFontSize(size) {
  size = Math.max(10, Math.min(24, size)); // Clamp between 10-24
  currentFontSize = size;
  document.body.style.fontSize = size + 'px';
  localStorage.setItem('acl2-fontsize', size.toString());
}

function increaseFontSize() {
  setFontSize(currentFontSize + 2);
}

function decreaseFontSize() {
  setFontSize(currentFontSize - 2);
}

// Get all form blocks
function getFormBlocks() {
  return document.querySelectorAll('.form-block');
}

// Clear all filters
function clearFilter() {
  activeFilter = null;
  activePartFilter = null;
  activeNameFilter = null;
  getFormBlocks().forEach(b => {
    b.classList.remove('hidden', 'dimmed');
  });
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  const status = document.querySelector('.filter-status');
  status.classList.remove('active');
  // Slide name filter back to original position
  document.querySelector('.controls-left').style.transform = '';
  // Clear the name filter input
  const nameInput = document.getElementById('name-filter');
  if (nameInput) nameInput.value = '';
}

// Show filter status and slide name filter right
function showFilterStatus(text) {
  const status = document.querySelector('.filter-status');
  status.classList.add('active');
  status.querySelector('.filter-text').textContent = text;
  // Slide name filter to the right to make room
  setTimeout(() => {
    const statusWidth = status.offsetWidth;
    document.querySelector('.controls-left').style.transform = `translateX(${statusWidth + 15}px)`;
  }, 10);
}

// Filter to show only forms that define or reference a symbol
function filterBySymbol(symName, showUsedBy) {
  clearFilter();
  activeFilter = symName;
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines;
    const references = (block.dataset.references || '').split(',');
    const usedBy = (block.dataset.usedBy || '').split(',');
    
    let show = false;
    if (showUsedBy) {
      // Show forms that USE this symbol
      show = references.includes(symName) || definesName === symName;
    } else {
      // Show forms that this symbol USES
      show = usedBy.includes(symName) || definesName === symName;
    }
    
    if (show) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering by: ${symName} (${visibleCount} items)`);
}

// Filter by defthm part (term, hints, rule-classes, etc.)
function filterByPart(formId, partName) {
  clearFilter();
  activePartFilter = { formId, partName };
  
  // Get the part's referenced symbols
  // data-part-term becomes dataset.partTerm, data-part-hints becomes dataset.partHints, etc.
  const block = document.getElementById(formId);
  const datasetKey = 'part' + partName.charAt(0).toUpperCase() + partName.slice(1).replace(/-([a-z])/g, (g) => g[1].toUpperCase());
  const partData = block.dataset[datasetKey];
  if (!partData) return;
  
  const partSyms = partData.split(',').filter(s => s);
  
  // Highlight the button
  block.querySelector(`.part-btn[data-part="${partName}"]`).classList.add('active');
  
  // Hide forms not referenced by this part
  getFormBlocks().forEach(b => {
    const definesName = b.dataset.defines;
    if (b.id === formId || partSyms.includes(definesName)) {
      b.classList.remove('hidden');
    } else {
      b.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering ${formId} :${partName} (${partSyms.length} references)`);
}

// Filter by name (substring or regex)
function filterByName(pattern, useRegex) {
  // Clear other filters but keep the input value
  activeFilter = null;
  activePartFilter = null;
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  
  if (!pattern || pattern.trim() === '') {
    // Empty pattern - show all
    activeNameFilter = null;
    getFormBlocks().forEach(b => b.classList.remove('hidden'));
    const status = document.querySelector('.filter-status');
    status.classList.remove('active');
    document.querySelector('.controls-left').style.transform = '';
    return;
  }
  
  activeNameFilter = pattern;
  
  let matcher;
  let isValidRegex = true;
  
  if (useRegex) {
    try {
      matcher = new RegExp(pattern, 'i');
    } catch (e) {
      // Invalid regex - show error in status and don't filter
      showFilterStatus(`Invalid regex: ${e.message}`);
      return;
    }
  } else {
    // Plain substring match (case-insensitive)
    const lowerPattern = pattern.toLowerCase();
    matcher = { test: (s) => s.toLowerCase().includes(lowerPattern) };
  }
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines || '';
    if (matcher.test(definesName)) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  const modeText = useRegex ? 'regex' : 'name';
  showFilterStatus(`Filtering by ${modeText}: "${pattern}" (${visibleCount} matches)`);
}

// Click on a name to show what references it
function handleNameClick(symName) {
  if (activeFilter === symName) {
    clearFilter();
  } else {
    filterBySymbol(symName, true);
  }
}

// Navigate to a definition (same file or different)
function navigateTo(symName, file) {
  if (file) {
    // External file - navigate
    window.location.href = file + '.html#def-' + symName.toLowerCase();
  } else {
    // Same file - scroll
    const target = document.getElementById('def-' + symName.toLowerCase());
    if (target) {
      target.scrollIntoView({ behavior: 'smooth', block: 'center' });
      target.classList.add('highlight');
      setTimeout(() => target.classList.remove('highlight'), 400);
    }
  }
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  // Part buttons
  document.querySelectorAll('.part-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const formId = btn.closest('.form-block').id;
      const partName = btn.dataset.part;
      if (activePartFilter && activePartFilter.formId === formId && 
          activePartFilter.partName === partName) {
        clearFilter();
      } else {
        filterByPart(formId, partName);
      }
    });
  });
  
  // Clear filter button
  document.querySelector('.clear-filter').addEventListener('click', clearFilter);
  
  // Name filter input
  const nameFilter = document.getElementById('name-filter');
  const regexToggle = document.getElementById('regex-toggle');
  
  let filterTimeout = null;
  nameFilter.addEventListener('input', () => {
    // Debounce the filter to avoid excessive updates while typing
    clearTimeout(filterTimeout);
    filterTimeout = setTimeout(() => {
      filterByName(nameFilter.value, regexToggle.checked);
    }, 150);
  });
  
  // Re-filter when regex toggle changes
  regexToggle.addEventListener('change', () => {
    if (nameFilter.value) {
      filterByName(nameFilter.value, regexToggle.checked);
    }
  });
  
  // Allow Escape key to clear filter when in input
  nameFilter.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      clearFilter();
      nameFilter.blur();
    }
  });
  
  // Symbol references (old span-based refs)
  document.querySelectorAll('.sym-ref').forEach(ref => {
    ref.addEventListener('click', (e) => {
      e.stopPropagation();
      const sym = ref.dataset.sym;
      const file = ref.dataset.file;
      if (file) {
        navigateTo(sym, file);
      } else {
        handleNameClick(sym);
      }
    });
  });
  
  // Symbol links (new anchor-based links)
  // These use standard <a> tags so navigation happens automatically
  // But we need to clear filters if target would be hidden
  document.querySelectorAll('.sym-link').forEach(link => {
    link.addEventListener('click', (e) => {
      const href = link.getAttribute('href');
      if (href && href.startsWith('#')) {
        // Local link - check if target is hidden by filter
        const targetId = href.substring(1);
        const target = document.getElementById(targetId);
        if (target) {
          // If target is hidden, clear the filter first
          if (target.classList.contains('hidden')) {
            clearFilter();
          }
          // Add highlight effect after a short delay
          setTimeout(() => {
            target.classList.add('highlight');
            setTimeout(() => target.classList.remove('highlight'), 400);
          }, 100);
        }
      }
      // For external links, default behavior handles navigation
    });
  });
  
  // Form names (show what uses them)
  document.querySelectorAll('.form-name').forEach(name => {
    name.addEventListener('click', (e) => {
      handleNameClick(name.dataset.sym);
    });
  });
  
  // Handle hash navigation (when arriving at page with #anchor)
  if (window.location.hash) {
    const target = document.querySelector(window.location.hash);
    if (target) {
      setTimeout(() => {
        target.scrollIntoView({ behavior: 'smooth', block: 'center' });
        target.classList.add('highlight');
        setTimeout(() => target.classList.remove('highlight'), 400);
      }, 200);
    }
  }
  
  // Initialize theme from storage
  setTheme(getStoredTheme());
  
  // Initialize font size from storage
  currentFontSize = getStoredFontSize();
  setFontSize(currentFontSize);
  
  // Theme toggle button
  document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
  
  // Font size buttons
  document.getElementById('font-larger').addEventListener('click', increaseFontSize);
  document.getElementById('font-smaller').addEventListener('click', decreaseFontSize);
});

</script>

</body>
</html>
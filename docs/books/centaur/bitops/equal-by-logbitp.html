<!DOCTYPE html>
<html lang="en" vocab="http://schema.org/" typeof="SoftwareSourceCode">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>equal-by-logbitp - ACL2 Book</title>
  <meta property="name" content="equal-by-logbitp">
  <meta property="programmingLanguage" content="ACL2">
  
<style>
/* ACL2 Book HTML Documentation Styles */
/* Generated by cert2 - build2 system */

/* Dark theme (default) */
:root {
  --bg: #1e1e2e;
  --fg: #cdd6f4;
  --comment: #6c7086;
  --keyword: #cba6f7;
  --string: #a6e3a1;
  --function: #89b4fa;
  --type: #f9e2af;
  --link: #89dceb;
  --link-hover: #f5c2e7;
  --highlight: rgba(137, 180, 250, 0.2);
  --border: #313244;
  --block-bg: rgba(49, 50, 68, 0.5);
  --btn-bg: #313244;
  --btn-hover: rgba(137, 180, 250, 0.2);
}

/* Light theme */
[data-theme="light"] {
  --bg: #eff1f5;
  --fg: #4c4f69;
  --comment: #6c6f85;
  --keyword: #8839ef;
  --string: #40a02b;
  --function: #1e66f5;
  --type: #df8e1d;
  --link: #04a5e5;
  --link-hover: #ea76cb;
  --highlight: rgba(30, 102, 245, 0.15);
  --border: #ccd0da;
  --block-bg: rgba(204, 208, 218, 0.3);
  --btn-bg: #ccd0da;
  --btn-hover: rgba(30, 102, 245, 0.15);
}

body {
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  background: var(--bg);
  color: var(--fg);
  margin: 0;
  padding: 20px;
  line-height: 1.6;
  font-size: 14px;
  transition: background 0.1s, color 0.1s;
}

/* Controls toolbar */
.controls-left {
  position: fixed;
  top: 10px;
  left: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
  transition: transform 0.1s ease;
}

.controls-right {
  position: fixed;
  top: 10px;
  right: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
}

.control-btn {
  padding: 6px 12px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-family: inherit;
  font-size: 14px;
  transition: all 0.1s;
}

.control-btn:hover {
  background: var(--btn-hover);
  border-color: var(--link);
}

.name-filter {
  padding: 6px 10px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  font-family: inherit;
  font-size: 13px;
  width: 150px;
  transition: all 0.1s;
}

.name-filter:focus {
  outline: none;
  border-color: var(--link);
  width: 200px;
}

.name-filter::placeholder {
  color: var(--comment);
}

.regex-label {
  display: flex;
  align-items: center;
  gap: 4px;
  color: var(--comment);
  font-size: 12px;
  cursor: pointer;
}

.regex-label input {
  cursor: pointer;
}

.book-header {
  border-bottom: 2px solid var(--border);
  padding-bottom: 20px;
  margin-bottom: 20px;
}

.book-header h1 {
  color: var(--keyword);
  margin: 0;
}

.book-header .path {
  color: var(--comment);
  font-size: 0.9em;
}

.book-header .path .source-link {
  color: var(--comment);
  text-decoration: none;
}

.book-header .path .source-link:hover {
  color: var(--link);
  text-decoration: underline;
}

.form-block {
  margin: 10px 0;
  padding: 15px;
  background: var(--block-bg);
  border-radius: 8px;
  border-left: 3px solid var(--border);
}

.form-block.theorem { border-left-color: var(--keyword); }
.form-block.function { border-left-color: var(--function); }
.form-block.macro { border-left-color: var(--type); }
.form-block.include-book { border-left-color: var(--string); }

.form-block.hidden { display: none; }
.form-block.dimmed { opacity: 0.3; }

.form-block.highlight {
  animation: highlight-pulse 0.4s ease-out;
}

@keyframes highlight-pulse {
  0% { background: var(--highlight); box-shadow: 0 0 20px var(--link); }
  100% { background: rgba(49, 50, 68, 0.5); box-shadow: none; }
}

.form-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.form-name {
  color: var(--function);
  font-weight: bold;
  cursor: pointer;
}

.form-name:hover {
  color: var(--link-hover);
  text-decoration: underline;
}

.form-type {
  color: var(--comment);
  font-size: 0.85em;
}

pre.code {
  margin: 0;
  overflow-x: auto;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.sym-ref {
  color: var(--link);
  cursor: pointer;
  border-radius: 2px;
}

.sym-ref:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.sym-ref.local-def { color: var(--function); font-weight: bold; }
.sym-ref.external { color: var(--type); }

/* Symbol links (clickable hyperlinks) */
.sym-link {
  color: var(--link);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
  position: relative;
}

.sym-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

.sym-link.local-def {
  color: var(--function);
  font-weight: bold;
}

.sym-link.external {
  color: var(--type);
}

/* Tooltips using title attribute with custom styling */
.sym-link[title] {
  /* Browser will show title on hover */
}

/* Syntax highlighting in code blocks */
.keyword {
  color: var(--keyword);
}

.string {
  color: var(--string);
}

.number {
  color: #f77524; /* orange */
}

/* Include-book path links */
.include-path {
  color: var(--string);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
}

.include-path:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

/* Part buttons for defthm */
.part-buttons {
  display: flex;
  gap: 5px;
  margin: 10px 0;
  flex-wrap: wrap;
}

.part-btn {
  padding: 4px 10px;
  background: var(--border);
  border: 1px solid var(--comment);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-size: 0.85em;
  font-family: inherit;
}

.part-btn:hover {
  background: var(--highlight);
  border-color: var(--link);
}

.part-btn.active {
  background: var(--link);
  color: var(--bg);
  border-color: var(--link);
}

/* References panel */
.refs-panel {
  margin-top: 10px;
  padding: 10px;
  background: rgba(0,0,0,0.2);
  border-radius: 4px;
  display: none;
}

.refs-panel.visible { display: block; }

.refs-panel h4 {
  margin: 0 0 5px 0;
  color: var(--comment);
  font-size: 0.9em;
}

.refs-list {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

/* Included books section */
.includes-section {
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(49, 50, 68, 0.3);
  border-radius: 8px;
  border: 1px solid var(--border);
}

.includes-section h2 {
  margin: 0 0 10px 0;
  color: var(--comment);
  font-size: 1em;
  font-weight: normal;
}

.includes-list {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.include-link {
  padding: 6px 12px;
  background: var(--border);
  border-radius: 4px;
  color: var(--link);
  text-decoration: none;
  font-size: 0.9em;
  transition: all 0.1s;
}

.include-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.include-link.local {
  border-left: 2px solid var(--comment);
}

/* Filter status */
.filter-status {
  position: fixed;
  top: 10px;
  left: 20px;
  background: var(--bg);
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: 4px;
  z-index: 201;
  display: none;
  align-items: center;
  gap: 10px;
}

.filter-status.active {
  display: flex;
  align-items: center;
  gap: 10px;
}

.clear-filter {
  padding: 5px 15px;
  background: var(--keyword);
  color: var(--bg);
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

/* RDFa vocab indicator */
[vocab] { /* semantic web annotations present */ }

</style>

</head>
<body>
  <div class="controls-left">
    <input type="text" id="name-filter" class="name-filter" placeholder="Filter by name..." title="Filter definitions by name">
    <label class="regex-label"><input type="checkbox" id="regex-toggle"> regex</label>
  </div>

  <div class="controls-right">
    <button class="control-btn" id="theme-toggle" title="Toggle light/dark theme">☀️</button>
    <button class="control-btn" id="font-smaller" title="Decrease font size">A-</button>
    <button class="control-btn" id="font-larger" title="Increase font size">A+</button>
  </div>

  <div class="filter-status">
    <span class="filter-text">Filtering...</span>
    <button class="clear-filter">Clear Filter</button>
  </div>
  
  <div class="book-header">
    <h1 property="name">equal-by-logbitp</h1>
    <div class="path"><a href="equal-by-logbitp.lisp" class="source-link">books/centaur/bitops/equal-by-logbitp</a></div>
  </div>
  
  <main property="text">
<div class="form-block other" id="form-0" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-in-package" data-sym="IN-PACKAGE">in-package</a> <span class="string">"BITOPS"</span>)</pre>
  </div>

<div class="form-block other" id="form-1" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="logbitp-mismatch.html" title="Open logbitp-mismatch">"logbitp-mismatch"</a>)</pre>
  </div>

<div class="form-block other" id="form-2" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../clause-processors/witness-cp.html" title="Open clause-processors/witness-cp">"clause-processors/witness-cp"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block other" id="form-3" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../std/util/wizard.html" title="Open std/util/wizard">"std/util/wizard"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block other" id="form-4" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../std/basic/arith-equiv-defs.html" title="Open std/basic/arith-equiv-defs">"std/basic/arith-equiv-defs"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block other" id="form-5" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="ihsext-basics.html" title="Open ihsext-basics">"ihsext-basics"</a>))</pre>
  </div>

<div class="form-block other" id="form-6" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="integer-length.html" title="Open integer-length">"integer-length"</a>))</pre>
  </div>

<div class="form-block other" id="form-7" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../arithmetic/top-with-meta.html" title="Open arithmetic/top-with-meta">"arithmetic/top-with-meta"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>))</pre>
  </div>

<div class="form-block other" id="form-8" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable* arith-equiv-forwarding)))</pre>
  </div>

<div class="form-block other" id="form-9" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection bitops/equal-by-logbitp
  <span class="keyword">:parents</span> (bitops)
  <span class="keyword">:short</span> <span class="string">"Introduces @(&#39;equal-by-logbitp&#39;), a strategy for proving that @(&#39;a =
b&#39;) by showing that their bits are equal, and computed hints that can automate
the application of this strategy."</span>)</pre>
  </div>

<div class="form-block other" id="form-10" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> equal-of-logcdrs-when-equal-of-logcars
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (integerp i)
        (integerp j)
        (equal (logcar i)
          (logcar j)))
      (equal (equal (logcdr i)
          (logcdr j))
        (equal i j)))))</pre>
  </div>

<div class="form-block other" id="form-11" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> logbitp-of-increment
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> i) (integerp j))
      (equal (logbitp (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">1</span> i) j)
        (logbitp i (logcdr j))))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable logbitp**)))))</pre>
  </div>

<div class="form-block other" id="form-12" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> logcar-possibilities
    (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (equal (logcar a) <span class="number">0</span>)
      (equal (logcar a) <span class="number">1</span>))
    <span class="keyword">:rule-classes</span> ((<span class="keyword">:forward-chaining</span> <span class="keyword">:trigger-terms</span> ((logcar a))))))</pre>
  </div>

<div class="form-block other" id="form-13" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection equal-by-logbitp
  <span class="keyword">:parents</span> (bitops/equal-by-logbitp logbitp)
  <span class="keyword">:short</span> <span class="string">"Show @(&#39;a = b&#39;) by showing their bits are equal."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;@(&#39;Equal-by-logbitp&#39;) may be functionally instantiated to prove
@(&#39;(equal a b)&#39;) by showing that:&lt;/p&gt;

@({
 (equal (logbitp bit a) (logbitp bit b))
})

&lt;p&gt;for any arbitrary @(&#39;bit&#39;) less than the maximum @(see integer-length) of
@(&#39;a&#39;) or @(&#39;b&#39;), where @(&#39;a&#39;) and @(&#39;b&#39;) are known to be integers.&lt;/p&gt;

&lt;p&gt;This unusual (but occasionally useful) proof strategy is similar to the
&lt;i&gt;pick-a-point&lt;/i&gt; proofs found in the ordered sets or &lt;see topic=&quot;@(url
acl2::ubdds)&quot;&gt;ubdd&lt;/see&gt; libraries.&lt;/p&gt;

&lt;p&gt;There are a couple of ways to invoke the hint.  First, you might manually
appeal to the theorem using a hint such as:&lt;/p&gt;

@({
 :use ((:functional-instance equal-by-logbitp
         (logbitp-hyp (lambda () my-hyps))
         (logbitp-lhs (lambda () my-lhs))
         (logbitp-rhs (lambda () my-rhs))))
})

&lt;p&gt;But this can be irritating if your particular hyps, lhs, and rhs are large
or complex terms.  See the @(see equal-by-logbitp-hint) computed hint, which
can generate the appropriate @(&#39;:functional-instance&#39;) automatically.&lt;/p&gt;"</span>
  (<a class="sym-link system" href="../../../axioms.html#def-encapsulate" data-sym="ENCAPSULATE">encapsulate</a> (((logbitp-hyp) =&gt; <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a>) ((logbitp-lhs) =&gt; <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a>)
      ((logbitp-rhs) =&gt; <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a>))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> logbitp-hyp nil <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> logbitp-lhs nil <span class="number">0</span>))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> logbitp-rhs nil <span class="number">0</span>))
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> logbitp-constraint
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (logbitp-hyp)
          (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> bit)
          (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> bit
            (max (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> (logbitp-lhs))
              (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> (logbitp-rhs)))))
        (equal (logbitp bit (logbitp-lhs))
          (logbitp bit (logbitp-rhs))))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthmd" data-sym="DEFTHMD">defthmd</a> equal-by-logbitp
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (logbitp-hyp)
      (equal (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> (logbitp-lhs))
        (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> (logbitp-rhs))))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (<a class="sym-link system" href="../../../axioms.html#def-e_2Fd" data-sym="E/D">e/d</a> (logbitp-mismatch-under-iff)
         (logbitp-mismatch-upper-bound logbitp-constraint))
       <span class="keyword">:use</span> ((<span class="keyword">:instance</span> logbitp-constraint
          (bit (logbitp-mismatch (logbitp-lhs)
              (logbitp-rhs)))) (<span class="keyword">:instance</span> logbitp-mismatch-upper-bound
           (a (logbitp-lhs))
           (b (logbitp-rhs))))))))</pre>
  </div>

<div class="form-block other" id="form-14" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defthmd" data-sym="DEFTHMD">defthmd</a> logbitp-when-bit
  (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-bitp" data-sym="BITP">bitp</a> b)
    (equal (logbitp i b)
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> i) (equal b <span class="number">1</span>)))))</pre>
  </div>

<div class="form-block other" id="form-15" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> logbitp-of-negative-const
  (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-syntaxp" data-sym="SYNTAXP">syntaxp</a> (<a class="sym-link system" href="../../../axioms.html#def-quotep" data-sym="QUOTEP">quotep</a> x))
      (&lt; x <span class="number">0</span>))
    (equal (logbitp bit x)
      (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (logbitp bit (lognot x))))))</pre>
  </div>

<div class="form-block other" id="form-16" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection logbitp-of-const
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable* arith-equiv-forwarding)))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> logbitp-of-lognot-free
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (equal n (lognot m))
        (equal (logbitp x n)
          (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (logbitp x m))))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> logbitp-of-1
      (equal (logbitp x <span class="number">1</span>) (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> x))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable logbitp** <a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> <a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a>)))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> logbitp-of-minus-2
      (equal (logbitp x <span class="number">-2</span>) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> x)))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable logbitp**)))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> logbitp-of-const
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-syntaxp" data-sym="SYNTAXP">syntaxp</a> (<a class="sym-link system" href="../../../axioms.html#def-quotep" data-sym="QUOTEP">quotep</a> n))
        (let ((n (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n)))
          (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> n <span class="number">0</span>)
            (<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> n <span class="number">-1</span>)
            (if (&lt; n <span class="number">0</span>)
              (<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> n
                (lognot (ash <span class="number">1</span> (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n)))))
              (<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> n (ash <span class="number">1</span> (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n))))))))
      (equal (logbitp x n)
        (let ((n (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n)))
          (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> n <span class="number">0</span>) nil)
            ((<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> n <span class="number">-1</span>) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
            ((&lt; n <span class="number">0</span>) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> x)
                  (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n)))))
            (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (equal (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> x)
                (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n))))))))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable logbitp-of-ash-split
         <a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a>
         <a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a>)
       <span class="keyword">:cases</span> ((<a class="sym-link system" href="../../../axioms.html#def-_3E" data-sym="&gt;">&gt;</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n) <span class="number">0</span>)))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthmd" data-sym="DEFTHMD">defthmd</a> logbitp-of-bitmask
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (bitmaskp n)
      (equal (logbitp x n)
        (&lt; (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> x) (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n))))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable* ihsext-recursive-redefs
         ihsext-inductions)
       <span class="keyword">:induct</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) '(<span class="keyword">:cases</span> ((logbitp x n)))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable logbitp-of-bitmask)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> integer-length-of-lognot
    (equal (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> (lognot x))
      (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> x))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable* ihsext-recursive-redefs
         ihsext-inductions))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> logbitp-of-mask
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-syntaxp" data-sym="SYNTAXP">syntaxp</a> (<a class="sym-link system" href="../../../axioms.html#def-quotep" data-sym="QUOTEP">quotep</a> n))
        (<a class="sym-link system" href="../../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((n (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n)) (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n)))
          (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (&lt; <span class="number">0</span> <a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a>)
            (if (&lt; n <span class="number">0</span>)
              (equal n
                (lognot (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (ash <span class="number">1</span> (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n))))))
              (equal n
                (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (ash <span class="number">1</span> (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n)))))))))
      (equal (logbitp x n)
        (let ((n (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n)))
          (if (&lt; n <span class="number">0</span>)
            (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n) (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> x))
            (&lt; (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> x) (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n))))))
    <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:cases</span> ((logbitp x n))
       <span class="keyword">:in-theory</span> (enable <a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> <a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a>)))))</pre>
  </div>

<div class="form-block other" id="form-17" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection logbitp-of-const-split
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable* arith-equiv-forwarding)))
  (defund scan-for-bit
    (start val n)
    (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> start)
          (<a class="sym-link system" href="../../../axioms.html#def-booleanp" data-sym="BOOLEANP">booleanp</a> val)
          (integerp n))))
    (if (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> start)
      nil
      (let ((start (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> start)))
        (if (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (logbitp start n)
            (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> val <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) <span class="keyword">:exec</span> val))
          start
          (scan-for-bit start val n)))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-progn" data-sym="PROGN">progn</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable scan-for-bit))
      (<a class="sym-link system" href="../../../defthm.html#def-defcong" data-sym="DEFCONG">defcong</a> nat-equiv
        equal
        (scan-for-bit start val n)
        <span class="number">1</span>)
      (<a class="sym-link system" href="../../../defthm.html#def-defcong" data-sym="DEFCONG">defcong</a> <a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a>
        equal
        (scan-for-bit start val n)
        <span class="number">2</span>)
      (<a class="sym-link system" href="../../../defthm.html#def-defcong" data-sym="DEFCONG">defcong</a> int-equiv
        equal
        (scan-for-bit start val n)
        <span class="number">3</span>)
      (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> logbitp-of-scan-for-bit
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (scan-for-bit start val n)
          (equal (logbitp (scan-for-bit start val n)
              n)
            (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> val <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>))))
      (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> logbitp-of-scan-for-bit-free
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal x
              (scan-for-bit start val n))
            (scan-for-bit start val n))
          (equal (logbitp x n) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> val <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>))))
      (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> scan-for-bit-bound
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (scan-for-bit start val n)
          (&lt; (scan-for-bit start val n)
            (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> start)))
        <span class="keyword">:rule-classes</span> <span class="keyword">:linear</span>)
      (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> scan-for-bit-between
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (&lt; (scan-for-bit start val n)
              bit)
            (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> bit)
            (equal val (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (logbitp start n)))
            (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> bit (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> start)))
          (equal (logbitp bit n) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> val)))
        <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable <a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a>)
           <span class="keyword">:induct</span> (scan-for-bit start val n)) '(<span class="keyword">:cases</span> ((<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> bit (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> start))))))
      (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> logbitp-when-not-scan-for-bit
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (scan-for-bit start val n))
            (<a class="sym-link system" href="../../../axioms.html#def-syntaxp" data-sym="SYNTAXP">syntaxp</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal start b)))
            (equal val (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (logbitp start n)))
            (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> b) (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> start)))
          (equal (logbitp b n) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> val))))
      (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (disable scan-for-bit))))
  (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> bit-scan-rec
    (bit start curr-val n)
    (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> bit)
          (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> start)
          (<a class="sym-link system" href="../../../axioms.html#def-booleanp" data-sym="BOOLEANP">booleanp</a> curr-val)
          (integerp n))
        <span class="keyword">:measure</span> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> start)))
    (<a class="sym-link system" href="../../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((nbit (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> bit) <span class="keyword">:exec</span> bit)) (start (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> start)
            <span class="keyword">:exec</span> start))
        (curr-val (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> curr-val <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
            <span class="keyword">:exec</span> curr-val))
        (n (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n)
            <span class="keyword">:exec</span> n))
        (next (scan-for-bit start
            (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> curr-val)
            n)))
      (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> next) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> curr-val
            (if (<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> start <span class="number">0</span>)
              (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> bit)
              (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> bit)) (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> bit start)))))
        ((<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> curr-val) (bit-scan-rec nbit next <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> n))
        ((<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> next (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> start))) (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> bit start)
            (bit-scan-rec nbit
              next
              nil
              n)))
        (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> nbit start)
              (<a class="sym-link system" href="../../../axioms.html#def-_3E" data-sym="&gt;">&gt;</a> nbit next))
            (bit-scan-rec nbit
              next
              nil
              n))))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-progn" data-sym="PROGN">progn</a> (<a class="sym-link system" href="../../../defthm.html#def-defcong" data-sym="DEFCONG">defcong</a> nat-equiv
        equal
        (bit-scan-rec bit
          start
          curr-val
          n)
        <span class="number">1</span>
        <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:expand</span> ((<span class="keyword">:free</span> (bit)
              (bit-scan-rec bit
                start
                curr-val
                n)))
           <span class="keyword">:in-theory</span> (enable <a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a>))))
      (<a class="sym-link system" href="../../../defthm.html#def-defcong" data-sym="DEFCONG">defcong</a> nat-equiv
        equal
        (bit-scan-rec bit
          start
          curr-val
          n)
        <span class="number">2</span>
        <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:expand</span> ((<span class="keyword">:free</span> (start)
              (bit-scan-rec bit
                start
                curr-val
                n))))))
      (<a class="sym-link system" href="../../../defthm.html#def-defcong" data-sym="DEFCONG">defcong</a> <a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a>
        equal
        (bit-scan-rec bit
          start
          curr-val
          n)
        <span class="number">3</span>
        <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:expand</span> ((<span class="keyword">:free</span> (curr-val)
              (bit-scan-rec bit
                start
                curr-val
                n))))))
      (<a class="sym-link system" href="../../../defthm.html#def-defcong" data-sym="DEFCONG">defcong</a> int-equiv
        equal
        (bit-scan-rec bit
          start
          curr-val
          n)
        <span class="number">4</span>
        <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:expand</span> ((<span class="keyword">:free</span> (n)
              (bit-scan-rec bit
                start
                curr-val
                n))))))
      (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> &lt;-0-forward-to-nat-equiv-0
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (&lt; x <span class="number">0</span>)
          (nat-equiv x <span class="number">0</span>))
        <span class="keyword">:rule-classes</span> <span class="keyword">:forward-chaining</span>)
      (<a class="sym-link system" href="../../../axioms.html#def-defthmd" data-sym="DEFTHMD">defthmd</a> equal-of-booleans
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-booleanp" data-sym="BOOLEANP">booleanp</a> a)
            (<a class="sym-link system" href="../../../axioms.html#def-booleanp" data-sym="BOOLEANP">booleanp</a> b))
          (equal (equal a b)
            (<a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a> a b))))
      (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> bit-scan-rec-correct
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> start)
            (equal curr-val (logbitp start n)))
          (equal (bit-scan-rec bit
              start
              curr-val
              n)
            (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> bit) start)
              (logbitp bit n))))
        <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:induct</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
           <span class="keyword">:in-theory</span> (<a class="sym-link system" href="../../../axioms.html#def-e_2Fd" data-sym="E/D">e/d</a> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> <a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a>)
             (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<span class="keyword">:definition</span> bit-scan-rec)))
           <span class="keyword">:expand</span> ((<span class="keyword">:free</span> (bit val)
              (bit-scan-rec bit
                start
                val
                n)) (<span class="keyword">:free</span> (bit val)
               (bit-scan-rec bit <span class="number">0</span> val n))
             (<span class="keyword">:free</span> (val)
               (bit-scan-rec bit bit val n)))) '(<span class="keyword">:cases</span> ((logbitp bit n)))
          (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp
            '(<span class="keyword">:in-theory</span> (enable equal-of-booleans)))))
      (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> logbitp-when-gte-integer-length
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n) (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> i))
          (equal (logbitp i n)
            (&lt; (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n) <span class="number">0</span>)))
        <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:in-theory</span> (enable* ihsext-inductions
             ihsext-recursive-redefs)
           <span class="keyword">:induct</span> (logbitp i n))))
      (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> logbitp-of-integer-length-minus-1
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal <span class="number">0</span> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n)))
          (equal (logbitp (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">-1</span> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n)) n)
            (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> <span class="number">0</span> (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n))))
        <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:in-theory</span> (enable* ihsext-inductions
             ihsext-recursive-redefs)
           <span class="keyword">:induct</span> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n))))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> open-bit-scan-rec
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-syntaxp" data-sym="SYNTAXP">syntaxp</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-quotep" data-sym="QUOTEP">quotep</a> start)
          (<a class="sym-link system" href="../../../axioms.html#def-quotep" data-sym="QUOTEP">quotep</a> curr-val)
          (<a class="sym-link system" href="../../../axioms.html#def-quotep" data-sym="QUOTEP">quotep</a> n)))
      (equal (bit-scan-rec bit
          start
          curr-val
          n)
        (<a class="sym-link system" href="../../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((nbit (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> bit) <span class="keyword">:exec</span> bit)) (start (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> start)
                <span class="keyword">:exec</span> start))
            (curr-val (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> curr-val <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
                <span class="keyword">:exec</span> curr-val))
            (n (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n)
                <span class="keyword">:exec</span> n))
            (next (scan-for-bit start
                (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> curr-val)
                n)))
          (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> next) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> curr-val
                (if (<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> start <span class="number">0</span>)
                  (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> bit)
                  (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> bit)) (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> bit start)))))
            ((<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> curr-val) (bit-scan-rec nbit next <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> n))
            ((<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> next (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> start))) (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> bit start)
                (bit-scan-rec nbit
                  next
                  nil
                  n)))
            (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> nbit start)
                  (<a class="sym-link system" href="../../../axioms.html#def-_3E" data-sym="&gt;">&gt;</a> nbit next))
                (bit-scan-rec nbit
                  next
                  nil
                  n)))))))
    <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:in-theory</span> nil
       <span class="keyword">:expand</span> ((bit-scan-rec bit
          start
          curr-val
          n)))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthmd" data-sym="DEFTHMD">defthmd</a> logbitp-of-const-split
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-syntaxp" data-sym="SYNTAXP">syntaxp</a> (<a class="sym-link system" href="../../../axioms.html#def-quotep" data-sym="QUOTEP">quotep</a> n))
      (equal (logbitp bit n)
        (let ((n (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n)))
          (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> n <span class="number">0</span>) nil)
            ((<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> n <span class="number">-1</span>) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
            ((&lt; n <span class="number">0</span>) (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-_3E_3D" data-sym="&gt;=">&gt;=</a> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> bit) (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n))
                (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (bit-scan-rec bit
                    (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n))
                    <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
                    (lognot n)))))
            (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (bit-scan-rec bit
                (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n))
                <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
                n))))))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (<a class="sym-link system" href="../../../axioms.html#def-e_2Fd" data-sym="E/D">e/d</a> nil (bit-scan-rec))) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp
        (if (<a class="sym-link system" href="../../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> '(negp n)
            clause)
          '(<span class="keyword">:cases</span> ((&lt; bit (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n))))
          '(<span class="keyword">:use</span> ((<span class="keyword">:instance</span> bit-scan-rec-correct
               (start (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">-1</span> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n)))
               (curr-val <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
               (n (lognot n))))
            <span class="keyword">:in-theory</span> (<a class="sym-link system" href="../../../axioms.html#def-e_2Fd" data-sym="E/D">e/d</a> nil
              (bit-scan-rec bit-scan-rec-correct)))))))
  (add-wizard-advice <span class="keyword">:pattern</span> (logbitp x const)
    <span class="keyword">:restrict</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-quotep" data-sym="QUOTEP">quotep</a> const)
      (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((n (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> (<a class="sym-link system" href="../../../axioms.html#def-unquote" data-sym="UNQUOTE">unquote</a> const))) (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n)))
          (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> <a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> <span class="number">0</span>)
            (if (&lt; n <span class="number">0</span>)
              (<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> n
                (lognot (ash <span class="number">1</span> (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n)))))
              (<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> n (ash <span class="number">1</span> (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n)))))
            (if (&lt; n <span class="number">0</span>)
              (equal n
                (lognot (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (ash <span class="number">1</span> (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n))))))
              (equal n
                (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (ash <span class="number">1</span> (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> n))))))))))
    <span class="keyword">:msg</span> <span class="string">"Possibly enable ~x0 to match ~x1; this may cause ~
                           some case splitting."</span>
    <span class="keyword">:args</span> (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> 'logbitp-of-const-split
      `(logbitp ,BITOPS::X ,BITOPS::CONST))))</pre>
  </div>

<div class="form-block other" id="form-18" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection equal-by-logbitp-hint
  <span class="keyword">:parents</span> (bitops/equal-by-logbitp)
  <span class="keyword">:short</span> <span class="string">"Basic automation for @(see equal-by-logbitp)."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;The @(&#39;equal-by-logbitp-hint&#39;) computed hint looks for goals of the
form:&lt;/p&gt;

@({
 (implies (and hyp1 hyp2 ...)
          (equal lhs rhs))
})

&lt;p&gt;And automatically generates an appropriate @(&#39;:functional-instance&#39;) of the
@(see equal-by-logbitp) theorem.  A typical use of this hint might be:&lt;/p&gt;

@({
 :hints((&quot;Goal&quot;
         :in-theory (enable foo bar))
        (and stable-under-simplificationp
             (equal-by-logbitp-hint)))
})

&lt;p&gt;Note that this hint is very aggressive.  For instance, it doesn&#39;t try to
determine whether @(&#39;lhs&#39;) and @(&#39;rhs&#39;) are numbers; it will try to use
@(see equal-by-logbitp) anyway.  Because of this, you would never want to add
this to the @(see default-hints).&lt;/p&gt;"</span>
  (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> equal-by-logbitp-hint-fn
    (clause)
    (declare (xargs <span class="keyword">:mode</span> <span class="keyword">:program</span>))
    (b* ((concl (car (<a class="sym-link system" href="../../../axioms.html#def-last" data-sym="LAST">last</a> clause))) ((unless (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (consp concl) (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (car concl) 'equal))) nil)
        (lhs (<a class="sym-link system" href="../../../axioms.html#def-cadr" data-sym="CADR">cadr</a> concl))
        (rhs (<a class="sym-link system" href="../../../axioms.html#def-caddr" data-sym="CADDR">caddr</a> concl))
        (hyp (cons '<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../basis-b.html#def-dumb-negate-lit-lst" data-sym="DUMB-NEGATE-LIT-LST">dumb-negate-lit-lst</a> (<a class="sym-link system" href="../../../axioms.html#def-butlast" data-sym="BUTLAST">butlast</a> clause <span class="number">1</span>)))))
      `(<span class="keyword">:use</span> ((<span class="keyword">:functional-instance</span> equal-by-logbitp
           (logbitp-hyp (lambda nil ,BITOPS::HYP))
           (logbitp-lhs (lambda nil ,BITOPS::LHS))
           (logbitp-rhs (lambda nil ,BITOPS::RHS)))))))
  (<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> equal-by-logbitp-hint
    nil
    `(equal-by-logbitp-hint-fn clause)))</pre>
  </div>

<div class="form-block other" id="form-19" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection open-logbitp-of-const-meta
  <span class="keyword">:parents</span> (bitops/equal-by-logbitp logbitp)
  <span class="keyword">:short</span> <span class="string">"Rewrite terms like @(&#39;(logbitp foo 7)&#39;) to @(&#39;(or (not (natp
foo)) (member-equal foo &#39;(0 1 2)))&#39;)."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;This meta rule targets terms of the form&lt;/p&gt;

@({
 (logbitp term const)
})

&lt;p&gt;where @(&#39;const&#39;) is a quoted constant, typically a number.  We know that
such a term can only be true when @(&#39;term&#39;) happens to be one of the bit
positions that has a @(&#39;1&#39;) bit set in @(&#39;const&#39;), so we can split into cases
based on which bits of @(&#39;const&#39;) are set.&lt;/p&gt;

&lt;p&gt;Note that this rule basically is going to split into @(&#39;n&#39;) cases, where
@(&#39;n&#39;) is the number of @(&#39;1&#39;) bits in @(&#39;const&#39;)!  Because of this we keep it
disabled.  But if you see a @(&#39;logbitp&#39;) term applied to a constant, you might
want to consider enabling this rule.&lt;/p&gt;"</span>
  (<a class="sym-link system" href="../../../defthm.html#def-defevaluator" data-sym="DEFEVALUATOR">defevaluator</a> lbpc-ev
    lbpc-ev-lst
    ((logbitp a b) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> a)
      (if a
        b
        c)
      (equal a b)
      (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> a)
      (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> a)
      (<a class="sym-link system" href="../../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> a x)))
  (defund bits-between
    (n m x)
    (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> n)
          (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> m)
          (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> n m)
          (integerp x))
        <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable <a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a>)))
        <span class="keyword">:measure</span> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> m) (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> n)))))
    (<a class="sym-link system" href="../../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((n (lnfix n)) (m (lnfix m)))
      (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> m n))
           <span class="keyword">:exec</span> (<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> m n)) nil)
        ((logbitp n x) (cons n
            (bits-between (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> n <span class="number">1</span>) m x)))
        (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (bits-between (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> n <span class="number">1</span>) m x)))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> member-equal-of-bits-between
      (<a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a> (<a class="sym-link system" href="../../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> a
          (bits-between n m x))
        (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> a)
          (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> n) a)
          (&lt; a (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> m))
          (logbitp a x)))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable bits-between)
         <span class="keyword">:induct</span> (bits-between n m x)))))
  (defund enumerate-logbitps
    (x)
    (declare (xargs <span class="keyword">:guard</span> (integerp x)))
    (bits-between <span class="number">0</span>
      (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> x)
      x))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> ind
      (n x)
      (if (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> n)
        (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> n x)
        (ind (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> n <span class="number">1</span>) (logcdr x)))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> crock
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> x)
          (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> x) (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> n)))
        (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (logbitp n x)))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> (ind n x)
         <span class="keyword">:in-theory</span> (enable* logbitp** integer-length**)))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> member-equal-of-enumerate-logbitps-for-naturals
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> x) (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> a))
        (<a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a> (<a class="sym-link system" href="../../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> a
            (enumerate-logbitps x))
          (logbitp a x)))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable enumerate-logbitps)))))
  (defund open-logbitp-of-const
    (term)
    (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a> term)))
    (<a class="sym-link system" href="../../../basis-a.html#def-case-match" data-sym="CASE-MATCH">case-match</a> term
      (('logbitp x
         ('quote const . &amp;) . &amp;) (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (integerp const)) (<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> const <span class="number">0</span>)) ''nil)
          ((<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> const <span class="number">-1</span>) ''<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
          ((<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> const) `(if (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> ,BITOPS::X)
              (if (<a class="sym-link system" href="../../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> ,BITOPS::X
                  ',(BITOPS::ENUMERATE-LOGBITPS BITOPS::CONST))
                '<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
                'nil)
              ',(LOGBITP 0 BITOPS::CONST)))
          (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> `(if (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> ,BITOPS::X)
              (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> ,BITOPS::X
                  ',(BITOPS::ENUMERATE-LOGBITPS (LOGNOT BITOPS::CONST))))
              ',(LOGBITP 0 BITOPS::CONST)))))
      (&amp; term)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthmd" data-sym="DEFTHMD">defthmd</a> open-logbitp-of-const-meta
    (equal (lbpc-ev x a)
      (lbpc-ev (open-logbitp-of-const x)
        a))
    <span class="keyword">:rule-classes</span> ((<span class="keyword">:meta</span> <span class="keyword">:trigger-fns</span> (logbitp)))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable* open-logbitp-of-const
         arith-equiv-forwarding))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> logbitp-of-ash-free-lemma
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (equal x (ash <span class="number">1</span> y))
        (equal (logbitp n x)
          (equal (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> n) (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> y))))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable logbitp-of-ash-split)))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable* arith-equiv-forwarding)))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> logbitp-of-ash-free-lemma2
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal (lognot x) (ash <span class="number">1</span> y))
          (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> y))
        (equal (logbitp n x)
          (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> n) (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> y)))))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (<a class="sym-link system" href="../../../axioms.html#def-e_2Fd" data-sym="E/D">e/d</a> nil (logbitp-of-ash-free-lemma))
         <span class="keyword">:use</span> ((<span class="keyword">:instance</span> logbitp-of-ash-free-lemma
            (x (lognot x))))))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> logbitp-of-ash-free-lemma3
      (equal (logbitp n <span class="number">-2</span>) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> n)))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (e/d* (logbitp**))))))
  (defund open-logbitp-of-const-lite
    (term)
    (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a> term)))
    (<a class="sym-link system" href="../../../basis-a.html#def-case-match" data-sym="CASE-MATCH">case-match</a> term
      (('logbitp x
         ('quote const . &amp;) . &amp;) (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (integerp const)) (<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> const <span class="number">0</span>)) ''nil)
          ((<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> const <span class="number">-1</span>) ''<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
          ((<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> const) (let ((<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> const))))
              (if (equal const (ash <span class="number">1</span> <a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a>))
                (if (<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> <a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> <span class="number">0</span>)
                  `(<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> ,BITOPS::X)
                  `(equal ,BITOPS::X ',BITOPS::LEN))
                term)))
          (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((const (lognot const)) (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (<a class="sym-link system" href="../../../axioms.html#def-integer-length" data-sym="INTEGER-LENGTH">integer-length</a> const))))
              (if (equal const (ash <span class="number">1</span> <a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a>))
                (if (<a class="sym-link system" href="../../../axioms.html#def-_3D" data-sym="=">=</a> <a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> <span class="number">0</span>)
                  `(<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> ,BITOPS::X))
                  `(<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal ,BITOPS::X ',BITOPS::LEN)))
                term)))))
      (&amp; term)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> open-logbitp-of-const-lite-meta
    (equal (lbpc-ev x a)
      (lbpc-ev (open-logbitp-of-const-lite x)
        a))
    <span class="keyword">:rule-classes</span> ((<span class="keyword">:meta</span> <span class="keyword">:trigger-fns</span> (logbitp)))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (e/d* (open-logbitp-of-const-lite arith-equiv-forwarding
           <a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a>
           <a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a>))))))</pre>
  </div>

<div class="form-block other" id="form-20" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection equal-by-logbitp-hammer
  <span class="keyword">:parents</span> (bitops/equal-by-logbitp)
  <span class="keyword">:short</span> <span class="string">"Drastic automation for @(see equal-by-logbitp)."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;This is an enhanced version of @(see equal-by-logbitp-hint) that
also enables a bunch of case-splitting rules that allow @(see logbitp) to go
through functions like @(see ash), @(see loghead), @(see install-bit),
etc.&lt;/p&gt;"</span>
  (def-ruleset! logbitp-case-splits
    '(logbitp-of-ash-split logbitp-of-loghead-split
      logbitp-of-logapp-split
      logbitp-of-logsquash-split
      logbitp-of-logrev-split))
  (def-ruleset! logbitp-case-splits+
    '(logbitp-case-splits logbitp-when-bit
      b-not
      b-and
      b-ior
      b-xor
      b-eqv
      b-nand
      b-nor
      b-andc1
      b-andc2
      b-orc1
      b-orc2
      <a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a>
      <a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a>
      bfix))
  (<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> equal-by-logbitp-hammer
    nil
    '(<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp
      '(<span class="keyword">:computed-hint-replacement</span> ((<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp
           '(<span class="keyword">:in-theory</span> (e/d* (logbitp-of-const-split)))) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp
            '(<span class="keyword">:in-theory</span> (e/d* (logbitp-case-splits logbitp-when-bit
                  logbitp-of-const-split))))
          (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp
            (equal-by-logbitp-hint))
          (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp
            '(<span class="keyword">:in-theory</span> (e/d* (logbitp-case-splits logbitp-when-bit
                  logbitp-of-const-split
                  b-xor
                  b-ior
                  b-and)))))
        <span class="keyword">:no-thanks</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>))))</pre>
  </div>

<div class="form-block other" id="form-21" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define logbitp-mismatch?
  ((x integerp) (y integerp))
  (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> (logbitp-mismatch x y))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (<a class="sym-link system" href="../../../axioms.html#def-e_2Fd" data-sym="E/D">e/d</a> (logbitp-mismatch) (int-equiv))))
  (<a class="sym-link system" href="../../../defthm.html#def-defcong" data-sym="DEFCONG">defcong</a> int-equiv
    equal
    (logbitp-mismatch? x y)
    <span class="number">1</span>)
  (<a class="sym-link system" href="../../../defthm.html#def-defcong" data-sym="DEFCONG">defcong</a> int-equiv
    equal
    (logbitp-mismatch? x y)
    <span class="number">2</span>)
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> logbitp-mismatch?-correct
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> x) (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> y)))
      (let ((i (logbitp-mismatch? x y)))
        (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal (logbitp i x)
            (logbitp i y)))))))</pre>
  </div>

<div class="form-block other" id="form-22" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection equal-by-logbitp-witnessing-rules
  (definstantiate equal-by-logbitp-instancing
    <span class="keyword">:predicate</span> (equal x y)
    <span class="keyword">:vars</span> (bit)
    <span class="keyword">:expr</span> (equal (logbitp bit x) (logbitp bit y))
    <span class="keyword">:hints</span> ('(<span class="keyword">:in-theory</span> nil)))
  (defwitness unequal-by-logbitp-witnessing
    <span class="keyword">:predicate</span> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal x y))
    <span class="keyword">:expr</span> (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (let ((bit (<a class="sym-link system" href="../../../axioms.html#def-hide" data-sym="HIDE">hide</a> (logbitp-mismatch? x y))))
        (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> bit)
          (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal (logbitp bit x) (logbitp bit y)))))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-zip" data-sym="ZIP">zip</a> x)
        (<a class="sym-link system" href="../../../axioms.html#def-zip" data-sym="ZIP">zip</a> y)
        (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (integerp x) (integerp y)))))
    <span class="keyword">:generalize</span> (((<a class="sym-link system" href="../../../axioms.html#def-hide" data-sym="HIDE">hide</a> (logbitp-mismatch? x y)) . wbit))
    <span class="keyword">:hints</span> ('(<span class="keyword">:use</span> logbitp-mismatch?-correct
       <span class="keyword">:in-theory</span> (<a class="sym-link system" href="../../../axioms.html#def-e_2Fd" data-sym="E/D">e/d</a> (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a>)
         (logbitp-mismatch?-correct))
       <span class="keyword">:expand</span> ((<span class="keyword">:free</span> (x) (<a class="sym-link system" href="../../../axioms.html#def-hide" data-sym="HIDE">hide</a> x)))))))</pre>
  </div>

<div class="form-block other" id="form-23" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defines eqbylbp-collect-terms
  <span class="keyword">:verify-guards</span> nil
  <span class="keyword">:prepwork</span> ((<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> pseudo-term-listp-of-union
       (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (pseudo-term-listp a)
           (pseudo-term-listp b))
         (pseudo-term-listp (<a class="sym-link system" href="../../../axioms.html#def-union-equal" data-sym="UNION-EQUAL">union-equal</a> a b))))))
  (define eqbylbp-collect-terms
    ((x <a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a>))
    <span class="keyword">:returns</span> (terms <a class="sym-link system" href="../../../axioms.html#def-pseudo-term-list-listp" data-sym="PSEUDO-TERM-LIST-LISTP">pseudo-term-list-listp</a> <span class="keyword">:hyp</span> <span class="keyword">:guard</span>)
    (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (car x) 'quote))) nil) (<a class="sym-link system" href="../../../axioms.html#def-rest" data-sym="REST">rest</a> (eqbylbp-collect-terms-list (cdr x))))
      (if (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (car x) 'logbitp)
        (cons (cdr x) <a class="sym-link system" href="../../../axioms.html#def-rest" data-sym="REST">rest</a>)
        <a class="sym-link system" href="../../../axioms.html#def-rest" data-sym="REST">rest</a>)))
  (define eqbylbp-collect-terms-list
    ((x pseudo-term-listp))
    <span class="keyword">:returns</span> (terms <a class="sym-link system" href="../../../axioms.html#def-pseudo-term-list-listp" data-sym="PSEUDO-TERM-LIST-LISTP">pseudo-term-list-listp</a> <span class="keyword">:hyp</span> <span class="keyword">:guard</span>)
    (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
      nil
      (<a class="sym-link system" href="../../../axioms.html#def-union-equal" data-sym="UNION-EQUAL">union-equal</a> (eqbylbp-collect-terms (car x))
        (eqbylbp-collect-terms-list (cdr x)))))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> pseudo-term-listp-implies-true-listp
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-pseudo-term-list-listp" data-sym="PSEUDO-TERM-LIST-LISTP">pseudo-term-list-listp</a> x)
        (<a class="sym-link system" href="../../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> x))))
  (<a class="sym-link system" href="../../../axioms.html#def-verify-guards" data-sym="VERIFY-GUARDS">verify-guards</a> eqbylbp-collect-terms))</pre>
  </div>

<div class="form-block other" id="form-24" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defaggregate eqbylbp-config
  ((restriction <a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a>) (witness-rule wcp-witness-rule-p)
    (instance-rule (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (wcp-instance-rule-p instance-rule)
        (equal (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> (wcp-instance-rule-&gt;vars instance-rule))
          <span class="number">1</span>)))
    (prune-examples)
    (passes <a class="sym-link system" href="../../../axioms.html#def-posp" data-sym="POSP">posp</a>)
    (simp-hint)
    (add-hints)
    (verbosep)))</pre>
  </div>

<div class="form-block other" id="form-25" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (disable (<a class="sym-link system" href="../../../axioms.html#def-force" data-sym="FORCE">force</a>))))</pre>
  </div>

<div class="form-block other" id="form-26" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define eqbylbp-check-witnesses
  ((x pseudo-term-listp) (config eqbylbp-config-p)
    state)
  <span class="keyword">:returns</span> (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> (apply-witness-list <a class="sym-link system" href="../../../axioms.html#def-boolean-listp" data-sym="BOOLEAN-LISTP">boolean-listp</a>)
    (new-terms pseudo-term-listp))
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil nil)) ((eqbylbp-config config) config)
      (rule config.witness-rule)
      ((wcp-witness-rule rule) rule)
      (restriction-term config.restriction)
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> rest-apply rest-terms) (eqbylbp-check-witnesses (cdr x)
          config
          state))
      ((unless (<a class="sym-link system" href="../../../axioms.html#def-mbt" data-sym="MBT">mbt</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a> (car x))
             (wcp-witness-rule-p rule)))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> (cons nil rest-apply)
          rest-terms))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> unify-ok alist) (simple-one-way-unify rule.term (car x) nil))
      ((unless unify-ok) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> (cons nil rest-apply)
          rest-terms))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> val) (if (equal restriction-term ''<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
          (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
          (witness-eval-restriction restriction-term
            alist
            state)))
      (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> <a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a>
          (raise <span class="string">"Restriction term evaluation failed! ~x0"</span>
            <a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a>)))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> <a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> val))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> (cons nil rest-apply)
          rest-terms))
      (new-term (substitute-into-term rule.expr alist)))
    (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> (cons <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> rest-apply)
      (cons new-term rest-terms)))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> eqbylbp-check-witnesses-len-of-apply-list
    (equal (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> (<a class="sym-link system" href="../../../axioms.html#def-mv-nth" data-sym="MV-NTH">mv-nth</a> <span class="number">0</span>
          (eqbylbp-check-witnesses x
            config
            state)))
      (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> x))))</pre>
  </div>

<div class="form-block other" id="form-27" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define eqbylbp-simplify
  ((x <a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a>) (config eqbylbp-config-p)
    (equiv symbolp)
    state)
  <span class="keyword">:mode</span> <span class="keyword">:program</span> (b* (((eqbylbp-config config) config) ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> erp rw state) (easy-simplify-term1-fn x
          nil
          config.simp-hint
          equiv
          <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
          <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
          <span class="number">1000</span>
          <span class="number">1000</span>
          state))
      ((when erp) (raise <span class="string">"Logbitp-reasoning: error simplifying ~x0: ~x1"</span>
          x
          erp)
        (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> x state)))
    (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> rw state)))</pre>
  </div>

<div class="form-block other" id="form-28" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define eqbylbp-simplify-each
  ((x pseudo-term-listp) (config eqbylbp-config-p)
    (equiv symbolp)
    state)
  <span class="keyword">:mode</span> <span class="keyword">:program</span> (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil state)) ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../../axioms.html#def-first" data-sym="FIRST">first</a> state) (eqbylbp-simplify (car x)
          config
          equiv
          state))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../../axioms.html#def-rest" data-sym="REST">rest</a> state) (eqbylbp-simplify-each (cdr x)
          config
          equiv
          state)))
    (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> (cons <a class="sym-link system" href="../../../axioms.html#def-first" data-sym="FIRST">first</a> <a class="sym-link system" href="../../../axioms.html#def-rest" data-sym="REST">rest</a>) state)))</pre>
  </div>

<div class="form-block other" id="form-29" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define eqbylbp-is-var
  ((x <a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a>) (var symbolp))
  (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x var)
    (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (consp x)
      (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (car x) '<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a>)
      (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (<a class="sym-link system" href="../../../axioms.html#def-cadr" data-sym="CADR">cadr</a> x) var))))</pre>
  </div>

<div class="form-block other" id="form-30" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-encapsulate" data-sym="ENCAPSULATE">encapsulate</a> (((eqbylbp-solve-for-var <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a> <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a> <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a>) =&gt;
     (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a> <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a>)
     <span class="keyword">:formals</span> (x var target)
     <span class="keyword">:guard</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a> x)
       (symbolp var)
       (<a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a> target))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> eqbylbp-solve-for-var
      (x var target)
      (declare (ignore var target))
      (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> x)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> pseudo-termp-of-eqbbylbp-solve-for-var
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a> x)
        (<a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a> target))
      (<a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a> (<a class="sym-link system" href="../../../axioms.html#def-mv-nth" data-sym="MV-NTH">mv-nth</a> <span class="number">1</span>
          (eqbylbp-solve-for-var x
            var
            target))))))</pre>
  </div>

<div class="form-block other" id="form-31" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define eqbylbp-solve-for-var-default
  ((x <a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a>) (var symbolp)
    (target <a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a>))
  <span class="keyword">:returns</span> (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> ok
    (res <a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a>
      <span class="keyword">:hyp</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a> x)
        (<a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a> target))))
  (b* (((when (eqbylbp-is-var x var)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> target)) ((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil nil))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (car x) 'unary--)) (eqbylbp-solve-for-var-default (<a class="sym-link system" href="../../../axioms.html#def-cadr" data-sym="CADR">cadr</a> x)
          var
          `(unary-- ,BITOPS::TARGET)))
      ((unless (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (car x) 'binary-+)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil nil))
      ((when (eqbylbp-is-var (<a class="sym-link system" href="../../../axioms.html#def-cadr" data-sym="CADR">cadr</a> x) var)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
          `(binary-+ ,BITOPS::TARGET
            (unary-- ,(CADDR BITOPS::X))))))
    (eqbylbp-solve-for-var-default (<a class="sym-link system" href="../../../axioms.html#def-caddr" data-sym="CADDR">caddr</a> x)
      var
      `(binary-+ ,BITOPS::TARGET
        (unary-- ,(CADR BITOPS::X))))))</pre>
  </div>

<div class="form-block other" id="form-32" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defattach" data-sym="DEFATTACH">defattach</a> eqbylbp-solve-for-var
  eqbylbp-solve-for-var-default)</pre>
  </div>

<div class="form-block other" id="form-33" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define eqbylbp-collect-examples-for-target
  ((avail-logbitp-args <a class="sym-link system" href="../../../axioms.html#def-pseudo-term-list-listp" data-sym="PSEUDO-TERM-LIST-LISTP">pseudo-term-list-listp</a>) (var symbolp)
    (target-logbitp-args pseudo-term-listp)
    (examples pseudo-term-listp)
    (config eqbylbp-config-p)
    state)
  <span class="keyword">:mode</span> <span class="keyword">:program</span> (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> avail-logbitp-args)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> examples state)) ((unless (equal (<a class="sym-link system" href="../../../axioms.html#def-cadr" data-sym="CADR">cadr</a> (car avail-logbitp-args))
           (<a class="sym-link system" href="../../../axioms.html#def-cadr" data-sym="CADR">cadr</a> target-logbitp-args))) (eqbylbp-collect-examples-for-target (cdr avail-logbitp-args)
          var
          target-logbitp-args
          examples
          config
          state))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> ok res) (eqbylbp-solve-for-var (car (car avail-logbitp-args))
          var
          (car target-logbitp-args)))
      ((unless ok) (eqbylbp-collect-examples-for-target (cdr avail-logbitp-args)
          var
          target-logbitp-args
          examples
          config
          state))
      (simp res)
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../../axioms.html#def-rest" data-sym="REST">rest</a> state) (eqbylbp-collect-examples-for-target (cdr avail-logbitp-args)
          var
          target-logbitp-args
          examples
          config
          state)))
    (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> (if (<a class="sym-link system" href="../../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> simp <a class="sym-link system" href="../../../axioms.html#def-rest" data-sym="REST">rest</a>)
        <a class="sym-link system" href="../../../axioms.html#def-rest" data-sym="REST">rest</a>
        (cons simp <a class="sym-link system" href="../../../axioms.html#def-rest" data-sym="REST">rest</a>))
      state)))</pre>
  </div>

<div class="form-block other" id="form-34" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define eqbylbp-collect-examples-targets
  ((avail-logbitp-args <a class="sym-link system" href="../../../axioms.html#def-pseudo-term-list-listp" data-sym="PSEUDO-TERM-LIST-LISTP">pseudo-term-list-listp</a>) (var symbolp)
    (target-logbitp-args <a class="sym-link system" href="../../../axioms.html#def-pseudo-term-list-listp" data-sym="PSEUDO-TERM-LIST-LISTP">pseudo-term-list-listp</a>)
    (examples pseudo-term-listp)
    (config eqbylbp-config-p)
    state)
  <span class="keyword">:mode</span> <span class="keyword">:program</span> (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> target-logbitp-args)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> examples state)) ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> examples state) (eqbylbp-collect-examples-for-target avail-logbitp-args
          var
          (car target-logbitp-args)
          examples
          config
          state)))
    (eqbylbp-collect-examples-targets avail-logbitp-args
      var
      (cdr target-logbitp-args)
      examples
      config
      state)))</pre>
  </div>

<div class="form-block other" id="form-35" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define eqbylbp-eval-example
  ((alist pseudo-term-substp) (example <a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a>)
    (config eqbylbp-config-p)
    state)
  <span class="keyword">:mode</span> <span class="keyword">:program</span> (b* (((eqbylbp-config config) config) (rule config.instance-rule)
      ((wcp-instance-rule rule) rule)
      (alist1 (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link system" href="../../../axioms.html#def-pairlis_24" data-sym="PAIRLIS$">pairlis$</a> rule.vars (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> example))
          alist))
      (newterm (wcp-beta-reduce-term (substitute-into-term rule.expr alist1)))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> newterm-rw state) (eqbylbp-simplify newterm
          config
          '<a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a>
          state))
      (includep (equal newterm-rw ''<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)))
    (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> includep
      (eqbylbp-collect-terms newterm-rw)
      state)))</pre>
  </div>

<div class="form-block other" id="form-36" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define eqbylbp-try-example
  ((alist pseudo-term-substp) (example <a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a>)
    (target-logbitp-args <a class="sym-link system" href="../../../axioms.html#def-pseudo-term-list-listp" data-sym="PSEUDO-TERM-LIST-LISTP">pseudo-term-list-listp</a>)
    (config eqbylbp-config-p)
    state)
  <span class="keyword">:mode</span> <span class="keyword">:program</span> (b* (((eqbylbp-config config) config) ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> includep
         new-logbitp-args
         state) (eqbylbp-eval-example alist
          example
          config
          state))
      (intersection (<a class="sym-link system" href="../../../axioms.html#def-intersection-equal" data-sym="INTERSECTION-EQUAL">intersection-equal</a> new-logbitp-args
          target-logbitp-args))
      ((unless (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> includep
           intersection
           (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> config.prune-examples))) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> config.verbosep
          (<a class="sym-link system" href="../../../axioms.html#def-cw" data-sym="CW">cw</a> <span class="string">"Rejected: ~x0 (produced: ~x1)~%"</span>
            example
            new-logbitp-args))
        (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil target-logbitp-args state))
      (new-targets (<a class="sym-link system" href="../../../axioms.html#def-set-difference-equal" data-sym="SET-DIFFERENCE-EQUAL">set-difference-equal</a> new-logbitp-args
          intersection)))
    (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> (make-wcp-example-app <span class="keyword">:instrule</span> config.instance-rule
          <span class="keyword">:bindings</span> (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> example)))
      (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> new-targets target-logbitp-args)
      state)))</pre>
  </div>

<div class="form-block other" id="form-37" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define eqbylbp-try-examples
  ((alist pseudo-term-substp) (examples pseudo-term-listp)
    (target-logbitp-args <a class="sym-link system" href="../../../axioms.html#def-pseudo-term-list-listp" data-sym="PSEUDO-TERM-LIST-LISTP">pseudo-term-list-listp</a>)
    (config eqbylbp-config-p)
    state)
  <span class="keyword">:mode</span> <span class="keyword">:program</span> (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> examples)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil target-logbitp-args state)) ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> first-examples
         target-logbitp-args
         state) (eqbylbp-try-example alist
          (car examples)
          target-logbitp-args
          config
          state))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> rest-examples
         target-logbitp-args
         state) (eqbylbp-try-examples alist
          (cdr examples)
          target-logbitp-args
          config
          state)))
    (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> first-examples rest-examples)
      target-logbitp-args
      state)))</pre>
  </div>

<div class="form-block other" id="form-38" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define eqbylbp-decide-examples-lit
  ((lit <a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a>) (var symbolp)
    (target-logbitp-args <a class="sym-link system" href="../../../axioms.html#def-pseudo-term-list-listp" data-sym="PSEUDO-TERM-LIST-LISTP">pseudo-term-list-listp</a>)
    (config eqbylbp-config-p)
    state)
  <span class="keyword">:mode</span> <span class="keyword">:program</span> (b* (((unless (<a class="sym-link system" href="../../../axioms.html#def-mbt" data-sym="MBT">mbt</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-pseudo-termp" data-sym="PSEUDO-TERMP">pseudo-termp</a> lit)
            (eqbylbp-config-p config)))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil target-logbitp-args state)) ((eqbylbp-config config) config)
      (rule config.instance-rule)
      ((wcp-instance-rule rule) rule)
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> unify-ok alist) (simple-one-way-unify rule.pred lit nil))
      ((unless unify-ok) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil target-logbitp-args state))
      (restriction-term config.restriction)
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> res) (if (equal restriction-term ''<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
          (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
          (witness-eval-restriction restriction-term
            alist
            state)))
      (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> <a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a>
          (raise <span class="string">"Restriction term evaluation failed! ~x0"</span>
            <a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a>)))
      ((unless (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> <a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a>) res)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil target-logbitp-args state))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> &amp;
         avail-logbitp-args
         state) (eqbylbp-eval-example alist
          var
          config
          state))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> example-terms state) (eqbylbp-collect-examples-targets avail-logbitp-args
          var
          target-logbitp-args
          nil
          config
          state))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> examples
         target-logbitp-args
         state) (eqbylbp-try-examples alist
          example-terms
          target-logbitp-args
          config
          state))
      ((when examples) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> examples
          target-logbitp-args
          state)))
    (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> (make-wcp-example-app <span class="keyword">:instrule</span> rule
          <span class="keyword">:bindings</span> (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> var)))
      (<a class="sym-link system" href="../../../axioms.html#def-union-equal" data-sym="UNION-EQUAL">union-equal</a> avail-logbitp-args
        target-logbitp-args)
      state)))</pre>
  </div>

<div class="form-block other" id="form-39" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define eqbylbp-decide-examples
  ((clause pseudo-term-listp) (var symbolp)
    (target-logbitp-args <a class="sym-link system" href="../../../axioms.html#def-pseudo-term-list-listp" data-sym="PSEUDO-TERM-LIST-LISTP">pseudo-term-list-listp</a>)
    (config eqbylbp-config-p)
    state)
  <span class="keyword">:mode</span> <span class="keyword">:program</span> (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> clause)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil target-logbitp-args state)) ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> examples1
         target-logbitp-args
         state) (eqbylbp-decide-examples-lit (car clause)
          var
          target-logbitp-args
          config
          state))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> rest-examples
         target-logbitp-args
         state) (eqbylbp-decide-examples (cdr clause)
          var
          target-logbitp-args
          config
          state)))
    (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> (cons examples1 rest-examples)
      target-logbitp-args
      state)))</pre>
  </div>

<div class="form-block other" id="form-40" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define eqbylbp-decide-examples-passes
  ((<a class="sym-link system" href="../../../axioms.html#def-count" data-sym="COUNT">count</a> <a class="sym-link system" href="../../../axioms.html#def-posp" data-sym="POSP">posp</a>) (clause pseudo-term-listp)
    (var symbolp)
    (target-logbitp-args <a class="sym-link system" href="../../../axioms.html#def-pseudo-term-list-listp" data-sym="PSEUDO-TERM-LIST-LISTP">pseudo-term-list-listp</a>)
    (config eqbylbp-config-p)
    state)
  <span class="keyword">:mode</span> <span class="keyword">:program</span> (b* (((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> examples
        target-logbitp-args
        state) (eqbylbp-decide-examples clause
         var
         target-logbitp-args
         config
         state)) (<a class="sym-link system" href="../../../axioms.html#def-count" data-sym="COUNT">count</a> (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> <a class="sym-link system" href="../../../axioms.html#def-count" data-sym="COUNT">count</a>))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> <a class="sym-link system" href="../../../axioms.html#def-count" data-sym="COUNT">count</a>)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> examples
          target-logbitp-args
          state)))
    (eqbylbp-decide-examples-passes <a class="sym-link system" href="../../../axioms.html#def-count" data-sym="COUNT">count</a>
      clause
      var
      target-logbitp-args
      config
      state)))</pre>
  </div>

<div class="form-block other" id="form-41" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define wcp-example-apps-listp
  (x)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x nil)
    (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (wcp-example-appsp (car x))
      (wcp-example-apps-listp (cdr x))))
  ///
  (defopen wcp-example-apps-listp-when-consp
    (wcp-example-apps-listp x)
    <span class="keyword">:hyp</span> (consp x)
    <span class="keyword">:hint</span> (<span class="keyword">:expand</span> ((wcp-example-apps-listp x)))
    <span class="keyword">:rule-classes</span> ((<span class="keyword">:rewrite</span> <span class="keyword">:backchain-limit-lst</span> <span class="number">0</span>))))</pre>
  </div>

<div class="form-block other" id="form-42" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define eqbylbp-pair-hints
  ((witness-apps <a class="sym-link system" href="../../../axioms.html#def-boolean-listp" data-sym="BOOLEAN-LISTP">boolean-listp</a>) (examples wcp-example-apps-listp)
    (config eqbylbp-config-p))
  <span class="keyword">:guard</span> (<a class="sym-link system" href="../../../axioms.html#def-eql" data-sym="EQL">eql</a> (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> witness-apps)
    (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> examples))
  <span class="keyword">:returns</span> (actions wcp-lit-actions-listp)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> witness-apps)
    nil
    (cons (make-wcp-lit-actions <span class="keyword">:witnesses</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (car witness-apps)
          (<a class="sym-link system" href="../../../axioms.html#def-mbt" data-sym="MBT">mbt</a> (eqbylbp-config-p config))
          (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> (eqbylbp-config-&gt;witness-rule config)))
        <span class="keyword">:examples</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-mbt" data-sym="MBT">mbt</a> (wcp-example-appsp (car examples)))
          (car examples)))
      (eqbylbp-pair-hints (cdr witness-apps)
        (cdr examples)
        config))))</pre>
  </div>

<div class="form-block other" id="form-43" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define eqbylbp-witness-hints
  ((clause pseudo-term-listp) (config eqbylbp-config-p)
    state)
  <span class="keyword">:mode</span> <span class="keyword">:program</span> (b* (((eqbylbp-config config) config) ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> apply-witnesses new-lits) (eqbylbp-check-witnesses clause
          config
          state))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> new-lits-simp state) (eqbylbp-simplify-each (wcp-beta-reduce-list new-lits)
          config
          '<a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a>
          state))
      (targets (eqbylbp-collect-terms-list (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> new-lits-simp clause)))
      (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> config.verbosep
          (<a class="sym-link system" href="../../../axioms.html#def-cw" data-sym="CW">cw</a> <span class="string">"Targets: ~x0~%"</span> targets)))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> examples ?targets state) (eqbylbp-decide-examples-passes config.passes
          clause
          'eqbylbp-index
          targets
          config
          state)))
    (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> (eqbylbp-pair-hints apply-witnesses
        examples
        config)
      state)))</pre>
  </div>

<div class="form-block other" id="form-44" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define logbitp-reasoning-fn
  (clause restrict
    passes
    prune-examples
    simp-hint
    add-hints
    verbosep
    stablep
    state)
  <span class="keyword">:mode</span> <span class="keyword">:program</span> (b* (((unless stablep) (<a class="sym-link system" href="../../../axioms.html#def-value" data-sym="VALUE">value</a> nil)) ((<a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> restrict-term) (translate restrict
          <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
          nil
          <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
          '<a class="sym-link local-def" href="#def-logbitp-reasoning" data-sym="LOGBITP-REASONING" title="(defmacro bitops::logbitp-reasoning
          (
           &amp;key (bitops::restrict &#39;t) (bitops::passes &#39;1)
           (bitops::verbosep &#39;nil) (bitops::prune-examples &#39;t)
           (bitops::simp-hint
...">logbitp-reasoning</a>
          (<a class="sym-link system" href="../../../axioms.html#def-w" data-sym="W">w</a> state)
          state))
      (witness-rule (cdr (<a class="sym-link system" href="../../../axioms.html#def-assoc" data-sym="ASSOC">assoc</a> 'unequal-by-logbitp-witnessing
            (<a class="sym-link system" href="../../../axioms.html#def-table-alist" data-sym="TABLE-ALIST">table-alist</a> 'witness-cp-witness-rules
              (<a class="sym-link system" href="../../../axioms.html#def-w" data-sym="W">w</a> state)))))
      (instance-rule (cdr (<a class="sym-link system" href="../../../axioms.html#def-assoc" data-sym="ASSOC">assoc</a> 'equal-by-logbitp-instancing
            (<a class="sym-link system" href="../../../axioms.html#def-table-alist" data-sym="TABLE-ALIST">table-alist</a> 'witness-cp-instance-rules
              (<a class="sym-link system" href="../../../axioms.html#def-w" data-sym="W">w</a> state)))))
      (config (make-eqbylbp-config <span class="keyword">:restriction</span> restrict-term
          <span class="keyword">:witness-rule</span> witness-rule
          <span class="keyword">:instance-rule</span> instance-rule
          <span class="keyword">:prune-examples</span> prune-examples
          <span class="keyword">:simp-hint</span> simp-hint
          <span class="keyword">:add-hints</span> add-hints
          <span class="keyword">:passes</span> passes
          <span class="keyword">:verbosep</span> verbosep))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> cp-hint state) (eqbylbp-witness-hints clause
          config
          state)))
    (<a class="sym-link system" href="../../../axioms.html#def-value" data-sym="VALUE">value</a> `(<span class="keyword">:clause-processor</span> (witness-cp clause
          ',BITOPS::CP-HINT
          state) . ,BITOPS::ADD-HINTS))))</pre>
  </div>

<div class="form-block other" id="form-45" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc <a class="sym-link local-def" href="#def-logbitp-reasoning" data-sym="LOGBITP-REASONING" title="(defmacro bitops::logbitp-reasoning
          (
           &amp;key (bitops::restrict &#39;t) (bitops::passes &#39;1)
           (bitops::verbosep &#39;nil) (bitops::prune-examples &#39;t)
           (bitops::simp-hint
...">logbitp-reasoning</a>
  <span class="keyword">:parents</span> (bitops)
  <span class="keyword">:short</span> <span class="string">"A computed hint for proving bit-twiddling theorems by smartly sampling bits"</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;@(&#39;Logbitp-reasoning&#39;) is a computed hint for proving theorems
about bitvector operations.  Example usage:&lt;/p&gt;
@({
 (defthm pass-context-of-ash
   (implies (equal (logand (ash mask (- (ifix n))) a1)
                   (logand (ash mask (- (ifix n))) a2))
            (equal (logand mask (ash a1 n))
                   (logand mask (ash a2 n))))
   :hints ((logbitp-reasoning)))
 })

&lt;p&gt;It works by:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Creating &lt;i&gt;witnesses&lt;/i&gt; for inequality hyps/equality conclusions, replacing
 @(&#39;(not (equal a b))&#39;) with:
@({
 (implies (and (integerp x) (integerp y))
          (and (natp bit)
               (not (equal (logbitp bit x)
                           (logbitp bit y)))))
 })
where @(&#39;bit&#39;) is a fresh variable,&lt;/li&gt;
&lt;li&gt;&lt;i&gt;Instantiating&lt;/i&gt; equality hyps/inequality conclusions, replacing
@(&#39;(equal a b)&#39;) with @(&#39;(equal (logbitp bit a) (logbitp bit b))&#39;), for one or
more several values of @(&#39;bit&#39;).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The main work done by this computed hint is to decide how to instantiate
@(&#39;bit&#39;) for each of the equality hyps/inequality conclusions. To do this
we:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Keep track of a list of logbitp term &quot;targets&quot;, which we think of as
already appearing in our goal either due to witnessing or instantiation.&lt;/li&gt;
&lt;li&gt;Try to instantiate equality hyps so as to create more occurrences of
existing targets.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;We take @(&#39;pass-context-of-ash&#39;) above as an example.&lt;/p&gt;
&lt;ol&gt;

&lt;li&gt;First we find the literals of the clause that we&#39;ll create witnesses for --
in this case, the conclusion.  We&#39;ll introduce some new variable @(&#39;wbit&#39;) and
our new conclusion will be (omitting some type info that isn&#39;t directly
relevant)
@({
 (equal (logbitp wbit (logand mask (ash a1 n)))
        (logbitp wbit (logand mask (ash a2 n))))
 })
&lt;/li&gt;

&lt;li&gt;Next we simplify this new conclusion and extract the logbitp terms that the
simplified term contains:
@({
 (logbitp wbit mask)
 (logbitp (+ (- (ifix n)) wbit) a1)
 (logbitp (+ (- (ifix n)) wbit) a2)
 })
These are now our target terms.&lt;/li&gt;

&lt;li&gt;Next we look for instantiations of our hypothesis that, when simplified,
will contain one or more of these target terms.  To do this, we first
instantiate it with a variable @(&#39;ibit&#39;), obtaining:
@({
 (equal (logbitp ibit (logand (ash mask (- (ifix n))) a1))
        (logbitp ibit (logand (ash mask (- (ifix n))) a1)))
 })
&lt;/li&gt;
&lt;li&gt;Then we simplify the result and extract the resulting logbitp terms:
@({
  (logbitp ibit a1)
  (logbitp ibit a2)
  (logbitp (+ (ifix n) (nfix ibit)) mask)
 })
&lt;/li&gt;

&lt;li&gt;Now we try to find values of @(&#39;ibit&#39;) that will make one or more of these
results match one or more of the target terms.  We immediately find that by
setting @(&#39;ibit&#39;) to @(&#39;(+ (- (nfix n)) wbit)&#39;) we create some matches.  So we
decide to instantiate the hyp using this term as our bit index.&lt;/li&gt;

&lt;li&gt;All of the above was done just to compute a hint.  The actual hint we
provide is a call to @(see witness-cp), a clause processor that supports this
sort of witness creation and instantiation, with instructions to do the
witnessing and instantiation steps that we&#39;ve settled on.  Once this clause
processor runs, the resulting proof splits into 8 subgoals that are all quickly
proved.&lt;/li&gt;

&lt;/ol&gt;

&lt;p&gt;@(&#39;Logbitp-reasoning&#39;) is a macro that can take a few optional arguments,
but reasonable defaults (in the invocation below) are provided:&lt;/p&gt;
@({
 :hints ((logbitp-reasoning
          :restrict t
          :passes 1
          :verbosep nil
          :simp-hint (:in-theory
                       (enable* logbitp-case-splits
                                logbitp-when-bit
                                logbitp-of-const-split))
          :add-hints (:in-theory
                      (enable* logbitp-case-splits
                               logbitp-when-bit
                               logbitp-of-const-split))))
 })

&lt;p&gt;The meanings of these:&lt;/p&gt;

&lt;ul&gt; &lt;li&gt;@(&#39;:restrict&#39;) is a term in the
variables @(&#39;x&#39;) and @(&#39;y&#39;) that restricts the equality literals to which we
will apply witnessing/instantiation.  For example,
 @({
   :restrict (or (and (consp x) (eq (car x) &#39;binary-logand))
                 (and (consp y) (eq (car y) &#39;binary-logand)))
  })
will cause the hint to ignore any equality literals that don&#39;t have an argument
that is a call of logand.&lt;/li&gt;
&lt;li&gt;@(&#39;:passes&#39;) determines the number of passes through the clause we use to
collect instantiations and target terms.  Instantiations can add new targets,
and the more targets there are, the more instantiations may be found.&lt;/li&gt;
&lt;li&gt;@(&#39;:simp-hint&#39;) is the hint given to the simplifier while deciding on the
instantiations.&lt;/li&gt;
&lt;li&gt;@(&#39;:add-hints&#39;) are hints given at the same time as the clause processor hint.&lt;/li&gt;
&lt;/ul&gt;
"</span>)</pre>
  </div>

<div class="form-block macro" id="def-logbitp-reasoning" data-defines="LOGBITP-REASONING" data-references="STATE,STABLE-UNDER-SIMPLIFICATIONP,CLAUSE,LOGBITP-REASONING-FN,QUASIQUOTE,ADD-HINTS,LOGBITP-OF-CONST-SPLIT,LOGBITP-WHEN-BIT,LOGBITP-CASE-SPLITS,ENABLE*,SIMP-HINT,PRUNE-EXAMPLES,VERBOSEP,PASSES,T,QUOTE,RESTRICT,&KEY,DEFMACRO" typeof="Code">
    <div class="form-header"><span class="form-name" property="name" data-sym="LOGBITP-REASONING">logbitp-reasoning</span><span class="form-type">macro</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> <a class="sym-link local-def" href="#def-logbitp-reasoning" data-sym="LOGBITP-REASONING" title="(defmacro bitops::logbitp-reasoning
          (
           &amp;key (bitops::restrict &#39;t) (bitops::passes &#39;1)
           (bitops::verbosep &#39;nil) (bitops::prune-examples &#39;t)
           (bitops::simp-hint
...">logbitp-reasoning</a>
  (&amp;key (restrict '<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
    (passes '<span class="number">1</span>)
    (verbosep 'nil)
    (prune-examples '<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
    (simp-hint '(<span class="keyword">:in-theory</span> (enable* logbitp-case-splits
          logbitp-when-bit
          logbitp-of-const-split)))
    (add-hints '(<span class="keyword">:in-theory</span> (enable* logbitp-case-splits
          logbitp-when-bit
          logbitp-of-const-split))))
  `(logbitp-reasoning-fn clause
    ',BITOPS::RESTRICT
    ',BITOPS::PASSES
    ',BITOPS::PRUNE-EXAMPLES
    ',BITOPS::SIMP-HINT
    ',BITOPS::ADD-HINTS
    ',BITOPS::VERBOSEP
    stable-under-simplificationp
    state))</pre>
  </div>

<div class="form-block other" id="form-47" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../std/system/non-parallel-book.html" title="Open std/system/non-parallel-book">"std/system/non-parallel-book"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>))</pre>
  </div>

<div class="form-block other" id="form-48" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (non-parallel-book))</pre>
  </div>

<div class="form-block other" id="form-49" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> pass-context-of-logapp
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal (<a class="sym-link system" href="../../../axioms.html#def-logand" data-sym="LOGAND">logand</a> (ash mask (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> n)))
            b1)
          (<a class="sym-link system" href="../../../axioms.html#def-logand" data-sym="LOGAND">logand</a> (ash mask (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> n)))
            b2))
        (equal (<a class="sym-link system" href="../../../axioms.html#def-logand" data-sym="LOGAND">logand</a> (loghead n mask) a1)
          (<a class="sym-link system" href="../../../axioms.html#def-logand" data-sym="LOGAND">logand</a> (loghead n mask) a2)))
      (equal (<a class="sym-link system" href="../../../axioms.html#def-logand" data-sym="LOGAND">logand</a> mask
          (logapp n a1 b1))
        (<a class="sym-link system" href="../../../axioms.html#def-logand" data-sym="LOGAND">logand</a> mask
          (logapp n a2 b2))))
    <span class="keyword">:hints</span> ((<a class="sym-link local-def" href="#def-logbitp-reasoning" data-sym="LOGBITP-REASONING" title="(defmacro bitops::logbitp-reasoning
          (
           &amp;key (bitops::restrict &#39;t) (bitops::passes &#39;1)
           (bitops::verbosep &#39;nil) (bitops::prune-examples &#39;t)
           (bitops::simp-hint
...">logbitp-reasoning</a>))))</pre>
  </div>

<div class="form-block other" id="form-50" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> pass-context-of-ash
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (equal (<a class="sym-link system" href="../../../axioms.html#def-logand" data-sym="LOGAND">logand</a> (ash mask (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n)))
          a1)
        (<a class="sym-link system" href="../../../axioms.html#def-logand" data-sym="LOGAND">logand</a> (ash mask (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n)))
          a2))
      (equal (<a class="sym-link system" href="../../../axioms.html#def-logand" data-sym="LOGAND">logand</a> mask (ash a1 n))
        (<a class="sym-link system" href="../../../axioms.html#def-logand" data-sym="LOGAND">logand</a> mask (ash a2 n))))
    <span class="keyword">:hints</span> ((<a class="sym-link local-def" href="#def-logbitp-reasoning" data-sym="LOGBITP-REASONING" title="(defmacro bitops::logbitp-reasoning
          (
           &amp;key (bitops::restrict &#39;t) (bitops::passes &#39;1)
           (bitops::verbosep &#39;nil) (bitops::prune-examples &#39;t)
           (bitops::simp-hint
...">logbitp-reasoning</a>))))</pre>
  </div>


  </main>
  
<script>
// ACL2 Book HTML Documentation - Interactive Features
// Generated by cert2 - build2 system

// State
let activeFilter = null;
let activePartFilter = null;
let activeNameFilter = null;
let currentFontSize = 14;

// Theme management
function getStoredTheme() {
  return localStorage.getItem('acl2-theme') || 'dark';
}

function setTheme(theme) {
  if (theme === 'light') {
    document.documentElement.setAttribute('data-theme', 'light');
    document.getElementById('theme-toggle').textContent = '🌙';
  } else {
    document.documentElement.removeAttribute('data-theme');
    document.getElementById('theme-toggle').textContent = '☀️';
  }
  localStorage.setItem('acl2-theme', theme);
}

function toggleTheme() {
  const current = getStoredTheme();
  setTheme(current === 'dark' ? 'light' : 'dark');
}

// Font size management
function getStoredFontSize() {
  return parseInt(localStorage.getItem('acl2-fontsize') || '14', 10);
}

function setFontSize(size) {
  size = Math.max(10, Math.min(24, size)); // Clamp between 10-24
  currentFontSize = size;
  document.body.style.fontSize = size + 'px';
  localStorage.setItem('acl2-fontsize', size.toString());
}

function increaseFontSize() {
  setFontSize(currentFontSize + 2);
}

function decreaseFontSize() {
  setFontSize(currentFontSize - 2);
}

// Get all form blocks
function getFormBlocks() {
  return document.querySelectorAll('.form-block');
}

// Clear all filters
function clearFilter() {
  activeFilter = null;
  activePartFilter = null;
  activeNameFilter = null;
  getFormBlocks().forEach(b => {
    b.classList.remove('hidden', 'dimmed');
  });
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  const status = document.querySelector('.filter-status');
  status.classList.remove('active');
  // Slide name filter back to original position
  document.querySelector('.controls-left').style.transform = '';
  // Clear the name filter input
  const nameInput = document.getElementById('name-filter');
  if (nameInput) nameInput.value = '';
}

// Show filter status and slide name filter right
function showFilterStatus(text) {
  const status = document.querySelector('.filter-status');
  status.classList.add('active');
  status.querySelector('.filter-text').textContent = text;
  // Slide name filter to the right to make room
  setTimeout(() => {
    const statusWidth = status.offsetWidth;
    document.querySelector('.controls-left').style.transform = `translateX(${statusWidth + 15}px)`;
  }, 10);
}

// Filter to show only forms that define or reference a symbol
function filterBySymbol(symName, showUsedBy) {
  clearFilter();
  activeFilter = symName;
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines;
    const references = (block.dataset.references || '').split(',');
    const usedBy = (block.dataset.usedBy || '').split(',');
    
    let show = false;
    if (showUsedBy) {
      // Show forms that USE this symbol
      show = references.includes(symName) || definesName === symName;
    } else {
      // Show forms that this symbol USES
      show = usedBy.includes(symName) || definesName === symName;
    }
    
    if (show) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering by: ${symName} (${visibleCount} items)`);
}

// Filter by defthm part (term, hints, rule-classes, etc.)
function filterByPart(formId, partName) {
  clearFilter();
  activePartFilter = { formId, partName };
  
  // Get the part's referenced symbols
  // data-part-term becomes dataset.partTerm, data-part-hints becomes dataset.partHints, etc.
  const block = document.getElementById(formId);
  const datasetKey = 'part' + partName.charAt(0).toUpperCase() + partName.slice(1).replace(/-([a-z])/g, (g) => g[1].toUpperCase());
  const partData = block.dataset[datasetKey];
  if (!partData) return;
  
  const partSyms = partData.split(',').filter(s => s);
  
  // Highlight the button
  block.querySelector(`.part-btn[data-part="${partName}"]`).classList.add('active');
  
  // Hide forms not referenced by this part
  getFormBlocks().forEach(b => {
    const definesName = b.dataset.defines;
    if (b.id === formId || partSyms.includes(definesName)) {
      b.classList.remove('hidden');
    } else {
      b.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering ${formId} :${partName} (${partSyms.length} references)`);
}

// Filter by name (substring or regex)
function filterByName(pattern, useRegex) {
  // Clear other filters but keep the input value
  activeFilter = null;
  activePartFilter = null;
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  
  if (!pattern || pattern.trim() === '') {
    // Empty pattern - show all
    activeNameFilter = null;
    getFormBlocks().forEach(b => b.classList.remove('hidden'));
    const status = document.querySelector('.filter-status');
    status.classList.remove('active');
    document.querySelector('.controls-left').style.transform = '';
    return;
  }
  
  activeNameFilter = pattern;
  
  let matcher;
  let isValidRegex = true;
  
  if (useRegex) {
    try {
      matcher = new RegExp(pattern, 'i');
    } catch (e) {
      // Invalid regex - show error in status and don't filter
      showFilterStatus(`Invalid regex: ${e.message}`);
      return;
    }
  } else {
    // Plain substring match (case-insensitive)
    const lowerPattern = pattern.toLowerCase();
    matcher = { test: (s) => s.toLowerCase().includes(lowerPattern) };
  }
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines || '';
    if (matcher.test(definesName)) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  const modeText = useRegex ? 'regex' : 'name';
  showFilterStatus(`Filtering by ${modeText}: "${pattern}" (${visibleCount} matches)`);
}

// Click on a name to show what references it
function handleNameClick(symName) {
  if (activeFilter === symName) {
    clearFilter();
  } else {
    filterBySymbol(symName, true);
  }
}

// Navigate to a definition (same file or different)
function navigateTo(symName, file) {
  if (file) {
    // External file - navigate
    window.location.href = file + '.html#def-' + symName.toLowerCase();
  } else {
    // Same file - scroll
    const target = document.getElementById('def-' + symName.toLowerCase());
    if (target) {
      target.scrollIntoView({ behavior: 'smooth', block: 'center' });
      target.classList.add('highlight');
      setTimeout(() => target.classList.remove('highlight'), 400);
    }
  }
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  // Part buttons
  document.querySelectorAll('.part-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const formId = btn.closest('.form-block').id;
      const partName = btn.dataset.part;
      if (activePartFilter && activePartFilter.formId === formId && 
          activePartFilter.partName === partName) {
        clearFilter();
      } else {
        filterByPart(formId, partName);
      }
    });
  });
  
  // Clear filter button
  document.querySelector('.clear-filter').addEventListener('click', clearFilter);
  
  // Name filter input
  const nameFilter = document.getElementById('name-filter');
  const regexToggle = document.getElementById('regex-toggle');
  
  let filterTimeout = null;
  nameFilter.addEventListener('input', () => {
    // Debounce the filter to avoid excessive updates while typing
    clearTimeout(filterTimeout);
    filterTimeout = setTimeout(() => {
      filterByName(nameFilter.value, regexToggle.checked);
    }, 150);
  });
  
  // Re-filter when regex toggle changes
  regexToggle.addEventListener('change', () => {
    if (nameFilter.value) {
      filterByName(nameFilter.value, regexToggle.checked);
    }
  });
  
  // Allow Escape key to clear filter when in input
  nameFilter.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      clearFilter();
      nameFilter.blur();
    }
  });
  
  // Symbol references (old span-based refs)
  document.querySelectorAll('.sym-ref').forEach(ref => {
    ref.addEventListener('click', (e) => {
      e.stopPropagation();
      const sym = ref.dataset.sym;
      const file = ref.dataset.file;
      if (file) {
        navigateTo(sym, file);
      } else {
        handleNameClick(sym);
      }
    });
  });
  
  // Symbol links (new anchor-based links)
  // These use standard <a> tags so navigation happens automatically
  // But we need to clear filters if target would be hidden
  document.querySelectorAll('.sym-link').forEach(link => {
    link.addEventListener('click', (e) => {
      const href = link.getAttribute('href');
      if (href && href.startsWith('#')) {
        // Local link - check if target is hidden by filter
        const targetId = href.substring(1);
        const target = document.getElementById(targetId);
        if (target) {
          // If target is hidden, clear the filter first
          if (target.classList.contains('hidden')) {
            clearFilter();
          }
          // Add highlight effect after a short delay
          setTimeout(() => {
            target.classList.add('highlight');
            setTimeout(() => target.classList.remove('highlight'), 400);
          }, 100);
        }
      }
      // For external links, default behavior handles navigation
    });
  });
  
  // Form names (show what uses them)
  document.querySelectorAll('.form-name').forEach(name => {
    name.addEventListener('click', (e) => {
      handleNameClick(name.dataset.sym);
    });
  });
  
  // Handle hash navigation (when arriving at page with #anchor)
  if (window.location.hash) {
    const target = document.querySelector(window.location.hash);
    if (target) {
      setTimeout(() => {
        target.scrollIntoView({ behavior: 'smooth', block: 'center' });
        target.classList.add('highlight');
        setTimeout(() => target.classList.remove('highlight'), 400);
      }, 200);
    }
  }
  
  // Initialize theme from storage
  setTheme(getStoredTheme());
  
  // Initialize font size from storage
  currentFontSize = getStoredFontSize();
  setFontSize(currentFontSize);
  
  // Theme toggle button
  document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
  
  // Font size buttons
  document.getElementById('font-larger').addEventListener('click', increaseFontSize);
  document.getElementById('font-smaller').addEventListener('click', decreaseFontSize);
});

</script>

</body>
</html>
<!DOCTYPE html>
<html lang="en" vocab="http://schema.org/" typeof="SoftwareSourceCode">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>aig-base - ACL2 Book</title>
  <meta property="name" content="aig-base">
  <meta property="programmingLanguage" content="ACL2">
  
<style>
/* ACL2 Book HTML Documentation Styles */
/* Generated by cert2 - build2 system */

/* Dark theme (default) */
:root {
  --bg: #1e1e2e;
  --fg: #cdd6f4;
  --comment: #6c7086;
  --keyword: #cba6f7;
  --string: #a6e3a1;
  --function: #89b4fa;
  --type: #f9e2af;
  --link: #89dceb;
  --link-hover: #f5c2e7;
  --highlight: rgba(137, 180, 250, 0.2);
  --border: #313244;
  --block-bg: rgba(49, 50, 68, 0.5);
  --btn-bg: #313244;
  --btn-hover: rgba(137, 180, 250, 0.2);
}

/* Light theme */
[data-theme="light"] {
  --bg: #eff1f5;
  --fg: #4c4f69;
  --comment: #6c6f85;
  --keyword: #8839ef;
  --string: #40a02b;
  --function: #1e66f5;
  --type: #df8e1d;
  --link: #04a5e5;
  --link-hover: #ea76cb;
  --highlight: rgba(30, 102, 245, 0.15);
  --border: #ccd0da;
  --block-bg: rgba(204, 208, 218, 0.3);
  --btn-bg: #ccd0da;
  --btn-hover: rgba(30, 102, 245, 0.15);
}

body {
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  background: var(--bg);
  color: var(--fg);
  margin: 0;
  padding: 20px;
  line-height: 1.6;
  font-size: 14px;
  transition: background 0.1s, color 0.1s;
}

/* Controls toolbar */
.controls-left {
  position: fixed;
  top: 10px;
  left: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
  transition: transform 0.1s ease;
}

.controls-right {
  position: fixed;
  top: 10px;
  right: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
}

.control-btn {
  padding: 6px 12px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-family: inherit;
  font-size: 14px;
  transition: all 0.1s;
}

.control-btn:hover {
  background: var(--btn-hover);
  border-color: var(--link);
}

.name-filter {
  padding: 6px 10px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  font-family: inherit;
  font-size: 13px;
  width: 150px;
  transition: all 0.1s;
}

.name-filter:focus {
  outline: none;
  border-color: var(--link);
  width: 200px;
}

.name-filter::placeholder {
  color: var(--comment);
}

.regex-label {
  display: flex;
  align-items: center;
  gap: 4px;
  color: var(--comment);
  font-size: 12px;
  cursor: pointer;
}

.regex-label input {
  cursor: pointer;
}

.book-header {
  border-bottom: 2px solid var(--border);
  padding-bottom: 20px;
  margin-bottom: 20px;
}

.book-header h1 {
  color: var(--keyword);
  margin: 0;
}

.book-header .path {
  color: var(--comment);
  font-size: 0.9em;
}

.book-header .path .source-link {
  color: var(--comment);
  text-decoration: none;
}

.book-header .path .source-link:hover {
  color: var(--link);
  text-decoration: underline;
}

.form-block {
  margin: 10px 0;
  padding: 15px;
  background: var(--block-bg);
  border-radius: 8px;
  border-left: 3px solid var(--border);
}

.form-block.theorem { border-left-color: var(--keyword); }
.form-block.function { border-left-color: var(--function); }
.form-block.macro { border-left-color: var(--type); }
.form-block.include-book { border-left-color: var(--string); }

.form-block.hidden { display: none; }
.form-block.dimmed { opacity: 0.3; }

.form-block.highlight {
  animation: highlight-pulse 0.4s ease-out;
}

@keyframes highlight-pulse {
  0% { background: var(--highlight); box-shadow: 0 0 20px var(--link); }
  100% { background: rgba(49, 50, 68, 0.5); box-shadow: none; }
}

.form-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.form-name {
  color: var(--function);
  font-weight: bold;
  cursor: pointer;
}

.form-name:hover {
  color: var(--link-hover);
  text-decoration: underline;
}

.form-type {
  color: var(--comment);
  font-size: 0.85em;
}

pre.code {
  margin: 0;
  overflow-x: auto;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.sym-ref {
  color: var(--link);
  cursor: pointer;
  border-radius: 2px;
}

.sym-ref:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.sym-ref.local-def { color: var(--function); font-weight: bold; }
.sym-ref.external { color: var(--type); }

/* Symbol links (clickable hyperlinks) */
.sym-link {
  color: var(--link);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
  position: relative;
}

.sym-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

.sym-link.local-def {
  color: var(--function);
  font-weight: bold;
}

.sym-link.external {
  color: var(--type);
}

/* Tooltips using title attribute with custom styling */
.sym-link[title] {
  /* Browser will show title on hover */
}

/* Syntax highlighting in code blocks */
.keyword {
  color: var(--keyword);
}

.string {
  color: var(--string);
}

.number {
  color: #f77524; /* orange */
}

/* Include-book path links */
.include-path {
  color: var(--string);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
}

.include-path:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

/* Part buttons for defthm */
.part-buttons {
  display: flex;
  gap: 5px;
  margin: 10px 0;
  flex-wrap: wrap;
}

.part-btn {
  padding: 4px 10px;
  background: var(--border);
  border: 1px solid var(--comment);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-size: 0.85em;
  font-family: inherit;
}

.part-btn:hover {
  background: var(--highlight);
  border-color: var(--link);
}

.part-btn.active {
  background: var(--link);
  color: var(--bg);
  border-color: var(--link);
}

/* References panel */
.refs-panel {
  margin-top: 10px;
  padding: 10px;
  background: rgba(0,0,0,0.2);
  border-radius: 4px;
  display: none;
}

.refs-panel.visible { display: block; }

.refs-panel h4 {
  margin: 0 0 5px 0;
  color: var(--comment);
  font-size: 0.9em;
}

.refs-list {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

/* Included books section */
.includes-section {
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(49, 50, 68, 0.3);
  border-radius: 8px;
  border: 1px solid var(--border);
}

.includes-section h2 {
  margin: 0 0 10px 0;
  color: var(--comment);
  font-size: 1em;
  font-weight: normal;
}

.includes-list {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.include-link {
  padding: 6px 12px;
  background: var(--border);
  border-radius: 4px;
  color: var(--link);
  text-decoration: none;
  font-size: 0.9em;
  transition: all 0.1s;
}

.include-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.include-link.local {
  border-left: 2px solid var(--comment);
}

/* Filter status */
.filter-status {
  position: fixed;
  top: 10px;
  left: 20px;
  background: var(--bg);
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: 4px;
  z-index: 201;
  display: none;
  align-items: center;
  gap: 10px;
}

.filter-status.active {
  display: flex;
  align-items: center;
  gap: 10px;
}

.clear-filter {
  padding: 5px 15px;
  background: var(--keyword);
  color: var(--bg);
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

/* RDFa vocab indicator */
[vocab] { /* semantic web annotations present */ }

</style>

</head>
<body>
  <div class="controls-left">
    <input type="text" id="name-filter" class="name-filter" placeholder="Filter by name..." title="Filter definitions by name">
    <label class="regex-label"><input type="checkbox" id="regex-toggle"> regex</label>
  </div>

  <div class="controls-right">
    <button class="control-btn" id="theme-toggle" title="Toggle light/dark theme">☀️</button>
    <button class="control-btn" id="font-smaller" title="Decrease font size">A-</button>
    <button class="control-btn" id="font-larger" title="Increase font size">A+</button>
  </div>

  <div class="filter-status">
    <span class="filter-text">Filtering...</span>
    <button class="clear-filter">Clear Filter</button>
  </div>
  
  <div class="book-header">
    <h1 property="name">aig-base</h1>
    <div class="path"><a href="aig-base.lisp" class="source-link">books/centaur/aig/aig-base</a></div>
  </div>
  
  <main property="text">
  <div class="includes-section">
    <h2>Included Books</h2>
    <div class="includes-list">
      <a class="include-link" href="../../std/util/define.html" title="std/util/define">define</a>
      <a class="include-link" href="../misc/hons-alphorder-merge.html" title="../misc/hons-alphorder-merge">hons-alphorder-merge</a>
    </div>
  </div>

<div class="form-block other" id="form-0" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-in-package" data-sym="IN-PACKAGE">in-package</a> <span class="string">"ACL2"</span>)</pre>
  </div>

<div class="form-block include-book" id="form-1" typeof="Code">
    <div class="form-header"><span class="form-type">include-book</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../std/util/define.html" title="Open std/util/define">"std/util/define"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block include-book" id="form-2" typeof="Code">
    <div class="form-header"><span class="form-type">include-book</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../misc/hons-alphorder-merge.html" title="Open ../misc/hons-alphorder-merge">"../misc/hons-alphorder-merge"</a>)</pre>
  </div>

<div class="form-block other" id="form-3" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-var-p
  (x)
  <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x nil)))
    (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (car x) nil) (cdr x) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-var-p-of-aig-var
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> x (aig-var-p (cons nil x))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-var-p-of-atom
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-var-p x))
      (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-booleanp" data-sym="BOOLEANP">booleanp</a> x)))))
    <span class="keyword">:rule-classes</span> <span class="keyword">:compound-recognizer</span>))</pre>
  </div>

<div class="form-block other" id="form-4" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-var-listp
  (x)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x nil)
    (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-var-p (car x)) (aig-var-listp (cdr x))))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthmd" data-sym="DEFTHMD">defthmd</a> aig-var-p-when-member-of-aig-var-listp
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-var-listp x) (<a class="sym-link system" href="../../../axioms.html#def-member" data-sym="MEMBER">member</a> k x)) (aig-var-p k)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-var-listp-of-cons
    (equal (aig-var-listp (cons x y))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-var-p x) (aig-var-listp y))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-var-listp-of-nil (aig-var-listp nil))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-var-listp-of-insert
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-var-p x) (aig-var-listp y))
      (aig-var-listp (insert x y)))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable insert head tail sfix))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-var-listp-of-union
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-var-listp x) (aig-var-listp y))
      (aig-var-listp (union x y)))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable union head tail sfix)))))</pre>
  </div>

<div class="form-block other" id="form-5" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-atom-p
  (x)
  <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (car x) nil) (cdr x) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> not-aig-atom-implies-consp
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-atom-p x)) (consp x))
    <span class="keyword">:rule-classes</span> <span class="keyword">:compound-recognizer</span>)
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-var-p-when-aig-atom-p
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-atom-p x) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-booleanp" data-sym="BOOLEANP">booleanp</a> x)))
      (aig-var-p x))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable aig-var-p))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-atom-p-when-aig-var-p
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (aig-var-p x) (aig-atom-p x))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable aig-var-p))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> not-aig-atom-p-of-negation
    (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-atom-p (cons x nil))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> not-aig-atom-p-of-cons
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> x (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-atom-p (cons x y)))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthmd" data-sym="DEFTHMD">defthmd</a> aig-atom-p-of-cons-strong
    (<a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a> (aig-atom-p (cons x y)) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> x) y))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable aig-atom-p)))))</pre>
  </div>

<div class="form-block other" id="form-6" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection aig-cases
  <span class="keyword">:parents</span> (aig-other)
  <span class="keyword">:short</span> <span class="string">"Control-flow macro to split into cases on what kind of AIG you have
encountered."</span>
  <span class="keyword">:long</span> <span class="string">"@(def aig-cases)"</span>
  (<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> aig-cases
    (x &amp;key true false var inv <a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a>)
    `(let ((aig-cases-var ,X))
      (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((aig-atom-p aig-cases-var) (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> aig-cases-var <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) ,TRUE)
            ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> aig-cases-var nil) ,FALSE)
            (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> ,VAR)))
        ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (cdr aig-cases-var) nil) ,INV)
        (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> ,AND)))))</pre>
  </div>

<div class="form-block other" id="form-7" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection aig-env-lookup-missing-output
  <span class="keyword">:parents</span> (aig-eval)
  <span class="keyword">:short</span> <span class="string">"Stub for warnings about missing variables in AIG evaluation."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;This stub is called when @(see aig-eval) encounters a variable in
the AIG that has no binding in the environment.  It is generally configured
with @(see aig-env-lookup-missing-action).&lt;/p&gt;"</span>
  (<a class="sym-link system" href="../../../basis-b.html#def-defstub" data-sym="DEFSTUB">defstub</a> aig-env-lookup-missing-output (name) nil))</pre>
  </div>

<div class="form-block other" id="form-8" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection aig-env-lookup-missing-action
  <span class="keyword">:parents</span> (aig-eval)
  <span class="keyword">:short</span> <span class="string">"Configurable warnings about missing variables in AIG evaluation."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;Ordinarily @(see aig-eval) treats any variables that are not bound
in the environment as having value @(&#39;t&#39;).  But a missing bindings could be the
result of a bug in your program, so by default @(&#39;aig-eval&#39;) is set up to print
a warning if this happens.&lt;/p&gt;

&lt;p&gt;@(call aig-env-lookup-missing-action) allows you to control whether these
warnings are printed, and also whether @(see break$) should be called.  The
valid @(&#39;action&#39;)s are:&lt;/p&gt;

&lt;ul&gt;
 &lt;li&gt;@(&#39;nil&#39;), silently bind the variable to @(&#39;t&#39;),&lt;/li&gt;
 &lt;li&gt;@(&#39;:warn&#39;) (the default), print a warning but do not @(&#39;break$&#39;), and&lt;/li&gt;
 &lt;li&gt;@(&#39;:break&#39;), to print the warning and then call @(&#39;break$&#39;).&lt;/li&gt;
&lt;/ul&gt;"</span>
  (<a class="sym-link system" href="../../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> *aig-env-lookup-warn-missing-binding* <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
  (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> aig-env-lookup-missing-quiet
    (name)
    (declare (xargs <span class="keyword">:guard</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
      (ignore name))
    nil)
  (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> aig-env-lookup-missing-complain
    (name)
    (declare (xargs <span class="keyword">:guard</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>))
    (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> *aig-env-lookup-warn-missing-binding*
      (<a class="sym-link system" href="../../../axioms.html#def-cw" data-sym="CW">cw</a> <span class="string">"WARNING: Missing variable binding ~x0 in AIG-ENV-LOOKUP; ~
              assigning T~%"</span>
        name)))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (disable (<a class="sym-link system" href="../../../axioms.html#def-break_24" data-sym="BREAK$">break$</a>))))
  (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> aig-env-lookup-missing-break
    (name)
    (declare (xargs <span class="keyword">:guard</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>))
    (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> *aig-env-lookup-warn-missing-binding*
      (<a class="sym-link system" href="../../../axioms.html#def-prog2_24" data-sym="PROG2$">prog2$</a> (<a class="sym-link system" href="../../../axioms.html#def-cw" data-sym="CW">cw</a> <span class="string">"WARNING: Missing variable binding ~x0 in ~x1; assigning ~
                      T. To avoid this break, run ~x2, where action is NIL or ~
                      :WARN.~%"</span>
          name
          'aig-env-lookup
          '(aig-env-lookup-missing-action action))
        (<a class="sym-link system" href="../../../axioms.html#def-break_24" data-sym="BREAK$">break$</a>))))
  (<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> aig-env-lookup-missing-action
    (val)
    (<a class="sym-link system" href="../../../axioms.html#def-case" data-sym="CASE">case</a> val
      ((nil) '(<a class="sym-link system" href="../../../axioms.html#def-defattach" data-sym="DEFATTACH">defattach</a> aig-env-lookup-missing-output
          aig-env-lookup-missing-quiet))
      (<span class="keyword">:warn</span> '(<a class="sym-link system" href="../../../axioms.html#def-defattach" data-sym="DEFATTACH">defattach</a> aig-env-lookup-missing-output
          aig-env-lookup-missing-complain))
      (<span class="keyword">:break</span> '(<a class="sym-link system" href="../../../axioms.html#def-defattach" data-sym="DEFATTACH">defattach</a> aig-env-lookup-missing-output
          aig-env-lookup-missing-break))
      (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> hard
          'aig-env-lookup-missing-action
          <span class="string">"Expected argument NIL, :WARN, or :BREAK.~%"</span>))))
  (aig-env-lookup-missing-action <span class="keyword">:warn</span>))</pre>
  </div>

<div class="form-block other" id="form-9" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-env-lookup
  <span class="keyword">:parents</span> (aig-eval)
  <span class="keyword">:short</span> <span class="string">"Look up the value of an AIG variable in an environment."</span>
  ((x <span class="string">"Variable to look up."</span>) (env <span class="string">"Fast alist mapping variables to values."</span>))
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;Unbound variables are given the default value @(&#39;t&#39;) instead of
@(&#39;nil&#39;) because this makes theorems about @(see faig) evaluation work out more
nicely (it makes unbound FAIG variables evaluate to @(&#39;X&#39;)).&lt;/p&gt;"</span>
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (let ((look (hons-get x env)))
    (if look
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (cdr look) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
      (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
        <span class="keyword">:exec</span> (if *aig-env-lookup-warn-missing-binding*
          (<a class="sym-link system" href="../../../axioms.html#def-prog2_24" data-sym="PROG2$">prog2$</a> (aig-env-lookup-missing-output x) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
          <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)))))</pre>
  </div>

<div class="form-block other" id="form-10" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-alist-lookup
  <span class="keyword">:parents</span> (aig-eval)
  <span class="keyword">:short</span> <span class="string">"Look up the value of an AIG variable in an environment."</span>
  ((x <span class="string">"Variable to look up."</span>) (env <span class="string">"Fast alist mapping variables to values."</span>))
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;Unbound variables are given the default value @(&#39;t&#39;) instead of
@(&#39;nil&#39;) because this makes theorems about @(see faig) evaluation work out more
nicely (it makes unbound FAIG variables evaluate to @(&#39;X&#39;)).&lt;/p&gt;"</span>
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (let ((look (hons-get x env)))
    (if look
      (cdr look)
      (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
        <span class="keyword">:exec</span> (if *aig-env-lookup-warn-missing-binding*
          (<a class="sym-link system" href="../../../axioms.html#def-prog2_24" data-sym="PROG2$">prog2$</a> (aig-env-lookup-missing-output x) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
          <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)))))</pre>
  </div>

<div class="form-block other" id="form-11" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-eval
  <span class="keyword">:parents</span> (aig-semantics)
  <span class="keyword">:short</span> <span class="string">"@(call aig-eval) gives the semantics of @(see AIG)s: it gives the
Boolean value of the AIG @(&#39;x&#39;) under the environment @(&#39;env&#39;)."</span>
  ((x <span class="string">"The AIG to evaluate."</span>) (env <span class="string">"A fast alist that binds variables to values.  Typically it should bind
every variable in @(&#39;x&#39;) to some Boolean value.  When this isn&#39;t the case,
variables are assigned the default value @(&#39;t&#39;); see @(see aig-env-lookup)."</span>))
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;This function is @(see memoize)d.  You should typically free its
memo table after you are done with whatever @(&#39;env&#39;) you are using, to avoid
excessive memory usage.  (We don&#39;t use @(&#39;:forget t&#39;) because you often want to
evaluate several related AIGs.)&lt;/p&gt;"</span>
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (aig-cases x
    <span class="keyword">:true</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
    <span class="keyword">:false</span> nil
    <span class="keyword">:var</span> (aig-env-lookup x env)
    <span class="keyword">:inv</span> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-eval (car x) env))
    <span class="keyword">:and</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval (car x) env) (aig-eval (cdr x) env)))
  ///
  (memoize 'aig-eval <span class="keyword">:condition</span> '(<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (consp x) (cdr x))))</pre>
  </div>

<div class="form-block other" id="form-12" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-eval-list
  <span class="keyword">:parents</span> (aig-semantics)
  <span class="keyword">:short</span> <span class="string">"@(call aig-eval-list) evaluates a list of AIGs."</span>
  ((x <span class="string">"The AIG list to evaluate."</span>) (env <span class="string">"The environment to use; see @(see aig-eval)."</span>))
  <span class="keyword">:returns</span> (vals <span class="string">"A list of Boolean values; the evaluations of each AIG under this
         environment."</span>)
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    nil
    (cons (aig-eval (car x) env) (aig-eval-list (cdr x) env)))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> consp-of-aig-eval-list
    (equal (consp (aig-eval-list x env)) (consp x)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> len-of-aig-eval-list
    (equal (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> (aig-eval-list x env)) (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> x)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-eval-list-of-append
    (equal (aig-eval-list (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> x y) env)
      (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (aig-eval-list x env) (aig-eval-list y env)))))</pre>
  </div>

<div class="form-block other" id="form-13" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-eval-alist
  <span class="keyword">:parents</span> (aig-semantics)
  <span class="keyword">:short</span> <span class="string">"@(call aig-eval-alist) evaluates an AIG Alist (an alist binding keys
to AIGs)."</span>
  ((x <span class="string">"The AIG alist to evaluate.  This does not need to be a fast alist."</span>) (env <span class="string">"The environment to use; see @(see aig-eval)."</span>))
  <span class="keyword">:returns</span> (vals-alist <span class="string">"An ordinary (slow) alist that binds the same keys to the values
               of their associated AIGs."</span>)
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) nil)
    ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> (car x)) (aig-eval-alist (cdr x) env))
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (cons (cons (<a class="sym-link system" href="../../../axioms.html#def-caar" data-sym="CAAR">caar</a> x) (aig-eval (<a class="sym-link system" href="../../../axioms.html#def-cdar" data-sym="CDAR">cdar</a> x) env))
        (aig-eval-alist (cdr x) env))))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> hons-assoc-equal-aig-eval-alist
    (equal (hons-assoc-equal key (aig-eval-alist x env))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (hons-assoc-equal key x)
        (cons key (aig-eval (cdr (hons-assoc-equal key x)) env))))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>))))</pre>
  </div>

<div class="form-block other" id="form-14" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-eval-alists
  <span class="keyword">:parents</span> (aig-semantics)
  <span class="keyword">:short</span> <span class="string">"Evaluate a list of AIG Alists."</span>
  ((x <span class="string">"List of AIG Alists to evaluate."</span>) (env <span class="string">"The environment to use; see @(see aig-eval)."</span>))
  <span class="keyword">:returns</span> (vals-alists <span class="string">"A copy of @(&#39;x&#39;), except that each AIG has been replaced with
                its value."</span>)
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    nil
    (cons (aig-eval-alist (car x) env)
      (aig-eval-alists (cdr x) env))))</pre>
  </div>

<div class="form-block other" id="form-15" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-vars
  (x)
  <span class="keyword">:parents</span> (aig)
  <span class="keyword">:short</span> <span class="string">"@(call aig-vars) returns the variables of the AIG @(&#39;X&#39;)."</span>
  <span class="keyword">:returns</span> (vars <span class="string">"An ordered set of AIG variables (atoms)."</span>)
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;Note: variable collection can be surprisingly tricky to do
efficiently.  For a good background discussion that describes various
approaches to the problem and ways to avoid needing to collect variables, see
@(see 4v-sexpr-vars).&lt;/p&gt;

&lt;p&gt;@(&#39;aig-vars&#39;) is a slow but simple way to collect the variables that occur
within an AIG, and we adopt it as our &lt;b&gt;normal form&lt;/b&gt; for talking about the
variables of an AIG.  That is, when we introduce other, faster algorithms for
collecting variables, we always relate them back to @(&#39;aig-vars&#39;).&lt;/p&gt;

&lt;p&gt;The variable collection strategy used by @(&#39;aig-vars&#39;) is to memoize the
whole computation; this implicitly records, for every AND node, the exact set
of variables that are found under that node.  We use ordinary @(see std/osets)
as our variable set representation so that merging these sets is linear at each
node.  The overall complexity is then @(&#39;O(n^2)&#39;) in the size of the AIG.&lt;/p&gt;

&lt;p&gt;This approach records the full variable information for every AND node
throughout the AIG.  This takes a lot of memory, and often you do not need
nearly this much information.  In practice, functions like @(see
aig-vars-1pass) are often much more practical.&lt;/p&gt;"</span>
  <span class="keyword">:verify-guards</span> nil
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (aig-cases x
    <span class="keyword">:true</span> nil
    <span class="keyword">:false</span> nil
    <span class="keyword">:var</span> (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (insert x nil) <span class="keyword">:exec</span> (hons x nil))
    <span class="keyword">:inv</span> (aig-vars (car x))
    <span class="keyword">:and</span> (union (aig-vars (car x)) (aig-vars (cdr x))))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-var-listp-aig-vars (aig-var-listp (aig-vars x)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> true-listp-aig-vars
    (<a class="sym-link system" href="../../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> (aig-vars x))
    <span class="keyword">:rule-classes</span> <span class="keyword">:type-prescription</span>)
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> setp-aig-vars
    (setp (aig-vars x))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable* (<span class="keyword">:ruleset</span> primitive-rules)))))
  (<a class="sym-link system" href="../../../axioms.html#def-verify-guards" data-sym="VERIFY-GUARDS">verify-guards</a> aig-vars
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable* (<span class="keyword">:ruleset</span> primitive-rules)))))
  (memoize 'aig-vars <span class="keyword">:condition</span> '(<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (consp x) (cdr x))))</pre>
  </div>

<div class="form-block other" id="form-16" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-not
  (x)
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-not) constructs an AIG representing @(&#39;(not x)&#39;)."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;This could be implemented as @(&#39;(hons x nil)&#39;), but we at least
take care to fold constants and avoid creating double negatives.&lt;/p&gt;"</span>
  <span class="keyword">:returns</span> aig
  (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x nil) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) nil)
    ((<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-atom-p x)) (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (cdr x) nil)) (car x))
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (hons x nil)))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-eval-not
    (equal (aig-eval (aig-not x) env) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-eval x env)))))</pre>
  </div>

<div class="form-block other" id="form-17" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-and-count
  (x)
  <span class="keyword">:parents</span> (aig)
  <span class="keyword">:short</span> <span class="string">"Counts how many ANDs are in an AIG."</span>
  <span class="keyword">:returns</span> (<a class="sym-link system" href="../../../axioms.html#def-count" data-sym="COUNT">count</a> <a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> <span class="keyword">:rule-classes</span> <span class="keyword">:type-prescription</span>)
  (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((aig-atom-p x) <span class="number">0</span>)
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (cdr x) nil) (aig-and-count (car x)))
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">1</span> (aig-and-count (car x)) (aig-and-count (cdr x)))))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-and-count-when-atom
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (aig-atom-p x) (equal (aig-and-count x) <span class="number">0</span>)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-and-count-of-aig-not
    (equal (aig-and-count (aig-not x)) (aig-and-count x))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable aig-not)))))</pre>
  </div>

<div class="form-block local" id="form-18" typeof="Code">
    <div class="form-header"><span class="form-type">local</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (set-default-parents aig-and))</pre>
  </div>

<div class="form-block other" id="form-19" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-negation-p
  (x y)
  <span class="keyword">:short</span> <span class="string">"@(call aig-negation-p) determines if the AIGs @(&#39;x&#39;) and @(&#39;y&#39;)
are (syntactically) negations of one another."</span>
  <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (consp y) (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (cdr y) nil) (hons-equal (car y) x))
    (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (consp x) (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (cdr x) nil) (hons-equal (car x) y)))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-negation-p-symmetric
    (equal (aig-negation-p x y) (aig-negation-p y x)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthmd" data-sym="DEFTHMD">defthmd</a> aig-negation-p-correct-1
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-negation-p x y) (aig-eval x env))
      (equal (aig-eval y env) nil)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthmd" data-sym="DEFTHMD">defthmd</a> aig-negation-p-correct-2
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-negation-p x y) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-eval x env)))
      (equal (aig-eval y env) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>))))</pre>
  </div>

<div class="form-block local" id="form-20" typeof="Code">
    <div class="form-header"><span class="form-type">local</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable aig-negation-p-correct-1 aig-negation-p-correct-2)))</pre>
  </div>

<div class="form-block other" id="form-21" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-and-dumb
  (x y)
  <span class="keyword">:short</span> <span class="string">"@(call aig-and-dumb) is a simpler alternative to @(see aig-and)."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;This does far fewer reductions than @(see aig-and).  We fold
constants and collapse @(&#39;x &amp; x&#39;) and @(&#39;x &amp; ~x&#39;), but that&#39;s it.&lt;/p&gt;"</span>
  <span class="keyword">:returns</span> aig
  (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x nil) (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> y nil)) nil)
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) y)
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> y <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) x)
    ((hons-equal x y) x)
    ((aig-negation-p x y) nil)
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (hons x y)))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-eval-of-aig-and-dumb
    (equal (aig-eval (aig-and-dumb x y) env)
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval x env) (aig-eval y env))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-and-dumb-of-constants
    (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal (aig-and-dumb nil x) nil)
      (equal (aig-and-dumb x nil) nil)
      (equal (aig-and-dumb x <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) x)
      (equal (aig-and-dumb <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> x) x))))</pre>
  </div>

<div class="form-block other" id="form-22" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-and-pass1
  (x y)
  <span class="keyword">:returns</span> (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> hit ans)
  <span class="keyword">:short</span> <span class="string">"Level 1 simplifications."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;See also @(see aig-and-dumb), which tries to apply these same
reductions, but otherwise just gives up, and doesn&#39;t report whether it has
succeded or not.&lt;/p&gt;"</span>
  <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x nil) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> nil))
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> y nil) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> nil))
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> y))
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> y <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> x))
    ((hons-equal x y) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> x))
    ((aig-negation-p x y) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> nil))
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil nil)))
  ///
  (defret aig-and-pass1-correct
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> hit
      (equal (aig-eval ans env)
        (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval x env) (aig-eval y env))))
    <span class="keyword">:rule-classes</span> nil))</pre>
  </div>

<div class="form-block other" id="form-23" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-and-pass2a
  (x y)
  <span class="keyword">:returns</span> (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2)
  <span class="keyword">:short</span> <span class="string">"Level 2 Contradiction Rule 1 and Idempotence Rule, Single Direction."</span>
  (b* (((unless (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-atom-p x)) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (cdr x) nil)))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:fail</span> x y)) (a (car x))
      (b (cdr x))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (aig-negation-p a y) (aig-negation-p b y))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:subterm</span> nil nil))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (hons-equal a y) (hons-equal b y))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:subterm</span> x x)))
    (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:fail</span> x y))
  ///
  (defret aig-and-pass2a-correct
    (equal (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval arg1 env) (aig-eval arg2 env))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval x env) (aig-eval y env)))
    <span class="keyword">:rule-classes</span> nil)
  (defret aig-and-pass2a-never-reduced
    (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:reduced</span>)))
  (defret aig-and-pass2a-subterm-convention
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (equal status <span class="keyword">:subterm</span>) (equal arg2 arg1)))
  (defret aig-and-pass2a-normalize-status
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:subterm</span>))
        (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:reduced</span>)))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal status <span class="keyword">:fail</span>) (equal arg1 x) (equal arg2 y)))))</pre>
  </div>

<div class="form-block other" id="form-24" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-and-pass2
  (x y)
  <span class="keyword">:returns</span> (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2)
  <span class="keyword">:short</span> <span class="string">"Level 2 Contradiction Rule 1 and Idempotence Rule, Both Directions."</span>
  <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (b* (((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status a b) (aig-and-pass2a y x)) ((unless (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> status <span class="keyword">:fail</span>)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status a b)))
    (aig-and-pass2a x y))
  ///
  (defret aig-and-pass2-correct
    (equal (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval arg1 env) (aig-eval arg2 env))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval x env) (aig-eval y env)))
    <span class="keyword">:rule-classes</span> nil
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:use</span> ((<span class="keyword">:instance</span> aig-and-pass2a-correct) (<span class="keyword">:instance</span> aig-and-pass2a-correct (x y) (y x))))))
  (defret aig-and-pass2-never-reduced
    (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:reduced</span>)))
  (defret aig-and-pass2-subterm-convention
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (equal status <span class="keyword">:subterm</span>) (equal arg2 arg1)))
  (defret aig-and-pass2-normalize-status
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:subterm</span>))
        (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:reduced</span>)))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal status <span class="keyword">:fail</span>) (equal arg1 x) (equal arg2 y)))))</pre>
  </div>

<div class="form-block other" id="form-25" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-and-pass3
  (x y)
  <span class="keyword">:returns</span> (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2)
  <span class="keyword">:short</span> <span class="string">"Level 2 Contradiction Rule 2 and all Level 4 Rules."</span>
  <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (b* (((unless (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-atom-p x)) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (cdr x) nil)))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:fail</span> x y)) ((unless (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-atom-p y)) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (cdr y) nil)))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:fail</span> x y))
      (a (car x))
      (b (cdr x))
      (c (car y))
      (d (cdr y))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (aig-negation-p a c)
           (aig-negation-p a d)
           (aig-negation-p b c)
           (aig-negation-p b d))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:subterm</span> nil nil))
      ((when (hons-equal a c)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:reduced</span> x d))
      ((when (hons-equal b c)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:reduced</span> x d))
      ((when (hons-equal b d)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:reduced</span> x c))
      ((when (hons-equal a d)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:reduced</span> x c)))
    (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:fail</span> x y))
  ///
  (defret aig-and-pass3-correct
    (equal (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval arg1 env) (aig-eval arg2 env))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval x env) (aig-eval y env)))
    <span class="keyword">:rule-classes</span> nil)
  (defret aig-and-pass3-reduces-count
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> status <span class="keyword">:reduced</span>)
      (&lt; (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> (aig-and-count arg1) (aig-and-count arg2))
        (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> (aig-and-count x) (aig-and-count y))))
    <span class="keyword">:rule-classes</span> nil
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable aig-and-count))))
  (defret aig-and-pass3-subterm-convention
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (equal status <span class="keyword">:subterm</span>) (equal arg2 arg1)))
  (defret aig-and-pass3-normalize-status
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:subterm</span>))
        (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:reduced</span>)))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal status <span class="keyword">:fail</span>) (equal arg1 x) (equal arg2 y)))))</pre>
  </div>

<div class="form-block other" id="form-26" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-and-pass4a
  (x y)
  <span class="keyword">:returns</span> (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2)
  <span class="keyword">:short</span> <span class="string">"Level 2, Subsumption Rules 1 and 2, Single Direction."</span>
  (b* (((unless (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-atom-p x)) (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (cdr x) nil))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:fail</span> x y)) (~x (car x))
      ((unless (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-atom-p ~x)) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (cdr ~x) nil)))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:fail</span> x y))
      (a (car ~x))
      (b (cdr ~x))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (aig-negation-p a y) (aig-negation-p b y))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:subterm</span> y y))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-atom-p y)) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (cdr y) nil)))) (b* ((c (car y)) (d (cdr y))
            ((when (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (aig-negation-p a c)
                 (aig-negation-p a d)
                 (aig-negation-p b c)
                 (aig-negation-p b d))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:subterm</span> y y)))
          (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:fail</span> x y))))
    (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:fail</span> x y))
  ///
  (defret aig-and-pass4a-correct
    (equal (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval arg1 env) (aig-eval arg2 env))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval x env) (aig-eval y env)))
    <span class="keyword">:rule-classes</span> nil)
  (defret aig-and-pass4a-never-reduced
    (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:reduced</span>)))
  (defret aig-and-pass4a-subterm-convention
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (equal status <span class="keyword">:subterm</span>) (equal arg2 arg1)))
  (defret aig-and-pass4a-normalize-status
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:subterm</span>))
        (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:reduced</span>)))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal status <span class="keyword">:fail</span>) (equal arg1 x) (equal arg2 y)))))</pre>
  </div>

<div class="form-block other" id="form-27" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-and-pass4
  (x y)
  <span class="keyword">:short</span> <span class="string">"Level 2, Subsumption Rules 1 and 2, Both Directions."</span>
  <span class="keyword">:returns</span> (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2)
  <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (b* (((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2) (aig-and-pass4a y x)) ((unless (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> status <span class="keyword">:fail</span>)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2)))
    (aig-and-pass4a x y))
  ///
  (defret aig-and-pass4-correct
    (equal (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval arg1 env) (aig-eval arg2 env))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval x env) (aig-eval y env)))
    <span class="keyword">:rule-classes</span> nil
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:use</span> ((<span class="keyword">:instance</span> aig-and-pass4a-correct) (<span class="keyword">:instance</span> aig-and-pass4a-correct (x y) (y x))))))
  (defret aig-and-pass4-never-reduced
    (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:reduced</span>)))
  (defret aig-and-pass4-subterm-convention
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (equal status <span class="keyword">:subterm</span>) (equal arg2 arg1)))
  (defret aig-and-pass4-normalize-status
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:subterm</span>))
        (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:reduced</span>)))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal status <span class="keyword">:fail</span>) (equal arg1 x) (equal arg2 y)))))</pre>
  </div>

<div class="form-block other" id="form-28" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-and-pass5
  (x y)
  <span class="keyword">:short</span> <span class="string">"Level 2, Resolution Rule."</span>
  <span class="keyword">:returns</span> (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2)
  <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (b* (((unless (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-atom-p x))
          (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (cdr x) nil)
          (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-atom-p (car x)))
          (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (<a class="sym-link system" href="../../../axioms.html#def-cdar" data-sym="CDAR">cdar</a> x) nil)))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:fail</span> x y)) ((unless (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-atom-p y))
           (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (cdr y) nil)
           (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-atom-p (car y)))
           (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (<a class="sym-link system" href="../../../axioms.html#def-cdar" data-sym="CDAR">cdar</a> y) nil)))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:fail</span> x y))
      (a (<a class="sym-link system" href="../../../axioms.html#def-caar" data-sym="CAAR">caar</a> x))
      (b (<a class="sym-link system" href="../../../axioms.html#def-cdar" data-sym="CDAR">cdar</a> x))
      (c (<a class="sym-link system" href="../../../axioms.html#def-caar" data-sym="CAAR">caar</a> y))
      (d (<a class="sym-link system" href="../../../axioms.html#def-cdar" data-sym="CDAR">cdar</a> y))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (hons-equal a d) (aig-negation-p b c))
           (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (hons-equal a c) (aig-negation-p b d)))) (let ((ans (aig-not a)))
          (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:subterm</span> ans ans)))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (hons-equal b d) (aig-negation-p a c))
           (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (hons-equal b c) (aig-negation-p a d)))) (let ((ans (aig-not b)))
          (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:subterm</span> ans ans))))
    (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:fail</span> x y))
  ///
  (defret aig-and-pass5-correct
    (equal (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval arg1 env) (aig-eval arg2 env))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval x env) (aig-eval y env)))
    <span class="keyword">:rule-classes</span> nil)
  (defret aig-and-pass5-never-reduced
    (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:reduced</span>)))
  (defret aig-and-pass5-subterm-convention
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (equal status <span class="keyword">:subterm</span>) (equal arg2 arg1)))
  (defret aig-and-pass5-normalize-status
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:subterm</span>))
        (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:reduced</span>)))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal status <span class="keyword">:fail</span>) (equal arg1 x) (equal arg2 y)))))</pre>
  </div>

<div class="form-block other" id="form-29" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-and-pass6a
  (x y)
  <span class="keyword">:short</span> <span class="string">"Level 3 Substitution Rules, Single Direction."</span>
  <span class="keyword">:returns</span> (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2)
  (b* (((unless (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-atom-p x))
          (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (cdr x) nil)
          (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-atom-p (car x)))
          (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (<a class="sym-link system" href="../../../axioms.html#def-cdar" data-sym="CDAR">cdar</a> x) nil)))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:fail</span> x y)) (a (<a class="sym-link system" href="../../../axioms.html#def-caar" data-sym="CAAR">caar</a> x))
      (b (<a class="sym-link system" href="../../../axioms.html#def-cdar" data-sym="CDAR">cdar</a> x))
      ((when (hons-equal a y)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:reduced</span> a (aig-not b)))
      ((when (hons-equal b y)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:reduced</span> b (aig-not a)))
      ((unless (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (aig-atom-p y)) (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (cdr y) nil)))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:fail</span> x y))
      (c (car y))
      (d (cdr y))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (hons-equal b c) (hons-equal b d))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:reduced</span> (aig-not a) y))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (hons-equal a c) (hons-equal a d))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:reduced</span> (aig-not b) y)))
    (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:fail</span> x y))
  ///
  (defret aig-and-pass6a-correct
    (equal (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval arg1 env) (aig-eval arg2 env))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval x env) (aig-eval y env)))
    <span class="keyword">:rule-classes</span> nil)
  (defret aig-and-pass6a-reduces-count
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> status <span class="keyword">:reduced</span>)
      (&lt; (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> (aig-and-count arg1) (aig-and-count arg2))
        (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> (aig-and-count x) (aig-and-count y))))
    <span class="keyword">:rule-classes</span> nil
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable aig-and-count))))
  (defret aig-and-pass6a-subterm-convention
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (equal status <span class="keyword">:subterm</span>) (equal arg2 arg1)))
  (defret aig-and-pass6a-arg2-on-failure
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal status <span class="keyword">:fail</span>) y) (<a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a> arg2 <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)))
  (defret aig-and-pass6a-when-fail
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:subterm</span>))
        (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:reduced</span>)))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal status <span class="keyword">:fail</span>) (equal arg1 x) (equal arg2 y)))))</pre>
  </div>

<div class="form-block other" id="form-30" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-and-pass6
  (x y)
  <span class="keyword">:short</span> <span class="string">"Level 3 Substitution Rules, Both Directions."</span>
  <span class="keyword">:returns</span> (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2)
  <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (b* (((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2) (aig-and-pass6a y x)) ((unless (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> status <span class="keyword">:fail</span>)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2)))
    (aig-and-pass6a x y))
  ///
  (defret aig-and-pass6-correct
    (equal (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval arg1 env) (aig-eval arg2 env))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval x env) (aig-eval y env)))
    <span class="keyword">:rule-classes</span> nil
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:use</span> ((<span class="keyword">:instance</span> aig-and-pass6a-correct) (<span class="keyword">:instance</span> aig-and-pass6a-correct (x y) (y x))))))
  (defret aig-and-pass6-reduces-count
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> status <span class="keyword">:reduced</span>)
      (&lt; (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> (aig-and-count arg1) (aig-and-count arg2))
        (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> (aig-and-count x) (aig-and-count y))))
    <span class="keyword">:rule-classes</span> nil
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:use</span> ((<span class="keyword">:instance</span> aig-and-pass6a-reduces-count) (<span class="keyword">:instance</span> aig-and-pass6a-reduces-count (x y) (y x))))))
  (defret aig-and-pass6-subterm-convention
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (equal status <span class="keyword">:subterm</span>) (equal arg2 arg1)))
  (defret aig-and-pass6-arg2-on-failure
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal status <span class="keyword">:fail</span>) y) (<a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a> arg2 <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)))
  (defret aig-and-pass6-when-fail
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:subterm</span>))
        (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:reduced</span>)))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal status <span class="keyword">:fail</span>) (equal arg1 x) (equal arg2 y)))))</pre>
  </div>

<div class="form-block other" id="form-31" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-and-main
  (x y)
  <span class="keyword">:short</span> <span class="string">"And-Node, Main Optimizations, Non-Recursive."</span>
  <span class="keyword">:returns</span> (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2)
  (b* (((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> hit ans) (aig-and-pass1 x y)) ((when hit) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:subterm</span> ans ans))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2) (aig-and-pass2 x y))
      ((unless (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> status <span class="keyword">:fail</span>)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2) (aig-and-pass3 x y))
      ((unless (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> status <span class="keyword">:fail</span>)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2) (aig-and-pass4 x y))
      ((unless (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> status <span class="keyword">:fail</span>)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2) (aig-and-pass5 x y))
      ((unless (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> status <span class="keyword">:fail</span>)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2)))
    (aig-and-pass6 x y))
  ///
  (defret aig-and-main-correct
    (equal (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval arg1 env) (aig-eval arg2 env))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval x env) (aig-eval y env)))
    <span class="keyword">:rule-classes</span> nil
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:use</span> ((<span class="keyword">:instance</span> aig-and-pass1-correct) (<span class="keyword">:instance</span> aig-and-pass2-correct)
         (<span class="keyword">:instance</span> aig-and-pass3-correct)
         (<span class="keyword">:instance</span> aig-and-pass4-correct)
         (<span class="keyword">:instance</span> aig-and-pass5-correct)
         (<span class="keyword">:instance</span> aig-and-pass6-correct)))))
  (defret aig-and-main-reduces-count
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> status <span class="keyword">:reduced</span>)
      (&lt; (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> (aig-and-count arg1) (aig-and-count arg2))
        (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> (aig-and-count x) (aig-and-count y))))
    <span class="keyword">:rule-classes</span> nil
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:use</span> ((<span class="keyword">:instance</span> aig-and-pass3-reduces-count) (<span class="keyword">:instance</span> aig-and-pass6-reduces-count)))))
  (defret aig-and-main-subterm-convention
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (equal status <span class="keyword">:subterm</span>) (equal arg2 arg1)))
  (defret aig-and-main-on-failure
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:reduced</span>))
        (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (equal status <span class="keyword">:subterm</span>)))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal status <span class="keyword">:fail</span>) (equal arg1 x) (equal arg2 y))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-and-main-of-constants
    (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal (aig-and-main x nil) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:subterm</span> nil nil))
      (equal (aig-and-main nil y) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:subterm</span> nil nil))
      (equal (aig-and-main x <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:subterm</span> x x))
      (equal (aig-and-main <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> x) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <span class="keyword">:subterm</span> x x)))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable aig-and-main aig-and-pass1))))
  (defret aig-and-main-arg2-on-failure
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (equal status <span class="keyword">:fail</span>) arg2)
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable aig-and-pass1)))))</pre>
  </div>

<div class="form-block other" id="form-32" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-binary-and
  (x y)
  <span class="keyword">:short</span> <span class="string">"@(call aig-binary-and) constructs an AIG representing @(&#39;(and x y)&#39;)."</span>
  <span class="keyword">:measure</span> (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> (aig-and-count x) (aig-and-count y))
  (b* (((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> status arg1 arg2) (aig-and-main x y)) ((when (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> status <span class="keyword">:subterm</span>)) arg1)
      ((when (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> status <span class="keyword">:reduced</span>)) (aig-binary-and arg1 arg2)))
    (hons arg1 arg2))
  <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:use</span> ((<span class="keyword">:instance</span> aig-and-main-reduces-count))))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable aig-binary-and)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-and-constants
    (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal (aig-binary-and nil x) nil)
      (equal (aig-binary-and x nil) nil)
      (equal (aig-binary-and x <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) x)
      (equal (aig-binary-and <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> x) x)))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable aig-atom-p-of-cons-strong)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-eval-and
    (equal (aig-eval (aig-binary-and x y) env)
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (aig-eval x env) (aig-eval y env)))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> (aig-binary-and x y)
       <span class="keyword">:do-not</span> '(generalize fertilize)) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp
        '(<span class="keyword">:use</span> ((<span class="keyword">:instance</span> aig-and-main-correct)))))))</pre>
  </div>

<div class="form-block other" id="form-33" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-and-macro-logic-part
  (<a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)
  <span class="keyword">:short</span> <span class="string">"Generates the :logic part for a aig-and MBE call."</span>
  <span class="keyword">:mode</span> <span class="keyword">:program</span> (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
    ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> (cdr <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)) (car <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>))
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> `(aig-binary-and ,(CAR ARGS)
        ,(AIG-AND-MACRO-LOGIC-PART (CDR ARGS))))))</pre>
  </div>

<div class="form-block other" id="form-34" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-and-macro-exec-part
  (<a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)
  <span class="keyword">:short</span> <span class="string">"Generates the :exec part for a aig-and MBE call."</span>
  <span class="keyword">:mode</span> <span class="keyword">:program</span> (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
    ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> (cdr <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)) (car <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>))
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> `(let ((aig-and-x-do-not-use-elsewhere ,(CAR ARGS)))
        (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> aig-and-x-do-not-use-elsewhere
          (aig-binary-and aig-and-x-do-not-use-elsewhere
            ,(AIG-AND-MACRO-EXEC-PART (CDR ARGS))))))))</pre>
  </div>

<div class="form-block other" id="form-35" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection aig-and
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(&#39;(aig-and x1 x2 ...)&#39;) constructs an AIG representing @(&#39;(and x1 x2
...)&#39;)."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;The main function is @(see aig-binary-and).  It implements
something like the algorithm described in:&lt;/p&gt;

&lt;ul&gt;

&lt;li&gt;Robert Brummayer and Armin Biere.  &lt;a
href=&#39;http://fmv.jku.at/papers/BrummayerBiere-MEMICS06.pdf&#39;&gt;Local Two-Level And
Inverter Graph Minimization Without Blowup&lt;/a&gt;.  Mathematical and Engineering
Methods in Computer Science (MEMICS).  2006.&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;In particular, see Table 2 in that paper, which describes optimization rules
that are ``locally size decreasing without affecting global sharing
negatively.&#39;&#39;&lt;/p&gt;

&lt;p&gt;We try to implement these rules in @(see aig-and-main), which returns:&lt;/p&gt;

@({
     (mv status arg1 arg2)
})

&lt;p&gt;The status is either:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;@(&#39;:fail&#39;) if no rule applies, in which case @(&#39;arg1&#39;) and @(&#39;arg2&#39;) are
just copies of @(&#39;x&#39;) and @(&#39;y&#39;) and we need to construct a new AND node that
joins them together;&lt;/li&gt;

&lt;li&gt;@(&#39;:subterm&#39;) if a rewrite rule applies that reduces the AND of @(&#39;x&#39;) and
@(&#39;y&#39;) to either a constant or to a subterm of @(&#39;x&#39;) or @(&#39;y&#39;).  This subterm
is returned as both @(&#39;arg1&#39;) and @(&#39;arg2&#39;).  In this case, we assume there is
no more rewriting to be done and just return the reduced subterm.&lt;/li&gt;

&lt;li&gt;@(&#39;:reduced&#39;) if a rewrite rule applies that reduces the AND in some
interesting way, where it is no longer a proper subterm of @(&#39;x&#39;) or @(&#39;y&#39;).
In this case, it may be possible to further reduce @(&#39;arg1&#39;) and @(&#39;arg2&#39;),
so we want to recursively rewrite them.&lt;/li&gt;

&lt;/ul&gt;

&lt;p&gt;@(&#39;aig-and&#39;) itself is a macro which extends @(&#39;aig-binary-and&#39;) across many
arguments.  As one last special optimization, when there is more than one
argument we try to &quot;short-circuit&quot; the computation and avoid evaluating some
arguments.&lt;/p&gt;

&lt;p&gt;See also @(see aig-and-dumb), which is much less sophisticated but may be
easier to reason about in certain cases where you really care about the
structure of the resulting AIGs.&lt;/p&gt;

&lt;p&gt;A June 2015 experiment suggests that, for a particular 80-bit floating point
addition problem, this fancier algorithm improves the size of AIGs produced by
@(see SV) by about 3% when measured either by unique AND nodes or by unique
conses.&lt;/p&gt;

@(def aig-and)"</span>
  (<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> aig-and
    (&amp;rest <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)
    `(<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> ,(AIG-AND-MACRO-LOGIC-PART ARGS)
      <span class="keyword">:exec</span> ,(AIG-AND-MACRO-EXEC-PART ARGS)))
  (<a class="sym-link system" href="../../../axioms.html#def-add-binop" data-sym="ADD-BINOP">add-binop</a> aig-and aig-binary-and)
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-and-sanity-check
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal (aig-and) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
        (equal (aig-and x) x)
        (equal (aig-and x y) (aig-binary-and x y))
        (equal (aig-and x y z)
          (aig-binary-and x (aig-binary-and y z))))
      <span class="keyword">:rule-classes</span> nil)))</pre>
  </div>

<div class="form-block local" id="form-36" typeof="Code">
    <div class="form-header"><span class="form-type">local</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (set-default-parents))</pre>
  </div>

<div class="form-block other" id="form-37" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-binary-or
  (x y)
  <span class="keyword">:parents</span> (aig-or)
  <span class="keyword">:short</span> <span class="string">"@(call aig-binary-or) constructs an AIG representing @(&#39;(or x y)&#39;)."</span>
  <span class="keyword">:returns</span> aig
  (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x nil) y)
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> y nil) x)
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (aig-not (aig-and (aig-not x) (aig-not y)))))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-eval-or
    (equal (aig-eval (aig-binary-or x y) env)
      (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (aig-eval x env) (aig-eval y env))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-or-constants
    (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal (aig-binary-or nil x) x)
      (equal (aig-binary-or x nil) x)
      (equal (aig-binary-or x <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
      (equal (aig-binary-or <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> x) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>))))</pre>
  </div>

<div class="form-block other" id="form-38" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-or-macro-logic-part
  (<a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)
  <span class="keyword">:parents</span> (aig-or)
  <span class="keyword">:mode</span> <span class="keyword">:program</span> (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>) nil)
    ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> (cdr <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)) (car <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>))
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> `(aig-binary-or ,(CAR ARGS)
        ,(AIG-OR-MACRO-LOGIC-PART (CDR ARGS))))))</pre>
  </div>

<div class="form-block other" id="form-39" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-or-macro-exec-part
  (<a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)
  <span class="keyword">:parents</span> (aig-or)
  <span class="keyword">:mode</span> <span class="keyword">:program</span> (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>) nil)
    ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> (cdr <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)) (car <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>))
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> `(let ((aig-or-x-do-not-use-elsewhere ,(CAR ARGS)))
        (if (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> aig-or-x-do-not-use-elsewhere)
          <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
          (aig-binary-or aig-or-x-do-not-use-elsewhere
            (<a class="sym-link system" href="../../../axioms.html#def-check-vars-not-free" data-sym="CHECK-VARS-NOT-FREE">check-vars-not-free</a> (aig-or-x-do-not-use-elsewhere)
              ,(AIG-OR-MACRO-EXEC-PART (CDR ARGS)))))))))</pre>
  </div>

<div class="form-block other" id="form-40" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection aig-or
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(&#39;(aig-or x1 x2 ...)&#39;) constructs an AIG representing @(&#39;(or x1 x2
  ...)&#39;)."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;Like @(see aig-and), we attempt to lazily avoid computing later
terms in the expression.&lt;/p&gt;

@(def aig-or)"</span>
  (<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> aig-or
    (&amp;rest <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)
    `(<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> ,(AIG-OR-MACRO-LOGIC-PART ARGS)
      <span class="keyword">:exec</span> ,(AIG-OR-MACRO-EXEC-PART ARGS)))
  (<a class="sym-link system" href="../../../axioms.html#def-add-binop" data-sym="ADD-BINOP">add-binop</a> aig-or aig-binary-or)
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-or-sanity-check
      (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (equal (aig-or) nil)
        (equal (aig-or x) x)
        (equal (aig-or x y) (aig-binary-or x y))
        (equal (aig-or x y z) (aig-binary-or x (aig-binary-or y z))))
      <span class="keyword">:rule-classes</span> nil)))</pre>
  </div>

<div class="form-block other" id="form-41" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-xor
  (x y)
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-xor) constructs an AIG representing @(&#39;(xor x y)&#39;)."</span>
  <span class="keyword">:returns</span> aig
  (aig-or (aig-and x (aig-not y)) (aig-and y (aig-not x)))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-eval-xor
    (equal (aig-eval (aig-xor x y) env)
      (<a class="sym-link system" href="../../../axioms.html#def-xor" data-sym="XOR">xor</a> (aig-eval x env) (aig-eval y env)))))</pre>
  </div>

<div class="form-block other" id="form-42" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-iff
  (x y)
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-iff) constructs an AIG representing @(&#39;(iff x y)&#39;)."</span>
  <span class="keyword">:returns</span> aig
  (aig-or (aig-and x y) (aig-and (aig-not x) (aig-not y)))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-eval-iff
    (equal (aig-eval (aig-iff x y) env)
      (<a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a> (aig-eval x env) (aig-eval y env)))))</pre>
  </div>

<div class="form-block other" id="form-43" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-implies-fn
  (x y)
  <span class="keyword">:parents</span> (aig-implies)
  <span class="keyword">:returns</span> aig
  (aig-not (aig-and x (aig-not y)))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-eval-implies
    (equal (aig-eval (aig-implies-fn x y) env)
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (aig-eval x env) (aig-eval y env))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-eval-implies-nil
    (equal (aig-implies-fn nil x) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)))</pre>
  </div>

<div class="form-block other" id="form-44" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection aig-implies
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-implies) constructs an AIG representing @(&#39;(implies x
  y)&#39;)."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;We try to lazily avoid evaluating @(&#39;y&#39;).&lt;/p&gt;
@(def aig-implies)"</span>
  (<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> aig-implies
    (x y)
    `(<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (aig-implies-fn ,X ,Y)
      <span class="keyword">:exec</span> (let ((aig-implies-x-do-not-use-elsewhere ,X))
        (if (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> nil aig-implies-x-do-not-use-elsewhere)
          <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
          (aig-implies-fn aig-implies-x-do-not-use-elsewhere
            (<a class="sym-link system" href="../../../axioms.html#def-check-vars-not-free" data-sym="CHECK-VARS-NOT-FREE">check-vars-not-free</a> (aig-implies-x-do-not-use-elsewhere)
              ,Y))))))
  (<a class="sym-link system" href="../../../axioms.html#def-add-macro-alias" data-sym="ADD-MACRO-ALIAS">add-macro-alias</a> aig-implies aig-implies-fn)
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-implies-sanity-check
      (equal (aig-implies x y) (aig-implies-fn x y))
      <span class="keyword">:rule-classes</span> nil)))</pre>
  </div>

<div class="form-block other" id="form-45" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection aig-nand
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-nand) constructs an AIG representing @(&#39;(not (and x y))&#39;)."</span>
  <span class="keyword">:long</span> <span class="string">"@(def aig-nand)"</span>
  (<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> aig-nand (x y) `(aig-not (aig-and ,X ,Y))))</pre>
  </div>

<div class="form-block other" id="form-46" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection aig-nor
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-nor) constructs an AIG representing @(&#39;(not (or x y))&#39;)."</span>
  (<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> aig-nor
    (x y)
    `(aig-and (aig-not ,X) (aig-not ,Y))))</pre>
  </div>

<div class="form-block other" id="form-47" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection aig-andc1
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-andc1) constructs an AIG representing @(&#39;(and (not x) y)&#39;)."</span>
  (<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> aig-andc1 (x y) `(aig-and (aig-not ,X) ,Y)))</pre>
  </div>

<div class="form-block other" id="form-48" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection aig-andc2
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-andc2) constructs an AIG representing @(&#39;(and x (not y))&#39;)."</span>
  (<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> aig-andc2 (x y) `(aig-and ,X (aig-not ,Y))))</pre>
  </div>

<div class="form-block other" id="form-49" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection aig-orc1
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-orc1) is identical to @(see aig-implies)."</span>
  <span class="keyword">:long</span> <span class="string">"@(def aig-orc1)"</span>
  (<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> aig-orc1 (x y) `(aig-implies ,X ,Y)))</pre>
  </div>

<div class="form-block other" id="form-50" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection aig-orc2
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-orc2) constructs an AIG representing @(&#39;(or x (not y))&#39;)."</span>
  (<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> aig-orc2
    (x y)
    `(aig-not (aig-and (aig-not ,X) ,Y))))</pre>
  </div>

<div class="form-block other" id="form-51" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-ite-fn
  (a b c)
  <span class="keyword">:parents</span> (aig-ite)
  <span class="keyword">:returns</span> aig
  (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> a <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) b)
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> a nil) c)
    ((hons-equal b c) b)
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> b <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) (aig-or a c))
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (aig-or (aig-and a b) (aig-and (aig-not a) c))))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-eval-ite
    (<a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a> (aig-eval (aig-ite-fn a b c) env)
      (if (aig-eval a env)
        (aig-eval b env)
        (aig-eval c env))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-ite-of-constants
    (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal (aig-ite-fn <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> b c) b)
      (equal (aig-ite-fn nil b c) c))))</pre>
  </div>

<div class="form-block other" id="form-52" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection aig-ite
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-ite) constructs an AIG representing @(&#39;(if a b c)&#39;)."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;This is logically just @(see aig-ite-fn), but we try to lazily
avoid computing @(&#39;b&#39;) or @(&#39;c&#39;) when the value of @(&#39;a&#39;) is known.&lt;/p&gt;"</span>
  (<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> aig-ite
    (a b c)
    `(<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (aig-ite-fn ,A ,B ,C)
      <span class="keyword">:exec</span> (let ((aig-ite-x-do-not-use-elsewhere ,A))
        (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> aig-ite-x-do-not-use-elsewhere <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) ,B)
          ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> aig-ite-x-do-not-use-elsewhere nil) ,C)
          (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (aig-ite-fn aig-ite-x-do-not-use-elsewhere ,B ,C))))))
  (<a class="sym-link system" href="../../../axioms.html#def-add-macro-alias" data-sym="ADD-MACRO-ALIAS">add-macro-alias</a> aig-ite aig-ite-fn))</pre>
  </div>

<div class="form-block other" id="form-53" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-not-list
  (x)
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-not-list) negates every AIG in the list @(&#39;x&#39;)."</span>
  <span class="keyword">:returns</span> aig-list
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    nil
    (cons (aig-not (car x)) (aig-not-list (cdr x)))))</pre>
  </div>

<div class="form-block other" id="form-54" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define member-eql-without-truelistp
  ((a <a class="sym-link system" href="../../../axioms.html#def-eqlablep" data-sym="EQLABLEP">eqlablep</a>) x)
  <span class="keyword">:parents</span> (aig-and-list aig-or-list)
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (<a class="sym-link system" href="../../../axioms.html#def-member" data-sym="MEMBER">member</a> a x)
    <span class="keyword">:exec</span> (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) nil)
      ((<a class="sym-link system" href="../../../axioms.html#def-eql" data-sym="EQL">eql</a> a (car x)) x)
      (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (member-eql-without-truelistp a (cdr x))))))</pre>
  </div>

<div class="form-block other" id="form-55" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-and-list-aux
  (x)
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  <span class="keyword">:parents</span> (aig-and-list)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
    (aig-and (car x) (aig-and-list-aux (cdr x)))))</pre>
  </div>

<div class="form-block other" id="form-56" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-and-list
  (x)
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-and-list) &lt;i&gt;and&lt;/i&gt;s together all of the AIGs in the list
@(&#39;x&#39;)."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;As a dumb attempt at optimization, we try to avoid consing if we
see that there&#39;s a @(&#39;nil&#39;) anywhere in the list.  This won&#39;t win very often,
but it is quite cheap and it can win big when it does win by avoiding a lot of
AIG construction.&lt;/p&gt;"</span>
  <span class="keyword">:returns</span> aig
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  <span class="keyword">:verify-guards</span> nil
  (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
      <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
      (aig-and (car x) (aig-and-list (cdr x))))
    <span class="keyword">:exec</span> (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
      ((member-eql-without-truelistp nil x) nil)
      (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (aig-and-list-aux x))))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-and-list-aux-removal
    (equal (aig-and-list-aux x) (aig-and-list x)))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-and-list-when-member-nil
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-member" data-sym="MEMBER">member</a> nil x) (equal (aig-and-list x) nil))))
  (<a class="sym-link system" href="../../../axioms.html#def-verify-guards" data-sym="VERIFY-GUARDS">verify-guards</a> aig-and-list))</pre>
  </div>

<div class="form-block other" id="form-57" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-or-list-aux
  (x)
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  <span class="keyword">:parents</span> (aig-or-list)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    nil
    (aig-or (car x) (aig-or-list-aux (cdr x)))))</pre>
  </div>

<div class="form-block other" id="form-58" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-or-list
  (x)
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-or-list) &lt;i&gt;or&lt;/i&gt;s together all of the AIGs in the list
@(&#39;x&#39;)."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;As a dumb attempt at optimization, we try to avoid consing if we
see that there&#39;s a @(&#39;t&#39;) anywhere in the list.  This won&#39;t win very often, but
it is quite cheap and it can win big when it does win by avoiding a lot of AIG
construction.&lt;/p&gt;"</span>
  <span class="keyword">:returns</span> aig
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  <span class="keyword">:verify-guards</span> nil
  (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
      nil
      (aig-or (car x) (aig-or-list (cdr x))))
    <span class="keyword">:exec</span> (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) nil)
      ((member-eql-without-truelistp <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> x) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
      (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (aig-or-list-aux x))))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-or-list-aux-removal
    (equal (aig-or-list-aux x) (aig-or-list x)))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> l0
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (equal (aig-or <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> y) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) (equal (aig-or y <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable aig-or)))))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-or-list-when-member-t
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-member" data-sym="MEMBER">member</a> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> x) (equal (aig-or-list x) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>))))
  (<a class="sym-link system" href="../../../axioms.html#def-verify-guards" data-sym="VERIFY-GUARDS">verify-guards</a> aig-or-list))</pre>
  </div>

<div class="form-block other" id="form-59" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-and-lists
  (x y)
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-and-lists) pairwise &lt;i&gt;and&lt;/i&gt;s together the AIGs from the
lists @(&#39;x&#39;) and @(&#39;y&#39;)."</span>
  <span class="keyword">:returns</span> aig-list
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (if (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> y))
    nil
    (cons (aig-binary-and (car x) (car y))
      (aig-and-lists (cdr x) (cdr y)))))</pre>
  </div>

<div class="form-block other" id="form-60" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-or-lists
  (x y)
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-or-lists) pairwise &lt;i&gt;or&lt;/i&gt;s together the AIGs from the
lists @(&#39;x&#39;) and @(&#39;y&#39;)."</span>
  <span class="keyword">:returns</span> aig-list
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (if (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> y))
    nil
    (cons (aig-binary-or (car x) (car y))
      (aig-or-lists (cdr x) (cdr y)))))</pre>
  </div>

<div class="form-block other" id="form-61" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-xor-lists
  (x y)
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-xor-lists) pairwise &lt;i&gt;xor&lt;/i&gt;s together the AIGs from the
lists @(&#39;x&#39;) and @(&#39;y&#39;)."</span>
  <span class="keyword">:returns</span> aig-list
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (if (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> y))
    nil
    (cons (aig-xor (car x) (car y))
      (aig-xor-lists (cdr x) (cdr y)))))</pre>
  </div>

<div class="form-block other" id="form-62" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-iff-lists
  (x y)
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-iff-lists) pairwise &lt;i&gt;iff&lt;/i&gt;s together the AIGs from the
lists @(&#39;x&#39;) and @(&#39;y&#39;)."</span>
  <span class="keyword">:returns</span> aig-list
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (if (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> y))
    nil
    (cons (aig-iff (car x) (car y))
      (aig-iff-lists (cdr x) (cdr y)))))</pre>
  </div>

<div class="form-block other" id="form-63" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-implies-lists
  (x y)
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-implies-lists) pairwise &lt;i&gt;implies&lt;/i&gt; together the AIGs
from the lists @(&#39;x&#39;) and @(&#39;y&#39;)."</span>
  <span class="keyword">:returns</span> aig-list
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (if (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> y))
    nil
    (cons (aig-implies-fn (car x) (car y))
      (aig-implies-lists (cdr x) (cdr y)))))</pre>
  </div>

<div class="form-block other" id="form-64" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-nand-lists
  (x y)
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-nand-lists) pairwise &lt;i&gt;nand&lt;/i&gt;s together the AIGs from the
lists @(&#39;x&#39;) and @(&#39;y&#39;)."</span>
  <span class="keyword">:returns</span> aig-list
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (if (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> y))
    nil
    (cons (aig-nand (car x) (car y))
      (aig-nand-lists (cdr x) (cdr y)))))</pre>
  </div>

<div class="form-block other" id="form-65" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-nor-lists
  (x y)
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-nor-lists) pairwise &lt;i&gt;nor&lt;/i&gt;s together the AIGs from the
lists @(&#39;x&#39;) and @(&#39;y&#39;)."</span>
  <span class="keyword">:returns</span> aig-list
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (if (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> y))
    nil
    (cons (aig-nor (car x) (car y))
      (aig-nor-lists (cdr x) (cdr y)))))</pre>
  </div>

<div class="form-block other" id="form-66" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-andc1-lists
  (x y)
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-andc1-lists) pairwise &lt;i&gt;andc1&lt;/i&gt;s together the AIGs from the
lists @(&#39;x&#39;) and @(&#39;y&#39;)."</span>
  <span class="keyword">:returns</span> aig-list
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (if (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> y))
    nil
    (cons (aig-andc1 (car x) (car y))
      (aig-andc1-lists (cdr x) (cdr y)))))</pre>
  </div>

<div class="form-block other" id="form-67" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-andc2-lists
  (x y)
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-andc2-lists) pairwise &lt;i&gt;andc2&lt;/i&gt;s together the AIGs from the
lists @(&#39;x&#39;) and @(&#39;y&#39;)."</span>
  <span class="keyword">:returns</span> aig-list
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (if (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> y))
    nil
    (cons (aig-andc2 (car x) (car y))
      (aig-andc2-lists (cdr x) (cdr y)))))</pre>
  </div>

<div class="form-block other" id="form-68" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection aig-orc1-lists
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-orc1-lists) is identical to @(see aig-implies-lists)."</span>
  <span class="keyword">:long</span> <span class="string">"@(def aig-orc1-lists)"</span>
  (<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> aig-orc1-lists (x y) `(aig-implies-lists ,X ,Y)))</pre>
  </div>

<div class="form-block other" id="form-69" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-orc2-lists
  (x y)
  <span class="keyword">:parents</span> (aig-constructors)
  <span class="keyword">:short</span> <span class="string">"@(call aig-orc2-lists) pairwise &lt;i&gt;orc2&lt;/i&gt;s together the AIGs from the
lists @(&#39;x&#39;) or @(&#39;y&#39;)."</span>
  <span class="keyword">:returns</span> aig-list
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (if (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> y))
    nil
    (cons (aig-orc2 (car x) (car y))
      (aig-orc2-lists (cdr x) (cdr y)))))</pre>
  </div>

<div class="form-block other" id="form-70" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(def-ruleset aig-constructors
  '(aig-not aig-and
    aig-or
    aig-xor
    aig-iff
    aig-implies
    aig-ite
    aig-not-list
    aig-and-list
    aig-or-list
    aig-and-lists
    aig-or-lists
    aig-xor-lists
    aig-iff-lists
    aig-nand-lists
    aig-nor-lists
    aig-implies-lists
    aig-andc1-lists
    aig-andc2-lists
    aig-orc2-lists))</pre>
  </div>

<div class="form-block other" id="form-71" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-restrict
  <span class="keyword">:parents</span> (aig-substitution)
  <span class="keyword">:short</span> <span class="string">"@(call aig-restrict) performs variable substitution throughout the
AIG @(&#39;x&#39;), replacing any variables bound in @(&#39;sigma&#39;) with their
corresponding values."</span>
  ((x <span class="string">"The AIG to restrict."</span>) (sigma <span class="string">"A fast alist binding variables to replacement AIGs."</span>))
  <span class="keyword">:returns</span> (aig <span class="string">"Modified version of @(&#39;x&#39;) where all variables bound in @(&#39;sigma&#39;) are
replaced, and any unmentioned variables are left &lt;b&gt;unchanged&lt;/b&gt;."</span>)
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;The name @(&#39;sigma&#39;) is intended to evoke the notion of substitution
lists in logic.  Any variables that are not mentioned in @(&#39;sigma&#39;) are left
unchanged.  When all of the variables in @(&#39;x&#39;) are bound in @(&#39;sigma&#39;), and
all of the values are Boolean, this is equivalent to @(see aig-eval).&lt;/p&gt;

&lt;p&gt;This function is @(see memoize)d.  You should typically free its memo table
after you are done with whatever @(&#39;sigma&#39;) you are using, to avoid excessive
memory usage.  (We don&#39;t use @(&#39;:forget t&#39;) because you often want to restrict
several related AIGs.)&lt;/p&gt;"</span>
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (aig-cases x
    <span class="keyword">:true</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
    <span class="keyword">:false</span> nil
    <span class="keyword">:var</span> (let ((a (hons-get x sigma)))
      (if a
        (cdr a)
        x))
    <span class="keyword">:inv</span> (aig-not (aig-restrict (car x) sigma))
    <span class="keyword">:and</span> (let ((a (aig-restrict (car x) sigma)))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> a (aig-and a (aig-restrict (cdr x) sigma)))))
  ///
  (memoize 'aig-restrict <span class="keyword">:condition</span> '(<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (consp x) (cdr x)))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> hons-assoc-equal-of-append
      (equal (hons-assoc-equal k (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> a b))
        (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (hons-assoc-equal k a) (hons-assoc-equal k b)))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-eval-of-aig-restrict
    (equal (aig-eval (aig-restrict x al1) al2)
      (aig-eval x (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (aig-eval-alist al1 al2) al2)))
    <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> <span class="keyword">:in-theory</span> (enable aig-env-lookup)))))</pre>
  </div>

<div class="form-block other" id="form-72" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-restrict-list-acc
  (x sigma (acc <a class="sym-link system" href="../../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a>))
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    (<a class="sym-link system" href="../../../axioms.html#def-revappend" data-sym="REVAPPEND">revappend</a> acc nil)
    (aig-restrict-list-acc (cdr x)
      sigma
      (cons (aig-restrict (car x) sigma) acc))))</pre>
  </div>

<div class="form-block other" id="form-73" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-restrict-list
  <span class="keyword">:parents</span> (aig-substitution)
  <span class="keyword">:short</span> <span class="string">"@(call aig-restrict-list) substitutes into a list of AIGs."</span>
  ((x <span class="string">"List of AIGs."</span>) (sigma <span class="string">"Fast alist binding variables to replacement AIGs, as in @(see
           aig-restrict)."</span>))
  <span class="keyword">:returns</span> aig-list
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  <span class="keyword">:verify-guards</span> nil
  (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
      nil
      (cons (aig-restrict (car x) sigma)
        (aig-restrict-list (cdr x) sigma)))
    <span class="keyword">:exec</span> (aig-restrict-list-acc x sigma nil))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-restrict-list-acc-elim
      (equal (aig-restrict-list-acc x sigma acc)
        (<a class="sym-link system" href="../../../axioms.html#def-revappend" data-sym="REVAPPEND">revappend</a> acc (aig-restrict-list x sigma)))
      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable aig-restrict-list-acc)))))
  (<a class="sym-link system" href="../../../axioms.html#def-verify-guards" data-sym="VERIFY-GUARDS">verify-guards</a> aig-restrict-list))</pre>
  </div>

<div class="form-block other" id="form-74" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-restrict-alist
  <span class="keyword">:parents</span> (aig-substitution)
  <span class="keyword">:short</span> <span class="string">"@(call aig-restrict-alist) substitutes into an AIG Alist (an alist
binding keys to AIGs)."</span>
  ((x <span class="string">"Alist binding names to AIGs.  This doesn&#39;t need to be a fast alist."</span>) (sigma <span class="string">"Fast alist binding variables to replacement AIGs, as in @(see
           aig-restrict)."</span>))
  <span class="keyword">:returns</span> (aig-alist <span class="string">"Ordinary (slow) alist with the same keys as @(&#39;x&#39;), and values
              formed by restricting each aig with @(see aig-restrict)."</span>)
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) nil)
    ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> (car x)) (aig-restrict-alist (cdr x) sigma))
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (cons (cons (<a class="sym-link system" href="../../../axioms.html#def-caar" data-sym="CAAR">caar</a> x) (aig-restrict (<a class="sym-link system" href="../../../axioms.html#def-cdar" data-sym="CDAR">cdar</a> x) sigma))
        (aig-restrict-alist (cdr x) sigma))))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> alistp-of-aig-restrict-alist
    (<a class="sym-link system" href="../../../axioms.html#def-alistp" data-sym="ALISTP">alistp</a> (aig-restrict-alist x sigma))))</pre>
  </div>

<div class="form-block other" id="form-75" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-restrict-alists
  <span class="keyword">:parents</span> (aig-substitution)
  <span class="keyword">:short</span> <span class="string">"@(call aig-restrict-alists) substitutes into a list of AIG Alists."</span>
  ((x <span class="string">"List of AIG alists, which need not be fast."</span>) (sigma <span class="string">"Fast alist binding variables to replacement AIGs, as in @(see
           aig-restrict)."</span>))
  <span class="keyword">:returns</span> (aig-alists <span class="string">"List of ordinary (slow) alists, derived from @(&#39;x&#39;) via
               @(see aig-restrict-alist)."</span>)
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    nil
    (cons (aig-restrict-alist (car x) sigma)
      (aig-restrict-alists (cdr x) sigma))))</pre>
  </div>

<div class="form-block other" id="form-76" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-compose
  <span class="keyword">:parents</span> (aig-substitution)
  <span class="keyword">:short</span> <span class="string">"@(call aig-compose) performs variable substitution throughout the AIG
@(&#39;x&#39;), &lt;b&gt;unconditionally&lt;/b&gt; replacing every variable in @(&#39;x&#39;) with its
binding in @(&#39;sigma&#39;)."</span>
  ((x <span class="string">"The AIG to compose into."</span>) (sigma <span class="string">"A fast alist that should bind variables to replacement AIGs."</span>))
  <span class="keyword">:returns</span> (aig <span class="string">"Modified version of @(&#39;x&#39;) where every variable is replaced with its
        binding in @(&#39;sigma&#39;) or @(&#39;t&#39;) if it has no binding."</span>)
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;The name @(&#39;sigma&#39;) is intended to evoke the notion of substitution
lists in logic.  This operation is similar to @(see aig-restrict), except that
whereas @(&#39;aig-restrict&#39;) leaves unbound variables alone, @(&#39;aig-compose&#39;)
replaces them with @(&#39;t&#39;).  This has the logically nice property that the
variables after composition are just the variables in the AIGs of
@(&#39;sigma&#39;).&lt;/p&gt;

&lt;p&gt;This function is @(see memoize)d.  You should typically free its memo table
after you are done with whatever @(&#39;sigma&#39;) you are using, to avoid excessive
memory usage.  (We don&#39;t use @(&#39;:forget t&#39;) because you often want to compose
several related AIGs.)&lt;/p&gt;"</span>
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (aig-cases x
    <span class="keyword">:true</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
    <span class="keyword">:false</span> nil
    <span class="keyword">:var</span> (aig-alist-lookup x sigma)
    <span class="keyword">:inv</span> (aig-not (aig-compose (car x) sigma))
    <span class="keyword">:and</span> (let ((a (aig-compose (car x) sigma)))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> a (aig-and a (aig-compose (cdr x) sigma)))))
  ///
  (memoize 'aig-compose <span class="keyword">:condition</span> '(<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (consp x) (cdr x))))</pre>
  </div>

<div class="form-block other" id="form-77" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-compose-list
  <span class="keyword">:parents</span> (aig-substitution)
  <span class="keyword">:short</span> <span class="string">"@(call aig-compose-list) composes into a list of AIGs."</span>
  ((x <span class="string">"List of AIGs."</span>) (sigma <span class="string">"Fast alist binding variables to replacement AIGs, as in @(see
           aig-compose)."</span>))
  <span class="keyword">:returns</span> aig-list
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    nil
    (cons (aig-compose (car x) sigma)
      (aig-compose-list (cdr x) sigma))))</pre>
  </div>

<div class="form-block other" id="form-78" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-compose-alist
  <span class="keyword">:parents</span> (aig-substitution)
  <span class="keyword">:short</span> <span class="string">"@(call aig-compose-alist) composes into an AIG Alist (an alist
binding keys to AIGs)."</span>
  ((x <span class="string">"Alist binding names to AIGs.  This doesn&#39;t need to be a fast alist."</span>) (sigma <span class="string">"Fast alist binding variables to replacement AIGs, as in @(see
           aig-compose)."</span>))
  <span class="keyword">:returns</span> (aig-alist <span class="string">"Ordinary (slow) alist with the same keys as @(&#39;x&#39;), and values formed
              by restricting each aig with @(see aig-compose)."</span>)
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) nil)
    ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> (car x)) (aig-compose-alist (cdr x) sigma))
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (cons (cons (<a class="sym-link system" href="../../../axioms.html#def-caar" data-sym="CAAR">caar</a> x) (aig-compose (<a class="sym-link system" href="../../../axioms.html#def-cdar" data-sym="CDAR">cdar</a> x) sigma))
        (aig-compose-alist (cdr x) sigma)))))</pre>
  </div>

<div class="form-block other" id="form-79" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-compose-alists
  <span class="keyword">:parents</span> (aig-substitution)
  <span class="keyword">:short</span> <span class="string">"@(call aig-compose-alists) composes into a list of AIG Alists."</span>
  ((x <span class="string">"List of AIG alists, which need not be fast."</span>) (sigma <span class="string">"Fast alist binding variables to replacement AIGs, as in @(see
           aig-compose)."</span>))
  <span class="keyword">:returns</span> (aig-alists <span class="string">"List of ordinary (slow) alists, derived from @(&#39;x&#39;) via @(see
               aig-compose-alist)."</span>)
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    nil
    (cons (aig-compose-alist (car x) sigma)
      (aig-compose-alists (cdr x) sigma))))</pre>
  </div>

<div class="form-block other" id="form-80" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-partial-eval
  <span class="keyword">:parents</span> (aig-substitution)
  <span class="keyword">:short</span> <span class="string">"@(call aig-partial-eval) evaluates @(&#39;x&#39;), an AIG, under the partial
environment @(&#39;env&#39;), producing a new AIG as a result."</span>
  ((x <span class="string">"The AIG to partially evaluate."</span>) (env <span class="string">"A fast alist that (typically) binds some of the variables in @(&#39;x&#39;) to
         Boolean values."</span>))
  <span class="keyword">:returns</span> (aig <span class="string">"Modified version of @(&#39;x&#39;) obtained by replacing bound variables with their
        values and doing basic constant propagation."</span>)
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;In ordinary AIG evaluation with @(see aig-eval), any variables that
are missing from @(&#39;env&#39;) are just assumed to have a default value.  Because of
this, every variable can be given a Boolean value and we can evaluate the whole
AIG to produce a Boolean result.&lt;/p&gt;

&lt;p&gt;In partial evaluation, variables that aren&#39;t bound in @(&#39;env&#39;) are left
alone.  Because of this, the result of a partial evaluation is a typically a
reduced AIG instead of a Boolean.&lt;/p&gt;

&lt;p&gt;Another way to do partial evaluations is with @(see aig-restrict).  In fact,
the only difference between @(&#39;aig-restrict&#39;) and @(&#39;aig-partial-eval&#39;) is that
@(&#39;aig-partial-eval&#39;) Boolean-fixes the values in the alist as it looks them
up.  This has logically nice properties, e.g., since we never replace a
variable by a subtree, only by a Boolean, we know unconditionally that the
variables of the resulting AIG are a subset of the variables of the
original.&lt;/p&gt;

&lt;p&gt;This function is @(see memoize)d.  You should typically free its memo table
after you are done with whatever @(&#39;env&#39;) you are using, to avoid excessive
memory usage.  (We don&#39;t use @(&#39;:forget t&#39;) because you often want to evaluate
several related AIGs.)&lt;/p&gt;"</span>
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (aig-cases x
    <span class="keyword">:true</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
    <span class="keyword">:false</span> nil
    <span class="keyword">:var</span> (let ((a (hons-get x env)))
      (if a
        (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (cdr a) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
        x))
    <span class="keyword">:inv</span> (aig-not (aig-partial-eval (car x) env))
    <span class="keyword">:and</span> (let ((a (aig-partial-eval (car x) env)))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> a (aig-and a (aig-partial-eval (cdr x) env)))))
  ///
  (memoize 'aig-partial-eval
    <span class="keyword">:condition</span> '(<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (consp x) (cdr x))))</pre>
  </div>

<div class="form-block other" id="form-81" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-partial-eval-list
  <span class="keyword">:parents</span> (aig-substitution)
  <span class="keyword">:short</span> <span class="string">"@(call aig-partial-eval-list) partially evaluates a list of AIGs."</span>
  ((x <span class="string">"List of AIGs."</span>) (env <span class="string">"Fast alist binding variables to Booleans, as in @(see
         aig-partial-eval)."</span>))
  <span class="keyword">:returns</span> aig-list
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    nil
    (cons (aig-partial-eval (car x) env)
      (aig-partial-eval-list (cdr x) env))))</pre>
  </div>

<div class="form-block other" id="form-82" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-partial-eval-alist
  <span class="keyword">:parents</span> (aig-substitution)
  <span class="keyword">:short</span> <span class="string">"@(call aig-partial-eval-alist) partially evaluates an AIG Alist (an
alist binding keys to AIGs)."</span>
  ((x <span class="string">"Alist binding names to AIGs.  This doesn&#39;t need to be a fast alist."</span>) (env <span class="string">"Fast alist binding variables to Booleans, as in @(see
         aig-partial-eval)."</span>))
  <span class="keyword">:returns</span> (aig-alist <span class="string">"Ordinary (slow) alist with the same keys as x, and values formed
              by restricting each aig with @(see aig-partial-eval)."</span>)
  <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
  (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) nil)
    ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> (car x)) (aig-partial-eval-alist (cdr x) env))
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (cons (cons (<a class="sym-link system" href="../../../axioms.html#def-caar" data-sym="CAAR">caar</a> x) (aig-partial-eval (<a class="sym-link system" href="../../../axioms.html#def-cdar" data-sym="CDAR">cdar</a> x) env))
        (aig-partial-eval-alist (cdr x) env))))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> alistp-of-aig-partial-eval-alist
    (<a class="sym-link system" href="../../../axioms.html#def-alistp" data-sym="ALISTP">alistp</a> (aig-partial-eval-alist x env))))</pre>
  </div>

<div class="form-block other" id="form-83" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define aig-env-extract
  (vars env)
  <span class="keyword">:returns</span> (extract <a class="sym-link system" href="../../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> <span class="keyword">:rule-classes</span> <span class="keyword">:type-prescription</span>)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> vars)
    nil
    (hons-acons (car vars)
      (aig-env-lookup (car vars) env)
      (aig-env-extract (cdr vars) env)))
  ///
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> aig-env-lookup-in-aig-env-extract
    (<a class="sym-link system" href="../../../axioms.html#def-iff" data-sym="IFF">iff</a> (aig-env-lookup v (aig-env-extract vars env))
      (if (<a class="sym-link system" href="../../../axioms.html#def-member" data-sym="MEMBER">member</a> v vars)
        (aig-env-lookup v env)
        <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> hons-assoc-equal-in-aig-env-extract
    (equal (hons-assoc-equal v (aig-env-extract vars env))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-member" data-sym="MEMBER">member</a> v vars) (cons v (aig-env-lookup v env))))))</pre>
  </div>


  </main>
  
<script>
// ACL2 Book HTML Documentation - Interactive Features
// Generated by cert2 - build2 system

// State
let activeFilter = null;
let activePartFilter = null;
let activeNameFilter = null;
let currentFontSize = 14;

// Theme management
function getStoredTheme() {
  return localStorage.getItem('acl2-theme') || 'dark';
}

function setTheme(theme) {
  if (theme === 'light') {
    document.documentElement.setAttribute('data-theme', 'light');
    document.getElementById('theme-toggle').textContent = '🌙';
  } else {
    document.documentElement.removeAttribute('data-theme');
    document.getElementById('theme-toggle').textContent = '☀️';
  }
  localStorage.setItem('acl2-theme', theme);
}

function toggleTheme() {
  const current = getStoredTheme();
  setTheme(current === 'dark' ? 'light' : 'dark');
}

// Font size management
function getStoredFontSize() {
  return parseInt(localStorage.getItem('acl2-fontsize') || '14', 10);
}

function setFontSize(size) {
  size = Math.max(10, Math.min(24, size)); // Clamp between 10-24
  currentFontSize = size;
  document.body.style.fontSize = size + 'px';
  localStorage.setItem('acl2-fontsize', size.toString());
}

function increaseFontSize() {
  setFontSize(currentFontSize + 2);
}

function decreaseFontSize() {
  setFontSize(currentFontSize - 2);
}

// Get all form blocks
function getFormBlocks() {
  return document.querySelectorAll('.form-block');
}

// Clear all filters
function clearFilter() {
  activeFilter = null;
  activePartFilter = null;
  activeNameFilter = null;
  getFormBlocks().forEach(b => {
    b.classList.remove('hidden', 'dimmed');
  });
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  const status = document.querySelector('.filter-status');
  status.classList.remove('active');
  // Slide name filter back to original position
  document.querySelector('.controls-left').style.transform = '';
  // Clear the name filter input
  const nameInput = document.getElementById('name-filter');
  if (nameInput) nameInput.value = '';
}

// Show filter status and slide name filter right
function showFilterStatus(text) {
  const status = document.querySelector('.filter-status');
  status.classList.add('active');
  status.querySelector('.filter-text').textContent = text;
  // Slide name filter to the right to make room
  setTimeout(() => {
    const statusWidth = status.offsetWidth;
    document.querySelector('.controls-left').style.transform = `translateX(${statusWidth + 15}px)`;
  }, 10);
}

// Filter to show only forms that define or reference a symbol
function filterBySymbol(symName, showUsedBy) {
  clearFilter();
  activeFilter = symName;
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines;
    const references = (block.dataset.references || '').split(',');
    const usedBy = (block.dataset.usedBy || '').split(',');
    
    let show = false;
    if (showUsedBy) {
      // Show forms that USE this symbol
      show = references.includes(symName) || definesName === symName;
    } else {
      // Show forms that this symbol USES
      show = usedBy.includes(symName) || definesName === symName;
    }
    
    if (show) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering by: ${symName} (${visibleCount} items)`);
}

// Filter by defthm part (term, hints, rule-classes, etc.)
function filterByPart(formId, partName) {
  clearFilter();
  activePartFilter = { formId, partName };
  
  // Get the part's referenced symbols
  // data-part-term becomes dataset.partTerm, data-part-hints becomes dataset.partHints, etc.
  const block = document.getElementById(formId);
  const datasetKey = 'part' + partName.charAt(0).toUpperCase() + partName.slice(1).replace(/-([a-z])/g, (g) => g[1].toUpperCase());
  const partData = block.dataset[datasetKey];
  if (!partData) return;
  
  const partSyms = partData.split(',').filter(s => s);
  
  // Highlight the button
  block.querySelector(`.part-btn[data-part="${partName}"]`).classList.add('active');
  
  // Hide forms not referenced by this part
  getFormBlocks().forEach(b => {
    const definesName = b.dataset.defines;
    if (b.id === formId || partSyms.includes(definesName)) {
      b.classList.remove('hidden');
    } else {
      b.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering ${formId} :${partName} (${partSyms.length} references)`);
}

// Filter by name (substring or regex)
function filterByName(pattern, useRegex) {
  // Clear other filters but keep the input value
  activeFilter = null;
  activePartFilter = null;
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  
  if (!pattern || pattern.trim() === '') {
    // Empty pattern - show all
    activeNameFilter = null;
    getFormBlocks().forEach(b => b.classList.remove('hidden'));
    const status = document.querySelector('.filter-status');
    status.classList.remove('active');
    document.querySelector('.controls-left').style.transform = '';
    return;
  }
  
  activeNameFilter = pattern;
  
  let matcher;
  let isValidRegex = true;
  
  if (useRegex) {
    try {
      matcher = new RegExp(pattern, 'i');
    } catch (e) {
      // Invalid regex - show error in status and don't filter
      showFilterStatus(`Invalid regex: ${e.message}`);
      return;
    }
  } else {
    // Plain substring match (case-insensitive)
    const lowerPattern = pattern.toLowerCase();
    matcher = { test: (s) => s.toLowerCase().includes(lowerPattern) };
  }
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines || '';
    if (matcher.test(definesName)) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  const modeText = useRegex ? 'regex' : 'name';
  showFilterStatus(`Filtering by ${modeText}: "${pattern}" (${visibleCount} matches)`);
}

// Click on a name to show what references it
function handleNameClick(symName) {
  if (activeFilter === symName) {
    clearFilter();
  } else {
    filterBySymbol(symName, true);
  }
}

// Navigate to a definition (same file or different)
function navigateTo(symName, file) {
  if (file) {
    // External file - navigate
    window.location.href = file + '.html#def-' + symName.toLowerCase();
  } else {
    // Same file - scroll
    const target = document.getElementById('def-' + symName.toLowerCase());
    if (target) {
      target.scrollIntoView({ behavior: 'smooth', block: 'center' });
      target.classList.add('highlight');
      setTimeout(() => target.classList.remove('highlight'), 400);
    }
  }
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  // Part buttons
  document.querySelectorAll('.part-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const formId = btn.closest('.form-block').id;
      const partName = btn.dataset.part;
      if (activePartFilter && activePartFilter.formId === formId && 
          activePartFilter.partName === partName) {
        clearFilter();
      } else {
        filterByPart(formId, partName);
      }
    });
  });
  
  // Clear filter button
  document.querySelector('.clear-filter').addEventListener('click', clearFilter);
  
  // Name filter input
  const nameFilter = document.getElementById('name-filter');
  const regexToggle = document.getElementById('regex-toggle');
  
  let filterTimeout = null;
  nameFilter.addEventListener('input', () => {
    // Debounce the filter to avoid excessive updates while typing
    clearTimeout(filterTimeout);
    filterTimeout = setTimeout(() => {
      filterByName(nameFilter.value, regexToggle.checked);
    }, 150);
  });
  
  // Re-filter when regex toggle changes
  regexToggle.addEventListener('change', () => {
    if (nameFilter.value) {
      filterByName(nameFilter.value, regexToggle.checked);
    }
  });
  
  // Allow Escape key to clear filter when in input
  nameFilter.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      clearFilter();
      nameFilter.blur();
    }
  });
  
  // Symbol references (old span-based refs)
  document.querySelectorAll('.sym-ref').forEach(ref => {
    ref.addEventListener('click', (e) => {
      e.stopPropagation();
      const sym = ref.dataset.sym;
      const file = ref.dataset.file;
      if (file) {
        navigateTo(sym, file);
      } else {
        handleNameClick(sym);
      }
    });
  });
  
  // Symbol links (new anchor-based links)
  // These use standard <a> tags so navigation happens automatically
  // But we need to clear filters if target would be hidden
  document.querySelectorAll('.sym-link').forEach(link => {
    link.addEventListener('click', (e) => {
      const href = link.getAttribute('href');
      if (href && href.startsWith('#')) {
        // Local link - check if target is hidden by filter
        const targetId = href.substring(1);
        const target = document.getElementById(targetId);
        if (target) {
          // If target is hidden, clear the filter first
          if (target.classList.contains('hidden')) {
            clearFilter();
          }
          // Add highlight effect after a short delay
          setTimeout(() => {
            target.classList.add('highlight');
            setTimeout(() => target.classList.remove('highlight'), 400);
          }, 100);
        }
      }
      // For external links, default behavior handles navigation
    });
  });
  
  // Form names (show what uses them)
  document.querySelectorAll('.form-name').forEach(name => {
    name.addEventListener('click', (e) => {
      handleNameClick(name.dataset.sym);
    });
  });
  
  // Handle hash navigation (when arriving at page with #anchor)
  if (window.location.hash) {
    const target = document.querySelector(window.location.hash);
    if (target) {
      setTimeout(() => {
        target.scrollIntoView({ behavior: 'smooth', block: 'center' });
        target.classList.add('highlight');
        setTimeout(() => target.classList.remove('highlight'), 400);
      }, 200);
    }
  }
  
  // Initialize theme from storage
  setTheme(getStoredTheme());
  
  // Initialize font size from storage
  currentFontSize = getStoredFontSize();
  setFontSize(currentFontSize);
  
  // Theme toggle button
  document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
  
  // Font size buttons
  document.getElementById('font-larger').addEventListener('click', increaseFontSize);
  document.getElementById('font-smaller').addEventListener('click', decreaseFontSize);
});

</script>

</body>
</html>
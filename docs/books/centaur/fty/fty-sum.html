<!DOCTYPE html>
<html lang="en" vocab="http://schema.org/" typeof="SoftwareSourceCode">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>fty-sum - ACL2 Book</title>
  <meta property="name" content="fty-sum">
  <meta property="programmingLanguage" content="ACL2">
  
<style>
/* ACL2 Book HTML Documentation Styles */
/* Generated by cert2 - build2 system */

/* Dark theme (default) */
:root {
  --bg: #1e1e2e;
  --fg: #cdd6f4;
  --comment: #6c7086;
  --keyword: #cba6f7;
  --string: #a6e3a1;
  --function: #89b4fa;
  --type: #f9e2af;
  --link: #89dceb;
  --link-hover: #f5c2e7;
  --highlight: rgba(137, 180, 250, 0.2);
  --border: #313244;
  --block-bg: rgba(49, 50, 68, 0.5);
  --btn-bg: #313244;
  --btn-hover: rgba(137, 180, 250, 0.2);
}

/* Light theme */
[data-theme="light"] {
  --bg: #eff1f5;
  --fg: #4c4f69;
  --comment: #6c6f85;
  --keyword: #8839ef;
  --string: #40a02b;
  --function: #1e66f5;
  --type: #df8e1d;
  --link: #04a5e5;
  --link-hover: #ea76cb;
  --highlight: rgba(30, 102, 245, 0.15);
  --border: #ccd0da;
  --block-bg: rgba(204, 208, 218, 0.3);
  --btn-bg: #ccd0da;
  --btn-hover: rgba(30, 102, 245, 0.15);
}

body {
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  background: var(--bg);
  color: var(--fg);
  margin: 0;
  padding: 20px;
  line-height: 1.6;
  font-size: 14px;
  transition: background 0.1s, color 0.1s;
}

/* Controls toolbar */
.controls-left {
  position: fixed;
  top: 10px;
  left: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
  transition: transform 0.1s ease;
}

.controls-right {
  position: fixed;
  top: 10px;
  right: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
}

.control-btn {
  padding: 6px 12px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-family: inherit;
  font-size: 14px;
  transition: all 0.1s;
}

.control-btn:hover {
  background: var(--btn-hover);
  border-color: var(--link);
}

.name-filter {
  padding: 6px 10px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  font-family: inherit;
  font-size: 13px;
  width: 150px;
  transition: all 0.1s;
}

.name-filter:focus {
  outline: none;
  border-color: var(--link);
  width: 200px;
}

.name-filter::placeholder {
  color: var(--comment);
}

.regex-label {
  display: flex;
  align-items: center;
  gap: 4px;
  color: var(--comment);
  font-size: 12px;
  cursor: pointer;
}

.regex-label input {
  cursor: pointer;
}

.book-header {
  border-bottom: 2px solid var(--border);
  padding-bottom: 20px;
  margin-bottom: 20px;
}

.book-header h1 {
  color: var(--keyword);
  margin: 0;
}

.book-header .path {
  color: var(--comment);
  font-size: 0.9em;
}

.book-header .path .source-link {
  color: var(--comment);
  text-decoration: none;
}

.book-header .path .source-link:hover {
  color: var(--link);
  text-decoration: underline;
}

.form-block {
  margin: 10px 0;
  padding: 15px;
  background: var(--block-bg);
  border-radius: 8px;
  border-left: 3px solid var(--border);
}

.form-block.theorem { border-left-color: var(--keyword); }
.form-block.function { border-left-color: var(--function); }
.form-block.macro { border-left-color: var(--type); }
.form-block.include-book { border-left-color: var(--string); }

.form-block.hidden { display: none; }
.form-block.dimmed { opacity: 0.3; }

.form-block.highlight {
  animation: highlight-pulse 0.4s ease-out;
}

@keyframes highlight-pulse {
  0% { background: var(--highlight); box-shadow: 0 0 20px var(--link); }
  100% { background: rgba(49, 50, 68, 0.5); box-shadow: none; }
}

.form-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.form-name {
  color: var(--function);
  font-weight: bold;
  cursor: pointer;
}

.form-name:hover {
  color: var(--link-hover);
  text-decoration: underline;
}

.form-type {
  color: var(--comment);
  font-size: 0.85em;
}

pre.code {
  margin: 0;
  overflow-x: auto;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.sym-ref {
  color: var(--link);
  cursor: pointer;
  border-radius: 2px;
}

.sym-ref:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.sym-ref.local-def { color: var(--function); font-weight: bold; }
.sym-ref.external { color: var(--type); }

/* Symbol links (clickable hyperlinks) */
.sym-link {
  color: var(--link);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
  position: relative;
}

.sym-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

.sym-link.local-def {
  color: var(--function);
  font-weight: bold;
}

.sym-link.external {
  color: var(--type);
}

/* Tooltips using title attribute with custom styling */
.sym-link[title] {
  /* Browser will show title on hover */
}

/* Syntax highlighting in code blocks */
.keyword {
  color: var(--keyword);
}

.string {
  color: var(--string);
}

.number {
  color: #f77524; /* orange */
}

/* Include-book path links */
.include-path {
  color: var(--string);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
}

.include-path:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

/* Part buttons for defthm */
.part-buttons {
  display: flex;
  gap: 5px;
  margin: 10px 0;
  flex-wrap: wrap;
}

.part-btn {
  padding: 4px 10px;
  background: var(--border);
  border: 1px solid var(--comment);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-size: 0.85em;
  font-family: inherit;
}

.part-btn:hover {
  background: var(--highlight);
  border-color: var(--link);
}

.part-btn.active {
  background: var(--link);
  color: var(--bg);
  border-color: var(--link);
}

/* References panel */
.refs-panel {
  margin-top: 10px;
  padding: 10px;
  background: rgba(0,0,0,0.2);
  border-radius: 4px;
  display: none;
}

.refs-panel.visible { display: block; }

.refs-panel h4 {
  margin: 0 0 5px 0;
  color: var(--comment);
  font-size: 0.9em;
}

.refs-list {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

/* Included books section */
.includes-section {
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(49, 50, 68, 0.3);
  border-radius: 8px;
  border: 1px solid var(--border);
}

.includes-section h2 {
  margin: 0 0 10px 0;
  color: var(--comment);
  font-size: 1em;
  font-weight: normal;
}

.includes-list {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.include-link {
  padding: 6px 12px;
  background: var(--border);
  border-radius: 4px;
  color: var(--link);
  text-decoration: none;
  font-size: 0.9em;
  transition: all 0.1s;
}

.include-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.include-link.local {
  border-left: 2px solid var(--comment);
}

/* Filter status */
.filter-status {
  position: fixed;
  top: 10px;
  left: 20px;
  background: var(--bg);
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: 4px;
  z-index: 201;
  display: none;
  align-items: center;
  gap: 10px;
}

.filter-status.active {
  display: flex;
  align-items: center;
  gap: 10px;
}

.clear-filter {
  padding: 5px 15px;
  background: var(--keyword);
  color: var(--bg);
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

/* RDFa vocab indicator */
[vocab] { /* semantic web annotations present */ }

</style>

</head>
<body>
  <div class="controls-left">
    <input type="text" id="name-filter" class="name-filter" placeholder="Filter by name..." title="Filter definitions by name">
    <label class="regex-label"><input type="checkbox" id="regex-toggle"> regex</label>
  </div>

  <div class="controls-right">
    <button class="control-btn" id="theme-toggle" title="Toggle light/dark theme">☀️</button>
    <button class="control-btn" id="font-smaller" title="Decrease font size">A-</button>
    <button class="control-btn" id="font-larger" title="Increase font size">A+</button>
  </div>

  <div class="filter-status">
    <span class="filter-text">Filtering...</span>
    <button class="clear-filter">Clear Filter</button>
  </div>
  
  <div class="book-header">
    <h1 property="name">fty-sum</h1>
    <div class="path"><a href="fty-sum.lisp" class="source-link">books/centaur/fty/fty-sum</a></div>
  </div>
  
  <main property="text">
<div class="form-block other" id="form-0" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-in-package" data-sym="IN-PACKAGE">in-package</a> <span class="string">"FTY"</span>)</pre>
  </div>

<div class="form-block other" id="form-1" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="fty-parseutils.html" title="Open fty-parseutils">"fty-parseutils"</a>)</pre>
  </div>

<div class="form-block other" id="form-2" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="fty-sum-casemacro.html" title="Open fty-sum-casemacro">"fty-sum-casemacro"</a>)</pre>
  </div>

<div class="form-block other" id="form-3" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../xdoc/names.html" title="Open xdoc/names">"xdoc/names"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block other" id="form-4" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-program" data-sym="PROGRAM">program</a>)</pre>
  </div>

<div class="form-block other" id="form-5" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define nice-and
  (x y)
  <span class="string">"Like `(and ,x ,y) but maybe simplify things."</span>
  (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) y)
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> y <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) x)
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x nil) nil)
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> y nil) nil)
    ((<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (consp x) (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (car x) '<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a>)) (if (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (consp y) (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (car y) '<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a>))
        (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> x (cdr y))
        (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> x (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> y))))
    ((<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (consp y) (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (car y) '<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a>)) `(<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> ,FTY::X . ,(CDR FTY::Y)))
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> `(<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> ,FTY::X ,FTY::Y))))</pre>
  </div>

<div class="form-block other" id="form-6" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define nice-or
  (x y)
  <span class="string">"Like `(or ,x ,y) but maybe simplify things."</span>
  (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> y <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x nil) y)
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> y nil) x)
    ((<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (consp x) (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (car x) '<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a>)) (if (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (car y) '<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a>)
        (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> x (cdr y))
        (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> x (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> y))))
    ((<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (consp y) (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (car y) '<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a>)) `(<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> ,FTY::X . ,(CDR FTY::Y)))
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> `(<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> ,FTY::X ,FTY::Y))))</pre>
  </div>

<div class="form-block other" id="form-7" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define nice-implies
  (x y)
  <span class="string">"Like `(implies ,x ,y) but maybe simplify things."</span>
  (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) y)
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> y <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x nil) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> y nil) x)
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> `(<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> ,FTY::X ,FTY::Y))))</pre>
  </div>

<div class="form-block other" id="form-8" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define nice-cond
  (x)
  <span class="string">"Like `(cond ...)` but maybe reduce (cond (t foo)) to just foo."</span>
  (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) nil)
    ((<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (<a class="sym-link system" href="../../../axioms.html#def-caar" data-sym="CAAR">caar</a> x) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) (<a class="sym-link system" href="../../../axioms.html#def-cadar" data-sym="CADAR">cadar</a> x))
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> `(<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> . ,FTY::X))))</pre>
  </div>

<div class="form-block other" id="form-9" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> *flexprod-field-keywords*
  '(<span class="keyword">:type</span> <span class="keyword">:acc-body</span> <span class="keyword">:acc-name</span> <span class="keyword">:default</span> <span class="keyword">:doc</span> <span class="keyword">:rule-classes</span> <span class="keyword">:reqfix</span> <span class="keyword">:reqfix-vars</span> <span class="keyword">:shared</span>))</pre>
  </div>

<div class="form-block other" id="form-10" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define parse-flexprod-field
  ((x <span class="string">"User-level syntax, a single field they are defining."</span>) (type-name <span class="string">"Product type this field is part of."</span>)
    (our-fixtypes <span class="string">"New fixtypes being defined."</span>)
    (fixtypes <span class="string">"Previous fixtypes."</span>))
  <span class="keyword">:returns</span> (field <span class="string">"A flexprod-field-p."</span>)
  (b* (((cons name kws) x) ((unless (symbolp name)) (raise <span class="string">"In ~x0: malformed field ~x1: first element should be the name, a symbol."</span>
          type-name
          x))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> kwd-alist <a class="sym-link system" href="../../../axioms.html#def-rest" data-sym="REST">rest</a>) (extract-keywords (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> type-name (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> name '|[...]|))
          *flexprod-field-keywords*
          kws
          nil))
      ((when <a class="sym-link system" href="../../../axioms.html#def-rest" data-sym="REST">rest</a>) (raise <span class="string">"In ~x0: malformed field ~x1: after name should be a keyword/value list."</span>
          type-name
          x))
      (acc-body (getarg <span class="keyword">:acc-body</span> <span class="number">0</span> kwd-alist))
      ((unless (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (symbolp acc-body) (consp acc-body))) (raise <span class="string">"In ~x0: malformed field ~x1: :acc-body should be a term."</span>
          type-name
          x))
      (acc-name (getarg-nonnil! <span class="keyword">:acc-name</span> (intern-in-package-of-symbol (cat (symbol-name type-name)
              <span class="string">"-&gt;"</span>
              (symbol-name name))
            type-name)
          kwd-alist))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> type <a class="sym-link system" href="../../../axioms.html#def-fix" data-sym="FIX">fix</a> equiv recp) (get-pred/fix/equiv (getarg <span class="keyword">:type</span> nil kwd-alist)
          our-fixtypes
          fixtypes))
      (reqfix (getarg <span class="keyword">:reqfix</span> name kwd-alist)))
    (make-flexprod-field <span class="keyword">:name</span> name
      <span class="keyword">:acc-body</span> acc-body
      <span class="keyword">:acc-name</span> acc-name
      <span class="keyword">:type</span> type
      <span class="keyword">:fix</span> <a class="sym-link system" href="../../../axioms.html#def-fix" data-sym="FIX">fix</a>
      <span class="keyword">:equiv</span> equiv
      <span class="keyword">:default</span> (getarg <span class="keyword">:default</span> nil kwd-alist)
      <span class="keyword">:doc</span> (getarg <span class="keyword">:doc</span> <span class="string">""</span> kwd-alist)
      <span class="keyword">:reqfix</span> reqfix
      <span class="keyword">:reqfix-vars</span> (getarg <span class="keyword">:reqfix-vars</span> <span class="keyword">:all</span> kwd-alist)
      <span class="keyword">:rule-classes</span> (let ((look (<a class="sym-link system" href="../../../axioms.html#def-assoc" data-sym="ASSOC">assoc</a> <span class="keyword">:rule-classes</span> kwd-alist)))
        (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> look `(<span class="keyword">:rule-classes</span> ,(CDR FTY::LOOK))))
      <span class="keyword">:recp</span> recp
      <span class="keyword">:shared</span> (getarg <span class="keyword">:shared</span> nil kwd-alist))))</pre>
  </div>

<div class="form-block other" id="form-11" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define parse-flexprod-fields
  (x type-name our-fixtypes fixtypes)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    nil
    (cons (parse-flexprod-field (car x)
        type-name
        our-fixtypes
        fixtypes)
      (parse-flexprod-fields (cdr x)
        type-name
        our-fixtypes
        fixtypes))))</pre>
  </div>

<div class="form-block other" id="form-12" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> *flexprod-keywords*
  '(<span class="keyword">:shape</span> <span class="keyword">:fields</span> <span class="keyword">:ctor-body</span> <span class="keyword">:ctor-name</span> <span class="keyword">:ctor-macro</span> <span class="keyword">:remake-name</span> <span class="keyword">:remake-body</span> <span class="keyword">:cond</span> <span class="keyword">:type-name</span> <span class="keyword">:short</span> <span class="keyword">:long</span> <span class="keyword">:inline</span> <span class="keyword">:require</span> <span class="keyword">:count-incr</span> <span class="keyword">:extra-binder-names</span> <span class="keyword">:no-ctor-macros</span> <span class="keyword">:verbosep</span>))</pre>
  </div>

<div class="form-block other" id="form-13" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define dumb-append-conjunct
  (rev-prev-conds newcond)
  (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> newcond <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) (equal newcond ''<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)) (<a class="sym-link system" href="../../../axioms.html#def-reverse" data-sym="REVERSE">reverse</a> rev-prev-conds))
    ((<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> newcond nil) (equal newcond ''nil)) (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> nil))
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../../axioms.html#def-revappend" data-sym="REVAPPEND">revappend</a> rev-prev-conds (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> newcond)))))</pre>
  </div>

<div class="form-block other" id="form-14" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define parse-flexprod
  ((x <span class="string">"User-level syntax, the whole product type."</span>) (sumname <span class="string">"The name of the superior sum type, e.g., mysum but not mysum-p."</span>)
    (sumkind <span class="string">"The kind function for the superior sum type, if applicable."</span>)
    (sum-kwds <span class="string">"The keyword arguments from the superior sum type."</span>)
    (xvar <span class="string">"The special @(&#39;x&#39;) variable to use."</span>)
    (rev-not-prevconds <span class="string">"The previous conditions for the sum type, if applicable."</span>)
    (our-fixtypes <span class="string">"New fixtypes being defined."</span>)
    (fixtypes <span class="string">"Previous fixtypes."</span>))
  <span class="keyword">:returns</span> (prod <span class="string">"A flexprod-p."</span>)
  (b* (((unless (consp x)) (raise <span class="string">"In ~x0: malformed flexprod ~x1: expected (:kind ...)."</span>
         sumname
         x)) ((cons kind kws) x)
      ((unless (<a class="sym-link system" href="../../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> kind)) (raise <span class="string">"In ~x0: malformed flexprod ~x1: kind (~x2) should be a keyword"</span>
          sumname
          x
          kind))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> kwd-alist <a class="sym-link system" href="../../../axioms.html#def-rest" data-sym="REST">rest</a>) (extract-keywords (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> kind '|[...]|)
          *flexprod-keywords*
          kws
          nil))
      ((when <a class="sym-link system" href="../../../axioms.html#def-rest" data-sym="REST">rest</a>) (raise <span class="string">"In ~x0: malformed flexprod ~x1: after kind keyword ~x1 there ~
                should be only keywords and values."</span>
          sumname
          kind))
      (ctor-body-lookup (<a class="sym-link system" href="../../../axioms.html#def-assoc" data-sym="ASSOC">assoc</a> <span class="keyword">:ctor-body</span> kwd-alist))
      ((unless ctor-body-lookup) (raise <span class="string">"In ~x0: malformed product: ~x1: :ctor-body should be a term."</span>
          sumname
          kind))
      (ctor-body (cdr ctor-body-lookup))
      (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> (getarg <span class="keyword">:cond</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> kwd-alist))
      (shape (getarg <span class="keyword">:shape</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> kwd-alist))
      (type-name (getarg-nonnil! <span class="keyword">:type-name</span> (intern-in-package-of-symbol (if (getarg <span class="keyword">:short-names</span> nil sum-kwds)
              (symbol-name kind)
              (cat (symbol-name sumname)
                <span class="string">"-"</span>
                (symbol-name kind)))
            sumname)
          kwd-alist))
      (ctor-name (getarg-nonnil! <span class="keyword">:ctor-name</span> type-name
          kwd-alist))
      (ctor-macro (getarg-nonnil! <span class="keyword">:ctor-macro</span> (intern-in-package-of-symbol (cat <span class="string">"MAKE-"</span> (symbol-name ctor-name))
            ctor-name)
          kwd-alist))
      (remake-body (getarg <span class="keyword">:remake-body</span> nil kwd-alist))
      (remake-name (getarg <span class="keyword">:remake-name</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> remake-body
            (intern-in-package-of-symbol (cat <span class="string">"REMAKE-"</span> (symbol-name ctor-name))
              ctor-name))
          kwd-alist))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> remake-name (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> remake-body))) (raise <span class="string">"In ~x0: malformed product ~x1: :remake-name is ~x2 but ~
                no :remake-body has been provided."</span>
          sumname
          x
          remake-name))
      (fields (parse-flexprod-fields (getarg <span class="keyword">:fields</span> nil kwd-alist)
          type-name
          our-fixtypes
          fixtypes))
      (<a class="sym-link system" href="../../../basis-b.html#def-guard" data-sym="GUARD">guard</a> (if sumkind
          `(equal (,FTY::SUMKIND ,FTY::XVAR) ,FTY::KIND)
          (<a class="sym-link system" href="../../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((fullcond-terms (dumb-append-conjunct rev-not-prevconds <a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a>)))
            (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fullcond-terms) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
              ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> (cdr fullcond-terms)) (car fullcond-terms))
              (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> `(<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> . ,FTY::FULLCOND-TERMS))))))
      (inline (get-deftypes-inline-opt (getarg <span class="keyword">:inline</span> *inline-defaults* sum-kwds)
          kwd-alist))
      (require (getarg <span class="keyword">:require</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> kwd-alist))
      (extra-binder-names (getarg <span class="keyword">:extra-binder-names</span> nil kwd-alist))
      (count-incr (getarg <span class="keyword">:count-incr</span> nil kwd-alist))
      (no-ctor-macros (getarg <span class="keyword">:no-ctor-macros</span> nil kwd-alist)))
    (make-flexprod <span class="keyword">:kind</span> kind
      <span class="keyword">:cond</span> <a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a>
      <span class="keyword">:guard</span> <a class="sym-link system" href="../../../basis-b.html#def-guard" data-sym="GUARD">guard</a>
      <span class="keyword">:shape</span> shape
      <span class="keyword">:require</span> require
      <span class="keyword">:fields</span> fields
      <span class="keyword">:type-name</span> type-name
      <span class="keyword">:ctor-name</span> ctor-name
      <span class="keyword">:ctor-macro</span> ctor-macro
      <span class="keyword">:ctor-body</span> ctor-body
      <span class="keyword">:remake-name</span> remake-name
      <span class="keyword">:remake-body</span> remake-body
      <span class="keyword">:extra-binder-names</span> extra-binder-names
      <span class="keyword">:short</span> (getarg <span class="keyword">:short</span> nil kwd-alist)
      <span class="keyword">:long</span> (getarg <span class="keyword">:long</span> nil kwd-alist)
      <span class="keyword">:inline</span> inline
      <span class="keyword">:count-incr</span> count-incr
      <span class="keyword">:no-ctor-macros</span> no-ctor-macros)))</pre>
  </div>

<div class="form-block other" id="form-15" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define dumb-cons-conjunct
  (newcond conds)
  (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> newcond <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) (equal newcond ''<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)) conds)
    ((<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> newcond nil) (equal newcond ''nil)) (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> nil))
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (cons newcond conds))))</pre>
  </div>

<div class="form-block other" id="form-16" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define parse-flexprods
  (x sumname
    sumkind
    sum-kwds
    xvar
    rev-not-prevconds
    our-fixtypes
    fixtypes)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)) nil) (newprod (parse-flexprod (car x)
          sumname
          sumkind
          sum-kwds
          xvar
          rev-not-prevconds
          our-fixtypes
          fixtypes))
      (rev-not-prevconds (dumb-cons-conjunct (<a class="sym-link system" href="../../../basis-b.html#def-dumb-negate-lit" data-sym="DUMB-NEGATE-LIT">dumb-negate-lit</a> (flexprod-&gt;cond newprod))
          rev-not-prevconds)))
    (cons newprod
      (parse-flexprods (cdr x)
        sumname
        sumkind
        sum-kwds
        xvar
        rev-not-prevconds
        our-fixtypes
        fixtypes))))</pre>
  </div>

<div class="form-block other" id="form-17" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> *flexsum-keywords*
  '(<span class="keyword">:pred</span> <span class="keyword">:fix</span> <span class="keyword">:equiv</span> <span class="keyword">:kind</span> <span class="keyword">:count</span> <span class="keyword">:case</span> <span class="keyword">:measure</span> <span class="keyword">:measure-debug</span> <span class="keyword">:xvar</span> <span class="keyword">:no-count</span> <span class="keyword">:shape</span> <span class="keyword">:kind-body</span> <span class="keyword">:parents</span> <span class="keyword">:short</span> <span class="keyword">:long</span> <span class="keyword">:short-names</span> <span class="keyword">:prepwork</span> <span class="keyword">:post-pred-events</span> <span class="keyword">:post-fix-events</span> <span class="keyword">:post-acc-events</span> <span class="keyword">:post-events</span> <span class="keyword">:inline</span> <span class="keyword">:enable-rules</span> <span class="keyword">:verbosep</span>))</pre>
  </div>

<div class="form-block other" id="form-18" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define some-flexprod-field-recursivep
  (x)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    nil
    (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (flexprod-field-&gt;recp (car x))
      (some-flexprod-field-recursivep (cdr x)))))</pre>
  </div>

<div class="form-block other" id="form-19" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define some-flexprod-recursivep
  (x)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    nil
    (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (some-flexprod-field-recursivep (flexprod-&gt;fields (car x)))
      (some-flexprod-recursivep (cdr x)))))</pre>
  </div>

<div class="form-block other" id="form-20" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define flexsum-infer-xvar
  ((ctx <span class="string">"Context for error messages."</span>) (kwd-alist <span class="string">"Keyword alist that may include :xvar"</span>)
    (xvar <span class="string">"The value of :xvar in the superior deftypes call, if applicable.
               When provided, we use this unless the user explicitly overrides
               it in the sum itself."</span>)
    (prods <span class="string">"The products in this sum type, not yet parsed, we&#39;re just
               dumbly looking for Xes in these."</span>))
  (b* ((xvar (getarg-nonnil! <span class="keyword">:xvar</span> xvar kwd-alist)) ((when xvar) xvar)
      (xsyms (find-symbols-named-x prods))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> xsyms)) (raise <span class="string">"In ~x0: no variable named X occurs in the defflexsum form. ~
                Specify another variable with :xvar."</span>
          ctx))
      ((when (consp (cdr xsyms))) (raise <span class="string">"In ~x0: more than one symbol named X occurs in the deftypes ~
                form: ~&amp;1.  Specify the variable denoting the typed object ~
                with :xvar."</span>
          ctx
          xsyms)))
    (car xsyms)))</pre>
  </div>

<div class="form-block other" id="form-21" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define flexprod-fields-check-xvar
  (xvar fields prodname)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fields)) nil) ((flexprod-field x) (car fields))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x.name xvar)) (raise <span class="string">"Product ~x0 has a field named ~x1, which is not allowed ~
                because it&#39;s also the name of the variable representing the ~
                whole product.  You may change the field name or provide an ~
                explicit :xvar argument.~%"</span>
          prodname
          x.name)))
    (flexprod-fields-check-xvar xvar
      (cdr fields)
      prodname)))</pre>
  </div>

<div class="form-block other" id="form-22" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define flexprods-check-xvar
  (xvar prods)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)) nil) ((flexprod x) (car prods)))
    (flexprod-fields-check-xvar xvar
      x.fields
      x.kind)
    (flexprods-check-xvar xvar (cdr prods))))</pre>
  </div>

<div class="form-block other" id="form-23" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define parse-flexsum
  ((x <span class="string">"User-level syntax, the whole defflexsum form."</span>) (xvar <span class="string">"The special x variable to use.  BOZO but we infer it?"</span>)
    (our-fixtypes <span class="string">"New fixtypes being defined."</span>)
    (fixtypes <span class="string">"Previous fixtypes."</span>)
    state)
  <span class="keyword">:returns</span> (flexsum <span class="string">"A flexsum-p."</span>)
  (b* (((cons name <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>) x) ((unless (symbolp name)) (raise <span class="string">"Malformed flexsum: ~x0: name must be a symbol"</span>
          x))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> pre-/// post-///) (split-/// name <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> kwd-alist orig-prods) (extract-keywords name
          *flexsum-keywords*
          pre-///
          nil))
      (kwd-alist (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> kwd-alist
          (<a class="sym-link system" href="../../../axioms.html#def-table-alist" data-sym="TABLE-ALIST">table-alist</a> 'defflexsum-defaults
            (<a class="sym-link system" href="../../../axioms.html#def-w" data-sym="W">w</a> state))))
      (pred (getarg! <span class="keyword">:pred</span> (intern-in-package-of-symbol (cat (symbol-name name) <span class="string">"-P"</span>)
            name)
          kwd-alist))
      (<a class="sym-link system" href="../../../axioms.html#def-fix" data-sym="FIX">fix</a> (getarg! <span class="keyword">:fix</span> (intern-in-package-of-symbol (cat (symbol-name name) <span class="string">"-FIX"</span>)
            name)
          kwd-alist))
      (equiv (getarg! <span class="keyword">:equiv</span> (intern-in-package-of-symbol (cat (symbol-name name) <span class="string">"-EQUIV"</span>)
            name)
          kwd-alist))
      (kind (getarg! <span class="keyword">:kind</span> (intern-in-package-of-symbol (cat (symbol-name name) <span class="string">"-KIND"</span>)
            name)
          kwd-alist))
      (<a class="sym-link system" href="../../../axioms.html#def-case" data-sym="CASE">case</a> (getarg! <span class="keyword">:case</span> (intern-in-package-of-symbol (cat (symbol-name name) <span class="string">"-CASE"</span>)
            name)
          kwd-alist))
      (inline (get-deftypes-inline-opt *inline-defaults*
          kwd-alist))
      (shape (getarg <span class="keyword">:shape</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> kwd-alist))
      (xvar (flexsum-infer-xvar name
          kwd-alist
          xvar
          orig-prods))
      (measure (getarg! <span class="keyword">:measure</span> `(<a class="sym-link system" href="../../../axioms.html#def-acl2-count" data-sym="ACL2-COUNT">acl2-count</a> ,FTY::XVAR)
          kwd-alist))
      (<a class="sym-link system" href="../../../axioms.html#def-count" data-sym="COUNT">count</a> (flextype-get-count-fn name kwd-alist))
      (prods (parse-flexprods orig-prods
          name
          kind
          kwd-alist
          xvar
          nil
          our-fixtypes
          fixtypes))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)) (raise <span class="string">"Malformed SUM ~x0: Must have at least one product"</span>
          x))
      (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> (flexprods-check-xvar xvar prods))
      (recp (some-flexprod-recursivep prods)))
    (make-flexsum <span class="keyword">:name</span> name
      <span class="keyword">:pred</span> pred
      <span class="keyword">:fix</span> <a class="sym-link system" href="../../../axioms.html#def-fix" data-sym="FIX">fix</a>
      <span class="keyword">:case</span> <a class="sym-link system" href="../../../axioms.html#def-case" data-sym="CASE">case</a>
      <span class="keyword">:equiv</span> equiv
      <span class="keyword">:kind</span> kind
      <span class="keyword">:kind-body</span> (getarg <span class="keyword">:kind-body</span> nil kwd-alist)
      <span class="keyword">:count</span> <a class="sym-link system" href="../../../axioms.html#def-count" data-sym="COUNT">count</a>
      <span class="keyword">:prods</span> prods
      <span class="keyword">:xvar</span> xvar
      <span class="keyword">:inline</span> inline
      <span class="keyword">:shape</span> shape
      <span class="keyword">:measure</span> measure
      <span class="keyword">:kwd-alist</span> (if post-///
        (cons (cons <span class="keyword">:///-events</span> post-///) kwd-alist)
        kwd-alist)
      <span class="keyword">:orig-prods</span> orig-prods
      <span class="keyword">:recp</span> recp
      <span class="keyword">:typemacro</span> 'defflexsum)))</pre>
  </div>

<div class="form-block function" id="def-flexprod-fields-pred-bindings" data-defines="FLEXPROD-FIELDS-PRED-BINDINGS" data-references="CDR,X.ACC-BODY,X.NAME,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,LIST,CONS,X.TYPE,UNLESS,CAR,X,FLEXPROD-FIELD,ATOM,WHEN,B*,FIELDS,DEFUN" data-used-by="FLEXSUM-PRED-PROD-CASE" data-part-name="FLEXPROD-FIELDS-PRED-BINDINGS" data-part-args="FIELDS" data-part-body="CDR,FLEXPROD-FIELDS-PRED-BINDINGS,X.ACC-BODY,X.NAME,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,LIST,CONS,X.TYPE,UNLESS,CAR,X,FLEXPROD-FIELD,FIELDS,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELDS-PRED-BINDINGS">flexprod-fields-pred-bindings</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-fields-pred-bindings" data-sym="FLEXPROD-FIELDS-PRED-BINDINGS" title="(defun fty::flexprod-fields-pred-bindings (fty::fields)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields))
    ((unless fty::x.type)
...">flexprod-fields-pred-bindings</a>
  (fields)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fields)) nil) ((flexprod-field x) (car fields))
      ((unless x.type) (cons (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> (intern-in-package-of-symbol (cat <span class="string">"?"</span> (symbol-name x.name))
              x.name)
            x.acc-body)
          (<a class="sym-link local-def" href="#def-flexprod-fields-pred-bindings" data-sym="FLEXPROD-FIELDS-PRED-BINDINGS" title="(defun fty::flexprod-fields-pred-bindings (fty::fields)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields))
    ((unless fty::x.type)
...">flexprod-fields-pred-bindings</a> (cdr fields)))))
    (cons (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> x.name x.acc-body)
      (<a class="sym-link local-def" href="#def-flexprod-fields-pred-bindings" data-sym="FLEXPROD-FIELDS-PRED-BINDINGS" title="(defun fty::flexprod-fields-pred-bindings (fty::fields)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields))
    ((unless fty::x.type)
...">flexprod-fields-pred-bindings</a> (cdr fields)))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-fields-typechecks" data-defines="FLEXPROD-FIELDS-TYPECHECKS" data-references="X.NAME,LIST,NICE-AND,CDR,X.TYPE,UNLESS,CAR,X,FLEXPROD-FIELD,ATOM,WHEN,B*,LAST,FIELDS,DEFUN" data-used-by="FLEXSUM-PRED-PROD-CASE" data-part-name="FLEXPROD-FIELDS-TYPECHECKS" data-part-args="LAST,FIELDS" data-part-body="X.NAME,LIST,NICE-AND,CDR,FLEXPROD-FIELDS-TYPECHECKS,X.TYPE,UNLESS,CAR,X,FLEXPROD-FIELD,LAST,FIELDS,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELDS-TYPECHECKS">flexprod-fields-typechecks</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-fields-typechecks" data-sym="FLEXPROD-FIELDS-TYPECHECKS" title="(defun fty::flexprod-fields-typechecks (fty::fields last)
  (fty::b*
   (((when (atom fty::fields)) last)
    ((fty::flexprod-field fty::x) (car fty::fields))
    ((unless fty::x.type)
...">flexprod-fields-typechecks</a>
  (fields <a class="sym-link system" href="../../../axioms.html#def-last" data-sym="LAST">last</a>)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fields)) <a class="sym-link system" href="../../../axioms.html#def-last" data-sym="LAST">last</a>) ((flexprod-field x) (car fields))
      ((unless x.type) (<a class="sym-link local-def" href="#def-flexprod-fields-typechecks" data-sym="FLEXPROD-FIELDS-TYPECHECKS" title="(defun fty::flexprod-fields-typechecks (fty::fields last)
  (fty::b*
   (((when (atom fty::fields)) last)
    ((fty::flexprod-field fty::x) (car fty::fields))
    ((unless fty::x.type)
...">flexprod-fields-typechecks</a> (cdr fields) <a class="sym-link system" href="../../../axioms.html#def-last" data-sym="LAST">last</a>)))
    (nice-and (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> x.type x.name)
      (<a class="sym-link local-def" href="#def-flexprod-fields-typechecks" data-sym="FLEXPROD-FIELDS-TYPECHECKS" title="(defun fty::flexprod-fields-typechecks (fty::fields last)
  (fty::b*
   (((when (atom fty::fields)) last)
    ((fty::flexprod-field fty::x) (car fty::fields))
    ((unless fty::x.type)
...">flexprod-fields-typechecks</a> (cdr fields) <a class="sym-link system" href="../../../axioms.html#def-last" data-sym="LAST">last</a>))))</pre>
  </div>

<div class="form-block function" id="def-flexsum-pred-prod-case" data-defines="FLEXSUM-PRED-PROD-CASE" data-references="PROD.SHAPE,NICE-AND,QUASIQUOTE,TYPECHECKTERM,PROD.REQUIRE,FLEXPROD-FIELDS-TYPECHECKS,TYPECHECKS,PROD.FIELDS,FLEXPROD-FIELDS-PRED-BINDINGS,BINDINGS,FLEXPROD,B*,PROD,DEFUN" data-used-by="FLEXSUM-PRED-CASES-NOKIND" data-part-name="FLEXSUM-PRED-PROD-CASE" data-part-args="PROD" data-part-body="PROD.SHAPE,NICE-AND,QUASIQUOTE,TYPECHECKTERM,PROD.REQUIRE,FLEXPROD-FIELDS-TYPECHECKS,TYPECHECKS,PROD.FIELDS,FLEXPROD-FIELDS-PRED-BINDINGS,BINDINGS,PROD,FLEXPROD,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-PRED-PROD-CASE">flexsum-pred-prod-case</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-pred-prod-case" data-sym="FLEXSUM-PRED-PROD-CASE" title="(defun fty::flexsum-pred-prod-case (fty::prod)
  (fty::b*
   (((fty::flexprod fty::prod) fty::prod)
    (fty::bindings (fty::flexprod-fields-pred-bindings fty::prod.fields))
    (fty::typechecks
...">flexsum-pred-prod-case</a>
  (prod)
  (b* (((flexprod prod) prod) (bindings (<a class="sym-link local-def" href="#def-flexprod-fields-pred-bindings" data-sym="FLEXPROD-FIELDS-PRED-BINDINGS" title="(defun fty::flexprod-fields-pred-bindings (fty::fields)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields))
    ((unless fty::x.type)
...">flexprod-fields-pred-bindings</a> prod.fields))
      (typechecks (<a class="sym-link local-def" href="#def-flexprod-fields-typechecks" data-sym="FLEXPROD-FIELDS-TYPECHECKS" title="(defun fty::flexprod-fields-typechecks (fty::fields last)
  (fty::b*
   (((when (atom fty::fields)) last)
    ((fty::flexprod-field fty::x) (car fty::fields))
    ((unless fty::x.type)
...">flexprod-fields-typechecks</a> prod.fields
          prod.require))
      (typecheckterm `(b* ,FTY::BINDINGS ,FTY::TYPECHECKS)))
    (nice-and prod.shape typecheckterm)))</pre>
  </div>

<div class="form-block function" id="def-flexsum-pred-cases-nokind" data-defines="FLEXSUM-PRED-CASES-NOKIND" data-references="CDR,FLEXSUM-PRED-PROD-CASE,CAR,FLEXPROD->COND,LIST,CONS,ATOM,IF,PRODS,DEFUN" data-part-name="FLEXSUM-PRED-CASES-NOKIND" data-part-args="PRODS" data-part-body="CDR,FLEXSUM-PRED-CASES-NOKIND,FLEXSUM-PRED-PROD-CASE,CAR,FLEXPROD->COND,LIST,CONS,PRODS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-PRED-CASES-NOKIND">flexsum-pred-cases-nokind</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-pred-cases-nokind" data-sym="FLEXSUM-PRED-CASES-NOKIND" title="(defun fty::flexsum-pred-cases-nokind (fty::prods)
  (if (atom fty::prods)
      nil
      (cons
       (list (fty::flexprod-&gt;cond (car fty::prods))
...">flexsum-pred-cases-nokind</a>
  (prods)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)
    nil
    (cons (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> (flexprod-&gt;cond (car prods))
        (<a class="sym-link local-def" href="#def-flexsum-pred-prod-case" data-sym="FLEXSUM-PRED-PROD-CASE" title="(defun fty::flexsum-pred-prod-case (fty::prod)
  (fty::b*
   (((fty::flexprod fty::prod) fty::prod)
    (fty::bindings (fty::flexprod-fields-pred-bindings fty::prod.fields))
    (fty::typechecks
...">flexsum-pred-prod-case</a> (car prods)))
      (<a class="sym-link local-def" href="#def-flexsum-pred-cases-nokind" data-sym="FLEXSUM-PRED-CASES-NOKIND" title="(defun fty::flexsum-pred-cases-nokind (fty::prods)
  (if (atom fty::prods)
      nil
      (cons
       (list (fty::flexprod-&gt;cond (car fty::prods))
...">flexsum-pred-cases-nokind</a> (cdr prods)))))</pre>
  </div>

<div class="form-block function" id="def-flexsum-predicate-def" data-defines="FLEXSUM-PREDICATE-DEF" data-references="VALUE-TRIPLE,STABLE-UNDER-SIMPLIFICATIONP,AND,CONSP,IMPLIES,DEFTHM,ERROR,WITH-OUTPUT,QUOTE,MAKE-EVENT,///,T,DEFINE,QUASIQUOTE,SUM.PRED,SYMBOL-NAME,INTERN-IN-PACKAGE-OF-SYMBOL,CONSP-WHEN-FOO-P,SUM.NAME,FULL-ESCAPE-SYMBOL,CAT,SHORT,FLEXSUM,B*,SUM,DEFUN" data-part-name="FLEXSUM-PREDICATE-DEF" data-part-args="SUM" data-part-body="VALUE-TRIPLE,STABLE-UNDER-SIMPLIFICATIONP,AND,CONSP,IMPLIES,DEFTHM,ERROR,WITH-OUTPUT,QUOTE,MAKE-EVENT,///,T,DEFINE,QUASIQUOTE,SUM.PRED,SYMBOL-NAME,INTERN-IN-PACKAGE-OF-SYMBOL,CONSP-WHEN-FOO-P,SUM.NAME,FULL-ESCAPE-SYMBOL,CAT,SHORT,SUM,FLEXSUM,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-PREDICATE-DEF">flexsum-predicate-def</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-predicate-def" data-sym="FLEXSUM-PREDICATE-DEF" title="(defun fty::flexsum-predicate-def (fty::sum)
  (fty::b*
   (((fty::flexsum fty::sum) fty::sum)
    (fty::short
     (fty::cat &quot;Recognizer for @(see &quot; (xdoc::full-escape-symbol fty::sum.name)
...">flexsum-predicate-def</a>
  (sum)
  (b* (((flexsum sum) sum) (short (cat <span class="string">"Recognizer for @(see "</span>
          (full-escape-symbol sum.name)
          <span class="string">") structures."</span>))
      (consp-when-foo-p (intern-in-package-of-symbol (cat <span class="string">"CONSP-WHEN-"</span> (symbol-name sum.pred))
          sum.pred)))
    `(define ,FTY::SUM.PRED
      (,FTY::SUM.XVAR)
      <span class="keyword">:parents</span> (,FTY::SUM.NAME)
      <span class="keyword">:short</span> ,FTY::SHORT
      <span class="keyword">:measure</span> ,FTY::SUM.MEASURE
      ,@(AND (FTY::GETARG :MEASURE-DEBUG NIL FTY::SUM.KWD-ALIST) `(:MEASURE-DEBUG T))
      <span class="keyword">:progn</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
      ,(FTY::NICE-AND FTY::SUM.SHAPE
  (FTY::NICE-COND (FTY::FLEXSUM-PRED-CASES-NOKIND FTY::SUM.PRODS)))
      ///
      (<a class="sym-link system" href="../../../axioms.html#def-make-event" data-sym="MAKE-EVENT">make-event</a> '(<span class="keyword">:or</span> (<span class="keyword">:do-proofs</span> (<a class="sym-link system" href="../../../axioms.html#def-with-output" data-sym="WITH-OUTPUT">with-output</a> <span class="keyword">:off</span> (error)
              (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,FTY::CONSP-WHEN-FOO-P
                (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (,FTY::SUM.PRED ,FTY::SUM.XVAR)
                  (consp ,FTY::SUM.XVAR))
                <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:expand</span> ((,FTY::SUM.PRED ,FTY::SUM.XVAR))) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp '(<span class="keyword">:error</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)))
                <span class="keyword">:rule-classes</span> <span class="keyword">:compound-recognizer</span>)))
          (<a class="sym-link system" href="../../../axioms.html#def-value-triple" data-sym="VALUE-TRIPLE">value-triple</a> <span class="keyword">:skip-compound-recognizer</span>))))))</pre>
  </div>

<div class="form-block function" id="def-flextype-sum-kind-conds-basic" data-defines="FLEXTYPE-SUM-KIND-CONDS-BASIC" data-references="CDR,QUASIQUOTE,CONS,ATOM,IF,PRODS,DEFUN" data-used-by="FLEXTYPE-SUM-KIND-CONDS" data-part-name="FLEXTYPE-SUM-KIND-CONDS-BASIC" data-part-args="PRODS" data-part-body="CDR,FLEXTYPE-SUM-KIND-CONDS-BASIC,QUASIQUOTE,CONS,PRODS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXTYPE-SUM-KIND-CONDS-BASIC">flextype-sum-kind-conds-basic</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flextype-sum-kind-conds-basic" data-sym="FLEXTYPE-SUM-KIND-CONDS-BASIC" title="(defun fty::flextype-sum-kind-conds-basic (fty::prods)
  (if (atom fty::prods)
      nil
      (cons
       `(,(fty::flexprod-&gt;cond (car fty::prods))
...">flextype-sum-kind-conds-basic</a>
  (prods)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)
    nil
    (cons `(,(FTY::FLEXPROD-&gt;COND (CAR FTY::PRODS)) ,(FTY::FLEXPROD-&gt;KIND (CAR FTY::PRODS)))
      (<a class="sym-link local-def" href="#def-flextype-sum-kind-conds-basic" data-sym="FLEXTYPE-SUM-KIND-CONDS-BASIC" title="(defun fty::flextype-sum-kind-conds-basic (fty::prods)
  (if (atom fty::prods)
      nil
      (cons
       `(,(fty::flexprod-&gt;cond (car fty::prods))
...">flextype-sum-kind-conds-basic</a> (cdr prods)))))</pre>
  </div>

<div class="form-block function" id="def-match-optimizable-tag-check" data-defines="MATCH-OPTIMIZABLE-TAG-CHECK" data-references="&,TAG-COND,CONSP,MBT,NOT,OR,LIST,T,MV,EQUAL,EQL,EQ,MEMBER,AND,IF,FOO,VAR,TAG,QUOTE,EQSYM,CASE-MATCH,XVAR,PROD.COND,DEFUN" data-part-name="MATCH-OPTIMIZABLE-TAG-CHECK" data-part-args="XVAR,PROD.COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="MATCH-OPTIMIZABLE-TAG-CHECK">match-optimizable-tag-check</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-match-optimizable-tag-check" data-sym="MATCH-OPTIMIZABLE-TAG-CHECK" title="(defun fty::match-optimizable-tag-check (fty::prod.cond fty::xvar)
  &quot;Returns (mv matchp possible-tags)&quot;
  (fty::case-match fty::prod.cond
   ((fty::eqsym (&#39;fty::tag fty::var) (&#39;quote fty::foo))
    (if (and (member fty::eqsym &#39;(eq eql equal)) (eq fty::var fty::xvar))
...">match-optimizable-tag-check</a>
  (prod.cond xvar)
  <span class="string">"Returns (mv matchp possible-tags)"</span>
  (<a class="sym-link system" href="../../../basis-a.html#def-case-match" data-sym="CASE-MATCH">case-match</a> prod.cond
    ((eqsym ('tag var) ('quote foo)) (if (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-member" data-sym="MEMBER">member</a> eqsym '(<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> <a class="sym-link system" href="../../../axioms.html#def-eql" data-sym="EQL">eql</a> equal))
          (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> var xvar))
        (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> foo))
        (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil nil)))
    (('<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> ('<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> ('<a class="sym-link system" href="../../../axioms.html#def-mbt" data-sym="MBT">mbt</a> ('consp var))) tag-cond) (if (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> var xvar)
        (<a class="sym-link local-def" href="#def-match-optimizable-tag-check" data-sym="MATCH-OPTIMIZABLE-TAG-CHECK" title="(defun fty::match-optimizable-tag-check (fty::prod.cond fty::xvar)
  &quot;Returns (mv matchp possible-tags)&quot;
  (fty::case-match fty::prod.cond
   ((fty::eqsym (&#39;fty::tag fty::var) (&#39;quote fty::foo))
    (if (and (member fty::eqsym &#39;(eq eql equal)) (eq fty::var fty::xvar))
...">match-optimizable-tag-check</a> tag-cond xvar)
        (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil nil)))
    (&amp; (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil nil))))</pre>
  </div>

<div class="form-block other" id="form-31" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define prod-conds-can-be-optimized-p
  (prods xvar)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)) (raise <span class="string">"never get here"</span>)) ((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> (cdr prods))) (equal (flexprod-&gt;cond (car prods)) <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> matchp &amp;) (<a class="sym-link local-def" href="#def-match-optimizable-tag-check" data-sym="MATCH-OPTIMIZABLE-TAG-CHECK" title="(defun fty::match-optimizable-tag-check (fty::prod.cond fty::xvar)
  &quot;Returns (mv matchp possible-tags)&quot;
  (fty::case-match fty::prod.cond
   ((fty::eqsym (&#39;fty::tag fty::var) (&#39;quote fty::foo))
    (if (and (member fty::eqsym &#39;(eq eql equal)) (eq fty::var fty::xvar))
...">match-optimizable-tag-check</a> (flexprod-&gt;cond (car prods))
          xvar))
      ((unless matchp) nil))
    (prod-conds-can-be-optimized-p (cdr prods)
      xvar)))</pre>
  </div>

<div class="form-block other" id="form-32" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define flextype-sum-kind-conds-optimized
  (prods xvar)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)) (raise <span class="string">"should never get here"</span>)) (ans1 (flexprod-&gt;kind (car prods)))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> (cdr prods))) (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> `(otherwise ,FTY::ANS1)))
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> matchp tags1) (<a class="sym-link local-def" href="#def-match-optimizable-tag-check" data-sym="MATCH-OPTIMIZABLE-TAG-CHECK" title="(defun fty::match-optimizable-tag-check (fty::prod.cond fty::xvar)
  &quot;Returns (mv matchp possible-tags)&quot;
  (fty::case-match fty::prod.cond
   ((fty::eqsym (&#39;fty::tag fty::var) (&#39;quote fty::foo))
    (if (and (member fty::eqsym &#39;(eq eql equal)) (eq fty::var fty::xvar))
...">match-optimizable-tag-check</a> (flexprod-&gt;cond (car prods))
          xvar))
      ((unless matchp) (raise <span class="string">"expected optimizable tags."</span>)))
    (cons `(,FTY::TAGS1 ,FTY::ANS1)
      (flextype-sum-kind-conds-optimized (cdr prods)
        xvar))))</pre>
  </div>

<div class="form-block function" id="def-flextype-sum-kind-conds" data-defines="FLEXTYPE-SUM-KIND-CONDS" data-references="FLEXTYPE-SUM-KIND-CONDS-BASIC,NICE-COND,TAG,CASE,QUASIQUOTE,T,MV,PROD-CONDS-CAN-BE-OPTIMIZED-P,IF,XVAR,PRODS,DEFUN" data-used-by="FLEXTYPE-DEF-SUM-KIND" data-part-name="FLEXTYPE-SUM-KIND-CONDS" data-part-args="XVAR,PRODS" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXTYPE-SUM-KIND-CONDS">flextype-sum-kind-conds</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flextype-sum-kind-conds" data-sym="FLEXTYPE-SUM-KIND-CONDS" title="(defun fty::flextype-sum-kind-conds (fty::prods fty::xvar)
  &quot;Returns (mv optimized-p body)&quot;
  (if (fty::prod-conds-can-be-optimized-p fty::prods fty::xvar)
      (fty::mv t
       `(case (fty::tag ,fty::xvar)
...">flextype-sum-kind-conds</a>
  (prods xvar)
  <span class="string">"Returns (mv optimized-p body)"</span>
  (if (prod-conds-can-be-optimized-p prods xvar)
    (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
      `(<a class="sym-link system" href="../../../axioms.html#def-case" data-sym="CASE">case</a> (tag ,FTY::XVAR) . ,(FTY::FLEXTYPE-SUM-KIND-CONDS-OPTIMIZED FTY::PRODS FTY::XVAR)))
    (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil
      (nice-cond (<a class="sym-link local-def" href="#def-flextype-sum-kind-conds-basic" data-sym="FLEXTYPE-SUM-KIND-CONDS-BASIC" title="(defun fty::flextype-sum-kind-conds-basic (fty::prods)
  (if (atom fty::prods)
      nil
      (cons
       `(,(fty::flexprod-&gt;cond (car fty::prods))
...">flextype-sum-kind-conds-basic</a> prods)))))</pre>
  </div>

<div class="form-block function" id="def-flextype-def-sum-kind" data-defines="FLEXTYPE-DEF-SUM-KIND" data-references="TAG-REASONING,ADD-TO-RULESET,OR,DEFTHM,///,T,STABLE-UNDER-SIMPLIFICATIONP,AND,OPEN-MEMBER-EQUAL-ON-LIST-OF-TAGS,DISABLE,DEFINE,FOO-KIND-TAG-PRESERVATION-HELPER,SYMBOL-NAME,INTERN-IN-PACKAGE-OF-SYMBOL,FOO-KIND-POSSIBILITIES,SUM.NAME,FULL-ESCAPE-SYMBOL,CAT,SHORT,QUASIQUOTE,EQUAL,QUOTE,LEN,MAKE-LIST,PAIRLIS$,POSSIBILITIES,FLEXPRODS->KINDS,VALUES,SUM.XVAR,SUM.PRODS,FLEXTYPE-SUM-KIND-CONDS,CONDFORM,OPTIMIZED-P,MV,SUM.KIND,NOT,WHEN,FLEXSUM,B*,SUM,DEFUN" data-used-by="FLEXTYPE-DEF-SUM-KINDS" data-part-name="FLEXTYPE-DEF-SUM-KIND" data-part-args="SUM" data-part-body="TAG-REASONING,ADD-TO-RULESET,OR,DEFTHM,///,T,STABLE-UNDER-SIMPLIFICATIONP,AND,OPEN-MEMBER-EQUAL-ON-LIST-OF-TAGS,DISABLE,DEFINE,FOO-KIND-TAG-PRESERVATION-HELPER,SYMBOL-NAME,INTERN-IN-PACKAGE-OF-SYMBOL,FOO-KIND-POSSIBILITIES,SUM.NAME,FULL-ESCAPE-SYMBOL,CAT,SHORT,QUASIQUOTE,EQUAL,QUOTE,LEN,MAKE-LIST,PAIRLIS$,POSSIBILITIES,FLEXPRODS->KINDS,VALUES,SUM.XVAR,SUM.PRODS,FLEXTYPE-SUM-KIND-CONDS,CONDFORM,OPTIMIZED-P,MV,SUM.KIND,NOT,WHEN,SUM,FLEXSUM,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXTYPE-DEF-SUM-KIND">flextype-def-sum-kind</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flextype-def-sum-kind" data-sym="FLEXTYPE-DEF-SUM-KIND" title="(defun fty::flextype-def-sum-kind (fty::sum)
  (fty::b*
   (((fty::flexsum fty::sum) fty::sum) ((when (not fty::sum.kind)) nil)
    ((fty::mv fty::optimized-p fty::condform)
     (fty::flextype-sum-kind-conds fty::sum.prods fty::sum.xvar))
...">flextype-def-sum-kind</a>
  (sum)
  (b* (((flexsum sum) sum) ((when (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> sum.kind)) nil)
      ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> optimized-p condform) (<a class="sym-link local-def" href="#def-flextype-sum-kind-conds" data-sym="FLEXTYPE-SUM-KIND-CONDS" title="(defun fty::flextype-sum-kind-conds (fty::prods fty::xvar)
  &quot;Returns (mv optimized-p body)&quot;
  (if (fty::prod-conds-can-be-optimized-p fty::prods fty::xvar)
      (fty::mv t
       `(case (fty::tag ,fty::xvar)
...">flextype-sum-kind-conds</a> sum.prods sum.xvar))
      (values (flexprods-&gt;kinds sum.prods))
      (possibilities (<a class="sym-link system" href="../../../axioms.html#def-pairlis_24" data-sym="PAIRLIS$">pairlis$</a> (<a class="sym-link system" href="../../../axioms.html#def-make-list" data-sym="MAKE-LIST">make-list</a> (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> values) <span class="keyword">:initial-element</span> 'equal)
          (<a class="sym-link system" href="../../../axioms.html#def-pairlis_24" data-sym="PAIRLIS$">pairlis$</a> (<a class="sym-link system" href="../../../axioms.html#def-make-list" data-sym="MAKE-LIST">make-list</a> (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> values)
              <span class="keyword">:initial-element</span> `(,FTY::SUM.KIND ,FTY::SUM.XVAR))
            (<a class="sym-link system" href="../../../axioms.html#def-pairlis_24" data-sym="PAIRLIS$">pairlis$</a> values nil))))
      (short (cat <span class="string">"Get the &lt;i&gt;kind&lt;/i&gt; (tag) of a @(see "</span>
          (full-escape-symbol sum.name)
          <span class="string">") structure."</span>))
      (foo-kind-possibilities (intern-in-package-of-symbol (cat (symbol-name sum.kind) <span class="string">"-POSSIBILITIES"</span>)
          sum.kind))
      (foo-kind-tag-preservation-helper (intern-in-package-of-symbol (cat (symbol-name sum.kind)
            <span class="string">"-TAG-PRESERVATION-HELPER"</span>)
          sum.kind)))
    `((define ,FTY::SUM.KIND
       ((,FTY::SUM.XVAR ,FTY::SUM.PRED))
       <span class="keyword">:parents</span> (,FTY::SUM.NAME)
       <span class="keyword">:short</span> ,FTY::SHORT
       <span class="keyword">:returns</span> ,(FTY::INTERN-IN-PACKAGE-OF-SYMBOL &quot;KIND&quot; FTY::SUM.NAME)
       ,@(AND (MEMBER :KIND FTY::SUM.INLINE) `(:INLINE T))
       <span class="keyword">:guard-hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (disable open-member-equal-on-list-of-tags)) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp
           '(<span class="keyword">:expand</span> ((,FTY::SUM.PRED ,FTY::SUM.XVAR)))))
       <span class="keyword">:progn</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
       ,(IF FTY::SUM.KIND-BODY
     `(FTY::MBE :LOGIC ,FTY::CONDFORM :EXEC ,FTY::SUM.KIND-BODY)
     FTY::CONDFORM)
       ///
       (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,FTY::FOO-KIND-POSSIBILITIES
         (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> . ,FTY::POSSIBILITIES)
         <span class="keyword">:rule-classes</span> ((<span class="keyword">:forward-chaining</span> <span class="keyword">:trigger-terms</span> ((,FTY::SUM.KIND ,FTY::SUM.XVAR)))))
       (add-to-ruleset tag-reasoning
         '(,FTY::FOO-KIND-POSSIBILITIES))
       ,@(AND FTY::OPTIMIZED-P
       `((FTY::LOCAL
          (FTY::DEFTHMD ,FTY::FOO-KIND-TAG-PRESERVATION-HELPER
           (FTY::IMPLIES (FTY::MEMBER-EQUAL (FTY::TAG FTY::X) &#39;,VALUES)
            (EQUAL (,FTY::SUM.KIND FTY::X) (FTY::TAG FTY::X)))
           :HINTS ((&quot;Goal&quot; :IN-THEORY (FTY::ENABLE FTY::CONSP-WHEN-TAG)))))))))))</pre>
  </div>

<div class="form-block function" id="def-find-prod-by-kind" data-defines="FIND-PROD-BY-KIND" data-references="CDR,PROD.KIND,EQ,CAR,PROD,FLEXPROD,ATOM,WHEN,B*,PRODS,KIND,DEFUN" data-part-name="FIND-PROD-BY-KIND" data-part-args="PRODS,KIND" data-part-body="CDR,FIND-PROD-BY-KIND,KIND,PROD.KIND,EQ,CAR,PROD,FLEXPROD,PRODS,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FIND-PROD-BY-KIND">find-prod-by-kind</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-find-prod-by-kind" data-sym="FIND-PROD-BY-KIND" title="(defun fty::find-prod-by-kind (fty::kind fty::prods)
  (fty::b*
   (((when (atom fty::prods)) nil) ((fty::flexprod fty::prod) (car fty::prods))
    ((when (eq fty::prod.kind fty::kind)) fty::prod))
   (fty::find-prod-by-kind fty::kind (cdr fty::prods))))">find-prod-by-kind</a>
  (kind prods)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)) nil) ((flexprod prod) (car prods))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> prod.kind kind)) prod))
    (<a class="sym-link local-def" href="#def-find-prod-by-kind" data-sym="FIND-PROD-BY-KIND" title="(defun fty::find-prod-by-kind (fty::kind fty::prods)
  (fty::b*
   (((when (atom fty::prods)) nil) ((fty::flexprod fty::prod) (car fty::prods))
    ((when (eq fty::prod.kind fty::kind)) fty::prod))
   (fty::find-prod-by-kind fty::kind (cdr fty::prods))))">find-prod-by-kind</a> kind (cdr prods))))</pre>
  </div>

<div class="form-block other" id="form-36" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define flexsum-kind-case-macro-spec-prods
  (prods)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)
    nil
    (b* (((flexprod prod) (car prods)))
      (cons (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> prod.kind prod.ctor-name)
        (flexsum-kind-case-macro-spec-prods (cdr prods))))))</pre>
  </div>

<div class="form-block other" id="form-37" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define flexsum-kind-case-macro-spec
  (sum)
  (b* (((flexsum sum)) (prods (flexsum-kind-case-macro-spec-prods sum.prods)))
    (<a class="sym-link system" href="../../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> sum.case sum.kind prods)))</pre>
  </div>

<div class="form-block other" id="form-38" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define flexsum-cond-case-macro-spec-prods
  (prods)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)
    nil
    (b* (((flexprod prod) (car prods)))
      (cons (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> prod.kind prod.cond prod.ctor-name)
        (flexsum-cond-case-macro-spec-prods (cdr prods))))))</pre>
  </div>

<div class="form-block other" id="form-39" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(define flexsum-cond-case-macro-spec
  (sum)
  (b* (((flexsum sum)) (prods (flexsum-cond-case-macro-spec-prods sum.prods)))
    (<a class="sym-link system" href="../../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> sum.case sum.xvar prods)))</pre>
  </div>

<div class="form-block function" id="def-flexsum-def-case-macro" data-defines="FLEXSUM-DEF-CASE-MACRO" data-references="ARGS,&REST,VAR-OR-EXPR,DEFMACRO,QUASIQUOTE,SYMBOL-NAME,STRING,QUOTE,CONCATENATE,INTERN-IN-PACKAGE-OF-SYMBOL,AND,KIND-EQ,FLEXSUM-COND-CASE-MACRO-SPEC,FLEXSUM-KIND-CASE-MACRO-SPEC,SUM.KIND,IF,CASE-SPEC,SUM.CASE,UNLESS,FLEXSUM,B*,SUM,DEFUN" data-used-by="FLEXTYPE-DEF-SUM-KINDS" data-part-name="FLEXSUM-DEF-CASE-MACRO" data-part-args="SUM" data-part-body="ARGS,&REST,VAR-OR-EXPR,DEFMACRO,QUASIQUOTE,SYMBOL-NAME,STRING,QUOTE,CONCATENATE,INTERN-IN-PACKAGE-OF-SYMBOL,AND,KIND-EQ,FLEXSUM-COND-CASE-MACRO-SPEC,FLEXSUM-KIND-CASE-MACRO-SPEC,SUM.KIND,IF,CASE-SPEC,SUM.CASE,UNLESS,SUM,FLEXSUM,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-DEF-CASE-MACRO">flexsum-def-case-macro</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-def-case-macro" data-sym="FLEXSUM-DEF-CASE-MACRO" title="(defun fty::flexsum-def-case-macro (fty::sum)
  (fty::b*
   (((fty::flexsum fty::sum) fty::sum) ((unless fty::sum.case) nil)
    (fty::case-spec
     (if fty::sum.kind
...">flexsum-def-case-macro</a>
  (sum)
  (b* (((flexsum sum) sum) ((unless sum.case) nil)
      (case-spec (if sum.kind
          (flexsum-kind-case-macro-spec sum)
          (flexsum-cond-case-macro-spec sum)))
      (kind-eq (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> sum.kind
          (intern-in-package-of-symbol (<a class="sym-link system" href="../../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../../axioms.html#def-string" data-sym="STRING">string</a> (symbol-name sum.kind) <span class="string">"-EQ"</span>)
            sum.kind))))
    `((<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> ,FTY::SUM.CASE
       (var-or-expr &amp;rest <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)
       ,(IF FTY::SUM.KIND
     `(FTY::KIND-CASEMACRO-FN FTY::VAR-OR-EXPR FTY::ARGS &#39;,FTY::CASE-SPEC)
     `(FTY::COND-CASEMACRO-FN FTY::VAR-OR-EXPR FTY::ARGS &#39;,FTY::CASE-SPEC))) ,@(AND FTY::SUM.KIND
       `((DEFMACRO ,FTY::KIND-EQ (FTY::KIND KEYWORD)
           (DECLARE
            (FTY::XARGS :GUARD
             (FTY::MEMBER-EQ KEYWORD
              (QUOTE ,(FTY::FLEXPRODS-&gt;KINDS FTY::SUM.PRODS)))))
           `(EQ ,FTY::KIND ,KEYWORD)))))))</pre>
  </div>

<div class="form-block function" id="def-flextype-def-sum-kinds" data-defines="FLEXTYPE-DEF-SUM-KINDS" data-references="CDR,FLEXSUM-DEF-CASE-MACRO,FLEXTYPE-DEF-SUM-KIND,CAR,TAG,EQ,AND,APPEND,ATOM,IF,SUMS,DEFUN" data-part-name="FLEXTYPE-DEF-SUM-KINDS" data-part-args="SUMS" data-part-body="CDR,FLEXTYPE-DEF-SUM-KINDS,FLEXSUM-DEF-CASE-MACRO,FLEXTYPE-DEF-SUM-KIND,CAR,TAG,EQ,AND,APPEND,SUMS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXTYPE-DEF-SUM-KINDS">flextype-def-sum-kinds</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flextype-def-sum-kinds" data-sym="FLEXTYPE-DEF-SUM-KINDS" title="(defun fty::flextype-def-sum-kinds (fty::sums)
  (if (atom fty::sums)
      nil
      (append
       (and (eq (fty::tag (car fty::sums)) :sum)
...">flextype-def-sum-kinds</a>
  (sums)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> sums)
    nil
    (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (tag (car sums)) <span class="keyword">:sum</span>)
        (<a class="sym-link local-def" href="#def-flextype-def-sum-kind" data-sym="FLEXTYPE-DEF-SUM-KIND" title="(defun fty::flextype-def-sum-kind (fty::sum)
  (fty::b*
   (((fty::flexsum fty::sum) fty::sum) ((when (not fty::sum.kind)) nil)
    ((fty::mv fty::optimized-p fty::condform)
     (fty::flextype-sum-kind-conds fty::sum.prods fty::sum.xvar))
...">flextype-def-sum-kind</a> (car sums)))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (tag (car sums)) <span class="keyword">:sum</span>)
        (<a class="sym-link local-def" href="#def-flexsum-def-case-macro" data-sym="FLEXSUM-DEF-CASE-MACRO" title="(defun fty::flexsum-def-case-macro (fty::sum)
  (fty::b*
   (((fty::flexsum fty::sum) fty::sum) ((unless fty::sum.case) nil)
    (fty::case-spec
     (if fty::sum.kind
...">flexsum-def-case-macro</a> (car sums)))
      (<a class="sym-link local-def" href="#def-flextype-def-sum-kinds" data-sym="FLEXTYPE-DEF-SUM-KINDS" title="(defun fty::flextype-def-sum-kinds (fty::sums)
  (if (atom fty::sums)
      nil
      (append
       (and (eq (fty::tag (car fty::sums)) :sum)
...">flextype-def-sum-kinds</a> (cdr sums)))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-fields-typefix-bindings" data-defines="FLEXPROD-FIELDS-TYPEFIX-BINDINGS" data-references="CDR,QUASIQUOTE,CONS,X.NAME,MEMBER-EQ,EQ,OR,IF,CAR,X,FLEXPROD-FIELD,ATOM,WHEN,B*,NAMES,FIELDS,DEFUN" data-used-by="FLEXSUM-FIX-PROD-CASE" data-part-name="FLEXPROD-FIELDS-TYPEFIX-BINDINGS" data-part-args="NAMES,FIELDS" data-part-body="CDR,FLEXPROD-FIELDS-TYPEFIX-BINDINGS,QUASIQUOTE,CONS,X.NAME,MEMBER-EQ,NAMES,EQ,OR,IF,CAR,X,FLEXPROD-FIELD,FIELDS,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELDS-TYPEFIX-BINDINGS">flexprod-fields-typefix-bindings</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-fields-typefix-bindings" data-sym="FLEXPROD-FIELDS-TYPEFIX-BINDINGS" title="(defun fty::flexprod-fields-typefix-bindings (fty::fields fty::names)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields)))
   (if (or (eq fty::names :all) (fty::member-eq fty::x.name fty::names))
...">flexprod-fields-typefix-bindings</a>
  (fields names)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fields)) nil) ((flexprod-field x) (car fields)))
    (if (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> names <span class="keyword">:all</span>)
        (<a class="sym-link system" href="../../../axioms.html#def-member-eq" data-sym="MEMBER-EQ">member-eq</a> x.name names))
      (cons `(,FTY::X.NAME ,(IF FTY::X.FIX
     `(,FTY::X.FIX ,FTY::X.ACC-BODY)
     FTY::X.ACC-BODY))
        (<a class="sym-link local-def" href="#def-flexprod-fields-typefix-bindings" data-sym="FLEXPROD-FIELDS-TYPEFIX-BINDINGS" title="(defun fty::flexprod-fields-typefix-bindings (fty::fields fty::names)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields)))
   (if (or (eq fty::names :all) (fty::member-eq fty::x.name fty::names))
...">flexprod-fields-typefix-bindings</a> (cdr fields)
          names))
      (<a class="sym-link local-def" href="#def-flexprod-fields-typefix-bindings" data-sym="FLEXPROD-FIELDS-TYPEFIX-BINDINGS" title="(defun fty::flexprod-fields-typefix-bindings (fty::fields fty::names)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields)))
   (if (or (eq fty::names :all) (fty::member-eq fty::x.name fty::names))
...">flexprod-fields-typefix-bindings</a> (cdr fields)
        names))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-fields-reqfix-bindings" data-defines="FLEXPROD-FIELDS-REQFIX-BINDINGS" data-references="LIST,CONS,CDR,X.REQFIX,X.NAME,EQ,IF,CAR,X,FLEXPROD-FIELD,ATOM,WHEN,B*,FIELDS,DEFUN" data-used-by="FLEXSUM-FIX-PROD-CASE" data-part-name="FLEXPROD-FIELDS-REQFIX-BINDINGS" data-part-args="FIELDS" data-part-body="LIST,CONS,CDR,FLEXPROD-FIELDS-REQFIX-BINDINGS,X.REQFIX,X.NAME,EQ,IF,CAR,X,FLEXPROD-FIELD,FIELDS,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELDS-REQFIX-BINDINGS">flexprod-fields-reqfix-bindings</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-fields-reqfix-bindings" data-sym="FLEXPROD-FIELDS-REQFIX-BINDINGS" title="(defun fty::flexprod-fields-reqfix-bindings (fty::fields)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields)))
   (if (eq fty::x.name fty::x.reqfix)
...">flexprod-fields-reqfix-bindings</a>
  (fields)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fields)) nil) ((flexprod-field x) (car fields)))
    (if (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x.name x.reqfix)
      (<a class="sym-link local-def" href="#def-flexprod-fields-reqfix-bindings" data-sym="FLEXPROD-FIELDS-REQFIX-BINDINGS" title="(defun fty::flexprod-fields-reqfix-bindings (fty::fields)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields)))
   (if (eq fty::x.name fty::x.reqfix)
...">flexprod-fields-reqfix-bindings</a> (cdr fields))
      (cons (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> x.name x.reqfix)
        (<a class="sym-link local-def" href="#def-flexprod-fields-reqfix-bindings" data-sym="FLEXPROD-FIELDS-REQFIX-BINDINGS" title="(defun fty::flexprod-fields-reqfix-bindings (fty::fields)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields)))
   (if (eq fty::x.name fty::x.reqfix)
...">flexprod-fields-reqfix-bindings</a> (cdr fields))))))</pre>
  </div>

<div class="form-block function" id="def-flexsum-fix-prod-case" data-defines="FLEXSUM-FIX-PROD-CASE" data-references="PROD.CTOR-BODY,QUASIQUOTE,IF,FLEXPROD-FIELDS-REQFIX-BINDINGS,REQFIX-BINDINGS,PROD.FIELDS,FLEXPROD-FIELDS-TYPEFIX-BINDINGS,TYPEFIX-BINDINGS,FLEXPROD,B*,PROD,DEFUN" data-used-by="FLEXSUM-FIX-CASES-NOKIND,FLEXSUM-FIX-CASES" data-part-name="FLEXSUM-FIX-PROD-CASE" data-part-args="PROD" data-part-body="PROD.CTOR-BODY,QUASIQUOTE,IF,FLEXPROD-FIELDS-REQFIX-BINDINGS,REQFIX-BINDINGS,PROD.FIELDS,FLEXPROD-FIELDS-TYPEFIX-BINDINGS,TYPEFIX-BINDINGS,PROD,FLEXPROD,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-FIX-PROD-CASE">flexsum-fix-prod-case</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-fix-prod-case" data-sym="FLEXSUM-FIX-PROD-CASE" title="(defun fty::flexsum-fix-prod-case (fty::prod)
  (fty::b*
   (((fty::flexprod fty::prod) fty::prod)
    (fty::typefix-bindings
     (fty::flexprod-fields-typefix-bindings fty::prod.fields :all))
...">flexsum-fix-prod-case</a>
  (prod)
  (b* (((flexprod prod) prod) (typefix-bindings (<a class="sym-link local-def" href="#def-flexprod-fields-typefix-bindings" data-sym="FLEXPROD-FIELDS-TYPEFIX-BINDINGS" title="(defun fty::flexprod-fields-typefix-bindings (fty::fields fty::names)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields)))
   (if (or (eq fty::names :all) (fty::member-eq fty::x.name fty::names))
...">flexprod-fields-typefix-bindings</a> prod.fields
          <span class="keyword">:all</span>))
      (reqfix-bindings (<a class="sym-link local-def" href="#def-flexprod-fields-reqfix-bindings" data-sym="FLEXPROD-FIELDS-REQFIX-BINDINGS" title="(defun fty::flexprod-fields-reqfix-bindings (fty::fields)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields)))
   (if (eq fty::x.name fty::x.reqfix)
...">flexprod-fields-reqfix-bindings</a> prod.fields)))
    (if typefix-bindings
      `(b* ,FTY::TYPEFIX-BINDINGS
        ,(IF FTY::REQFIX-BINDINGS
     `(LET ,FTY::REQFIX-BINDINGS
        ,FTY::PROD.CTOR-BODY)
     FTY::PROD.CTOR-BODY))
      prod.ctor-body)))</pre>
  </div>

<div class="form-block function" id="def-flexsum-fix-cases" data-defines="FLEXSUM-FIX-CASES" data-references="CDR,FLEXSUM-FIX-PROD-CASE,CAR,FLEXPROD->KIND,LIST,CONS,ATOM,IF,PRODS,DEFUN" data-part-name="FLEXSUM-FIX-CASES" data-part-args="PRODS" data-part-body="CDR,FLEXSUM-FIX-CASES,FLEXSUM-FIX-PROD-CASE,CAR,FLEXPROD->KIND,LIST,CONS,PRODS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-FIX-CASES">flexsum-fix-cases</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-fix-cases" data-sym="FLEXSUM-FIX-CASES" title="(defun fty::flexsum-fix-cases (fty::prods)
  (if (atom fty::prods)
      nil
      (cons
       (list (fty::flexprod-&gt;kind (car fty::prods))
...">flexsum-fix-cases</a>
  (prods)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)
    nil
    (cons (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> (flexprod-&gt;kind (car prods))
        (<a class="sym-link local-def" href="#def-flexsum-fix-prod-case" data-sym="FLEXSUM-FIX-PROD-CASE" title="(defun fty::flexsum-fix-prod-case (fty::prod)
  (fty::b*
   (((fty::flexprod fty::prod) fty::prod)
    (fty::typefix-bindings
     (fty::flexprod-fields-typefix-bindings fty::prod.fields :all))
...">flexsum-fix-prod-case</a> (car prods)))
      (<a class="sym-link local-def" href="#def-flexsum-fix-cases" data-sym="FLEXSUM-FIX-CASES" title="(defun fty::flexsum-fix-cases (fty::prods)
  (if (atom fty::prods)
      nil
      (cons
       (list (fty::flexprod-&gt;kind (car fty::prods))
...">flexsum-fix-cases</a> (cdr prods)))))</pre>
  </div>

<div class="form-block function" id="def-flexsum-fix-cases-nokind" data-defines="FLEXSUM-FIX-CASES-NOKIND" data-references="CDR,FLEXSUM-FIX-PROD-CASE,CAR,FLEXPROD->COND,LIST,CONS,ATOM,IF,PRODS,DEFUN" data-used-by="FLEXSUM-FIX-DEF" data-part-name="FLEXSUM-FIX-CASES-NOKIND" data-part-args="PRODS" data-part-body="CDR,FLEXSUM-FIX-CASES-NOKIND,FLEXSUM-FIX-PROD-CASE,CAR,FLEXPROD->COND,LIST,CONS,PRODS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-FIX-CASES-NOKIND">flexsum-fix-cases-nokind</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-fix-cases-nokind" data-sym="FLEXSUM-FIX-CASES-NOKIND" title="(defun fty::flexsum-fix-cases-nokind (fty::prods)
  (if (atom fty::prods)
      nil
      (cons
       (list (fty::flexprod-&gt;cond (car fty::prods))
...">flexsum-fix-cases-nokind</a>
  (prods)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)
    nil
    (cons (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> (flexprod-&gt;cond (car prods))
        (<a class="sym-link local-def" href="#def-flexsum-fix-prod-case" data-sym="FLEXSUM-FIX-PROD-CASE" title="(defun fty::flexsum-fix-prod-case (fty::prod)
  (fty::b*
   (((fty::flexprod fty::prod) fty::prod)
    (fty::typefix-bindings
     (fty::flexprod-fields-typefix-bindings fty::prod.fields :all))
...">flexsum-fix-prod-case</a> (car prods)))
      (<a class="sym-link local-def" href="#def-flexsum-fix-cases-nokind" data-sym="FLEXSUM-FIX-CASES-NOKIND" title="(defun fty::flexsum-fix-cases-nokind (fty::prods)
  (if (atom fty::prods)
      nil
      (cons
       (list (fty::flexprod-&gt;cond (car fty::prods))
...">flexsum-fix-cases-nokind</a> (cdr prods)))))</pre>
  </div>

<div class="form-block function" id="def-flexsum-fix-def" data-defines="FLEXSUM-FIX-DEF" data-references="///,MBE,EQ,CLAUSE,LAST,CAR,LIT,LET,STABLE-UNDER-SIMPLIFICATIONP,AND,DISABLE,QUOTE,T,DEFINE,INTERN-IN-PACKAGE-OF-SYMBOL,NEWX,SUM.NAME,FULL-ESCAPE-SYMBOL,CAT,SHORT,SUM.PRODS,FLEXSUM-FIX-CASES-NOKIND,NICE-COND,CASE,QUASIQUOTE,SUM.KIND,IF,BODY,FLEXSUM,B*,FLAGP,SUM,DEFUN" data-part-name="FLEXSUM-FIX-DEF" data-part-args="FLAGP,SUM" data-part-body="///,MBE,EQ,CLAUSE,LAST,CAR,LIT,LET,STABLE-UNDER-SIMPLIFICATIONP,AND,DISABLE,QUOTE,T,DEFINE,INTERN-IN-PACKAGE-OF-SYMBOL,NEWX,SUM.NAME,FULL-ESCAPE-SYMBOL,CAT,SHORT,SUM.PRODS,FLEXSUM-FIX-CASES-NOKIND,NICE-COND,CASE,QUASIQUOTE,SUM.KIND,IF,BODY,SUM,FLEXSUM,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-FIX-DEF">flexsum-fix-def</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-fix-def" data-sym="FLEXSUM-FIX-DEF" title="(defun fty::flexsum-fix-def (fty::sum fty::flagp)
  (fty::b*
   (((fty::flexsum fty::sum) fty::sum)
    (fty::body
     (if fty::sum.kind
...">flexsum-fix-def</a>
  (sum flagp)
  (b* (((flexsum sum) sum) (<a class="sym-link system" href="../../../basis-b.html#def-body" data-sym="BODY">body</a> (if sum.kind
          `(<a class="sym-link system" href="../../../axioms.html#def-case" data-sym="CASE">case</a> (,FTY::SUM.KIND ,FTY::SUM.XVAR) . ,(FTY::FLEXSUM-FIX-CASES FTY::SUM.PRODS))
          (nice-cond (<a class="sym-link local-def" href="#def-flexsum-fix-cases-nokind" data-sym="FLEXSUM-FIX-CASES-NOKIND" title="(defun fty::flexsum-fix-cases-nokind (fty::prods)
  (if (atom fty::prods)
      nil
      (cons
       (list (fty::flexprod-&gt;cond (car fty::prods))
...">flexsum-fix-cases-nokind</a> sum.prods))))
      (short (cat <span class="string">"Fixing function for @(see "</span>
          (full-escape-symbol sum.name)
          <span class="string">") structures."</span>))
      (newx (intern-in-package-of-symbol <span class="string">"NEW-X"</span> sum.name)))
    `(define ,FTY::SUM.FIX
      ((,FTY::SUM.XVAR ,FTY::SUM.PRED))
      <span class="keyword">:parents</span> (,FTY::SUM.NAME)
      <span class="keyword">:short</span> ,FTY::SHORT
      <span class="keyword">:inline</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
      <span class="keyword">:measure</span> ,FTY::SUM.MEASURE
      <span class="keyword">:hints</span> ,(AND FTY::SUM.KIND `((&quot;Goal&quot; :EXPAND ((,FTY::SUM.KIND ,FTY::SUM.XVAR)))))
      ,@(AND (FTY::GETARG :MEASURE-DEBUG NIL FTY::SUM.KWD-ALIST) `(:MEASURE-DEBUG T))
      ,@(AND FTY::FLAGP `(:FLAG ,FTY::SUM.NAME))
      <span class="keyword">:returns</span> (,FTY::NEWX ,FTY::SUM.PRED
        <span class="keyword">:hints</span> ('(<span class="keyword">:in-theory</span> (disable ,FTY::SUM.FIX
             ,FTY::SUM.PRED . ,(AND FTY::SUM.KIND `(,FTY::SUM.KIND)))
           <span class="keyword">:expand</span> ((,FTY::SUM.FIX ,FTY::SUM.XVAR))) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp
            (let ((lit (car (<a class="sym-link system" href="../../../axioms.html#def-last" data-sym="LAST">last</a> clause))))
              (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (car lit) ',FTY::SUM.PRED)
                `(<span class="keyword">:expand</span> (,FTY::LIT)))))))
      <span class="keyword">:progn</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
      <span class="keyword">:verify-guards</span> nil
      (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> ,FTY::BODY <span class="keyword">:exec</span> ,FTY::SUM.XVAR)
      ///
      ,@(AND FTY::SUM.DISABLE-TYPE-PRESCRIPTION
       `((FTY::IN-THEORY (FTY::DISABLE (:T ,FTY::SUM.FIX))))))))</pre>
  </div>

<div class="form-block function" id="def-flexsum-fix-postevents" data-defines="FLEXSUM-FIX-POSTEVENTS" data-references="CONSP,DEFTHM,VALUE-TRIPLE,STATE,W,THEOREM,FGETPROP,UNLESS,CONSP-OF-FIX,SUM.FIX,SUM.XVAR,CONSP-WHEN-FOO-P,MAKE-EVENT,DISABLE-IF-THEOREM,ENABLE,QUOTE,STABLE-UNDER-SIMPLIFICATIONP,TAG-REASONING,MEMBER-EQUAL,E/D*,DEFFIXEQUIV,DISABLE,IN-THEORY,ENABLE-IF-THEOREM,LOCAL,QUASIQUOTE,AND,FOO-KIND-TAG-PRESERVATION-HELPER,X.KIND,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,FOO-KIND-POSSIBILITIES,FLEXSUM,B*,X,DEFUN" data-part-name="FLEXSUM-FIX-POSTEVENTS" data-part-args="X" data-part-body="CONSP,DEFTHM,VALUE-TRIPLE,STATE,W,THEOREM,FGETPROP,UNLESS,CONSP-OF-FIX,SUM.FIX,SUM.XVAR,CONSP-WHEN-FOO-P,MAKE-EVENT,DISABLE-IF-THEOREM,ENABLE,QUOTE,STABLE-UNDER-SIMPLIFICATIONP,TAG-REASONING,MEMBER-EQUAL,E/D*,DEFFIXEQUIV,DISABLE,IN-THEORY,ENABLE-IF-THEOREM,LOCAL,QUASIQUOTE,AND,FOO-KIND-TAG-PRESERVATION-HELPER,X.KIND,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,FOO-KIND-POSSIBILITIES,X,FLEXSUM,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-FIX-POSTEVENTS">flexsum-fix-postevents</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-fix-postevents" data-sym="FLEXSUM-FIX-POSTEVENTS" title="(defun fty::flexsum-fix-postevents (fty::x)
  (fty::b*
   (((fty::flexsum fty::x) fty::x)
    (fty::foo-kind-possibilities
     (fty::intern-in-package-of-symbol
...">flexsum-fix-postevents</a>
  (x)
  (b* (((flexsum x) x) (foo-kind-possibilities (intern-in-package-of-symbol (cat (symbol-name x.kind) <span class="string">"-POSSIBILITIES"</span>)
          x.kind))
      (foo-kind-tag-preservation-helper (intern-in-package-of-symbol (cat (symbol-name x.kind)
            <span class="string">"-TAG-PRESERVATION-HELPER"</span>)
          x.kind)))
    (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> x.kind
      `((<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (enable-if-theorem ,FTY::FOO-KIND-TAG-PRESERVATION-HELPER)) (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (disable ,FTY::FOO-KIND-POSSIBILITIES)))
        (deffixequiv ,FTY::X.KIND
          <span class="keyword">:args</span> ((,FTY::X.XVAR ,FTY::X.PRED))
          <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (e/d* ((<span class="keyword">:e</span> <a class="sym-link system" href="../../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a>) tag-reasoning)
               ((<span class="keyword">:rules-of-class</span> <span class="keyword">:type-prescription</span> <span class="keyword">:here</span>)))
             <span class="keyword">:expand</span> ((,FTY::X.FIX ,FTY::X.XVAR) (,FTY::X.KIND ,FTY::X.XVAR))) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp
              '(<span class="keyword">:in-theory</span> (enable ,FTY::X.KIND)
                <span class="keyword">:expand</span> ((,FTY::X.FIX ,FTY::X.XVAR))))))
        (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (disable-if-theorem ,FTY::FOO-KIND-TAG-PRESERVATION-HELPER))
        (<a class="sym-link system" href="../../../axioms.html#def-make-event" data-sym="MAKE-EVENT">make-event</a> (b* ((consp-when-foo-p ',(FTY::INTERN-IN-PACKAGE-OF-SYMBOL
  (FTY::CAT &quot;CONSP-WHEN-&quot; (SYMBOL-NAME FTY::X.PRED)) FTY::X.PRED)) (sum.xvar ',FTY::X.XVAR)
              (sum.fix ',FTY::X.FIX)
              (consp-of-fix ',(FTY::INTERN-IN-PACKAGE-OF-SYMBOL
  (FTY::CAT &quot;CONSP-OF-&quot; (SYMBOL-NAME FTY::X.FIX)) FTY::X.FIX))
              ((unless (<a class="sym-link system" href="../../../axioms.html#def-fgetprop" data-sym="FGETPROP">fgetprop</a> consp-when-foo-p
                   'theorem
                   nil
                   (<a class="sym-link system" href="../../../axioms.html#def-w" data-sym="W">w</a> state))) '(<a class="sym-link system" href="../../../axioms.html#def-value-triple" data-sym="VALUE-TRIPLE">value-triple</a> <span class="keyword">:skip-type-prescription</span>)))
            `(<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,FTY::CONSP-OF-FIX
              (consp (,FTY::SUM.FIX ,FTY::SUM.XVAR))
              <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:use</span> ((<span class="keyword">:instance</span> ,FTY::CONSP-WHEN-FOO-P
                    (,FTY::SUM.XVAR (,FTY::SUM.FIX ,FTY::SUM.XVAR))))
                 <span class="keyword">:in-theory</span> (disable ,FTY::CONSP-WHEN-FOO-P)))
              <span class="keyword">:rule-classes</span> <span class="keyword">:type-prescription</span>)))))))</pre>
  </div>

<div class="form-block function" id="def-flexsum-fix-when-pred-thm" data-defines="FLEXSUM-FIX-WHEN-PRED-THM" data-references="DISABLE,QUOTE,EQUAL,IMPLIES,DEFTHM,QUASIQUOTE,X.PRED,X.FIX,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,FOO-FIX-WHEN-FOO-P,FLEXSUM,B*,FLAGP,X,DEFUN" data-part-name="FLEXSUM-FIX-WHEN-PRED-THM" data-part-args="FLAGP,X" data-part-body="DISABLE,QUOTE,EQUAL,IMPLIES,DEFTHM,QUASIQUOTE,X.PRED,X.FIX,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,FOO-FIX-WHEN-FOO-P,X,FLEXSUM,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-FIX-WHEN-PRED-THM">flexsum-fix-when-pred-thm</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-fix-when-pred-thm" data-sym="FLEXSUM-FIX-WHEN-PRED-THM" title="(defun fty::flexsum-fix-when-pred-thm (fty::x fty::flagp)
  (fty::b*
   (((fty::flexsum fty::x) fty::x)
    (fty::foo-fix-when-foo-p
     (fty::intern-in-package-of-symbol
...">flexsum-fix-when-pred-thm</a>
  (x flagp)
  (b* (((flexsum x) x) (foo-fix-when-foo-p (intern-in-package-of-symbol (cat (symbol-name x.fix)
            <span class="string">"-WHEN-"</span>
            (symbol-name x.pred))
          x.fix)))
    `(<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,FTY::FOO-FIX-WHEN-FOO-P
      (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (,FTY::X.PRED ,FTY::X.XVAR)
        (equal (,FTY::X.FIX ,FTY::X.XVAR) ,FTY::X.XVAR))
      <span class="keyword">:hints</span> ('(<span class="keyword">:expand</span> ((,FTY::X.PRED ,FTY::X.XVAR) (,FTY::X.FIX ,FTY::X.XVAR)
           ,@(AND FTY::X.KIND `((,FTY::X.KIND ,FTY::X.XVAR))))
         <span class="keyword">:in-theory</span> (disable ,FTY::X.PRED ,FTY::X.FIX))) . ,(AND FTY::FLAGP `(:FLAG ,FTY::X.NAME)))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-field-acc" data-defines="FLEXPROD-FIELD-ACC" data-references="ENABLE,IN-THEORY,LOCAL,QUOTE,STABLE-UNDER-SIMPLIFICATIONP,AND,DEFFIXEQUIV,///,MBE,T,DEFINE,QUASIQUOTE,LONG,RCHARS-TO-STRING,PROD.TYPE-NAME,X.NAME,FULL-ESCAPE-SYMBOL,REVAPPEND-CHARS,ACC,SHORT,FLEXPROD-FIELD,FLEXPROD,FLEXSUM,B*,SUM,PROD,X,DEFUN" data-used-by="FLEXPROD-FIELD-ACC-LST" data-part-name="FLEXPROD-FIELD-ACC" data-part-args="SUM,PROD,X" data-part-body="ENABLE,IN-THEORY,LOCAL,QUOTE,STABLE-UNDER-SIMPLIFICATIONP,AND,DEFFIXEQUIV,///,MBE,T,DEFINE,QUASIQUOTE,LONG,RCHARS-TO-STRING,PROD.TYPE-NAME,X.NAME,FULL-ESCAPE-SYMBOL,REVAPPEND-CHARS,ACC,SHORT,X,FLEXPROD-FIELD,PROD,FLEXPROD,SUM,FLEXSUM,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELD-ACC">flexprod-field-acc</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-field-acc" data-sym="FLEXPROD-FIELD-ACC" title="(defun fty::flexprod-field-acc (fty::x fty::prod fty::sum)
  (fty::b*
   (((fty::flexsum fty::sum) fty::sum) ((fty::flexprod fty::prod) fty::prod)
    ((fty::flexprod-field fty::x) fty::x)
    (fty::short
...">flexprod-field-acc</a>
  (x prod sum)
  (b* (((flexsum sum) sum) ((flexprod prod) prod)
      ((flexprod-field x) x)
      (short (b* ((acc nil) (acc (revappend-chars <span class="string">"Get the &lt;tt&gt;@(sym "</span> acc))
            (acc (revappend-chars (full-escape-symbol x.name)
                acc))
            (acc (revappend-chars <span class="string">")&lt;/tt&gt; field from a @(see? "</span>
                acc))
            (acc (revappend-chars (full-escape-symbol prod.type-name)
                acc))
            (acc (revappend-chars <span class="string">")."</span> acc)))
          (rchars-to-string acc)))
      (long <span class="string">"&lt;p&gt;This is an ordinary field accessor created by @(see fty::defprod).&lt;/p&gt;"</span>))
    `((define ,FTY::X.ACC-NAME
       ((,FTY::SUM.XVAR ,FTY::SUM.PRED))
       <span class="keyword">:parents</span> (,FTY::PROD.TYPE-NAME)
       <span class="keyword">:short</span> ,FTY::SHORT
       <span class="keyword">:long</span> ,FTY::LONG
       ,@(AND (MEMBER :ACC FTY::PROD.INLINE) `(:INLINE T))
       ,@(AND (NOT FTY::X.SHARED) `(:GUARD ,FTY::PROD.GUARD))
       <span class="keyword">:guard-hints</span> ((<span class="string">"goal"</span> <span class="keyword">:expand</span> ((,FTY::SUM.PRED ,FTY::SUM.XVAR) . ,(AND FTY::SUM.KIND `((,FTY::SUM.KIND ,FTY::SUM.XVAR))))))
       <span class="keyword">:returns</span> ,(IF FTY::X.TYPE
     `(,FTY::X.NAME ,FTY::X.TYPE ,@FTY::X.RULE-CLASSES)
     `(FTY::X.NAME))
       <span class="keyword">:progn</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
       (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> ,(FTY::B*
  ((FTY::BODY
    (IF (EQ FTY::X.REQFIX FTY::X.NAME)
        (IF FTY::X.FIX
            `(,FTY::X.FIX ,FTY::X.ACC-BODY)
            FTY::X.ACC-BODY)
        FTY::X.REQFIX))
   (FTY::XVAR-BINDING
    (AND (NOT FTY::X.SHARED)
         `((,FTY::SUM.XVAR (AND ,FTY::PROD.GUARD ,FTY::SUM.XVAR)))))
   (FTY::BINDINGS
    (IF (EQ FTY::X.REQFIX FTY::X.NAME)
        FTY::XVAR-BINDING
        (APPEND FTY::XVAR-BINDING
                (FTY::FLEXPROD-FIELDS-TYPEFIX-BINDINGS FTY::PROD.FIELDS
                 FTY::X.REQFIX-VARS)))))
  (IF FTY::BINDINGS
      `(FTY::B* ,FTY::BINDINGS ,FTY::BODY)
      FTY::BODY))
         <span class="keyword">:exec</span> ,FTY::X.ACC-BODY)
       ///
       (deffixequiv ,FTY::X.ACC-NAME
         <span class="keyword">:hints</span> (,@(AND FTY::SUM.KIND `((&quot;goal&quot; :IN-THEORY (FTY::DISABLE ,FTY::SUM.KIND)))) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp
             '(,@(AND FTY::SUM.KIND `(:IN-THEORY (FTY::ENABLE ,FTY::SUM.KIND))) <span class="keyword">:expand</span> ((,FTY::SUM.FIX ,FTY::SUM.XVAR))))))
       ,@(AND (NOT (EQ FTY::PROD.GUARD T)) (NOT FTY::X.SHARED)
       `((FTY::DEFTHMD
          ,(FTY::INTERN-IN-PACKAGE-OF-SYMBOL
            (FTY::CAT (SYMBOL-NAME FTY::X.ACC-NAME) &quot;-WHEN-WRONG-KIND&quot;)
            FTY::X.ACC-NAME)
          (FTY::IMPLIES (NOT ,FTY::PROD.GUARD)
           (EQUAL (,FTY::X.ACC-NAME ,FTY::SUM.XVAR)
                  ,(IF (EQ FTY::X.REQFIX FTY::X.NAME)
                       (IF FTY::X.FIX
                           `(,FTY::X.FIX NIL)
                           NIL)
                       `(FTY::B*
                         ((,FTY::SUM.XVAR NIL)
                          . ,(FTY::FLEXPROD-FIELDS-TYPEFIX-BINDINGS
                              FTY::PROD.FIELDS FTY::X.REQFIX-VARS))
                         ,FTY::X.REQFIX))))
          :HINTS
          ((&quot;Goal&quot; :IN-THEORY
            (FTY::DISABLE ,@(AND FTY::SUM.KIND `(,FTY::SUM.KIND))))))))) (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable ,FTY::X.ACC-NAME))))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-field-acc-lst" data-defines="FLEXPROD-FIELD-ACC-LST" data-references="CDR,CAR,FLEXPROD-FIELD-ACC,APPEND,ATOM,IF,SUM,PROD,FIELDS,DEFUN" data-used-by="FLEXPROD-FIELD-ACCESSORS" data-part-name="FLEXPROD-FIELD-ACC-LST" data-part-args="SUM,PROD,FIELDS" data-part-body="CDR,FLEXPROD-FIELD-ACC-LST,SUM,PROD,CAR,FLEXPROD-FIELD-ACC,APPEND,FIELDS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELD-ACC-LST">flexprod-field-acc-lst</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-field-acc-lst" data-sym="FLEXPROD-FIELD-ACC-LST" title="(defun fty::flexprod-field-acc-lst (fty::fields fty::prod fty::sum)
  (if (atom fty::fields)
      nil
      (append (fty::flexprod-field-acc (car fty::fields) fty::prod fty::sum)
              (fty::flexprod-field-acc-lst (cdr fty::fields) fty::prod">flexprod-field-acc-lst</a>
  (fields prod sum)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fields)
    nil
    (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link local-def" href="#def-flexprod-field-acc" data-sym="FLEXPROD-FIELD-ACC" title="(defun fty::flexprod-field-acc (fty::x fty::prod fty::sum)
  (fty::b*
   (((fty::flexsum fty::sum) fty::sum) ((fty::flexprod fty::prod) fty::prod)
    ((fty::flexprod-field fty::x) fty::x)
    (fty::short
...">flexprod-field-acc</a> (car fields)
        prod
        sum)
      (<a class="sym-link local-def" href="#def-flexprod-field-acc-lst" data-sym="FLEXPROD-FIELD-ACC-LST" title="(defun fty::flexprod-field-acc-lst (fty::fields fty::prod fty::sum)
  (if (atom fty::fields)
      nil
      (append (fty::flexprod-field-acc (car fty::fields) fty::prod fty::sum)
              (fty::flexprod-field-acc-lst (cdr fty::fields) fty::prod">flexprod-field-acc-lst</a> (cdr fields)
        prod
        sum))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-field-accessors" data-defines="FLEXPROD-FIELD-ACCESSORS" data-references="FLEXPROD->FIELDS,FLEXPROD-FIELD-ACC-LST,SUM,PROD,DEFUN" data-used-by="FLEXPROD-ACCESSOR/CONSTRUCTORS" data-part-name="FLEXPROD-FIELD-ACCESSORS" data-part-args="SUM,PROD" data-part-body="SUM,PROD,FLEXPROD->FIELDS,FLEXPROD-FIELD-ACC-LST" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELD-ACCESSORS">flexprod-field-accessors</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-field-accessors" data-sym="FLEXPROD-FIELD-ACCESSORS" title="(defun fty::flexprod-field-accessors (fty::prod fty::sum)
  (fty::flexprod-field-acc-lst (fty::flexprod-&gt;fields fty::prod) fty::prod
   fty::sum))">flexprod-field-accessors</a>
  (prod sum)
  (<a class="sym-link local-def" href="#def-flexprod-field-acc-lst" data-sym="FLEXPROD-FIELD-ACC-LST" title="(defun fty::flexprod-field-acc-lst (fty::fields fty::prod fty::sum)
  (if (atom fty::fields)
      nil
      (append (fty::flexprod-field-acc (car fty::fields) fty::prod fty::sum)
              (fty::flexprod-field-acc-lst (cdr fty::fields) fty::prod">flexprod-field-acc-lst</a> (flexprod-&gt;fields prod)
    prod
    sum))</pre>
  </div>

<div class="form-block function" id="def-flexprod-field-names-types" data-defines="FLEXPROD-FIELD-NAMES-TYPES" data-references="CDR,X.NAME,LIST,X.TYPE,CAR,X,FLEXPROD-FIELD,B*,CONS,ATOM,IF,FIELDS,DEFUN" data-used-by="FLEXPROD-REMAKER" data-part-name="FLEXPROD-FIELD-NAMES-TYPES" data-part-args="FIELDS" data-part-body="CDR,FLEXPROD-FIELD-NAMES-TYPES,X.NAME,LIST,X.TYPE,CAR,X,FLEXPROD-FIELD,B*,CONS,FIELDS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELD-NAMES-TYPES">flexprod-field-names-types</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-field-names-types" data-sym="FLEXPROD-FIELD-NAMES-TYPES" title="(defun fty::flexprod-field-names-types (fty::fields)
  (if (atom fty::fields)
      nil
      (cons
       (fty::b* (((fty::flexprod-field fty::x) (car fty::fields)))
...">flexprod-field-names-types</a>
  (fields)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fields)
    nil
    (cons (b* (((flexprod-field x) (car fields)))
        (if x.type
          (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> x.name x.type)
          (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> x.name)))
      (<a class="sym-link local-def" href="#def-flexprod-field-names-types" data-sym="FLEXPROD-FIELD-NAMES-TYPES" title="(defun fty::flexprod-field-names-types (fty::fields)
  (if (atom fty::fields)
      nil
      (cons
       (fty::b* (((fty::flexprod-field fty::x) (car fty::fields)))
...">flexprod-field-names-types</a> (cdr fields)))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-fields-mbe-typefix-bindings" data-defines="FLEXPROD-FIELDS-MBE-TYPEFIX-BINDINGS" data-references="MBE,QUASIQUOTE,CONS,CDR,X.FIX,UNLESS,CAR,X,FLEXPROD-FIELD,ATOM,WHEN,B*,FIELDS,DEFUN" data-used-by="FLEXPROD-CONSTRUCTOR,FLEXPROD-FIELDS-IGNORABLE-TYPEFIX-BINDINGS" data-part-name="FLEXPROD-FIELDS-MBE-TYPEFIX-BINDINGS" data-part-args="FIELDS" data-part-body="MBE,QUASIQUOTE,CONS,CDR,FLEXPROD-FIELDS-MBE-TYPEFIX-BINDINGS,X.FIX,UNLESS,CAR,X,FLEXPROD-FIELD,FIELDS,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELDS-MBE-TYPEFIX-BINDINGS">flexprod-fields-mbe-typefix-bindings</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-fields-mbe-typefix-bindings" data-sym="FLEXPROD-FIELDS-MBE-TYPEFIX-BINDINGS" title="(defun fty::flexprod-fields-mbe-typefix-bindings (fty::fields)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields))
    ((unless fty::x.fix)
...">flexprod-fields-mbe-typefix-bindings</a>
  (fields)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fields)) nil) ((flexprod-field x) (car fields))
      ((unless x.fix) (<a class="sym-link local-def" href="#def-flexprod-fields-mbe-typefix-bindings" data-sym="FLEXPROD-FIELDS-MBE-TYPEFIX-BINDINGS" title="(defun fty::flexprod-fields-mbe-typefix-bindings (fty::fields)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields))
    ((unless fty::x.fix)
...">flexprod-fields-mbe-typefix-bindings</a> (cdr fields))))
    (cons `(,FTY::X.NAME (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (,FTY::X.FIX ,FTY::X.NAME)
          <span class="keyword">:exec</span> ,FTY::X.NAME))
      (<a class="sym-link local-def" href="#def-flexprod-fields-mbe-typefix-bindings" data-sym="FLEXPROD-FIELDS-MBE-TYPEFIX-BINDINGS" title="(defun fty::flexprod-fields-mbe-typefix-bindings (fty::fields)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields))
    ((unless fty::x.fix)
...">flexprod-fields-mbe-typefix-bindings</a> (cdr fields)))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-fields-mbe-reqfix-bindings" data-defines="FLEXPROD-FIELDS-MBE-REQFIX-BINDINGS" data-references="MBE,QUASIQUOTE,CONS,CDR,X.NAME,X.REQFIX,EQ,CAR,X,FLEXPROD-FIELD,ATOM,WHEN,B*,FIELDS,DEFUN" data-used-by="FLEXPROD-CONSTRUCTOR" data-part-name="FLEXPROD-FIELDS-MBE-REQFIX-BINDINGS" data-part-args="FIELDS" data-part-body="MBE,QUASIQUOTE,CONS,CDR,FLEXPROD-FIELDS-MBE-REQFIX-BINDINGS,X.NAME,X.REQFIX,EQ,CAR,X,FLEXPROD-FIELD,FIELDS,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELDS-MBE-REQFIX-BINDINGS">flexprod-fields-mbe-reqfix-bindings</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-fields-mbe-reqfix-bindings" data-sym="FLEXPROD-FIELDS-MBE-REQFIX-BINDINGS" title="(defun fty::flexprod-fields-mbe-reqfix-bindings (fty::fields)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields))
    ((when (eq fty::x.reqfix fty::x.name))
...">flexprod-fields-mbe-reqfix-bindings</a>
  (fields)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fields)) nil) ((flexprod-field x) (car fields))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x.reqfix x.name)) (<a class="sym-link local-def" href="#def-flexprod-fields-mbe-reqfix-bindings" data-sym="FLEXPROD-FIELDS-MBE-REQFIX-BINDINGS" title="(defun fty::flexprod-fields-mbe-reqfix-bindings (fty::fields)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields))
    ((when (eq fty::x.reqfix fty::x.name))
...">flexprod-fields-mbe-reqfix-bindings</a> (cdr fields))))
    (cons `(,FTY::X.NAME (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> ,FTY::X.REQFIX <span class="keyword">:exec</span> ,FTY::X.NAME))
      (<a class="sym-link local-def" href="#def-flexprod-fields-mbe-reqfix-bindings" data-sym="FLEXPROD-FIELDS-MBE-REQFIX-BINDINGS" title="(defun fty::flexprod-fields-mbe-reqfix-bindings (fty::fields)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields))
    ((when (eq fty::x.reqfix fty::x.name))
...">flexprod-fields-mbe-reqfix-bindings</a> (cdr fields)))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-ctor-call" data-defines="FLEXPROD-CTOR-CALL" data-references="PROD.FIELDS,FLEXPROD-FIELDS->NAMES,PROD.CTOR-NAME,CONS,FLEXPROD,B*,PROD,DEFUN" data-used-by="FLEXPROD-CTOR-COUNT-THM,FLEXPROD-ACC-OF-CTOR-THMS" data-part-name="FLEXPROD-CTOR-CALL" data-part-args="PROD" data-part-body="PROD.FIELDS,FLEXPROD-FIELDS->NAMES,PROD.CTOR-NAME,CONS,PROD,FLEXPROD,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-CTOR-CALL">flexprod-ctor-call</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-ctor-call" data-sym="FLEXPROD-CTOR-CALL" title="(defun fty::flexprod-ctor-call (fty::prod)
  (fty::b* (((fty::flexprod fty::prod) fty::prod))
   (cons fty::prod.ctor-name (fty::flexprod-fields-&gt;names fty::prod.fields))))">flexprod-ctor-call</a>
  (prod)
  (b* (((flexprod prod) prod))
    (cons prod.ctor-name
      (flexprod-fields-&gt;names prod.fields))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-fields-ignorable-typefix-bindings" data-defines="FLEXPROD-FIELDS-IGNORABLE-TYPEFIX-BINDINGS" data-references="QUASIQUOTE,CONS,CDR,FLEXPROD-FIELDS-MBE-TYPEFIX-BINDINGS,X.FIX,UNLESS,CAR,X,FLEXPROD-FIELD,ATOM,WHEN,B*,FIELDS,DEFUN" data-part-name="FLEXPROD-FIELDS-IGNORABLE-TYPEFIX-BINDINGS" data-part-args="FIELDS" data-part-body="FLEXPROD-FIELDS-IGNORABLE-TYPEFIX-BINDINGS,QUASIQUOTE,CONS,CDR,FLEXPROD-FIELDS-MBE-TYPEFIX-BINDINGS,X.FIX,UNLESS,CAR,X,FLEXPROD-FIELD,FIELDS,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELDS-IGNORABLE-TYPEFIX-BINDINGS">flexprod-fields-ignorable-typefix-bindings</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-fields-ignorable-typefix-bindings" data-sym="FLEXPROD-FIELDS-IGNORABLE-TYPEFIX-BINDINGS" title="(defun fty::flexprod-fields-ignorable-typefix-bindings (fty::fields)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields))
    ((unless fty::x.fix)
...">flexprod-fields-ignorable-typefix-bindings</a>
  (fields)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fields)) nil) ((flexprod-field x) (car fields))
      ((unless x.fix) (<a class="sym-link local-def" href="#def-flexprod-fields-mbe-typefix-bindings" data-sym="FLEXPROD-FIELDS-MBE-TYPEFIX-BINDINGS" title="(defun fty::flexprod-fields-mbe-typefix-bindings (fty::fields)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields))
    ((unless fty::x.fix)
...">flexprod-fields-mbe-typefix-bindings</a> (cdr fields))))
    (cons `(,(FTY::INTERN-IN-PACKAGE-OF-SYMBOL
  (CONCATENATE &#39;STRING &quot;?&quot; (SYMBOL-NAME FTY::X.NAME)) FTY::X.NAME) (,FTY::X.FIX ,FTY::X.NAME))
      (<a class="sym-link local-def" href="#def-flexprod-fields-ignorable-typefix-bindings" data-sym="FLEXPROD-FIELDS-IGNORABLE-TYPEFIX-BINDINGS" title="(defun fty::flexprod-fields-ignorable-typefix-bindings (fty::fields)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields))
    ((unless fty::x.fix)
...">flexprod-fields-ignorable-typefix-bindings</a> (cdr fields)))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-acc-of-ctor-thms1" data-defines="FLEXPROD-ACC-OF-CTOR-THMS1" data-references="CDR,ENABLE,QUOTE,STABLE-UNDER-SIMPLIFICATIONP,AND,E/D,EQUAL,DEFTHM,CONS,X.ACC-NAME,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,FOO->BAR-OF-FOO,QUASIQUOTE,X.FIX,X.NAME,X.REQFIX,EQ,IF,FIXTERM,CAR,X,FLEXPROD-FIELD,ATOM,WHEN,B*,CTOR-CALL,ALL-FIELDS,FIELDS,DEFUN" data-used-by="FLEXPROD-ACC-OF-CTOR-THMS" data-part-name="FLEXPROD-ACC-OF-CTOR-THMS1" data-part-args="CTOR-CALL,ALL-FIELDS,FIELDS" data-part-body="ALL-FIELDS,CDR,FLEXPROD-ACC-OF-CTOR-THMS1,ENABLE,QUOTE,STABLE-UNDER-SIMPLIFICATIONP,AND,E/D,EQUAL,DEFTHM,CONS,CTOR-CALL,X.ACC-NAME,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,FOO->BAR-OF-FOO,QUASIQUOTE,X.FIX,X.NAME,X.REQFIX,EQ,IF,FIXTERM,CAR,X,FLEXPROD-FIELD,FIELDS,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-ACC-OF-CTOR-THMS1">flexprod-acc-of-ctor-thms1</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-acc-of-ctor-thms1" data-sym="FLEXPROD-ACC-OF-CTOR-THMS1" title="(defun fty::flexprod-acc-of-ctor-thms1
       (fty::fields fty::all-fields fty::ctor-call)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields))
...">flexprod-acc-of-ctor-thms1</a>
  (fields all-fields ctor-call)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fields)) nil) ((flexprod-field x) (car fields))
      (fixterm (if (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x.reqfix x.name)
          (if x.fix
            `(,FTY::X.FIX ,FTY::X.NAME)
            x.name)
          `(b* ,(FTY::FLEXPROD-FIELDS-IGNORABLE-TYPEFIX-BINDINGS FTY::ALL-FIELDS)
            ,FTY::X.REQFIX)))
      (foo-&gt;bar-of-foo (intern-in-package-of-symbol (cat (symbol-name x.acc-name)
            <span class="string">"-OF-"</span>
            (symbol-name (car ctor-call)))
          x.acc-name)))
    (cons `(<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,FTY::FOO-&gt;BAR-OF-FOO
        (equal (,FTY::X.ACC-NAME ,FTY::CTOR-CALL) ,FTY::FIXTERM)
        <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (<a class="sym-link system" href="../../../axioms.html#def-e_2Fd" data-sym="E/D">e/d</a> (,FTY::X.ACC-NAME) (,(CAR FTY::CTOR-CALL)))) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp
            '(<span class="keyword">:in-theory</span> (enable ,(CAR FTY::CTOR-CALL))))))
      (<a class="sym-link local-def" href="#def-flexprod-acc-of-ctor-thms1" data-sym="FLEXPROD-ACC-OF-CTOR-THMS1" title="(defun fty::flexprod-acc-of-ctor-thms1
       (fty::fields fty::all-fields fty::ctor-call)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields))
...">flexprod-acc-of-ctor-thms1</a> (cdr fields)
        all-fields
        ctor-call))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-acc-of-ctor-thms" data-defines="FLEXPROD-ACC-OF-CTOR-THMS" data-references="FLEXPROD-CTOR-CALL,FLEXPROD->FIELDS,FLEXPROD-ACC-OF-CTOR-THMS1,PROD,DEFUN" data-part-name="FLEXPROD-ACC-OF-CTOR-THMS" data-part-args="PROD" data-part-body="FLEXPROD-CTOR-CALL,PROD,FLEXPROD->FIELDS,FLEXPROD-ACC-OF-CTOR-THMS1" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-ACC-OF-CTOR-THMS">flexprod-acc-of-ctor-thms</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-acc-of-ctor-thms" data-sym="FLEXPROD-ACC-OF-CTOR-THMS" title="(defun fty::flexprod-acc-of-ctor-thms (fty::prod)
  (fty::flexprod-acc-of-ctor-thms1 (fty::flexprod-&gt;fields fty::prod)
   (fty::flexprod-&gt;fields fty::prod) (fty::flexprod-ctor-call fty::prod)))">flexprod-acc-of-ctor-thms</a>
  (prod)
  (<a class="sym-link local-def" href="#def-flexprod-acc-of-ctor-thms1" data-sym="FLEXPROD-ACC-OF-CTOR-THMS1" title="(defun fty::flexprod-acc-of-ctor-thms1
       (fty::fields fty::all-fields fty::ctor-call)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields))
...">flexprod-acc-of-ctor-thms1</a> (flexprod-&gt;fields prod)
    (flexprod-&gt;fields prod)
    (<a class="sym-link local-def" href="#def-flexprod-ctor-call" data-sym="FLEXPROD-CTOR-CALL" title="(defun fty::flexprod-ctor-call (fty::prod)
  (fty::b* (((fty::flexprod fty::prod) fty::prod))
   (cons fty::prod.ctor-name (fty::flexprod-fields-&gt;names fty::prod.fields))))">flexprod-ctor-call</a> prod)))</pre>
  </div>

<div class="form-block function" id="def-flexprod-fields-acc-calls" data-defines="FLEXPROD-FIELDS-ACC-CALLS" data-references="CDR,QUASIQUOTE,CONS,ATOM,IF,XVAR,FIELDS,DEFUN" data-used-by="FLEXPROD-CONSTRUCTOR" data-part-name="FLEXPROD-FIELDS-ACC-CALLS" data-part-args="XVAR,FIELDS" data-part-body="XVAR,CDR,FLEXPROD-FIELDS-ACC-CALLS,QUASIQUOTE,CONS,FIELDS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELDS-ACC-CALLS">flexprod-fields-acc-calls</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-fields-acc-calls" data-sym="FLEXPROD-FIELDS-ACC-CALLS" title="(defun fty::flexprod-fields-acc-calls (fty::fields fty::xvar)
  (if (atom fty::fields)
      nil
      (cons `(,(fty::flexprod-field-&gt;acc-name (car fty::fields)) ,fty::xvar)
            (fty::flexprod-fields-acc-calls (cdr fty::fields) fty::xvar))))">flexprod-fields-acc-calls</a>
  (fields xvar)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fields)
    nil
    (cons `(,(FTY::FLEXPROD-FIELD-&gt;ACC-NAME (CAR FTY::FIELDS)) ,FTY::XVAR)
      (<a class="sym-link local-def" href="#def-flexprod-fields-acc-calls" data-sym="FLEXPROD-FIELDS-ACC-CALLS" title="(defun fty::flexprod-fields-acc-calls (fty::fields fty::xvar)
  (if (atom fty::fields)
      nil
      (cons `(,(fty::flexprod-field-&gt;acc-name (car fty::fields)) ,fty::xvar)
            (fty::flexprod-fields-acc-calls (cdr fty::fields) fty::xvar))))">flexprod-fields-acc-calls</a> (cdr fields) xvar))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-equal-of-field-accessors" data-defines="FLEXPROD-EQUAL-OF-FIELD-ACCESSORS" data-references="CDR,EQUAL,QUASIQUOTE,CAR,X,FLEXPROD-FIELD,B*,CONS,ATOM,IF,XVAR,ALL-FIELDS,FIELDS,DEFUN" data-part-name="FLEXPROD-EQUAL-OF-FIELD-ACCESSORS" data-part-args="XVAR,ALL-FIELDS,FIELDS" data-part-body="XVAR,ALL-FIELDS,CDR,FLEXPROD-EQUAL-OF-FIELD-ACCESSORS,EQUAL,QUASIQUOTE,CAR,X,FLEXPROD-FIELD,B*,CONS,FIELDS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-EQUAL-OF-FIELD-ACCESSORS">flexprod-equal-of-field-accessors</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-equal-of-field-accessors" data-sym="FLEXPROD-EQUAL-OF-FIELD-ACCESSORS" title="(defun fty::flexprod-equal-of-field-accessors
       (fty::fields fty::all-fields fty::xvar)
  (if (atom fty::fields)
      nil
      (cons
...">flexprod-equal-of-field-accessors</a>
  (fields all-fields xvar)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fields)
    nil
    (cons (b* (((flexprod-field x) (car fields)))
        `(equal (,FTY::X.ACC-NAME ,FTY::XVAR)
          ,(IF (EQ FTY::X.REQFIX FTY::X.NAME)
     (IF FTY::X.FIX
         `(,FTY::X.FIX ,FTY::X.NAME)
         FTY::X.NAME)
     `(FTY::B*
       ,(FTY::FLEXPROD-FIELDS-IGNORABLE-TYPEFIX-BINDINGS FTY::ALL-FIELDS)
       ,FTY::X.REQFIX))))
      (<a class="sym-link local-def" href="#def-flexprod-equal-of-field-accessors" data-sym="FLEXPROD-EQUAL-OF-FIELD-ACCESSORS" title="(defun fty::flexprod-equal-of-field-accessors
       (fty::fields fty::all-fields fty::xvar)
  (if (atom fty::fields)
      nil
      (cons
...">flexprod-equal-of-field-accessors</a> (cdr fields)
        all-fields
        xvar))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-fields-macro-args" data-defines="FLEXPROD-FIELDS-MACRO-ARGS" data-references="CDR,QUOTE,QUASIQUOTE,CONS,CAR,F,FLEXPROD-FIELD,ATOM,WHEN,B*,X,DEFUN" data-part-name="FLEXPROD-FIELDS-MACRO-ARGS" data-part-args="X" data-part-body="CDR,FLEXPROD-FIELDS-MACRO-ARGS,QUOTE,QUASIQUOTE,CONS,CAR,F,FLEXPROD-FIELD,X,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELDS-MACRO-ARGS">flexprod-fields-macro-args</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-fields-macro-args" data-sym="FLEXPROD-FIELDS-MACRO-ARGS" title="(defun fty::flexprod-fields-macro-args (fty::x)
  (fty::b*
   (((when (atom fty::x)) nil) ((fty::flexprod-field fty::f) (car fty::x)))
   (cons `(,fty::f.name &#39;,fty::f.default)
         (fty::flexprod-fields-macro-args (cdr fty::x)))))">flexprod-fields-macro-args</a>
  (x)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)) nil) ((flexprod-field f) (car x)))
    (cons `(,FTY::F.NAME ',FTY::F.DEFAULT)
      (<a class="sym-link local-def" href="#def-flexprod-fields-macro-args" data-sym="FLEXPROD-FIELDS-MACRO-ARGS" title="(defun fty::flexprod-fields-macro-args (fty::x)
  (fty::b*
   (((when (atom fty::x)) nil) ((fty::flexprod-field fty::f) (car fty::x)))
   (cons `(,fty::f.name &#39;,fty::f.default)
         (fty::flexprod-fields-macro-args (cdr fty::x)))))">flexprod-fields-macro-args</a> (cdr x)))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-fields-bind-accessors" data-defines="FLEXPROD-FIELDS-BIND-ACCESSORS" data-references="CDR,QUASIQUOTE,F.NAME,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,LIST,CONS,CAR,F,FLEXPROD-FIELD,ATOM,WHEN,B*,XVAR,X,DEFUN" data-part-name="FLEXPROD-FIELDS-BIND-ACCESSORS" data-part-args="XVAR,X" data-part-body="XVAR,CDR,FLEXPROD-FIELDS-BIND-ACCESSORS,QUASIQUOTE,F.NAME,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,LIST,CONS,CAR,F,FLEXPROD-FIELD,X,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELDS-BIND-ACCESSORS">flexprod-fields-bind-accessors</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-fields-bind-accessors" data-sym="FLEXPROD-FIELDS-BIND-ACCESSORS" title="(defun fty::flexprod-fields-bind-accessors (fty::x fty::xvar)
  (fty::b*
   (((when (atom fty::x)) nil) ((fty::flexprod-field fty::f) (car fty::x)))
   (cons
    (list
...">flexprod-fields-bind-accessors</a>
  (x xvar)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)) nil) ((flexprod-field f) (car x)))
    (cons (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> (intern-in-package-of-symbol (cat <span class="string">"?"</span> (symbol-name f.name))
          f.name)
        `(,FTY::F.ACC-NAME ,FTY::XVAR))
      (<a class="sym-link local-def" href="#def-flexprod-fields-bind-accessors" data-sym="FLEXPROD-FIELDS-BIND-ACCESSORS" title="(defun fty::flexprod-fields-bind-accessors (fty::x fty::xvar)
  (fty::b*
   (((when (atom fty::x)) nil) ((fty::flexprod-field fty::f) (car fty::x)))
   (cons
    (list
...">flexprod-fields-bind-accessors</a> (cdr x) xvar))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-remaker" data-defines="FLEXPROD-REMAKER" data-references="ENABLE,MBE,T,DEFINE,QUASIQUOTE,FLEXPROD-FIELD-NAMES-TYPES,FIELDS/TYPES,PROD.FIELDS,FLEXPROD-FIELDS->NAMES,FIELDNAMES,PROD.REMAKE-NAME,UNLESS,FLEXPROD,FLEXSUM,B*,SUM,PROD,DEFUN" data-used-by="FLEXPROD-ACCESSOR/CONSTRUCTORS" data-part-name="FLEXPROD-REMAKER" data-part-args="SUM,PROD" data-part-body="ENABLE,MBE,T,DEFINE,QUASIQUOTE,FLEXPROD-FIELD-NAMES-TYPES,FIELDS/TYPES,PROD.FIELDS,FLEXPROD-FIELDS->NAMES,FIELDNAMES,PROD.REMAKE-NAME,UNLESS,PROD,FLEXPROD,SUM,FLEXSUM,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-REMAKER">flexprod-remaker</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-remaker" data-sym="FLEXPROD-REMAKER" title="(defun fty::flexprod-remaker (fty::prod fty::sum)
  (fty::b*
   (((fty::flexsum fty::sum) fty::sum) ((fty::flexprod fty::prod) fty::prod)
    ((unless fty::prod.remake-name) nil)
    (fty::fieldnames (fty::flexprod-fields-&gt;names fty::prod.fields))
...">flexprod-remaker</a>
  (prod sum)
  (b* (((flexsum sum) sum) ((flexprod prod) prod)
      ((unless prod.remake-name) nil)
      (fieldnames (flexprod-fields-&gt;names prod.fields))
      (fields/types (<a class="sym-link local-def" href="#def-flexprod-field-names-types" data-sym="FLEXPROD-FIELD-NAMES-TYPES" title="(defun fty::flexprod-field-names-types (fty::fields)
  (if (atom fty::fields)
      nil
      (cons
       (fty::b* (((fty::flexprod-field fty::x) (car fty::fields)))
...">flexprod-field-names-types</a> prod.fields)))
    `((define ,FTY::PROD.REMAKE-NAME
       ((,FTY::SUM.XVAR ,FTY::SUM.PRED) . ,FTY::FIELDS/TYPES)
       <span class="keyword">:guard</span> ,(FTY::NICE-AND FTY::PROD.GUARD FTY::PROD.REQUIRE)
       <span class="keyword">:parents</span> nil
       ,@(AND (MEMBER :XTOR FTY::PROD.INLINE) `(:INLINE T))
       <span class="keyword">:hooks</span> nil
       <span class="keyword">:progn</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
       <span class="keyword">:enabled</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
       (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (,FTY::PROD.CTOR-NAME . ,FTY::FIELDNAMES)
         <span class="keyword">:exec</span> ,FTY::PROD.REMAKE-BODY)
       <span class="keyword">:guard-hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable ,FTY::SUM.PRED . ,(AND FTY::SUM.KIND `(,FTY::SUM.KIND)))
          <span class="keyword">:expand</span> ((,FTY::PROD.CTOR-NAME . ,FTY::FIELDNAMES) (,FTY::SUM.PRED ,FTY::SUM.XVAR))))))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-constructor" data-defines="FLEXPROD-CONSTRUCTOR" data-references="IN-THEORY,LOCAL,REST-EXPR,FORMS,ARGS,DA-PATBIND-FN,DEF-B*-BINDER,DEFFIXEQUIV,E/D*,QUOTE,STABLE-UNDER-SIMPLIFICATIONP,DEFTYPES-TEMP-THMS,DISABLE*,AND,EQUAL,DEFTHM,///,T,ENABLE,DEFINE,TYPEFIX-BODY,PROD.CTOR-BODY,LET,QUASIQUOTE,IF,REQFIX-BODY,FLEXPROD-FIELDS-MBE-REQFIX-BINDINGS,REQFIXES,FLEXPROD-FIELDS-MBE-TYPEFIX-BINDINGS,TYPEFIXES,EQUAL-OF-FOO,PROD.KIND,SUM.FIX,FOO-FIX-WHEN-FOO-KIND,PROD.CTOR-NAME,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,FOO-OF-FIELDS,PROD.TYPE-NAME,PROD.EXTRA-BINDER-NAMES,EXTRA-BINDER-NAMES->ACC-ALIST,APPEND,BINDER-ACCS,FLEXPROD-FIELDS->ACC-NAMES,PAIRLIS$,FIELD-ACCS,FLEXPROD-FIELDS->NAMES,FIELDNAMES,SUM.XVAR,PROD.FIELDS,FLEXPROD-FIELDS-ACC-CALLS,FIELD-CALLS,FLEXPROD,FLEXSUM,B*,SUM,PROD,DEFUN" data-used-by="FLEXPROD-ACCESSOR/CONSTRUCTORS" data-part-name="FLEXPROD-CONSTRUCTOR" data-part-args="SUM,PROD" data-part-body="IN-THEORY,LOCAL,REST-EXPR,FORMS,ARGS,DA-PATBIND-FN,DEF-B*-BINDER,DEFFIXEQUIV,E/D*,QUOTE,STABLE-UNDER-SIMPLIFICATIONP,DEFTYPES-TEMP-THMS,DISABLE*,AND,EQUAL,DEFTHM,///,T,ENABLE,DEFINE,TYPEFIX-BODY,PROD.CTOR-BODY,LET,QUASIQUOTE,IF,REQFIX-BODY,FLEXPROD-FIELDS-MBE-REQFIX-BINDINGS,REQFIXES,FLEXPROD-FIELDS-MBE-TYPEFIX-BINDINGS,TYPEFIXES,EQUAL-OF-FOO,PROD.KIND,SUM.FIX,FOO-FIX-WHEN-FOO-KIND,PROD.CTOR-NAME,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,FOO-OF-FIELDS,PROD.TYPE-NAME,PROD.EXTRA-BINDER-NAMES,EXTRA-BINDER-NAMES->ACC-ALIST,APPEND,BINDER-ACCS,FLEXPROD-FIELDS->ACC-NAMES,PAIRLIS$,FIELD-ACCS,FLEXPROD-FIELDS->NAMES,FIELDNAMES,SUM.XVAR,PROD.FIELDS,FLEXPROD-FIELDS-ACC-CALLS,FIELD-CALLS,PROD,FLEXPROD,SUM,FLEXSUM,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-CONSTRUCTOR">flexprod-constructor</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-constructor" data-sym="FLEXPROD-CONSTRUCTOR" title="(defun fty::flexprod-constructor (fty::prod fty::sum)
  (fty::b*
   (((fty::flexsum fty::sum) fty::sum) ((fty::flexprod fty::prod) fty::prod)
    (fty::field-calls
     (fty::flexprod-fields-acc-calls fty::prod.fields fty::sum.xvar))
...">flexprod-constructor</a>
  (prod sum)
  (b* (((flexsum sum) sum) ((flexprod prod) prod)
      (field-calls (<a class="sym-link local-def" href="#def-flexprod-fields-acc-calls" data-sym="FLEXPROD-FIELDS-ACC-CALLS" title="(defun fty::flexprod-fields-acc-calls (fty::fields fty::xvar)
  (if (atom fty::fields)
      nil
      (cons `(,(fty::flexprod-field-&gt;acc-name (car fty::fields)) ,fty::xvar)
            (fty::flexprod-fields-acc-calls (cdr fty::fields) fty::xvar))))">flexprod-fields-acc-calls</a> prod.fields
          sum.xvar))
      (fieldnames (flexprod-fields-&gt;names prod.fields))
      (field-accs (<a class="sym-link system" href="../../../axioms.html#def-pairlis_24" data-sym="PAIRLIS$">pairlis$</a> fieldnames
          (flexprod-fields-&gt;acc-names prod.fields)))
      (binder-accs (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> field-accs
          (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (extra-binder-names-&gt;acc-alist prod.extra-binder-names
              prod.type-name))))
      (foo-of-fields (intern-in-package-of-symbol (cat (symbol-name prod.ctor-name) <span class="string">"-OF-FIELDS"</span>)
          prod.ctor-name))
      (foo-fix-when-foo-kind (intern-in-package-of-symbol (cat (symbol-name sum.fix)
            <span class="string">"-WHEN-"</span>
            (symbol-name prod.kind))
          sum.fix))
      (equal-of-foo (intern-in-package-of-symbol (cat <span class="string">"EQUAL-OF-"</span> (symbol-name prod.ctor-name))
          prod.ctor-name))
      (typefixes (<a class="sym-link local-def" href="#def-flexprod-fields-mbe-typefix-bindings" data-sym="FLEXPROD-FIELDS-MBE-TYPEFIX-BINDINGS" title="(defun fty::flexprod-fields-mbe-typefix-bindings (fty::fields)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields))
    ((unless fty::x.fix)
...">flexprod-fields-mbe-typefix-bindings</a> prod.fields))
      (reqfixes (<a class="sym-link local-def" href="#def-flexprod-fields-mbe-reqfix-bindings" data-sym="FLEXPROD-FIELDS-MBE-REQFIX-BINDINGS" title="(defun fty::flexprod-fields-mbe-reqfix-bindings (fty::fields)
  (fty::b*
   (((when (atom fty::fields)) nil)
    ((fty::flexprod-field fty::x) (car fty::fields))
    ((when (eq fty::x.reqfix fty::x.name))
...">flexprod-fields-mbe-reqfix-bindings</a> prod.fields))
      (reqfix-body (if reqfixes
          `(let ,FTY::REQFIXES
            ,FTY::PROD.CTOR-BODY)
          prod.ctor-body))
      (typefix-body (if typefixes
          `(b* ,FTY::TYPEFIXES ,FTY::REQFIX-BODY)
          reqfix-body)))
    `((define ,FTY::PROD.CTOR-NAME
       ,(FTY::FLEXPROD-FIELD-NAMES-TYPES FTY::PROD.FIELDS)
       <span class="keyword">:parents</span> nil
       ,@(AND (MEMBER :XTOR FTY::PROD.INLINE) `(:INLINE T))
       <span class="keyword">:guard</span> ,FTY::PROD.REQUIRE
       <span class="keyword">:returns</span> (,FTY::SUM.XVAR ,(IF (EQ FTY::PROD.GUARD T)
     FTY::SUM.PRED
     `(AND (,FTY::SUM.PRED ,FTY::SUM.XVAR) ,FTY::PROD.GUARD))
         <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable ,FTY::SUM.PRED . ,(AND FTY::SUM.KIND `(,FTY::SUM.KIND))))))
       <span class="keyword">:progn</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
       ,FTY::TYPEFIX-BODY
       ///
       ,@(AND FTY::SUM.DISABLE-TYPE-PRESCRIPTION
       `((FTY::IN-THEORY (FTY::DISABLE (:T ,FTY::PROD.CTOR-NAME)))))
       ,@(FTY::FLEXPROD-ACC-OF-CTOR-THMS FTY::PROD)
       ,@(AND (NOT (EQ FTY::PROD.REQUIRE T))
       (LET ((FTY::FOO-REQUIREMENTS
              (FTY::INTERN-IN-PACKAGE-OF-SYMBOL
               (FTY::CAT (SYMBOL-NAME FTY::PROD.CTOR-NAME) &quot;-REQUIREMENTS&quot;)
               FTY::PROD.CTOR-NAME)))
         `((FTY::DEFTHM ,FTY::FOO-REQUIREMENTS
            (FTY::B*
             ,(FTY::FLEXPROD-FIELDS-BIND-ACCESSORS FTY::PROD.FIELDS
               FTY::SUM.XVAR)
             ,FTY::PROD.REQUIRE)))))
       ,@(AND (CONSP FTY::PROD.FIELDS)
       `((FTY::DEFTHM ,FTY::FOO-OF-FIELDS
          ,(FTY::NICE-IMPLIES FTY::PROD.GUARD
            `(EQUAL (,FTY::PROD.CTOR-NAME . ,FTY::FIELD-CALLS)
                    (,FTY::SUM.FIX ,FTY::SUM.XVAR)))
          :HINTS ((&quot;Goal&quot; :EXPAND ((,FTY::SUM.FIX ,FTY::SUM.XVAR)))))))
       (,(IF (ATOM FTY::PROD.FIELDS)
     &#39;FTY::DEFTHM
     &#39;FTY::DEFTHMD) ,FTY::FOO-FIX-WHEN-FOO-KIND
         ,(FTY::NICE-IMPLIES FTY::PROD.GUARD
  `(EQUAL (,FTY::SUM.FIX ,FTY::SUM.XVAR)
          (,FTY::PROD.CTOR-NAME . ,FTY::FIELD-CALLS)))
         <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:expand</span> ((,FTY::SUM.FIX ,FTY::SUM.XVAR)))) . ,(AND (NOT (EQ FTY::PROD.GUARD T))
      &#39;(:RULE-CLASSES ((:REWRITE :BACKCHAIN-LIMIT-LST 0)))))
       (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,FTY::EQUAL-OF-FOO
         (equal (equal ,(FTY::FLEXPROD-CTOR-CALL FTY::PROD) ,FTY::SUM.XVAR)
           (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (,FTY::SUM.PRED ,FTY::SUM.XVAR)
             ,@(AND (NOT (EQ FTY::PROD.GUARD T)) (LIST FTY::PROD.GUARD)) . ,(FTY::FLEXPROD-EQUAL-OF-FIELD-ACCESSORS FTY::PROD.FIELDS FTY::PROD.FIELDS
  FTY::SUM.XVAR)))
         <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:in-theory</span> (disable* ,FTY::PROD.CTOR-NAME
              ,@(FTY::FLEXPROD-FIELDS-&gt;ACC-NAMES FTY::PROD.FIELDS)
              ,@(AND FTY::SUM.KIND `(,FTY::SUM.KIND))
              ,@(IF (CONSP FTY::PROD.FIELDS)
      `(,FTY::FOO-OF-FIELDS)
      `(,FTY::FOO-FIX-WHEN-FOO-KIND))
              deftypes-temp-thms
              (<span class="keyword">:rules-of-class</span> <span class="keyword">:forward-chaining</span> <span class="keyword">:here</span>)
              (<span class="keyword">:rules-of-class</span> <span class="keyword">:type-prescription</span> <span class="keyword">:here</span>))
            ,@(IF (CONSP FTY::PROD.FIELDS)
      `(:USE ,FTY::FOO-OF-FIELDS)
      `(:USE ,FTY::FOO-FIX-WHEN-FOO-KIND))) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp
             '(<span class="keyword">:in-theory</span> (e/d* (,FTY::PROD.CTOR-NAME)
                 (,@(FTY::FLEXPROD-FIELDS-&gt;ACC-NAMES FTY::PROD.FIELDS) ,@(AND FTY::SUM.KIND `(,FTY::SUM.KIND))
                   ,@(IF (CONSP FTY::PROD.FIELDS)
      `(,FTY::FOO-OF-FIELDS)
      `(,FTY::FOO-FIX-WHEN-FOO-KIND))
                   deftypes-temp-thms
                   (<span class="keyword">:rules-of-class</span> <span class="keyword">:forward-chaining</span> <span class="keyword">:here</span>)
                   (<span class="keyword">:rules-of-class</span> <span class="keyword">:type-prescription</span> <span class="keyword">:here</span>)))))))
       (deffixequiv ,FTY::PROD.CTOR-NAME)
       (def-b*-binder ,FTY::PROD.CTOR-NAME
         <span class="keyword">:body</span> (da-patbind-fn ',FTY::PROD.CTOR-NAME
           ',FTY::BINDER-ACCS
           <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>
           forms
           rest-expr))
       ,@(AND (NOT FTY::PROD.NO-CTOR-MACROS)
       `(,(STD::DA-MAKE-MAKER FTY::PROD.CTOR-NAME FTY::FIELDNAMES
           (FTY::FLEXPROD-FIELDS-&gt;DEFAULTS FTY::PROD.FIELDS))
         ,(STD::DA-MAKE-CHANGER FTY::PROD.CTOR-NAME FTY::FIELDNAMES
           FTY::PROD.REMAKE-NAME)))) (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable ,FTY::PROD.CTOR-NAME))))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-fns" data-defines="FLEXPROD-FNS" data-references="PROD.FIELDS,FLEXPROD-FIELDS->ACC-NAMES,PROD.CTOR-NAME,CONS,FLEXPROD,B*,PROD,DEFUN" data-used-by="FLEXSUM-PROD-FNS" data-part-name="FLEXPROD-FNS" data-part-args="PROD" data-part-body="PROD.FIELDS,FLEXPROD-FIELDS->ACC-NAMES,PROD.CTOR-NAME,CONS,PROD,FLEXPROD,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FNS">flexprod-fns</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-fns" data-sym="FLEXPROD-FNS" title="(defun fty::flexprod-fns (fty::prod)
  (fty::b* (((fty::flexprod fty::prod) fty::prod))
   (cons fty::prod.ctor-name
         (fty::flexprod-fields-&gt;acc-names fty::prod.fields))))">flexprod-fns</a>
  (prod)
  (b* (((flexprod prod) prod))
    (cons prod.ctor-name
      (flexprod-fields-&gt;acc-names prod.fields))))</pre>
  </div>

<div class="form-block function" id="def-flexsum-prod-fns" data-defines="FLEXSUM-PROD-FNS" data-references="CDR,CAR,FLEXPROD-FNS,APPEND,ATOM,IF,PRODS,DEFUN" data-used-by="FLEXSUM-FNS" data-part-name="FLEXSUM-PROD-FNS" data-part-args="PRODS" data-part-body="CDR,FLEXSUM-PROD-FNS,CAR,FLEXPROD-FNS,APPEND,PRODS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-PROD-FNS">flexsum-prod-fns</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-prod-fns" data-sym="FLEXSUM-PROD-FNS" title="(defun fty::flexsum-prod-fns (fty::prods)
  (if (atom fty::prods)
      nil
      (append (fty::flexprod-fns (car fty::prods))
              (fty::flexsum-prod-fns (cdr fty::prods)))))">flexsum-prod-fns</a>
  (prods)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)
    nil
    (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link local-def" href="#def-flexprod-fns" data-sym="FLEXPROD-FNS" title="(defun fty::flexprod-fns (fty::prod)
  (fty::b* (((fty::flexprod fty::prod) fty::prod))
   (cons fty::prod.ctor-name
         (fty::flexprod-fields-&gt;acc-names fty::prod.fields))))">flexprod-fns</a> (car prods))
      (<a class="sym-link local-def" href="#def-flexsum-prod-fns" data-sym="FLEXSUM-PROD-FNS" title="(defun fty::flexsum-prod-fns (fty::prods)
  (if (atom fty::prods)
      nil
      (append (fty::flexprod-fns (car fty::prods))
              (fty::flexsum-prod-fns (cdr fty::prods)))))">flexsum-prod-fns</a> (cdr prods)))))</pre>
  </div>

<div class="form-block function" id="def-flexsum-prod-ctors" data-defines="FLEXSUM-PROD-CTORS" data-references="CDR,CAR,FLEXPROD->CTOR-NAME,CONS,ATOM,IF,PRODS,DEFUN" data-part-name="FLEXSUM-PROD-CTORS" data-part-args="PRODS" data-part-body="CDR,FLEXSUM-PROD-CTORS,CAR,FLEXPROD->CTOR-NAME,CONS,PRODS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-PROD-CTORS">flexsum-prod-ctors</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-prod-ctors" data-sym="FLEXSUM-PROD-CTORS" title="(defun fty::flexsum-prod-ctors (fty::prods)
  (if (atom fty::prods)
      nil
      (cons (fty::flexprod-&gt;ctor-name (car fty::prods))
            (fty::flexsum-prod-ctors (cdr fty::prods)))))">flexsum-prod-ctors</a>
  (prods)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)
    nil
    (cons (flexprod-&gt;ctor-name (car prods))
      (<a class="sym-link local-def" href="#def-flexsum-prod-ctors" data-sym="FLEXSUM-PROD-CTORS" title="(defun fty::flexsum-prod-ctors (fty::prods)
  (if (atom fty::prods)
      nil
      (cons (fty::flexprod-&gt;ctor-name (car fty::prods))
            (fty::flexsum-prod-ctors (cdr fty::prods)))))">flexsum-prod-ctors</a> (cdr prods)))))</pre>
  </div>

<div class="form-block function" id="def-flexsum-fns" data-defines="FLEXSUM-FNS" data-references="CONS,X.KIND,IF,X.PRODS,FLEXSUM-PROD-FNS,X.FIX,X.PRED,LIST*,FNS1,FLEXSUM,B*,X,DEFUN" data-part-name="FLEXSUM-FNS" data-part-args="X" data-part-body="CONS,X.KIND,IF,X.PRODS,FLEXSUM-PROD-FNS,X.FIX,X.PRED,LIST*,FNS1,X,FLEXSUM,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-FNS">flexsum-fns</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-fns" data-sym="FLEXSUM-FNS" title="(defun fty::flexsum-fns (fty::x)
  (fty::b*
   (((fty::flexsum fty::x) fty::x)
    (fty::fns1
     (list* fty::x.pred fty::x.fix (fty::flexsum-prod-fns fty::x.prods))))
...">flexsum-fns</a>
  (x)
  (b* (((flexsum x) x) (fns1 (<a class="sym-link system" href="../../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> x.pred
          x.fix
          (<a class="sym-link local-def" href="#def-flexsum-prod-fns" data-sym="FLEXSUM-PROD-FNS" title="(defun fty::flexsum-prod-fns (fty::prods)
  (if (atom fty::prods)
      nil
      (append (fty::flexprod-fns (car fty::prods))
              (fty::flexsum-prod-fns (cdr fty::prods)))))">flexsum-prod-fns</a> x.prods))))
    (if x.kind
      (cons x.kind fns1)
      fns1)))</pre>
  </div>

<div class="form-block function" id="def-flexprod-accessor_2Fconstructors" data-defines="FLEXPROD-ACCESSOR/CONSTRUCTORS" data-references="FLEXPROD-REMAKER,FLEXPROD-CONSTRUCTOR,FLEXPROD-FIELD-ACCESSORS,APPEND,SUM,PROD,DEFUN" data-used-by="FLEXSUM-PRODS-ACCESSOR/CONSTRUCTORS" data-part-name="FLEXPROD-ACCESSOR/CONSTRUCTORS" data-part-args="SUM,PROD" data-part-body="FLEXPROD-REMAKER,FLEXPROD-CONSTRUCTOR,SUM,PROD,FLEXPROD-FIELD-ACCESSORS,APPEND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-ACCESSOR/CONSTRUCTORS">flexprod-accessor/constructors</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-accessor_2Fconstructors" data-sym="FLEXPROD-ACCESSOR/CONSTRUCTORS" title="(defun fty::flexprod-accessor/constructors (fty::prod fty::sum)
  (append (fty::flexprod-field-accessors fty::prod fty::sum)
          (fty::flexprod-constructor fty::prod fty::sum)
          (fty::flexprod-remaker fty::prod fty::sum)))">flexprod-accessor/constructors</a>
  (prod sum)
  (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link local-def" href="#def-flexprod-field-accessors" data-sym="FLEXPROD-FIELD-ACCESSORS" title="(defun fty::flexprod-field-accessors (fty::prod fty::sum)
  (fty::flexprod-field-acc-lst (fty::flexprod-&gt;fields fty::prod) fty::prod
   fty::sum))">flexprod-field-accessors</a> prod sum)
    (<a class="sym-link local-def" href="#def-flexprod-constructor" data-sym="FLEXPROD-CONSTRUCTOR" title="(defun fty::flexprod-constructor (fty::prod fty::sum)
  (fty::b*
   (((fty::flexsum fty::sum) fty::sum) ((fty::flexprod fty::prod) fty::prod)
    (fty::field-calls
     (fty::flexprod-fields-acc-calls fty::prod.fields fty::sum.xvar))
...">flexprod-constructor</a> prod sum)
    (<a class="sym-link local-def" href="#def-flexprod-remaker" data-sym="FLEXPROD-REMAKER" title="(defun fty::flexprod-remaker (fty::prod fty::sum)
  (fty::b*
   (((fty::flexsum fty::sum) fty::sum) ((fty::flexprod fty::prod) fty::prod)
    ((unless fty::prod.remake-name) nil)
    (fty::fieldnames (fty::flexprod-fields-&gt;names fty::prod.fields))
...">flexprod-remaker</a> prod sum)))</pre>
  </div>

<div class="form-block function" id="def-flexsum-prods-accessor_2Fconstructors" data-defines="FLEXSUM-PRODS-ACCESSOR/CONSTRUCTORS" data-references="CDR,CAR,FLEXPROD-ACCESSOR/CONSTRUCTORS,APPEND,ATOM,IF,SUM,PRODS,DEFUN" data-used-by="FLEXSUM-ACC/CTOR-EVENTS" data-part-name="FLEXSUM-PRODS-ACCESSOR/CONSTRUCTORS" data-part-args="SUM,PRODS" data-part-body="CDR,FLEXSUM-PRODS-ACCESSOR/CONSTRUCTORS,SUM,CAR,FLEXPROD-ACCESSOR/CONSTRUCTORS,APPEND,PRODS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-PRODS-ACCESSOR/CONSTRUCTORS">flexsum-prods-accessor/constructors</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-prods-accessor_2Fconstructors" data-sym="FLEXSUM-PRODS-ACCESSOR/CONSTRUCTORS" title="(defun fty::flexsum-prods-accessor/constructors (fty::prods fty::sum)
  (if (atom fty::prods)
      nil
      (append (fty::flexprod-accessor/constructors (car fty::prods) fty::sum)
              (fty::flexsum-prods-accessor/constructors (cdr fty::prods)">flexsum-prods-accessor/constructors</a>
  (prods sum)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)
    nil
    (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link local-def" href="#def-flexprod-accessor_2Fconstructors" data-sym="FLEXPROD-ACCESSOR/CONSTRUCTORS" title="(defun fty::flexprod-accessor/constructors (fty::prod fty::sum)
  (append (fty::flexprod-field-accessors fty::prod fty::sum)
          (fty::flexprod-constructor fty::prod fty::sum)
          (fty::flexprod-remaker fty::prod fty::sum)))">flexprod-accessor/constructors</a> (car prods)
        sum)
      (<a class="sym-link local-def" href="#def-flexsum-prods-accessor_2Fconstructors" data-sym="FLEXSUM-PRODS-ACCESSOR/CONSTRUCTORS" title="(defun fty::flexsum-prods-accessor/constructors (fty::prods fty::sum)
  (if (atom fty::prods)
      nil
      (append (fty::flexprod-accessor/constructors (car fty::prods) fty::sum)
              (fty::flexsum-prods-accessor/constructors (cdr fty::prods)">flexsum-prods-accessor/constructors</a> (cdr prods)
        sum))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-x-dot-fields" data-defines="FLEXPROD-X-DOT-FIELDS" data-references="CDR,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,CAR,FLEXPROD-FIELD->NAME,NAME,LET,CONS,ATOM,IF,FIELDS,XVAR,DEFUN" data-part-name="FLEXPROD-X-DOT-FIELDS" data-part-args="FIELDS,XVAR" data-part-body="CDR,FLEXPROD-X-DOT-FIELDS,XVAR,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,CAR,FLEXPROD-FIELD->NAME,NAME,LET,CONS,FIELDS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-X-DOT-FIELDS">flexprod-x-dot-fields</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-x-dot-fields" data-sym="FLEXPROD-X-DOT-FIELDS" title="(defun fty::flexprod-x-dot-fields (fty::xvar fty::fields)
  (if (atom fty::fields)
      nil
      (cons
       (let ((fty::name (fty::flexprod-field-&gt;name (car fty::fields))))
...">flexprod-x-dot-fields</a>
  (xvar fields)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fields)
    nil
    (cons (let ((name (flexprod-field-&gt;name (car fields))))
        (intern-in-package-of-symbol (cat (symbol-name xvar)
            <span class="string">"."</span>
            (symbol-name name))
          name))
      (<a class="sym-link local-def" href="#def-flexprod-x-dot-fields" data-sym="FLEXPROD-X-DOT-FIELDS" title="(defun fty::flexprod-x-dot-fields (fty::xvar fty::fields)
  (if (atom fty::fields)
      nil
      (cons
       (let ((fty::name (fty::flexprod-field-&gt;name (car fty::fields))))
...">flexprod-x-dot-fields</a> xvar (cdr fields)))))</pre>
  </div>

<div class="form-block function" id="def-flexsum-fix-redef-prod-cases" data-defines="FLEXSUM-FIX-REDEF-PROD-CASES" data-references="CDR,QUASIQUOTE,CONS,CAR,PROD,FLEXPROD,B*,ATOM,IF,XVAR,PRODS,DEFUN" data-part-name="FLEXSUM-FIX-REDEF-PROD-CASES" data-part-args="XVAR,PRODS" data-part-body="XVAR,CDR,FLEXSUM-FIX-REDEF-PROD-CASES,QUASIQUOTE,CONS,CAR,PROD,FLEXPROD,B*,PRODS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-FIX-REDEF-PROD-CASES">flexsum-fix-redef-prod-cases</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-fix-redef-prod-cases" data-sym="FLEXSUM-FIX-REDEF-PROD-CASES" title="(defun fty::flexsum-fix-redef-prod-cases (fty::prods fty::xvar)
  (if (atom fty::prods)
      nil
      (fty::b* (((fty::flexprod fty::prod) (car fty::prods)))
       (cons
...">flexsum-fix-redef-prod-cases</a>
  (prods xvar)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)
    nil
    (b* (((flexprod prod) (car prods)))
      (cons `(,FTY::PROD.KIND (,FTY::PROD.CTOR-NAME . ,(FTY::FLEXPROD-FIELDS-ACC-CALLS FTY::PROD.FIELDS FTY::XVAR)))
        (<a class="sym-link local-def" href="#def-flexsum-fix-redef-prod-cases" data-sym="FLEXSUM-FIX-REDEF-PROD-CASES" title="(defun fty::flexsum-fix-redef-prod-cases (fty::prods fty::xvar)
  (if (atom fty::prods)
      nil
      (fty::b* (((fty::flexprod fty::prod) (car fty::prods)))
       (cons
...">flexsum-fix-redef-prod-cases</a> (cdr prods)
          xvar)))))</pre>
  </div>

<div class="form-block function" id="def-flexsum-fix-redef-prod-cases-nokind" data-defines="FLEXSUM-FIX-REDEF-PROD-CASES-NOKIND" data-references="CDR,QUASIQUOTE,CONS,CAR,PROD,FLEXPROD,B*,ATOM,IF,XVAR,PRODS,DEFUN" data-part-name="FLEXSUM-FIX-REDEF-PROD-CASES-NOKIND" data-part-args="XVAR,PRODS" data-part-body="XVAR,CDR,FLEXSUM-FIX-REDEF-PROD-CASES-NOKIND,QUASIQUOTE,CONS,CAR,PROD,FLEXPROD,B*,PRODS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-FIX-REDEF-PROD-CASES-NOKIND">flexsum-fix-redef-prod-cases-nokind</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-fix-redef-prod-cases-nokind" data-sym="FLEXSUM-FIX-REDEF-PROD-CASES-NOKIND" title="(defun fty::flexsum-fix-redef-prod-cases-nokind (fty::prods fty::xvar)
  (if (atom fty::prods)
      nil
      (fty::b* (((fty::flexprod fty::prod) (car fty::prods)))
       (cons
...">flexsum-fix-redef-prod-cases-nokind</a>
  (prods xvar)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)
    nil
    (b* (((flexprod prod) (car prods)))
      (cons `(,FTY::PROD.COND (,FTY::PROD.CTOR-NAME . ,(FTY::FLEXPROD-FIELDS-ACC-CALLS FTY::PROD.FIELDS FTY::XVAR)))
        (<a class="sym-link local-def" href="#def-flexsum-fix-redef-prod-cases-nokind" data-sym="FLEXSUM-FIX-REDEF-PROD-CASES-NOKIND" title="(defun fty::flexsum-fix-redef-prod-cases-nokind (fty::prods fty::xvar)
  (if (atom fty::prods)
      nil
      (fty::b* (((fty::flexprod fty::prod) (car fty::prods)))
       (cons
...">flexsum-fix-redef-prod-cases-nokind</a> (cdr prods)
          xvar)))))</pre>
  </div>

<div class="form-block function" id="def-flextypelist-fixes" data-defines="FLEXTYPELIST-FIXES" data-references="CDR,X.FIX,CAR,X,WITH-FLEXTYPE-BINDINGS,CONS,ATOM,IF,TYPES,DEFUN" data-part-name="FLEXTYPELIST-FIXES" data-part-args="TYPES" data-part-body="CDR,FLEXTYPELIST-FIXES,X.FIX,CAR,X,WITH-FLEXTYPE-BINDINGS,CONS,TYPES,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXTYPELIST-FIXES">flextypelist-fixes</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flextypelist-fixes" data-sym="FLEXTYPELIST-FIXES" title="(defun fty::flextypelist-fixes (fty::types)
  (if (atom fty::types)
      nil
      (cons (fty::with-flextype-bindings (fty::x (car fty::types)) fty::x.fix)
            (fty::flextypelist-fixes (cdr fty::types)))))">flextypelist-fixes</a>
  (types)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> types)
    nil
    (cons (with-flextype-bindings (x (car types))
        x.fix)
      (<a class="sym-link local-def" href="#def-flextypelist-fixes" data-sym="FLEXTYPELIST-FIXES" title="(defun fty::flextypelist-fixes (fty::types)
  (if (atom fty::types)
      nil
      (cons (fty::with-flextype-bindings (fty::x (car fty::types)) fty::x.fix)
            (fty::flextypelist-fixes (cdr fty::types)))))">flextypelist-fixes</a> (cdr types)))))</pre>
  </div>

<div class="form-block function" id="def-flexsum-acc_2Fctor-events" data-defines="FLEXSUM-ACC/CTOR-EVENTS" data-references="QUOTE,STABLE-UNDER-SIMPLIFICATIONP,AND,E/D,EQUAL,DEFTHMD,QUASIQUOTE,SUM.PRODS,FLEXSUM-PRODS-ACCESSOR/CONSTRUCTORS,APPEND,SUM.FIX,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,FOO-FIX-REDEF,FLEXSUM,B*,IGNORABLE,DECLARE,TYPES,SUM,DEFUN" data-used-by="FLEXTYPES-SUM-ACCESSOR/CONSTRUCTORS" data-part-name="FLEXSUM-ACC/CTOR-EVENTS" data-part-args="TYPES,SUM" data-part-declare="TYPES,IGNORABLE,DECLARE" data-part-body="QUOTE,STABLE-UNDER-SIMPLIFICATIONP,AND,E/D,EQUAL,DEFTHMD,QUASIQUOTE,SUM.PRODS,FLEXSUM-PRODS-ACCESSOR/CONSTRUCTORS,APPEND,SUM.FIX,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,FOO-FIX-REDEF,SUM,FLEXSUM,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-ACC/CTOR-EVENTS">flexsum-acc/ctor-events</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-acc_2Fctor-events" data-sym="FLEXSUM-ACC/CTOR-EVENTS" title="(defun fty::flexsum-acc/ctor-events (fty::sum fty::types)
  (declare (ignorable fty::types))
  (fty::b*
   (((fty::flexsum fty::sum) fty::sum)
    (fty::foo-fix-redef
...">flexsum-acc/ctor-events</a>
  (sum types)
  (declare (ignorable types))
  (b* (((flexsum sum) sum) (foo-fix-redef (intern-in-package-of-symbol (cat (symbol-name sum.fix) <span class="string">"-REDEF"</span>)
          sum.fix)))
    (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link local-def" href="#def-flexsum-prods-accessor_2Fconstructors" data-sym="FLEXSUM-PRODS-ACCESSOR/CONSTRUCTORS" title="(defun fty::flexsum-prods-accessor/constructors (fty::prods fty::sum)
  (if (atom fty::prods)
      nil
      (append (fty::flexprod-accessor/constructors (car fty::prods) fty::sum)
              (fty::flexsum-prods-accessor/constructors (cdr fty::prods)">flexsum-prods-accessor/constructors</a> sum.prods
        sum)
      `((<a class="sym-link system" href="../../../axioms.html#def-defthmd" data-sym="DEFTHMD">defthmd</a> ,FTY::FOO-FIX-REDEF
         (equal (,FTY::SUM.FIX ,FTY::SUM.XVAR)
           ,(IF FTY::SUM.KIND
     `(CASE (,FTY::SUM.KIND ,FTY::SUM.XVAR)
        . ,(FTY::FLEXSUM-FIX-REDEF-PROD-CASES FTY::SUM.PRODS FTY::SUM.XVAR))
     (FTY::NICE-COND
      (FTY::FLEXSUM-FIX-REDEF-PROD-CASES-NOKIND FTY::SUM.PRODS FTY::SUM.XVAR))))
         <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (<a class="sym-link system" href="../../../axioms.html#def-e_2Fd" data-sym="E/D">e/d</a> ,(AND FTY::SUM.KIND
      (LIST
       (FTY::INTERN-IN-PACKAGE-OF-SYMBOL
        (FTY::CAT (SYMBOL-NAME FTY::SUM.KIND) &quot;-POSSIBILITIES&quot;) FTY::SUM.KIND)))
              ,(FTY::FLEXSUM-FNS FTY::SUM))) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp
             '(<span class="keyword">:expand</span> (,FTY::SUM.FIX ,FTY::SUM.XVAR))))
         <span class="keyword">:rule-classes</span> <span class="keyword">:definition</span>)))))</pre>
  </div>

<div class="form-block function" id="def-flextypes-sum-accessor_2Fconstructors" data-defines="FLEXTYPES-SUM-ACCESSOR/CONSTRUCTORS" data-references="CDR,FLEXSUM-ACC/CTOR-EVENTS,CAR,TAG,EQ,AND,APPEND,ATOM,IF,ALLTYPES,TYPES,DEFUN" data-part-name="FLEXTYPES-SUM-ACCESSOR/CONSTRUCTORS" data-part-args="ALLTYPES,TYPES" data-part-body="CDR,FLEXTYPES-SUM-ACCESSOR/CONSTRUCTORS,ALLTYPES,FLEXSUM-ACC/CTOR-EVENTS,CAR,TAG,EQ,AND,APPEND,TYPES,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXTYPES-SUM-ACCESSOR/CONSTRUCTORS">flextypes-sum-accessor/constructors</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flextypes-sum-accessor_2Fconstructors" data-sym="FLEXTYPES-SUM-ACCESSOR/CONSTRUCTORS" title="(defun fty::flextypes-sum-accessor/constructors (fty::types fty::alltypes)
  (if (atom fty::types)
      nil
      (append
       (and (eq (fty::tag (car fty::types)) :sum)
...">flextypes-sum-accessor/constructors</a>
  (types alltypes)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> types)
    nil
    (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (tag (car types)) <span class="keyword">:sum</span>)
        (<a class="sym-link local-def" href="#def-flexsum-acc_2Fctor-events" data-sym="FLEXSUM-ACC/CTOR-EVENTS" title="(defun fty::flexsum-acc/ctor-events (fty::sum fty::types)
  (declare (ignorable fty::types))
  (fty::b*
   (((fty::flexsum fty::sum) fty::sum)
    (fty::foo-fix-redef
...">flexsum-acc/ctor-events</a> (car types)
          alltypes))
      (<a class="sym-link local-def" href="#def-flextypes-sum-accessor_2Fconstructors" data-sym="FLEXTYPES-SUM-ACCESSOR/CONSTRUCTORS" title="(defun fty::flextypes-sum-accessor/constructors (fty::types fty::alltypes)
  (if (atom fty::types)
      nil
      (append
       (and (eq (fty::tag (car fty::types)) :sum)
...">flextypes-sum-accessor/constructors</a> (cdr types)
        alltypes))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-field-count" data-defines="FLEXPROD-FIELD-COUNT" data-references="QUASIQUOTE,FLEXTYPES-FIND-COUNT-FOR-PRED,TYPE-COUNT,X.TYPE,UNLESS,FLEXPROD-FIELD,B*,TYPES,XVAR,X,DEFUN" data-used-by="FLEXPROD-FIELD-COUNTS" data-part-name="FLEXPROD-FIELD-COUNT" data-part-args="TYPES,XVAR,X" data-part-body="QUASIQUOTE,TYPES,FLEXTYPES-FIND-COUNT-FOR-PRED,TYPE-COUNT,X.TYPE,UNLESS,X,FLEXPROD-FIELD,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELD-COUNT">flexprod-field-count</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-field-count" data-sym="FLEXPROD-FIELD-COUNT" title="(defun fty::flexprod-field-count (fty::x fty::xvar fty::types)
  (fty::b*
   (((fty::flexprod-field fty::x) fty::x) ((unless fty::x.type) nil)
    (fty::type-count
     (fty::flextypes-find-count-for-pred fty::x.type fty::types))
...">flexprod-field-count</a>
  (x xvar types)
  (b* (((flexprod-field x) x) ((unless x.type) nil)
      (type-count (flextypes-find-count-for-pred x.type types))
      ((unless type-count) nil))
    `((,FTY::TYPE-COUNT (,FTY::X.ACC-NAME ,FTY::XVAR)))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-field-counts" data-defines="FLEXPROD-FIELD-COUNTS" data-references="CDR,CAR,FLEXPROD-FIELD-COUNT,APPEND,ATOM,IF,TYPES,XVAR,FIELDS,DEFUN" data-used-by="FLEXSUM-PROD-COUNTS-NOKIND,FLEXSUM-PROD-COUNTS" data-part-name="FLEXPROD-FIELD-COUNTS" data-part-args="TYPES,XVAR,FIELDS" data-part-body="CDR,FLEXPROD-FIELD-COUNTS,TYPES,XVAR,CAR,FLEXPROD-FIELD-COUNT,APPEND,FIELDS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELD-COUNTS">flexprod-field-counts</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-field-counts" data-sym="FLEXPROD-FIELD-COUNTS" title="(defun fty::flexprod-field-counts (fty::fields fty::xvar fty::types)
  (if (atom fty::fields)
      nil
      (append
       (fty::flexprod-field-count (car fty::fields) fty::xvar fty::types)">flexprod-field-counts</a>
  (fields xvar types)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fields)
    nil
    (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link local-def" href="#def-flexprod-field-count" data-sym="FLEXPROD-FIELD-COUNT" title="(defun fty::flexprod-field-count (fty::x fty::xvar fty::types)
  (fty::b*
   (((fty::flexprod-field fty::x) fty::x) ((unless fty::x.type) nil)
    (fty::type-count
     (fty::flextypes-find-count-for-pred fty::x.type fty::types))
...">flexprod-field-count</a> (car fields)
        xvar
        types)
      (<a class="sym-link local-def" href="#def-flexprod-field-counts" data-sym="FLEXPROD-FIELD-COUNTS" title="(defun fty::flexprod-field-counts (fty::fields fty::xvar fty::types)
  (if (atom fty::fields)
      nil
      (append
       (fty::flexprod-field-count (car fty::fields) fty::xvar fty::types)">flexprod-field-counts</a> (cdr fields)
        xvar
        types))))</pre>
  </div>

<div class="form-block function" id="def-flexsum-prod-counts" data-defines="FLEXSUM-PROD-COUNTS" data-references="CDR,CONS,X.COUNT-INCR,+,QUASIQUOTE,IF,COUNT,X.FIELDS,FLEXPROD-FIELD-COUNTS,FIELDCOUNTS,CAR,X,FLEXPROD,ATOM,WHEN,B*,TYPES,XVAR,PRODS,DEFUN" data-part-name="FLEXSUM-PROD-COUNTS" data-part-args="TYPES,XVAR,PRODS" data-part-body="CDR,FLEXSUM-PROD-COUNTS,CONS,X.COUNT-INCR,+,QUASIQUOTE,IF,COUNT,TYPES,XVAR,X.FIELDS,FLEXPROD-FIELD-COUNTS,FIELDCOUNTS,CAR,X,FLEXPROD,PRODS,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-PROD-COUNTS">flexsum-prod-counts</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-prod-counts" data-sym="FLEXSUM-PROD-COUNTS" title="(defun fty::flexsum-prod-counts (fty::prods fty::xvar fty::types)
  (fty::b*
   (((when (atom fty::prods)) nil) ((fty::flexprod fty::x) (car fty::prods))
    (fty::fieldcounts
     (fty::flexprod-field-counts fty::x.fields fty::xvar fty::types))
...">flexsum-prod-counts</a>
  (prods xvar types)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)) nil) ((flexprod x) (car prods))
      (fieldcounts (<a class="sym-link local-def" href="#def-flexprod-field-counts" data-sym="FLEXPROD-FIELD-COUNTS" title="(defun fty::flexprod-field-counts (fty::fields fty::xvar fty::types)
  (if (atom fty::fields)
      nil
      (append
       (fty::flexprod-field-count (car fty::fields) fty::xvar fty::types)">flexprod-field-counts</a> x.fields
          xvar
          types))
      (<a class="sym-link system" href="../../../axioms.html#def-count" data-sym="COUNT">count</a> (if fieldcounts
          `(<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> ,(+ 1 (FTY::LEN FTY::X.FIELDS)) . ,FTY::FIELDCOUNTS)
          <span class="number">1</span>))
      (<a class="sym-link system" href="../../../axioms.html#def-count" data-sym="COUNT">count</a> (if x.count-incr
          `(<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> ,(IF (FTY::NATP FTY::X.COUNT-INCR)
     FTY::X.COUNT-INCR
     1)
            ,COUNT)
          <a class="sym-link system" href="../../../axioms.html#def-count" data-sym="COUNT">count</a>)))
    (cons `(,FTY::X.KIND ,COUNT)
      (<a class="sym-link local-def" href="#def-flexsum-prod-counts" data-sym="FLEXSUM-PROD-COUNTS" title="(defun fty::flexsum-prod-counts (fty::prods fty::xvar fty::types)
  (fty::b*
   (((when (atom fty::prods)) nil) ((fty::flexprod fty::x) (car fty::prods))
    (fty::fieldcounts
     (fty::flexprod-field-counts fty::x.fields fty::xvar fty::types))
...">flexsum-prod-counts</a> (cdr prods)
        xvar
        types))))</pre>
  </div>

<div class="form-block function" id="def-flexsum-prod-counts-nokind" data-defines="FLEXSUM-PROD-COUNTS-NOKIND" data-references="CDR,CONS,X.COUNT-INCR,+,QUASIQUOTE,IF,PRODCOUNT,X.FIELDS,FLEXPROD-FIELD-COUNTS,FIELDCOUNTS,CAR,X,FLEXPROD,ATOM,WHEN,B*,TYPES,XVAR,PRODS,DEFUN" data-part-name="FLEXSUM-PROD-COUNTS-NOKIND" data-part-args="TYPES,XVAR,PRODS" data-part-body="CDR,FLEXSUM-PROD-COUNTS-NOKIND,CONS,X.COUNT-INCR,+,QUASIQUOTE,IF,PRODCOUNT,TYPES,XVAR,X.FIELDS,FLEXPROD-FIELD-COUNTS,FIELDCOUNTS,CAR,X,FLEXPROD,PRODS,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-PROD-COUNTS-NOKIND">flexsum-prod-counts-nokind</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-prod-counts-nokind" data-sym="FLEXSUM-PROD-COUNTS-NOKIND" title="(defun fty::flexsum-prod-counts-nokind (fty::prods fty::xvar fty::types)
  (fty::b*
   (((when (atom fty::prods)) nil) ((fty::flexprod fty::x) (car fty::prods))
    (fty::fieldcounts
     (fty::flexprod-field-counts fty::x.fields fty::xvar fty::types))
...">flexsum-prod-counts-nokind</a>
  (prods xvar types)
  (b* (((when (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)) nil) ((flexprod x) (car prods))
      (fieldcounts (<a class="sym-link local-def" href="#def-flexprod-field-counts" data-sym="FLEXPROD-FIELD-COUNTS" title="(defun fty::flexprod-field-counts (fty::fields fty::xvar fty::types)
  (if (atom fty::fields)
      nil
      (append
       (fty::flexprod-field-count (car fty::fields) fty::xvar fty::types)">flexprod-field-counts</a> x.fields
          xvar
          types))
      (prodcount (if fieldcounts
          `(<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> ,(+ 1 (FTY::LEN FTY::X.FIELDS)) . ,FTY::FIELDCOUNTS)
          <span class="number">1</span>))
      (prodcount (if x.count-incr
          `(<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> ,(IF (FTY::NATP FTY::X.COUNT-INCR)
     FTY::X.COUNT-INCR
     1)
            ,FTY::PRODCOUNT)
          prodcount)))
    (cons `(,FTY::X.COND ,FTY::PRODCOUNT)
      (<a class="sym-link local-def" href="#def-flexsum-prod-counts-nokind" data-sym="FLEXSUM-PROD-COUNTS-NOKIND" title="(defun fty::flexsum-prod-counts-nokind (fty::prods fty::xvar fty::types)
  (fty::b*
   (((when (atom fty::prods)) nil) ((fty::flexprod fty::x) (car fty::prods))
    (fty::fieldcounts
     (fty::flexprod-field-counts fty::x.fields fty::xvar fty::types))
...">flexsum-prod-counts-nokind</a> (cdr prods)
        xvar
        types))))</pre>
  </div>

<div class="form-block function" id="def-flexsum-count" data-defines="FLEXSUM-COUNT" data-references="T,LET,E/D,QUOTE,NATP,COUNT,DEFINE,QUASIQUOTE,X.NAME,FULL-ESCAPE-SYMBOL,CAT,SHORT,X.COUNT,UNLESS,FLEXSUM,B*,TYPES,X,DEFUN" data-part-name="FLEXSUM-COUNT" data-part-args="TYPES,X" data-part-body="T,LET,E/D,QUOTE,NATP,COUNT,DEFINE,QUASIQUOTE,X.NAME,FULL-ESCAPE-SYMBOL,CAT,SHORT,X.COUNT,UNLESS,X,FLEXSUM,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-COUNT">flexsum-count</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-count" data-sym="FLEXSUM-COUNT" title="(defun fty::flexsum-count (fty::x fty::types)
  (fty::b*
   (((fty::flexsum fty::x) fty::x) ((unless fty::x.count) nil)
    (fty::short
     (fty::cat &quot;Measure for recurring over @(see &quot;
...">flexsum-count</a>
  (x types)
  (b* (((flexsum x) x) ((unless x.count) nil)
      (short (cat <span class="string">"Measure for recurring over @(see "</span>
          (full-escape-symbol x.name)
          <span class="string">") structures."</span>)))
    `((define ,FTY::X.COUNT
       ((,FTY::X.XVAR ,FTY::X.PRED))
       <span class="keyword">:parents</span> (,FTY::X.NAME)
       <span class="keyword">:short</span> ,FTY::SHORT
       <span class="keyword">:verify-guards</span> nil
       <span class="keyword">:returns</span> (<a class="sym-link system" href="../../../axioms.html#def-count" data-sym="COUNT">count</a> <a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a>
         <span class="keyword">:rule-classes</span> <span class="keyword">:type-prescription</span> <span class="keyword">:hints</span> ('(<span class="keyword">:expand</span> (,FTY::X.COUNT ,FTY::X.XVAR)
            <span class="keyword">:in-theory</span> (<a class="sym-link system" href="../../../axioms.html#def-e_2Fd" data-sym="E/D">e/d</a> ,(AND FTY::X.KIND
      (LIST
       (FTY::INTERN-IN-PACKAGE-OF-SYMBOL
        (FTY::CAT (SYMBOL-NAME FTY::X.KIND) &quot;-POSSIBILITIES&quot;) FTY::X.KIND)))
              (,FTY::X.COUNT . ,(FTY::FLEXSUM-PROD-FNS FTY::X.PRODS))))))
       <span class="keyword">:measure</span> (let ((,FTY::X.XVAR (,FTY::X.FIX ,FTY::X.XVAR)))
         ,FTY::X.MEASURE)
       ,@(AND (FTY::GETARG :MEASURE-DEBUG NIL FTY::X.KWD-ALIST) `(:MEASURE-DEBUG T))
       <span class="keyword">:progn</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>
       ,(IF FTY::X.KIND
     `(CASE (,FTY::X.KIND ,FTY::X.XVAR)
        . ,(FTY::FLEXSUM-PROD-COUNTS FTY::X.PRODS FTY::X.XVAR FTY::TYPES))
     (FTY::NICE-COND
      (FTY::FLEXSUM-PROD-COUNTS-NOKIND FTY::X.PRODS FTY::X.XVAR FTY::TYPES)))))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-field-count-thm" data-defines="FLEXPROD-FIELD-COUNT-THM" data-references="DISABLE,DEFTHM,QUASIQUOTE,X.ACC-NAME,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,BAR-COUNT-OF-FOO->BAR,FLEXSUM,FLEXPROD,FLEXTYPES-FIND-COUNT-FOR-PRED,TYPE-COUNT,X.TYPE,UNLESS,FLEXPROD-FIELD,B*,TYPES,SUM,PROD,X,DEFUN" data-used-by="FLEXPROD-FIELD-COUNT-THMS" data-part-name="FLEXPROD-FIELD-COUNT-THM" data-part-args="TYPES,SUM,PROD,X" data-part-body="DISABLE,DEFTHM,QUASIQUOTE,X.ACC-NAME,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,BAR-COUNT-OF-FOO->BAR,SUM,FLEXSUM,PROD,FLEXPROD,TYPES,FLEXTYPES-FIND-COUNT-FOR-PRED,TYPE-COUNT,X.TYPE,UNLESS,X,FLEXPROD-FIELD,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELD-COUNT-THM">flexprod-field-count-thm</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-field-count-thm" data-sym="FLEXPROD-FIELD-COUNT-THM" title="(defun fty::flexprod-field-count-thm (fty::x fty::prod fty::sum fty::types)
  (fty::b*
   (((fty::flexprod-field fty::x) fty::x) ((unless fty::x.type) nil)
    (fty::type-count
     (fty::flextypes-find-count-for-pred fty::x.type fty::types))
...">flexprod-field-count-thm</a>
  (x prod sum types)
  (b* (((flexprod-field x) x) ((unless x.type) nil)
      (type-count (flextypes-find-count-for-pred x.type types))
      ((unless type-count) nil)
      ((flexprod prod) prod)
      ((flexsum sum) sum)
      (bar-count-of-foo-&gt;bar (intern-in-package-of-symbol (cat (symbol-name type-count)
            <span class="string">"-OF-"</span>
            (symbol-name x.acc-name))
          x.acc-name)))
    `((<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,FTY::BAR-COUNT-OF-FOO-&gt;BAR
       ,(FTY::NICE-IMPLIES FTY::PROD.GUARD
  `(&lt; (,FTY::TYPE-COUNT (,FTY::X.ACC-NAME ,FTY::SUM.XVAR))
      (,FTY::SUM.COUNT ,FTY::SUM.XVAR)))
       <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:in-theory</span> (disable ,FTY::TYPE-COUNT
            ,FTY::X.ACC-NAME
            ,FTY::SUM.COUNT . ,(AND FTY::SUM.KIND `(,FTY::SUM.KIND)))
          <span class="keyword">:expand</span> ((,FTY::SUM.COUNT ,FTY::SUM.XVAR))))
       <span class="keyword">:rule-classes</span> <span class="keyword">:linear</span>))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-field-count-thms" data-defines="FLEXPROD-FIELD-COUNT-THMS" data-references="CDR,CAR,FLEXPROD-FIELD-COUNT-THM,APPEND,ATOM,IF,TYPES,SUM,PROD,FIELDS,DEFUN" data-used-by="FLEXSUM-PROD-COUNT-THMS" data-part-name="FLEXPROD-FIELD-COUNT-THMS" data-part-args="TYPES,SUM,PROD,FIELDS" data-part-body="CDR,FLEXPROD-FIELD-COUNT-THMS,TYPES,SUM,PROD,CAR,FLEXPROD-FIELD-COUNT-THM,APPEND,FIELDS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELD-COUNT-THMS">flexprod-field-count-thms</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-field-count-thms" data-sym="FLEXPROD-FIELD-COUNT-THMS" title="(defun fty::flexprod-field-count-thms
       (fty::fields fty::prod fty::sum fty::types)
  (if (atom fty::fields)
      nil
      (append
...">flexprod-field-count-thms</a>
  (fields prod sum types)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fields)
    nil
    (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link local-def" href="#def-flexprod-field-count-thm" data-sym="FLEXPROD-FIELD-COUNT-THM" title="(defun fty::flexprod-field-count-thm (fty::x fty::prod fty::sum fty::types)
  (fty::b*
   (((fty::flexprod-field fty::x) fty::x) ((unless fty::x.type) nil)
    (fty::type-count
     (fty::flextypes-find-count-for-pred fty::x.type fty::types))
...">flexprod-field-count-thm</a> (car fields)
        prod
        sum
        types)
      (<a class="sym-link local-def" href="#def-flexprod-field-count-thms" data-sym="FLEXPROD-FIELD-COUNT-THMS" title="(defun fty::flexprod-field-count-thms
       (fty::fields fty::prod fty::sum fty::types)
  (if (atom fty::fields)
      nil
      (append
...">flexprod-field-count-thms</a> (cdr fields)
        prod
        sum
        types))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-field-count-var" data-defines="FLEXPROD-FIELD-COUNT-VAR" data-references="QUASIQUOTE,FLEXTYPES-FIND-COUNT-FOR-PRED,TYPE-COUNT,X.TYPE,UNLESS,FLEXPROD-FIELD,B*,TYPES,X,DEFUN" data-used-by="FLEXPROD-FIELD-COUNTS-VARS" data-part-name="FLEXPROD-FIELD-COUNT-VAR" data-part-args="TYPES,X" data-part-body="QUASIQUOTE,TYPES,FLEXTYPES-FIND-COUNT-FOR-PRED,TYPE-COUNT,X.TYPE,UNLESS,X,FLEXPROD-FIELD,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELD-COUNT-VAR">flexprod-field-count-var</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-field-count-var" data-sym="FLEXPROD-FIELD-COUNT-VAR" title="(defun fty::flexprod-field-count-var (fty::x fty::types)
  (fty::b*
   (((fty::flexprod-field fty::x) fty::x) ((unless fty::x.type) nil)
    (fty::type-count
     (fty::flextypes-find-count-for-pred fty::x.type fty::types))
...">flexprod-field-count-var</a>
  (x types)
  (b* (((flexprod-field x) x) ((unless x.type) nil)
      (type-count (flextypes-find-count-for-pred x.type types))
      ((unless type-count) nil))
    `((,FTY::TYPE-COUNT ,FTY::X.NAME))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-field-counts-vars" data-defines="FLEXPROD-FIELD-COUNTS-VARS" data-references="CDR,CAR,FLEXPROD-FIELD-COUNT-VAR,APPEND,ATOM,IF,TYPES,FIELDS,DEFUN" data-used-by="FLEXPROD-CTOR-COUNT-THM" data-part-name="FLEXPROD-FIELD-COUNTS-VARS" data-part-args="TYPES,FIELDS" data-part-body="CDR,FLEXPROD-FIELD-COUNTS-VARS,TYPES,CAR,FLEXPROD-FIELD-COUNT-VAR,APPEND,FIELDS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELD-COUNTS-VARS">flexprod-field-counts-vars</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-field-counts-vars" data-sym="FLEXPROD-FIELD-COUNTS-VARS" title="(defun fty::flexprod-field-counts-vars (fty::fields fty::types)
  (if (atom fty::fields)
      nil
      (append (fty::flexprod-field-count-var (car fty::fields) fty::types)
              (fty::flexprod-field-counts-vars (cdr fty::fields) fty::types))))">flexprod-field-counts-vars</a>
  (fields types)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fields)
    nil
    (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link local-def" href="#def-flexprod-field-count-var" data-sym="FLEXPROD-FIELD-COUNT-VAR" title="(defun fty::flexprod-field-count-var (fty::x fty::types)
  (fty::b*
   (((fty::flexprod-field fty::x) fty::x) ((unless fty::x.type) nil)
    (fty::type-count
     (fty::flextypes-find-count-for-pred fty::x.type fty::types))
...">flexprod-field-count-var</a> (car fields) types)
      (<a class="sym-link local-def" href="#def-flexprod-field-counts-vars" data-sym="FLEXPROD-FIELD-COUNTS-VARS" title="(defun fty::flexprod-field-counts-vars (fty::fields fty::types)
  (if (atom fty::fields)
      nil
      (append (fty::flexprod-field-count-var (car fty::fields) fty::types)
              (fty::flexprod-field-counts-vars (cdr fty::fields) fty::types))))">flexprod-field-counts-vars</a> (cdr fields)
        types))))</pre>
  </div>

<div class="form-block function" id="def-flexprod-ctor-count-thm" data-defines="FLEXPROD-CTOR-COUNT-THM" data-references="DEFTHM,X.CTOR-NAME,SUM.COUNT,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,FOO-COUNT-OF-FOO,+,<,QUASIQUOTE,BODY,NOT,WHEN,X.FIELDS,FLEXPROD-FIELD-COUNTS-VARS,FIELD-COUNTS,FLEXPROD-CTOR-CALL,CALL,FLEXSUM,X,FLEXPROD,B*,TYPES,SUM,PROD,DEFUN" data-used-by="FLEXSUM-PROD-COUNT-THMS" data-part-name="FLEXPROD-CTOR-COUNT-THM" data-part-args="TYPES,SUM,PROD" data-part-body="DEFTHM,X.CTOR-NAME,SUM.COUNT,SYMBOL-NAME,CAT,INTERN-IN-PACKAGE-OF-SYMBOL,FOO-COUNT-OF-FOO,+,<,QUASIQUOTE,BODY,NOT,WHEN,TYPES,X.FIELDS,FLEXPROD-FIELD-COUNTS-VARS,FIELD-COUNTS,FLEXPROD-CTOR-CALL,CALL,SUM,FLEXSUM,PROD,X,FLEXPROD,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-CTOR-COUNT-THM">flexprod-ctor-count-thm</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-ctor-count-thm" data-sym="FLEXPROD-CTOR-COUNT-THM" title="(defun fty::flexprod-ctor-count-thm (fty::prod fty::sum fty::types)
  (fty::b*
   (((fty::flexprod fty::x) fty::prod) ((fty::flexsum fty::sum) fty::sum)
    (fty::call (fty::flexprod-ctor-call fty::prod))
    (fty::field-counts
...">flexprod-ctor-count-thm</a>
  (prod sum types)
  (b* (((flexprod x) prod) ((flexsum sum) sum)
      (call (<a class="sym-link local-def" href="#def-flexprod-ctor-call" data-sym="FLEXPROD-CTOR-CALL" title="(defun fty::flexprod-ctor-call (fty::prod)
  (fty::b* (((fty::flexprod fty::prod) fty::prod))
   (cons fty::prod.ctor-name (fty::flexprod-fields-&gt;names fty::prod.fields))))">flexprod-ctor-call</a> prod))
      (field-counts (<a class="sym-link local-def" href="#def-flexprod-field-counts-vars" data-sym="FLEXPROD-FIELD-COUNTS-VARS" title="(defun fty::flexprod-field-counts-vars (fty::fields fty::types)
  (if (atom fty::fields)
      nil
      (append (fty::flexprod-field-count-var (car fty::fields) fty::types)
              (fty::flexprod-field-counts-vars (cdr fty::fields) fty::types))))">flexprod-field-counts-vars</a> x.fields types))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> field-counts)) nil)
      (<a class="sym-link system" href="../../../basis-b.html#def-body" data-sym="BODY">body</a> `(&lt; (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> . ,FTY::FIELD-COUNTS) (,FTY::SUM.COUNT ,FTY::CALL)))
      (foo-count-of-foo (intern-in-package-of-symbol (cat (symbol-name sum.count)
            <span class="string">"-OF-"</span>
            (symbol-name x.ctor-name))
          sum.count)))
    `((<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,FTY::FOO-COUNT-OF-FOO
       ,(IF FTY::X.REQUIRE
     `(FTY::IMPLIES ,FTY::X.REQUIRE ,FTY::BODY)
     FTY::BODY)
       <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:expand</span> ((,FTY::SUM.COUNT ,FTY::CALL))))
       <span class="keyword">:rule-classes</span> <span class="keyword">:linear</span>))))</pre>
  </div>

<div class="form-block function" id="def-flexsum-prod-count-thms" data-defines="FLEXSUM-PROD-COUNT-THMS" data-references="CDR,FLEXPROD->FIELDS,FLEXPROD-FIELD-COUNT-THMS,CAR,FLEXPROD-CTOR-COUNT-THM,APPEND,ATOM,IF,TYPES,SUM,PRODS,DEFUN" data-used-by="FLEXSUM-COUNT-POST-EVENTS" data-part-name="FLEXSUM-PROD-COUNT-THMS" data-part-args="TYPES,SUM,PRODS" data-part-body="CDR,FLEXSUM-PROD-COUNT-THMS,FLEXPROD->FIELDS,FLEXPROD-FIELD-COUNT-THMS,TYPES,SUM,CAR,FLEXPROD-CTOR-COUNT-THM,APPEND,PRODS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-PROD-COUNT-THMS">flexsum-prod-count-thms</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-prod-count-thms" data-sym="FLEXSUM-PROD-COUNT-THMS" title="(defun fty::flexsum-prod-count-thms (fty::prods fty::sum fty::types)
  (if (atom fty::prods)
      nil
      (append
       (fty::flexprod-ctor-count-thm (car fty::prods) fty::sum fty::types)
...">flexsum-prod-count-thms</a>
  (prods sum types)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)
    nil
    (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link local-def" href="#def-flexprod-ctor-count-thm" data-sym="FLEXPROD-CTOR-COUNT-THM" title="(defun fty::flexprod-ctor-count-thm (fty::prod fty::sum fty::types)
  (fty::b*
   (((fty::flexprod fty::x) fty::prod) ((fty::flexsum fty::sum) fty::sum)
    (fty::call (fty::flexprod-ctor-call fty::prod))
    (fty::field-counts
...">flexprod-ctor-count-thm</a> (car prods)
        sum
        types)
      (<a class="sym-link local-def" href="#def-flexprod-field-count-thms" data-sym="FLEXPROD-FIELD-COUNT-THMS" title="(defun fty::flexprod-field-count-thms
       (fty::fields fty::prod fty::sum fty::types)
  (if (atom fty::fields)
      nil
      (append
...">flexprod-field-count-thms</a> (flexprod-&gt;fields (car prods))
        (car prods)
        sum
        types)
      (<a class="sym-link local-def" href="#def-flexsum-prod-count-thms" data-sym="FLEXSUM-PROD-COUNT-THMS" title="(defun fty::flexsum-prod-count-thms (fty::prods fty::sum fty::types)
  (if (atom fty::prods)
      nil
      (append
       (fty::flexprod-ctor-count-thm (car fty::prods) fty::sum fty::types)
...">flexsum-prod-count-thms</a> (cdr prods)
        sum
        types))))</pre>
  </div>

<div class="form-block function" id="def-flexsum-count-post-events" data-defines="FLEXSUM-COUNT-POST-EVENTS" data-references="X.PRODS,FLEXSUM-PROD-COUNT-THMS,X.COUNT,UNLESS,FLEXSUM,B*,ALLTYPES,X,DEFUN" data-part-name="FLEXSUM-COUNT-POST-EVENTS" data-part-args="ALLTYPES,X" data-part-body="ALLTYPES,X.PRODS,FLEXSUM-PROD-COUNT-THMS,X.COUNT,UNLESS,X,FLEXSUM,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-COUNT-POST-EVENTS">flexsum-count-post-events</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-count-post-events" data-sym="FLEXSUM-COUNT-POST-EVENTS" title="(defun fty::flexsum-count-post-events (fty::x fty::alltypes)
  (fty::b* (((fty::flexsum fty::x) fty::x) ((unless fty::x.count) nil))
   (fty::flexsum-prod-count-thms fty::x.prods fty::x fty::alltypes)))">flexsum-count-post-events</a>
  (x alltypes)
  (b* (((flexsum x) x) ((unless x.count) nil))
    (<a class="sym-link local-def" href="#def-flexsum-prod-count-thms" data-sym="FLEXSUM-PROD-COUNT-THMS" title="(defun fty::flexsum-prod-count-thms (fty::prods fty::sum fty::types)
  (if (atom fty::prods)
      nil
      (append
       (fty::flexprod-ctor-count-thm (car fty::prods) fty::sum fty::types)
...">flexsum-prod-count-thms</a> x.prods
      x
      alltypes)))</pre>
  </div>

<div class="form-block function" id="def-flexprod-fields-collect-fix_2Fpred-pairs" data-defines="FLEXPROD-FIELDS-COLLECT-FIX/PRED-PAIRS" data-references="CDR,CONS,X.TYPE,X.FIX,AND,CAR,X,FLEXPROD-FIELD,B*,ATOM,IF,FIELDS,DEFUN" data-used-by="FLEXPRODS-COLLECT-FIX/PRED-PAIRS" data-part-name="FLEXPROD-FIELDS-COLLECT-FIX/PRED-PAIRS" data-part-args="FIELDS" data-part-body="CDR,FLEXPROD-FIELDS-COLLECT-FIX/PRED-PAIRS,CONS,X.TYPE,X.FIX,AND,CAR,X,FLEXPROD-FIELD,B*,FIELDS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPROD-FIELDS-COLLECT-FIX/PRED-PAIRS">flexprod-fields-collect-fix/pred-pairs</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprod-fields-collect-fix_2Fpred-pairs" data-sym="FLEXPROD-FIELDS-COLLECT-FIX/PRED-PAIRS" title="(defun fty::flexprod-fields-collect-fix/pred-pairs (fty::fields)
  (if (atom fty::fields)
      nil
      (fty::b* (((fty::flexprod-field fty::x) (car fty::fields)))
       (if (and fty::x.fix fty::x.type)
...">flexprod-fields-collect-fix/pred-pairs</a>
  (fields)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> fields)
    nil
    (b* (((flexprod-field x) (car fields)))
      (if (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> x.fix x.type)
        (cons (cons x.fix x.type)
          (<a class="sym-link local-def" href="#def-flexprod-fields-collect-fix_2Fpred-pairs" data-sym="FLEXPROD-FIELDS-COLLECT-FIX/PRED-PAIRS" title="(defun fty::flexprod-fields-collect-fix/pred-pairs (fty::fields)
  (if (atom fty::fields)
      nil
      (fty::b* (((fty::flexprod-field fty::x) (car fty::fields)))
       (if (and fty::x.fix fty::x.type)
...">flexprod-fields-collect-fix/pred-pairs</a> (cdr fields)))
        (<a class="sym-link local-def" href="#def-flexprod-fields-collect-fix_2Fpred-pairs" data-sym="FLEXPROD-FIELDS-COLLECT-FIX/PRED-PAIRS" title="(defun fty::flexprod-fields-collect-fix/pred-pairs (fty::fields)
  (if (atom fty::fields)
      nil
      (fty::b* (((fty::flexprod-field fty::x) (car fty::fields)))
       (if (and fty::x.fix fty::x.type)
...">flexprod-fields-collect-fix/pred-pairs</a> (cdr fields))))))</pre>
  </div>

<div class="form-block function" id="def-flexprods-collect-fix_2Fpred-pairs" data-defines="FLEXPRODS-COLLECT-FIX/PRED-PAIRS" data-references="CDR,CAR,FLEXPROD->FIELDS,FLEXPROD-FIELDS-COLLECT-FIX/PRED-PAIRS,APPEND,ATOM,IF,PRODS,DEFUN" data-used-by="FLEXSUM-COLLECT-FIX/PRED-PAIRS" data-part-name="FLEXPRODS-COLLECT-FIX/PRED-PAIRS" data-part-args="PRODS" data-part-body="CDR,FLEXPRODS-COLLECT-FIX/PRED-PAIRS,CAR,FLEXPROD->FIELDS,FLEXPROD-FIELDS-COLLECT-FIX/PRED-PAIRS,APPEND,PRODS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXPRODS-COLLECT-FIX/PRED-PAIRS">flexprods-collect-fix/pred-pairs</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexprods-collect-fix_2Fpred-pairs" data-sym="FLEXPRODS-COLLECT-FIX/PRED-PAIRS" title="(defun fty::flexprods-collect-fix/pred-pairs (fty::prods)
  (if (atom fty::prods)
      nil
      (append
       (fty::flexprod-fields-collect-fix/pred-pairs
...">flexprods-collect-fix/pred-pairs</a>
  (prods)
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> prods)
    nil
    (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link local-def" href="#def-flexprod-fields-collect-fix_2Fpred-pairs" data-sym="FLEXPROD-FIELDS-COLLECT-FIX/PRED-PAIRS" title="(defun fty::flexprod-fields-collect-fix/pred-pairs (fty::fields)
  (if (atom fty::fields)
      nil
      (fty::b* (((fty::flexprod-field fty::x) (car fty::fields)))
       (if (and fty::x.fix fty::x.type)
...">flexprod-fields-collect-fix/pred-pairs</a> (flexprod-&gt;fields (car prods)))
      (<a class="sym-link local-def" href="#def-flexprods-collect-fix_2Fpred-pairs" data-sym="FLEXPRODS-COLLECT-FIX/PRED-PAIRS" title="(defun fty::flexprods-collect-fix/pred-pairs (fty::prods)
  (if (atom fty::prods)
      nil
      (append
       (fty::flexprod-fields-collect-fix/pred-pairs
...">flexprods-collect-fix/pred-pairs</a> (cdr prods)))))</pre>
  </div>

<div class="form-block function" id="def-flexsum-collect-fix_2Fpred-pairs" data-defines="FLEXSUM-COLLECT-FIX/PRED-PAIRS" data-references="FLEXSUM->PRODS,FLEXPRODS-COLLECT-FIX/PRED-PAIRS,SUM,DEFUN" data-part-name="FLEXSUM-COLLECT-FIX/PRED-PAIRS" data-part-args="SUM" data-part-body="SUM,FLEXSUM->PRODS,FLEXPRODS-COLLECT-FIX/PRED-PAIRS" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FLEXSUM-COLLECT-FIX/PRED-PAIRS">flexsum-collect-fix/pred-pairs</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-flexsum-collect-fix_2Fpred-pairs" data-sym="FLEXSUM-COLLECT-FIX/PRED-PAIRS" title="(defun fty::flexsum-collect-fix/pred-pairs (fty::sum)
  (fty::flexprods-collect-fix/pred-pairs (fty::flexsum-&gt;prods fty::sum)))">flexsum-collect-fix/pred-pairs</a>
  (sum)
  (<a class="sym-link local-def" href="#def-flexprods-collect-fix_2Fpred-pairs" data-sym="FLEXPRODS-COLLECT-FIX/PRED-PAIRS" title="(defun fty::flexprods-collect-fix/pred-pairs (fty::prods)
  (if (atom fty::prods)
      nil
      (append
       (fty::flexprod-fields-collect-fix/pred-pairs
...">flexprods-collect-fix/pred-pairs</a> (flexsum-&gt;prods sum)))</pre>
  </div>


  </main>
  
<script>
// ACL2 Book HTML Documentation - Interactive Features
// Generated by cert2 - build2 system

// State
let activeFilter = null;
let activePartFilter = null;
let activeNameFilter = null;
let currentFontSize = 14;

// Theme management
function getStoredTheme() {
  return localStorage.getItem('acl2-theme') || 'dark';
}

function setTheme(theme) {
  if (theme === 'light') {
    document.documentElement.setAttribute('data-theme', 'light');
    document.getElementById('theme-toggle').textContent = '🌙';
  } else {
    document.documentElement.removeAttribute('data-theme');
    document.getElementById('theme-toggle').textContent = '☀️';
  }
  localStorage.setItem('acl2-theme', theme);
}

function toggleTheme() {
  const current = getStoredTheme();
  setTheme(current === 'dark' ? 'light' : 'dark');
}

// Font size management
function getStoredFontSize() {
  return parseInt(localStorage.getItem('acl2-fontsize') || '14', 10);
}

function setFontSize(size) {
  size = Math.max(10, Math.min(24, size)); // Clamp between 10-24
  currentFontSize = size;
  document.body.style.fontSize = size + 'px';
  localStorage.setItem('acl2-fontsize', size.toString());
}

function increaseFontSize() {
  setFontSize(currentFontSize + 2);
}

function decreaseFontSize() {
  setFontSize(currentFontSize - 2);
}

// Get all form blocks
function getFormBlocks() {
  return document.querySelectorAll('.form-block');
}

// Clear all filters
function clearFilter() {
  activeFilter = null;
  activePartFilter = null;
  activeNameFilter = null;
  getFormBlocks().forEach(b => {
    b.classList.remove('hidden', 'dimmed');
  });
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  const status = document.querySelector('.filter-status');
  status.classList.remove('active');
  // Slide name filter back to original position
  document.querySelector('.controls-left').style.transform = '';
  // Clear the name filter input
  const nameInput = document.getElementById('name-filter');
  if (nameInput) nameInput.value = '';
}

// Show filter status and slide name filter right
function showFilterStatus(text) {
  const status = document.querySelector('.filter-status');
  status.classList.add('active');
  status.querySelector('.filter-text').textContent = text;
  // Slide name filter to the right to make room
  setTimeout(() => {
    const statusWidth = status.offsetWidth;
    document.querySelector('.controls-left').style.transform = `translateX(${statusWidth + 15}px)`;
  }, 10);
}

// Filter to show only forms that define or reference a symbol
function filterBySymbol(symName, showUsedBy) {
  clearFilter();
  activeFilter = symName;
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines;
    const references = (block.dataset.references || '').split(',');
    const usedBy = (block.dataset.usedBy || '').split(',');
    
    let show = false;
    if (showUsedBy) {
      // Show forms that USE this symbol
      show = references.includes(symName) || definesName === symName;
    } else {
      // Show forms that this symbol USES
      show = usedBy.includes(symName) || definesName === symName;
    }
    
    if (show) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering by: ${symName} (${visibleCount} items)`);
}

// Filter by defthm part (term, hints, rule-classes, etc.)
function filterByPart(formId, partName) {
  clearFilter();
  activePartFilter = { formId, partName };
  
  // Get the part's referenced symbols
  // data-part-term becomes dataset.partTerm, data-part-hints becomes dataset.partHints, etc.
  const block = document.getElementById(formId);
  const datasetKey = 'part' + partName.charAt(0).toUpperCase() + partName.slice(1).replace(/-([a-z])/g, (g) => g[1].toUpperCase());
  const partData = block.dataset[datasetKey];
  if (!partData) return;
  
  const partSyms = partData.split(',').filter(s => s);
  
  // Highlight the button
  block.querySelector(`.part-btn[data-part="${partName}"]`).classList.add('active');
  
  // Hide forms not referenced by this part
  getFormBlocks().forEach(b => {
    const definesName = b.dataset.defines;
    if (b.id === formId || partSyms.includes(definesName)) {
      b.classList.remove('hidden');
    } else {
      b.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering ${formId} :${partName} (${partSyms.length} references)`);
}

// Filter by name (substring or regex)
function filterByName(pattern, useRegex) {
  // Clear other filters but keep the input value
  activeFilter = null;
  activePartFilter = null;
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  
  if (!pattern || pattern.trim() === '') {
    // Empty pattern - show all
    activeNameFilter = null;
    getFormBlocks().forEach(b => b.classList.remove('hidden'));
    const status = document.querySelector('.filter-status');
    status.classList.remove('active');
    document.querySelector('.controls-left').style.transform = '';
    return;
  }
  
  activeNameFilter = pattern;
  
  let matcher;
  let isValidRegex = true;
  
  if (useRegex) {
    try {
      matcher = new RegExp(pattern, 'i');
    } catch (e) {
      // Invalid regex - show error in status and don't filter
      showFilterStatus(`Invalid regex: ${e.message}`);
      return;
    }
  } else {
    // Plain substring match (case-insensitive)
    const lowerPattern = pattern.toLowerCase();
    matcher = { test: (s) => s.toLowerCase().includes(lowerPattern) };
  }
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines || '';
    if (matcher.test(definesName)) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  const modeText = useRegex ? 'regex' : 'name';
  showFilterStatus(`Filtering by ${modeText}: "${pattern}" (${visibleCount} matches)`);
}

// Click on a name to show what references it
function handleNameClick(symName) {
  if (activeFilter === symName) {
    clearFilter();
  } else {
    filterBySymbol(symName, true);
  }
}

// Navigate to a definition (same file or different)
function navigateTo(symName, file) {
  if (file) {
    // External file - navigate
    window.location.href = file + '.html#def-' + symName.toLowerCase();
  } else {
    // Same file - scroll
    const target = document.getElementById('def-' + symName.toLowerCase());
    if (target) {
      target.scrollIntoView({ behavior: 'smooth', block: 'center' });
      target.classList.add('highlight');
      setTimeout(() => target.classList.remove('highlight'), 400);
    }
  }
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  // Part buttons
  document.querySelectorAll('.part-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const formId = btn.closest('.form-block').id;
      const partName = btn.dataset.part;
      if (activePartFilter && activePartFilter.formId === formId && 
          activePartFilter.partName === partName) {
        clearFilter();
      } else {
        filterByPart(formId, partName);
      }
    });
  });
  
  // Clear filter button
  document.querySelector('.clear-filter').addEventListener('click', clearFilter);
  
  // Name filter input
  const nameFilter = document.getElementById('name-filter');
  const regexToggle = document.getElementById('regex-toggle');
  
  let filterTimeout = null;
  nameFilter.addEventListener('input', () => {
    // Debounce the filter to avoid excessive updates while typing
    clearTimeout(filterTimeout);
    filterTimeout = setTimeout(() => {
      filterByName(nameFilter.value, regexToggle.checked);
    }, 150);
  });
  
  // Re-filter when regex toggle changes
  regexToggle.addEventListener('change', () => {
    if (nameFilter.value) {
      filterByName(nameFilter.value, regexToggle.checked);
    }
  });
  
  // Allow Escape key to clear filter when in input
  nameFilter.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      clearFilter();
      nameFilter.blur();
    }
  });
  
  // Symbol references (old span-based refs)
  document.querySelectorAll('.sym-ref').forEach(ref => {
    ref.addEventListener('click', (e) => {
      e.stopPropagation();
      const sym = ref.dataset.sym;
      const file = ref.dataset.file;
      if (file) {
        navigateTo(sym, file);
      } else {
        handleNameClick(sym);
      }
    });
  });
  
  // Symbol links (new anchor-based links)
  // These use standard <a> tags so navigation happens automatically
  // But we need to clear filters if target would be hidden
  document.querySelectorAll('.sym-link').forEach(link => {
    link.addEventListener('click', (e) => {
      const href = link.getAttribute('href');
      if (href && href.startsWith('#')) {
        // Local link - check if target is hidden by filter
        const targetId = href.substring(1);
        const target = document.getElementById(targetId);
        if (target) {
          // If target is hidden, clear the filter first
          if (target.classList.contains('hidden')) {
            clearFilter();
          }
          // Add highlight effect after a short delay
          setTimeout(() => {
            target.classList.add('highlight');
            setTimeout(() => target.classList.remove('highlight'), 400);
          }, 100);
        }
      }
      // For external links, default behavior handles navigation
    });
  });
  
  // Form names (show what uses them)
  document.querySelectorAll('.form-name').forEach(name => {
    name.addEventListener('click', (e) => {
      handleNameClick(name.dataset.sym);
    });
  });
  
  // Handle hash navigation (when arriving at page with #anchor)
  if (window.location.hash) {
    const target = document.querySelector(window.location.hash);
    if (target) {
      setTimeout(() => {
        target.scrollIntoView({ behavior: 'smooth', block: 'center' });
        target.classList.add('highlight');
        setTimeout(() => target.classList.remove('highlight'), 400);
      }, 200);
    }
  }
  
  // Initialize theme from storage
  setTheme(getStoredTheme());
  
  // Initialize font size from storage
  currentFontSize = getStoredFontSize();
  setFontSize(currentFontSize);
  
  // Theme toggle button
  document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
  
  // Font size buttons
  document.getElementById('font-larger').addEventListener('click', increaseFontSize);
  document.getElementById('font-smaller').addEventListener('click', decreaseFontSize);
});

</script>

</body>
</html>
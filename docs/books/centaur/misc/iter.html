<!DOCTYPE html>
<html lang="en" vocab="http://schema.org/" typeof="SoftwareSourceCode">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>iter - ACL2 Book</title>
  <meta property="name" content="iter">
  <meta property="programmingLanguage" content="ACL2">
  
<style>
/* ACL2 Book HTML Documentation Styles */
/* Generated by cert2 - build2 system */

/* Dark theme (default) */
:root {
  --bg: #1e1e2e;
  --fg: #cdd6f4;
  --comment: #6c7086;
  --keyword: #cba6f7;
  --string: #a6e3a1;
  --function: #89b4fa;
  --type: #f9e2af;
  --link: #89dceb;
  --link-hover: #f5c2e7;
  --highlight: rgba(137, 180, 250, 0.2);
  --border: #313244;
  --block-bg: rgba(49, 50, 68, 0.5);
  --btn-bg: #313244;
  --btn-hover: rgba(137, 180, 250, 0.2);
}

/* Light theme */
[data-theme="light"] {
  --bg: #eff1f5;
  --fg: #4c4f69;
  --comment: #6c6f85;
  --keyword: #8839ef;
  --string: #40a02b;
  --function: #1e66f5;
  --type: #df8e1d;
  --link: #04a5e5;
  --link-hover: #ea76cb;
  --highlight: rgba(30, 102, 245, 0.15);
  --border: #ccd0da;
  --block-bg: rgba(204, 208, 218, 0.3);
  --btn-bg: #ccd0da;
  --btn-hover: rgba(30, 102, 245, 0.15);
}

body {
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  background: var(--bg);
  color: var(--fg);
  margin: 0;
  padding: 20px;
  line-height: 1.6;
  font-size: 14px;
  transition: background 0.1s, color 0.1s;
}

/* Controls toolbar */
.controls-left {
  position: fixed;
  top: 10px;
  left: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
  transition: transform 0.1s ease;
}

.controls-right {
  position: fixed;
  top: 10px;
  right: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
}

.control-btn {
  padding: 6px 12px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-family: inherit;
  font-size: 14px;
  transition: all 0.1s;
}

.control-btn:hover {
  background: var(--btn-hover);
  border-color: var(--link);
}

.name-filter {
  padding: 6px 10px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  font-family: inherit;
  font-size: 13px;
  width: 150px;
  transition: all 0.1s;
}

.name-filter:focus {
  outline: none;
  border-color: var(--link);
  width: 200px;
}

.name-filter::placeholder {
  color: var(--comment);
}

.regex-label {
  display: flex;
  align-items: center;
  gap: 4px;
  color: var(--comment);
  font-size: 12px;
  cursor: pointer;
}

.regex-label input {
  cursor: pointer;
}

.book-header {
  border-bottom: 2px solid var(--border);
  padding-bottom: 20px;
  margin-bottom: 20px;
}

.book-header h1 {
  color: var(--keyword);
  margin: 0;
}

.book-header .path {
  color: var(--comment);
  font-size: 0.9em;
}

.book-header .path .source-link {
  color: var(--comment);
  text-decoration: none;
}

.book-header .path .source-link:hover {
  color: var(--link);
  text-decoration: underline;
}

.form-block {
  margin: 10px 0;
  padding: 15px;
  background: var(--block-bg);
  border-radius: 8px;
  border-left: 3px solid var(--border);
}

.form-block.theorem { border-left-color: var(--keyword); }
.form-block.function { border-left-color: var(--function); }
.form-block.macro { border-left-color: var(--type); }
.form-block.include-book { border-left-color: var(--string); }

.form-block.hidden { display: none; }
.form-block.dimmed { opacity: 0.3; }

.form-block.highlight {
  animation: highlight-pulse 0.4s ease-out;
}

@keyframes highlight-pulse {
  0% { background: var(--highlight); box-shadow: 0 0 20px var(--link); }
  100% { background: rgba(49, 50, 68, 0.5); box-shadow: none; }
}

.form-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.form-name {
  color: var(--function);
  font-weight: bold;
  cursor: pointer;
}

.form-name:hover {
  color: var(--link-hover);
  text-decoration: underline;
}

.form-type {
  color: var(--comment);
  font-size: 0.85em;
}

pre.code {
  margin: 0;
  overflow-x: auto;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.sym-ref {
  color: var(--link);
  cursor: pointer;
  border-radius: 2px;
}

.sym-ref:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.sym-ref.local-def { color: var(--function); font-weight: bold; }
.sym-ref.external { color: var(--type); }

/* Symbol links (clickable hyperlinks) */
.sym-link {
  color: var(--link);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
  position: relative;
}

.sym-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

.sym-link.local-def {
  color: var(--function);
  font-weight: bold;
}

.sym-link.external {
  color: var(--type);
}

/* Tooltips using title attribute with custom styling */
.sym-link[title] {
  /* Browser will show title on hover */
}

/* Syntax highlighting in code blocks */
.keyword {
  color: var(--keyword);
}

.string {
  color: var(--string);
}

.number {
  color: #f77524; /* orange */
}

/* Include-book path links */
.include-path {
  color: var(--string);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
}

.include-path:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

/* Part buttons for defthm */
.part-buttons {
  display: flex;
  gap: 5px;
  margin: 10px 0;
  flex-wrap: wrap;
}

.part-btn {
  padding: 4px 10px;
  background: var(--border);
  border: 1px solid var(--comment);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-size: 0.85em;
  font-family: inherit;
}

.part-btn:hover {
  background: var(--highlight);
  border-color: var(--link);
}

.part-btn.active {
  background: var(--link);
  color: var(--bg);
  border-color: var(--link);
}

/* References panel */
.refs-panel {
  margin-top: 10px;
  padding: 10px;
  background: rgba(0,0,0,0.2);
  border-radius: 4px;
  display: none;
}

.refs-panel.visible { display: block; }

.refs-panel h4 {
  margin: 0 0 5px 0;
  color: var(--comment);
  font-size: 0.9em;
}

.refs-list {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

/* Included books section */
.includes-section {
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(49, 50, 68, 0.3);
  border-radius: 8px;
  border: 1px solid var(--border);
}

.includes-section h2 {
  margin: 0 0 10px 0;
  color: var(--comment);
  font-size: 1em;
  font-weight: normal;
}

.includes-list {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.include-link {
  padding: 6px 12px;
  background: var(--border);
  border-radius: 4px;
  color: var(--link);
  text-decoration: none;
  font-size: 0.9em;
  transition: all 0.1s;
}

.include-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.include-link.local {
  border-left: 2px solid var(--comment);
}

/* Filter status */
.filter-status {
  position: fixed;
  top: 10px;
  left: 20px;
  background: var(--bg);
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: 4px;
  z-index: 201;
  display: none;
  align-items: center;
  gap: 10px;
}

.filter-status.active {
  display: flex;
  align-items: center;
  gap: 10px;
}

.clear-filter {
  padding: 5px 15px;
  background: var(--keyword);
  color: var(--bg);
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

/* RDFa vocab indicator */
[vocab] { /* semantic web annotations present */ }

</style>

</head>
<body>
  <div class="controls-left">
    <input type="text" id="name-filter" class="name-filter" placeholder="Filter by name..." title="Filter definitions by name">
    <label class="regex-label"><input type="checkbox" id="regex-toggle"> regex</label>
  </div>

  <div class="controls-right">
    <button class="control-btn" id="theme-toggle" title="Toggle light/dark theme">☀️</button>
    <button class="control-btn" id="font-smaller" title="Decrease font size">A-</button>
    <button class="control-btn" id="font-larger" title="Increase font size">A+</button>
  </div>

  <div class="filter-status">
    <span class="filter-text">Filtering...</span>
    <button class="clear-filter">Clear Filter</button>
  </div>
  
  <div class="book-header">
    <h1 property="name">iter</h1>
    <div class="path"><a href="iter.lisp" class="source-link">books/centaur/misc/iter</a></div>
  </div>
  
  <main property="text">
  <div class="includes-section">
    <h2>Included Books</h2>
    <div class="includes-list">
      <a class="include-link" href="../../std/basic/arith-equivs.html" title="std/basic/arith-equivs">arith-equivs</a>
      <a class="include-link" href="../../std/basic/defs.html" title="std/basic/defs">defs</a>
      <a class="include-link" href="../../std/util/bstar.html" title="std/util/bstar">bstar</a>
      <a class="include-link" href="../../xdoc/base.html" title="xdoc/base">base</a>
      <a class="include-link" href="../../centaur/fty/fixtype.html" title="centaur/fty/fixtype">fixtype</a>
      <a class="include-link" href="../../centaur/fty/basetypes.html" title="centaur/fty/basetypes">basetypes</a>
      <a class="include-link local" href="../../arithmetic/top-with-meta.html" title="arithmetic/top-with-meta">top-with-meta</a>
    </div>
  </div>

<div class="form-block other" id="form-0" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-in-package" data-sym="IN-PACKAGE">in-package</a> <span class="string">"ACL2"</span>)</pre>
  </div>

<div class="form-block include-book" id="form-1" typeof="Code">
    <div class="form-header"><span class="form-type">include-book</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../std/basic/arith-equivs.html" title="Open std/basic/arith-equivs">"std/basic/arith-equivs"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block include-book" id="form-2" typeof="Code">
    <div class="form-header"><span class="form-type">include-book</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../std/basic/defs.html" title="Open std/basic/defs">"std/basic/defs"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block include-book" id="form-3" typeof="Code">
    <div class="form-header"><span class="form-type">include-book</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../std/util/bstar.html" title="Open std/util/bstar">"std/util/bstar"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block include-book" id="form-4" typeof="Code">
    <div class="form-header"><span class="form-type">include-book</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../xdoc/base.html" title="Open xdoc/base">"xdoc/base"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block include-book" id="form-5" typeof="Code">
    <div class="form-header"><span class="form-type">include-book</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../centaur/fty/fixtype.html" title="Open centaur/fty/fixtype">"centaur/fty/fixtype"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block include-book" id="form-6" typeof="Code">
    <div class="form-header"><span class="form-type">include-book</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../centaur/fty/basetypes.html" title="Open centaur/fty/basetypes">"centaur/fty/basetypes"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block encapsulate" id="def-iter-up" data-defines="ITER-UP" data-references="QUOTE,STABLE-UNDER-SIMPLIFICATIONP,DISABLE,ITER-UP-IS-ITER-DOWN,<=,AND,IMPLIES,ITER-UP-OF-ITER-DOWN,ITER-DOWN-OF-ITER-FIX-VAL,ITER-UP-OF-ITER-FIX-VAL,ITER-FIX-VAL-OF-ITER-DOWN,ITER-FIX-VAL-OF-ITER-UP,ITER-LAST-OF-ITER-DOWN,ITER-LAST-OF-ITER-UP,1-,ITER-DOWN,1+,ZP,IF,IFIX,-,NFIX,XARGS,DECLARE,ITER-FIX-OF-ITER-STEP,ITER-STEP-OF-ITER-FIX,ITER-FIX-OF-ITER-FIX,ITER-LAST-OF-ITER-FIX,ITER-FIRST-OF-ITER-FIX,ITER-LAST-OF-ITER-STEP,EQUAL,ITER-FIRST-OF-ITER-STEP,DEFTHM,CADDR,CADR,CAR,UPDATE-NTH,LIST,VAL,AUX,N,DEFUN,SET-IRRELEVANT-FORMALS-OK,T,SET-IGNORE-OK,ITER-FIX-VAL,ITER-LAST,ITER-FIRST,=>,*,ITER-STEP,INCLUDE-BOOK,ARITH-EQUIV-FORWARDING,ENABLE*,IN-THEORY,LOCAL,ENCAPSULATE" data-used-by="DEFITERATION-FN" typeof="Code">
    <div class="form-header"><span class="form-name" property="name" data-sym="ITER-UP">iter-up</span><span class="form-type">encapsulate</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-encapsulate" data-sym="ENCAPSULATE">encapsulate</a> nil
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable* arith-equiv-forwarding)))
  (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../../arithmetic/top-with-meta.html" title="Open arithmetic/top-with-meta">"arithmetic/top-with-meta"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>))
  (<a class="sym-link system" href="../../../axioms.html#def-encapsulate" data-sym="ENCAPSULATE">encapsulate</a> (((iter-step <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a> <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a> <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a>) =&gt; <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a>) ((iter-first <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a> <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a>) =&gt; <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a>)
      ((iter-last <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a> <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a>) =&gt; <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a>)
      ((iter-fix-val <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a>) =&gt; <a class="sym-link system" href="../../../axioms.html#def-_2A" data-sym="*">*</a>))
    (<a class="sym-link system" href="../../../axioms.html#def-set-ignore-ok" data-sym="SET-IGNORE-OK">set-ignore-ok</a> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
    (<a class="sym-link system" href="../../../axioms.html#def-set-irrelevant-formals-ok" data-sym="SET-IRRELEVANT-FORMALS-OK">set-irrelevant-formals-ok</a> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> iter-step
        (n aux val)
        (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> (<a class="sym-link system" href="../../../axioms.html#def-update-nth" data-sym="UPDATE-NTH">update-nth</a> n (car aux) (car val)))))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> iter-first (aux val) (<a class="sym-link system" href="../../../axioms.html#def-cadr" data-sym="CADR">cadr</a> aux)))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> iter-last (aux val) (<a class="sym-link system" href="../../../axioms.html#def-caddr" data-sym="CADDR">caddr</a> aux)))
    (<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> iter-fix-val (val) (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> (car val))))
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> iter-first-of-iter-step
      (equal (iter-first aux (iter-step n aux val))
        (iter-first aux val)))
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> iter-last-of-iter-step
      (equal (iter-last aux (iter-step n aux val))
        (iter-last aux val)))
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> iter-first-of-iter-fix
      (equal (iter-first aux (iter-fix-val val))
        (iter-first aux val)))
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> iter-last-of-iter-fix
      (equal (iter-last aux (iter-fix-val val))
        (iter-last aux val)))
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> iter-fix-of-iter-fix
      (equal (iter-fix-val (iter-fix-val val)) (iter-fix-val val)))
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> iter-step-of-iter-fix
      (equal (iter-step n aux (iter-fix-val val))
        (iter-step n aux val)))
    (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> iter-fix-of-iter-step
      (equal (iter-fix-val (iter-step n aux val))
        (iter-step n aux val))))
  (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-iter-up" data-sym="ITER-UP" title="(encapsulate nil (local (in-theory (enable* arith-equiv-forwarding)))
             (local (include-book &quot;arithmetic/top-with-meta&quot; :dir :system))
             (encapsulate
              (((iter-step * * *) =&gt; *) ((iter-first * *) =&gt; *)
               ((iter-last * *) =&gt; *) ((iter-fix-val *) =&gt; *))
...">iter-up</a>
    (n aux val)
    (declare (xargs <span class="keyword">:measure</span> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> (iter-last aux val)) (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n)))))
    (if (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> (iter-last aux val)) (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n)))
      (iter-fix-val val)
      (<a class="sym-link local-def" href="#def-iter-up" data-sym="ITER-UP" title="(encapsulate nil (local (in-theory (enable* arith-equiv-forwarding)))
             (local (include-book &quot;arithmetic/top-with-meta&quot; :dir :system))
             (encapsulate
              (((iter-step * * *) =&gt; *) ((iter-first * *) =&gt; *)
               ((iter-last * *) =&gt; *) ((iter-fix-val *) =&gt; *))
...">iter-up</a> (<a class="sym-link system" href="../../../axioms.html#def-1_2B" data-sym="1+">1+</a> (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n)) aux (iter-step (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n) aux val))))
  (<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> iter-down
    (n aux val)
    (declare (xargs <span class="keyword">:measure</span> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n) (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> (iter-first aux val))))))
    (if (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n) (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> (iter-first aux val))))
      (iter-fix-val val)
      (iter-step (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n))
        aux
        (iter-down (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n)) aux val))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> iter-last-of-iter-up
    (equal (iter-last aux (<a class="sym-link local-def" href="#def-iter-up" data-sym="ITER-UP" title="(encapsulate nil (local (in-theory (enable* arith-equiv-forwarding)))
             (local (include-book &quot;arithmetic/top-with-meta&quot; :dir :system))
             (encapsulate
              (((iter-step * * *) =&gt; *) ((iter-first * *) =&gt; *)
               ((iter-last * *) =&gt; *) ((iter-fix-val *) =&gt; *))
...">iter-up</a> n aux val))
      (iter-last aux val)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> iter-last-of-iter-down
    (equal (iter-last aux (iter-down n aux val))
      (iter-last aux val)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> iter-fix-val-of-iter-up
    (equal (iter-fix-val (<a class="sym-link local-def" href="#def-iter-up" data-sym="ITER-UP" title="(encapsulate nil (local (in-theory (enable* arith-equiv-forwarding)))
             (local (include-book &quot;arithmetic/top-with-meta&quot; :dir :system))
             (encapsulate
              (((iter-step * * *) =&gt; *) ((iter-first * *) =&gt; *)
               ((iter-last * *) =&gt; *) ((iter-fix-val *) =&gt; *))
...">iter-up</a> n aux val))
      (<a class="sym-link local-def" href="#def-iter-up" data-sym="ITER-UP" title="(encapsulate nil (local (in-theory (enable* arith-equiv-forwarding)))
             (local (include-book &quot;arithmetic/top-with-meta&quot; :dir :system))
             (encapsulate
              (((iter-step * * *) =&gt; *) ((iter-first * *) =&gt; *)
               ((iter-last * *) =&gt; *) ((iter-fix-val *) =&gt; *))
...">iter-up</a> n aux val)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> iter-fix-val-of-iter-down
    (equal (iter-fix-val (iter-down n aux val))
      (iter-down n aux val))
    <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:induct</span> (iter-down n aux val))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> iter-up-of-iter-fix-val
    (equal (<a class="sym-link local-def" href="#def-iter-up" data-sym="ITER-UP" title="(encapsulate nil (local (in-theory (enable* arith-equiv-forwarding)))
             (local (include-book &quot;arithmetic/top-with-meta&quot; :dir :system))
             (encapsulate
              (((iter-step * * *) =&gt; *) ((iter-first * *) =&gt; *)
               ((iter-last * *) =&gt; *) ((iter-fix-val *) =&gt; *))
...">iter-up</a> n aux (iter-fix-val val))
      (<a class="sym-link local-def" href="#def-iter-up" data-sym="ITER-UP" title="(encapsulate nil (local (in-theory (enable* arith-equiv-forwarding)))
             (local (include-book &quot;arithmetic/top-with-meta&quot; :dir :system))
             (encapsulate
              (((iter-step * * *) =&gt; *) ((iter-first * *) =&gt; *)
               ((iter-last * *) =&gt; *) ((iter-fix-val *) =&gt; *))
...">iter-up</a> n aux val)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> iter-down-of-iter-fix-val
    (equal (iter-down n aux (iter-fix-val val))
      (iter-down n aux val)))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> iter-up-of-iter-down
    (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n) (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> (iter-last aux val)))
        (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> (iter-first aux val)) (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> n)))
      (equal (<a class="sym-link local-def" href="#def-iter-up" data-sym="ITER-UP" title="(encapsulate nil (local (in-theory (enable* arith-equiv-forwarding)))
             (local (include-book &quot;arithmetic/top-with-meta&quot; :dir :system))
             (encapsulate
              (((iter-step * * *) =&gt; *) ((iter-first * *) =&gt; *)
               ((iter-last * *) =&gt; *) ((iter-fix-val *) =&gt; *))
...">iter-up</a> n aux (iter-down n aux val))
        (<a class="sym-link local-def" href="#def-iter-up" data-sym="ITER-UP" title="(encapsulate nil (local (in-theory (enable* arith-equiv-forwarding)))
             (local (include-book &quot;arithmetic/top-with-meta&quot; :dir :system))
             (encapsulate
              (((iter-step * * *) =&gt; *) ((iter-first * *) =&gt; *)
               ((iter-last * *) =&gt; *) ((iter-fix-val *) =&gt; *))
...">iter-up</a> (iter-first aux val) aux val)))
    <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:induct</span> (iter-down n aux val)
       <span class="keyword">:expand</span> ((<span class="keyword">:free</span> (val) (<a class="sym-link local-def" href="#def-iter-up" data-sym="ITER-UP" title="(encapsulate nil (local (in-theory (enable* arith-equiv-forwarding)))
             (local (include-book &quot;arithmetic/top-with-meta&quot; :dir :system))
             (encapsulate
              (((iter-step * * *) =&gt; *) ((iter-first * *) =&gt; *)
               ((iter-last * *) =&gt; *) ((iter-fix-val *) =&gt; *))
...">iter-up</a> n aux val))))))
  (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> iter-up-is-iter-down
    (equal (<a class="sym-link local-def" href="#def-iter-up" data-sym="ITER-UP" title="(encapsulate nil (local (in-theory (enable* arith-equiv-forwarding)))
             (local (include-book &quot;arithmetic/top-with-meta&quot; :dir :system))
             (encapsulate
              (((iter-step * * *) =&gt; *) ((iter-first * *) =&gt; *)
               ((iter-last * *) =&gt; *) ((iter-fix-val *) =&gt; *))
...">iter-up</a> (iter-first aux val) aux val)
      (iter-down (iter-last aux val) aux val))
    <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:use</span> ((<span class="keyword">:instance</span> iter-up-of-iter-down (n (iter-last aux val))))
       <span class="keyword">:in-theory</span> (disable iter-up-of-iter-down)) (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp
        '(<span class="keyword">:expand</span> ((iter-down (iter-last aux val) aux val)))))))</pre>
  </div>

<div class="form-block function" id="def-defiteration-sort-args" data-defines="DEFITERATION-SORT-ARGS" data-references="T,KEYWORD-VALUE-LISTP,WHEN,STRINGP,CONS,CDR,KWLIST,BODY,DOC,DECLS,B*,DECLARE,CAAR,EQ,CAR,CONSP,AND,MV,DEFITERATION,QUOTE,HARD?,ER,PROG2$,ATOM,COND,ARGS,DEFUN" data-used-by="DEF-LIST-CONSTRUCTOR-FN,DEFITERATION-FN" data-part-name="DEFITERATION-SORT-ARGS" data-part-args="ARGS" data-part-body="T,KEYWORD-VALUE-LISTP,WHEN,STRINGP,CONS,CDR,DEFITERATION-SORT-ARGS,KWLIST,BODY,DOC,DECLS,B*,DECLARE,CAAR,EQ,CAR,CONSP,AND,MV,DEFITERATION,QUOTE,HARD?,ER,PROG2$,ARGS,ATOM,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="DEFITERATION-SORT-ARGS">defiteration-sort-args</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-defiteration-sort-args" data-sym="DEFITERATION-SORT-ARGS" title="(defun defiteration-sort-args (args)
  (cond
   ((atom args)
    (prog2$ (er hard? &#39;defiteration &quot;not enough args&quot;) (mv nil nil nil nil)))
   ((and (consp (car args)) (eq (caar args) &#39;declare))
...">defiteration-sort-args</a>
  (<a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)
  (<a class="sym-link system" href="../../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>) (<a class="sym-link system" href="../../../axioms.html#def-prog2_24" data-sym="PROG2$">prog2$</a> (<a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> hard? '<a class="sym-link local-def" href="#def-defiteration" data-sym="DEFITERATION" title="(defmacro defiteration (name formals &amp;rest args)
  (defiteration-fn name formals args))">defiteration</a> <span class="string">"not enough args"</span>)
        (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil nil nil nil)))
    ((<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (consp (car <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)) (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (<a class="sym-link system" href="../../../axioms.html#def-caar" data-sym="CAAR">caar</a> <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>) 'declare)) (<a class="sym-link external" href="../../std/util/bstar.html#def-b_2A" data-sym="B*">b*</a> (((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> decls <a class="sym-link system" href="../../../history-management.html#def-doc" data-sym="DOC">doc</a> <a class="sym-link system" href="../../../basis-b.html#def-body" data-sym="BODY">body</a> kwlist) (<a class="sym-link local-def" href="#def-defiteration-sort-args" data-sym="DEFITERATION-SORT-ARGS" title="(defun defiteration-sort-args (args)
  (cond
   ((atom args)
    (prog2$ (er hard? &#39;defiteration &quot;not enough args&quot;) (mv nil nil nil nil)))
   ((and (consp (car args)) (eq (caar args) &#39;declare))
...">defiteration-sort-args</a> (cdr <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>))))
        (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> (cons (car <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>) decls) <a class="sym-link system" href="../../../history-management.html#def-doc" data-sym="DOC">doc</a> <a class="sym-link system" href="../../../basis-b.html#def-body" data-sym="BODY">body</a> kwlist)))
    ((stringp (car <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)) (<a class="sym-link external" href="../../std/util/bstar.html#def-b_2A" data-sym="B*">b*</a> (((when (<a class="sym-link system" href="../../../axioms.html#def-keyword-value-listp" data-sym="KEYWORD-VALUE-LISTP">keyword-value-listp</a> (cdr <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>))) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil nil (car <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>) (cdr <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>))) ((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> decls <a class="sym-link system" href="../../../history-management.html#def-doc" data-sym="DOC">doc</a> <a class="sym-link system" href="../../../basis-b.html#def-body" data-sym="BODY">body</a> kwlist) (<a class="sym-link local-def" href="#def-defiteration-sort-args" data-sym="DEFITERATION-SORT-ARGS" title="(defun defiteration-sort-args (args)
  (cond
   ((atom args)
    (prog2$ (er hard? &#39;defiteration &quot;not enough args&quot;) (mv nil nil nil nil)))
   ((and (consp (car args)) (eq (caar args) &#39;declare))
...">defiteration-sort-args</a> (cdr <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)))
          ((when <a class="sym-link system" href="../../../history-management.html#def-doc" data-sym="DOC">doc</a>) (<a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> hard? '<a class="sym-link local-def" href="#def-defiteration" data-sym="DEFITERATION" title="(defmacro defiteration (name formals &amp;rest args)
  (defiteration-fn name formals args))">defiteration</a> <span class="string">"multiple doc strings"</span>)
            (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil nil nil nil)))
        (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> decls (car <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>) <a class="sym-link system" href="../../../basis-b.html#def-body" data-sym="BODY">body</a> kwlist)))
    ((<a class="sym-link system" href="../../../axioms.html#def-keyword-value-listp" data-sym="KEYWORD-VALUE-LISTP">keyword-value-listp</a> (cdr <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)) (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil nil (car <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>) (cdr <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)))
    (<a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../../axioms.html#def-prog2_24" data-sym="PROG2$">prog2$</a> (<a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> hard?
          '<a class="sym-link local-def" href="#def-defiteration" data-sym="DEFITERATION" title="(defmacro defiteration (name formals &amp;rest args)
  (defiteration-fn name formals args))">defiteration</a>
          <span class="string">"args after body not keyword-value-listp"</span>)
        (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> nil nil nil nil)))))</pre>
  </div>

<div class="form-block function" id="def-get-kw" data-defines="GET-KW" data-references="CADR,IF,ASSOC-KEYWORD,LOOK,LET,KEYWORD-VALUE-LISTP,XARGS,DECLARE,KWLIST,DEFAULT,KEY,DEFUN" data-used-by="DEF-LIST-CONSTRUCTOR-FN,DEFITERATION-FN" data-part-name="GET-KW" data-part-args="KWLIST,DEFAULT,KEY" data-part-declare="KWLIST,KEYWORD-VALUE-LISTP,XARGS,DECLARE" data-part-body="DEFAULT,CADR,IF,KWLIST,KEY,ASSOC-KEYWORD,LOOK,LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="GET-KW">get-kw</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-get-kw" data-sym="GET-KW" title="(defun get-kw (key default kwlist)
  (declare (xargs :guard (keyword-value-listp kwlist)))
  (let ((look (assoc-keyword key kwlist)))
    (if look
        (cadr look)">get-kw</a>
  (key <a class="sym-link system" href="../../../axioms.html#def-default" data-sym="DEFAULT">default</a> kwlist)
  (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../../axioms.html#def-keyword-value-listp" data-sym="KEYWORD-VALUE-LISTP">keyword-value-listp</a> kwlist)))
  (let ((look (<a class="sym-link system" href="../../../axioms.html#def-assoc-keyword" data-sym="ASSOC-KEYWORD">assoc-keyword</a> key kwlist)))
    (if look
      (<a class="sym-link system" href="../../../axioms.html#def-cadr" data-sym="CADR">cadr</a> look)
      <a class="sym-link system" href="../../../axioms.html#def-default" data-sym="DEFAULT">default</a>)))</pre>
  </div>

<div class="form-block function" id="def-var_2Fconst-listp" data-defines="VAR/CONST-LISTP" data-references="CDR,QUOTE,CAAR,CAR,OR,AND,EQ,ATOM,IF,T,XARGS,DECLARE,X,DEFUN" data-used-by="DEFITERATION-FN" data-part-name="VAR/CONST-LISTP" data-part-args="X" data-part-declare="T,XARGS,DECLARE" data-part-body="CDR,VAR/CONST-LISTP,QUOTE,CAAR,CAR,OR,AND,EQ,X,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="VAR/CONST-LISTP">var/const-listp</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-var_2Fconst-listp" data-sym="VAR/CONST-LISTP" title="(defun var/const-listp (x)
  (declare (xargs :guard t))
  (if (atom x)
      (eq x nil)
      (and (or (atom (car x)) (eq (caar x) &#39;quote)) (var/const-listp (cdr x)))))">var/const-listp</a>
  (x)
  (declare (xargs <span class="keyword">:guard</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>))
  (if (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> x nil)
    (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> (car x)) (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (<a class="sym-link system" href="../../../axioms.html#def-caar" data-sym="CAAR">caar</a> x) 'quote))
      (<a class="sym-link local-def" href="#def-var_2Fconst-listp" data-sym="VAR/CONST-LISTP" title="(defun var/const-listp (x)
  (declare (xargs :guard t))
  (if (atom x)
      (eq x nil)
      (and (or (atom (car x)) (eq (caar x) &#39;quote)) (var/const-listp (cdr x)))))">var/const-listp</a> (cdr x)))))</pre>
  </div>

<div class="form-block function" id="def-defiteration-fn" data-defines="DEFITERATION-FN" data-references="IN-THEORY,DEFUN-INLINE,STABLE-UNDER-SIMPLIFICATIONP,LNFIX,FIX,UNICITY-OF-0,IFIX-POSITIVE-TO-NON-ZP,UNARY--,COMMUTATIVITY-OF-+,ZP-WHEN-INTEGERP,CDR-CONS,CAR-CONS,ITER-DOWN,ITER-UP,N,ITER-STEP,ITER-LAST,AUX,ITER-FIRST,VAL,LAMBDA,ITER-FIX-VAL,ITER-UP-IS-ITER-DOWN,DEFTHM,SET-IGNORE-OK,ENABLE,INT-EQUIV,DEFFIXCONG,1-,1+,LIFIX,INT=,ZP,MBE,<=,NFIX,XARGS,INTEGER,TYPE,DECLARE,DEFUND,ENCAPSULATE,THMNAME,IFIX,-,QUASIQUOTE,EQUAL,ITER-MEAS,ITER,TAILREC,STEP,SYMBOL-NAME,STRING,CONCATENATE,STEP-CALL,CONS,ITER-FORMALS,VAR/CONST-LISTP,ATOM,BODY-IS-SIMPLE,APPEND,AUX-VARS,LIST,VAL-VARS,PACKAGE,GUARD-HINTS,TOP-RETURNS,TOP-GUARD,ITER-DECLS,T,ITER-GUARD,HINTS,SET-DIFFERENCE-EQ,SUBSETP-EQ,CDR,CONSP,CAR,EQ,OR,SYMBOLP,IF,RETURNS,INTERSECTP-EQ,MEMBER-EQ,NOT,SYMBOL-LISTP,AND,STRIP-CARS,INIT-VAL-VARS,INIT-VALS,MEMBER,WHEN,INTERN-IN-PACKAGE-OF-SYMBOL,INDEX,DEFITERATION,QUOTE,HARD?,ER,UNLESS,LAST,GET-KW,FIRST,DEFITERATION-SORT-ARGS,KWLIST,BODY,DOC,DECLS,MV,B*,ARGS,FORMALS,NAME,DEFUN" data-used-by="DEFITERATION" data-part-name="DEFITERATION-FN" data-part-args="ARGS,FORMALS,NAME" data-part-body="IN-THEORY,DEFUN-INLINE,STABLE-UNDER-SIMPLIFICATIONP,LNFIX,FIX,UNICITY-OF-0,IFIX-POSITIVE-TO-NON-ZP,UNARY--,COMMUTATIVITY-OF-+,ZP-WHEN-INTEGERP,CDR-CONS,CAR-CONS,ITER-DOWN,ITER-UP,N,ITER-STEP,ITER-LAST,AUX,ITER-FIRST,VAL,LAMBDA,ITER-FIX-VAL,ITER-UP-IS-ITER-DOWN,DEFTHM,SET-IGNORE-OK,ENABLE,INT-EQUIV,DEFFIXCONG,1-,1+,LIFIX,INT=,ZP,MBE,<=,NFIX,XARGS,INTEGER,TYPE,DECLARE,DEFUND,ENCAPSULATE,THMNAME,IFIX,-,QUASIQUOTE,EQUAL,ITER-MEAS,ITER,TAILREC,STEP,SYMBOL-NAME,STRING,CONCATENATE,STEP-CALL,CONS,ITER-FORMALS,VAR/CONST-LISTP,ATOM,BODY-IS-SIMPLE,APPEND,AUX-VARS,LIST,VAL-VARS,PACKAGE,GUARD-HINTS,TOP-RETURNS,TOP-GUARD,ITER-DECLS,T,ITER-GUARD,HINTS,SET-DIFFERENCE-EQ,SUBSETP-EQ,CDR,CONSP,CAR,EQ,OR,SYMBOLP,IF,RETURNS,INTERSECTP-EQ,MEMBER-EQ,NOT,SYMBOL-LISTP,AND,STRIP-CARS,INIT-VAL-VARS,INIT-VALS,FORMALS,MEMBER,WHEN,NAME,INTERN-IN-PACKAGE-OF-SYMBOL,INDEX,DEFITERATION,QUOTE,HARD?,ER,UNLESS,LAST,GET-KW,FIRST,ARGS,DEFITERATION-SORT-ARGS,KWLIST,BODY,DOC,DECLS,MV,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="DEFITERATION-FN">defiteration-fn</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-defiteration-fn" data-sym="DEFITERATION-FN" title="(defun defiteration-fn (name formals args)
  (b*
   (((mv decls doc body kwlist) (defiteration-sort-args args))
    (first (get-kw :first 0 kwlist)) (last (get-kw :last nil kwlist))
    ((unless last) (er hard? &#39;defiteration &quot;Need :last argument&quot;))
...">defiteration-fn</a>
  (name <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)
  (<a class="sym-link external" href="../../std/util/bstar.html#def-b_2A" data-sym="B*">b*</a> (((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> decls <a class="sym-link system" href="../../../history-management.html#def-doc" data-sym="DOC">doc</a> <a class="sym-link system" href="../../../basis-b.html#def-body" data-sym="BODY">body</a> kwlist) (<a class="sym-link local-def" href="#def-defiteration-sort-args" data-sym="DEFITERATION-SORT-ARGS" title="(defun defiteration-sort-args (args)
  (cond
   ((atom args)
    (prog2$ (er hard? &#39;defiteration &quot;not enough args&quot;) (mv nil nil nil nil)))
   ((and (consp (car args)) (eq (caar args) &#39;declare))
...">defiteration-sort-args</a> <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)) (<a class="sym-link system" href="../../../axioms.html#def-first" data-sym="FIRST">first</a> (<a class="sym-link local-def" href="#def-get-kw" data-sym="GET-KW" title="(defun get-kw (key default kwlist)
  (declare (xargs :guard (keyword-value-listp kwlist)))
  (let ((look (assoc-keyword key kwlist)))
    (if look
        (cadr look)">get-kw</a> <span class="keyword">:first</span> <span class="number">0</span> kwlist))
      (<a class="sym-link system" href="../../../axioms.html#def-last" data-sym="LAST">last</a> (<a class="sym-link local-def" href="#def-get-kw" data-sym="GET-KW" title="(defun get-kw (key default kwlist)
  (declare (xargs :guard (keyword-value-listp kwlist)))
  (let ((look (assoc-keyword key kwlist)))
    (if look
        (cadr look)">get-kw</a> <span class="keyword">:last</span> nil kwlist))
      ((unless <a class="sym-link system" href="../../../axioms.html#def-last" data-sym="LAST">last</a>) (<a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> hard? '<a class="sym-link local-def" href="#def-defiteration" data-sym="DEFITERATION" title="(defmacro defiteration (name formals &amp;rest args)
  (defiteration-fn name formals args))">defiteration</a> <span class="string">"Need :last argument"</span>))
      (index (<a class="sym-link local-def" href="#def-get-kw" data-sym="GET-KW" title="(defun get-kw (key default kwlist)
  (declare (xargs :guard (keyword-value-listp kwlist)))
  (let ((look (assoc-keyword key kwlist)))
    (if look
        (cadr look)">get-kw</a> <span class="keyword">:index</span> (intern-in-package-of-symbol <span class="string">"N"</span> name)
          kwlist))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-member" data-sym="MEMBER">member</a> index <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)) (<a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> hard?
          '<a class="sym-link local-def" href="#def-defiteration" data-sym="DEFITERATION" title="(defmacro defiteration (name formals &amp;rest args)
  (defiteration-fn name formals args))">defiteration</a>
          <span class="string">"Index variable (~x0) must not be in formals"</span>
          index))
      (init-vals (<a class="sym-link local-def" href="#def-get-kw" data-sym="GET-KW" title="(defun get-kw (key default kwlist)
  (declare (xargs :guard (keyword-value-listp kwlist)))
  (let ((look (assoc-keyword key kwlist)))
    (if look
        (cadr look)">get-kw</a> <span class="keyword">:init-vals</span> nil kwlist))
      (init-val-vars (<a class="sym-link system" href="../../../axioms.html#def-strip-cars" data-sym="STRIP-CARS">strip-cars</a> init-vals))
      ((unless (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-symbol-listp" data-sym="SYMBOL-LISTP">symbol-listp</a> init-val-vars)
           (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-member-eq" data-sym="MEMBER-EQ">member-eq</a> index init-val-vars))
           (<a class="sym-link system" href="../../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../../axioms.html#def-intersectp-eq" data-sym="INTERSECTP-EQ">intersectp-eq</a> init-val-vars <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)))) (<a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> hard?
          '<a class="sym-link local-def" href="#def-defiteration" data-sym="DEFITERATION" title="(defmacro defiteration (name formals &amp;rest args)
  (defiteration-fn name formals args))">defiteration</a>
          <span class="string">"May not assign initial values to formals or index var"</span>))
      (returns (<a class="sym-link local-def" href="#def-get-kw" data-sym="GET-KW" title="(defun get-kw (key default kwlist)
  (declare (xargs :guard (keyword-value-listp kwlist)))
  (let ((look (assoc-keyword key kwlist)))
    (if look
        (cadr look)">get-kw</a> <span class="keyword">:returns</span> nil kwlist))
      ((unless returns) (<a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> hard? '<a class="sym-link local-def" href="#def-defiteration" data-sym="DEFITERATION" title="(defmacro defiteration (name formals &amp;rest args)
  (defiteration-fn name formals args))">defiteration</a> <span class="string">"Must specify :returns"</span>))
      ((unless (if (symbolp returns)
           (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-member" data-sym="MEMBER">member</a> returns <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>) (<a class="sym-link system" href="../../../axioms.html#def-member" data-sym="MEMBER">member</a> returns init-val-vars))
           (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-symbol-listp" data-sym="SYMBOL-LISTP">symbol-listp</a> returns)
             (<a class="sym-link system" href="../../../axioms.html#def-eq" data-sym="EQ">eq</a> (car returns) '<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a>)
             (consp (cdr returns))
             (<a class="sym-link system" href="../../../axioms.html#def-subsetp-eq" data-sym="SUBSETP-EQ">subsetp-eq</a> (<a class="sym-link system" href="../../../axioms.html#def-set-difference-eq" data-sym="SET-DIFFERENCE-EQ">set-difference-eq</a> (cdr returns) <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)
               init-val-vars)))) (<a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> hard?
          '<a class="sym-link local-def" href="#def-defiteration" data-sym="DEFITERATION" title="(defmacro defiteration (name formals &amp;rest args)
  (defiteration-fn name formals args))">defiteration</a>
          <span class="string">"Returns must be either a variable symbol or ~
                                 MV of variable symbols, with each symbol ~
                                 either a formal or given an initial value in ~
                                 :init-vals"</span>))
      (hints (<a class="sym-link local-def" href="#def-get-kw" data-sym="GET-KW" title="(defun get-kw (key default kwlist)
  (declare (xargs :guard (keyword-value-listp kwlist)))
  (let ((look (assoc-keyword key kwlist)))
    (if look
        (cadr look)">get-kw</a> <span class="keyword">:hints</span> nil kwlist))
      (iter-guard (<a class="sym-link local-def" href="#def-get-kw" data-sym="GET-KW" title="(defun get-kw (key default kwlist)
  (declare (xargs :guard (keyword-value-listp kwlist)))
  (let ((look (assoc-keyword key kwlist)))
    (if look
        (cadr look)">get-kw</a> <span class="keyword">:iter-guard</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> kwlist))
      (iter-decls (<a class="sym-link local-def" href="#def-get-kw" data-sym="GET-KW" title="(defun get-kw (key default kwlist)
  (declare (xargs :guard (keyword-value-listp kwlist)))
  (let ((look (assoc-keyword key kwlist)))
    (if look
        (cadr look)">get-kw</a> <span class="keyword">:iter-decls</span> nil kwlist))
      (top-guard (<a class="sym-link local-def" href="#def-get-kw" data-sym="GET-KW" title="(defun get-kw (key default kwlist)
  (declare (xargs :guard (keyword-value-listp kwlist)))
  (let ((look (assoc-keyword key kwlist)))
    (if look
        (cadr look)">get-kw</a> <span class="keyword">:top-guard</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> kwlist))
      (top-returns (<a class="sym-link local-def" href="#def-get-kw" data-sym="GET-KW" title="(defun get-kw (key default kwlist)
  (declare (xargs :guard (keyword-value-listp kwlist)))
  (let ((look (assoc-keyword key kwlist)))
    (if look
        (cadr look)">get-kw</a> <span class="keyword">:top-returns</span> nil kwlist))
      (guard-hints (<a class="sym-link local-def" href="#def-get-kw" data-sym="GET-KW" title="(defun get-kw (key default kwlist)
  (declare (xargs :guard (keyword-value-listp kwlist)))
  (let ((look (assoc-keyword key kwlist)))
    (if look
        (cadr look)">get-kw</a> <span class="keyword">:guard-hints</span> nil kwlist))
      (package (<a class="sym-link local-def" href="#def-get-kw" data-sym="GET-KW" title="(defun get-kw (key default kwlist)
  (declare (xargs :guard (keyword-value-listp kwlist)))
  (let ((look (assoc-keyword key kwlist)))
    (if look
        (cadr look)">get-kw</a> <span class="keyword">:package</span> name kwlist))
      (val-vars (if (symbolp returns)
          (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> returns)
          (cdr returns)))
      (aux-vars (<a class="sym-link system" href="../../../axioms.html#def-set-difference-eq" data-sym="SET-DIFFERENCE-EQ">set-difference-eq</a> (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> init-val-vars) val-vars))
      (body-is-simple (<a class="sym-link system" href="../../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../../axioms.html#def-atom" data-sym="ATOM">atom</a> <a class="sym-link system" href="../../../basis-b.html#def-body" data-sym="BODY">body</a>)
          (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (symbolp (car <a class="sym-link system" href="../../../basis-b.html#def-body" data-sym="BODY">body</a>)) (<a class="sym-link local-def" href="#def-var_2Fconst-listp" data-sym="VAR/CONST-LISTP" title="(defun var/const-listp (x)
  (declare (xargs :guard t))
  (if (atom x)
      (eq x nil)
      (and (or (atom (car x)) (eq (caar x) &#39;quote)) (var/const-listp (cdr x)))))">var/const-listp</a> (cdr <a class="sym-link system" href="../../../basis-b.html#def-body" data-sym="BODY">body</a>)))))
      (iter-formals (cons index (<a class="sym-link system" href="../../../axioms.html#def-append" data-sym="APPEND">append</a> init-val-vars <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)))
      (step-call (if body-is-simple
          <a class="sym-link system" href="../../../basis-b.html#def-body" data-sym="BODY">body</a>
          (cons (intern-in-package-of-symbol (<a class="sym-link system" href="../../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../../axioms.html#def-string" data-sym="STRING">string</a> (symbol-name name) <span class="string">"-STEP"</span>)
              package)
            iter-formals)))
      (step (car step-call))
      (tailrec (intern-in-package-of-symbol (<a class="sym-link system" href="../../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../../axioms.html#def-string" data-sym="STRING">string</a> (symbol-name name) <span class="string">"-TAILREC"</span>)
          package))
      (iter (intern-in-package-of-symbol (<a class="sym-link system" href="../../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../../axioms.html#def-string" data-sym="STRING">string</a> (symbol-name name) <span class="string">"-ITER"</span>)
          package))
      (iter-meas (if (equal <a class="sym-link system" href="../../../axioms.html#def-first" data-sym="FIRST">first</a> <span class="number">0</span>)
          index
          `(<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> ,INDEX) (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> ,FIRST))))
      (thmname (intern-in-package-of-symbol (<a class="sym-link system" href="../../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../../axioms.html#def-string" data-sym="STRING">string</a>
            (symbol-name tailrec)
            <span class="string">"-IS-"</span>
            (symbol-name iter))
          package)))
    `(<a class="sym-link system" href="../../../axioms.html#def-encapsulate" data-sym="ENCAPSULATE">encapsulate</a> nil
      ,@(AND (NOT BODY-IS-SIMPLE)
       `((DEFUN-INLINE ,STEP ,ITER-FORMALS
                       (DECLARE
                        (TYPE
                         (INTEGER
                          ,(IF (INTEGERP FIRST)
                               FIRST
                               (QUOTE *))
                          ,(IF (INTEGERP LAST)
                               LAST
                               (QUOTE *)))
                         ,INDEX)
                        (IGNORABLE ,INDEX ,@INIT-VAL-VARS . ,FORMALS)
                        (XARGS :GUARD-HINTS ,GUARD-HINTS)
                        . ,ITER-DECLS)
                       ,@DECLS
                       (DECLARE
                        (XARGS :GUARD
                         (AND (&lt;= ,FIRST ,INDEX) (&lt; ,INDEX ,LAST)
                              ,ITER-GUARD)))
                       ,BODY)))
      (defund ,TAILREC
        ,ITER-FORMALS
        (declare (type (integer ,(IF (INTEGERP FIRST)
     FIRST
     &#39;*)
              ,(IF (INTEGERP LAST)
     LAST
     &#39;*))
            ,INDEX)
          (xargs <span class="keyword">:measure</span> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> ,LAST) (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> ,INDEX)))) . ,ITER-DECLS)
        ,@DECLS
        (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> ,FIRST ,INDEX) (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> ,INDEX ,LAST) ,ITER-GUARD)))
        (<a class="sym-link external" href="../../std/util/bstar.html#def-b_2A" data-sym="B*">b*</a> (((when (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> ,LAST) (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a> ,INDEX)))
                <span class="keyword">:exec</span> (<a class="sym-link system" href="../../../axioms.html#def-int_3D" data-sym="INT=">int=</a> ,LAST ,INDEX))) ,RETURNS) (,INDEX (lifix ,INDEX))
            (,RETURNS ,STEP-CALL))
          (,TAILREC (<a class="sym-link system" href="../../../axioms.html#def-1_2B" data-sym="1+">1+</a> ,INDEX) . ,(CDR ITER-FORMALS))))
      (defund ,ITER
        ,ITER-FORMALS
        (declare (type (integer ,(IF (INTEGERP FIRST)
     FIRST
     &#39;*)
              ,(IF (INTEGERP LAST)
     LAST
     &#39;*))
            ,INDEX)
          (xargs <span class="keyword">:measure</span> (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> ,ITER-MEAS) <span class="keyword">:verify-guards</span> nil) . ,ITER-DECLS)
        ,@DECLS
        (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> ,FIRST ,INDEX) (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> ,INDEX ,LAST) ,ITER-GUARD)))
        (<a class="sym-link external" href="../../std/util/bstar.html#def-b_2A" data-sym="B*">b*</a> (((when (<a class="sym-link system" href="../../../axioms.html#def-mbe" data-sym="MBE">mbe</a> <span class="keyword">:logic</span> (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a> ,ITER-MEAS) <span class="keyword">:exec</span> (<a class="sym-link system" href="../../../axioms.html#def-int_3D" data-sym="INT=">int=</a> ,FIRST ,INDEX))) ,RETURNS) (,INDEX (<a class="sym-link system" href="../../../axioms.html#def-1-" data-sym="1-">1-</a> (lifix ,INDEX)))
            (,RETURNS (,ITER . ,ITER-FORMALS)))
          ,STEP-CALL))
      (<a class="sym-link external" href="../fty/fixtype.html#def-deffixcong" data-sym="DEFFIXCONG">deffixcong</a> int-equiv
        equal
        (,ITER . ,ITER-FORMALS)
        ,INDEX
        <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:in-theory</span> (enable ,ITER))))
      (<a class="sym-link system" href="../../../axioms.html#def-encapsulate" data-sym="ENCAPSULATE">encapsulate</a> nil
        (<a class="sym-link system" href="../../../axioms.html#def-set-ignore-ok" data-sym="SET-IGNORE-OK">set-ignore-ok</a> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
        (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,THMNAME
          (equal (,TAILREC ,FIRST . ,(CDR ITER-FORMALS))
            (,ITER ,LAST . ,(CDR ITER-FORMALS)))
          <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:use</span> ((<span class="keyword">:instance</span> (<span class="keyword">:functional-instance</span> iter-up-is-iter-down
                  (iter-fix-val (lambda (val) (<a class="sym-link external" href="../../std/util/bstar.html#def-b_2A" data-sym="B*">b*</a> ((,RETURNS val)) ,RETURNS)))
                  (iter-first (lambda (aux val)
                      (<a class="sym-link external" href="../../std/util/bstar.html#def-b_2A" data-sym="B*">b*</a> (((<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> . ,AUX-VARS) aux) (,RETURNS val)) ,FIRST)))
                  (iter-last (lambda (aux val)
                      (<a class="sym-link external" href="../../std/util/bstar.html#def-b_2A" data-sym="B*">b*</a> (((<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> . ,AUX-VARS) aux) (,RETURNS val)) ,LAST)))
                  (iter-step (lambda (n aux val)
                      (<a class="sym-link external" href="../../std/util/bstar.html#def-b_2A" data-sym="B*">b*</a> (((<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> . ,AUX-VARS) aux) (,RETURNS val) (,INDEX n))
                        ,STEP-CALL)))
                  (<a class="sym-link local-def" href="#def-iter-up" data-sym="ITER-UP" title="(encapsulate nil (local (in-theory (enable* arith-equiv-forwarding)))
             (local (include-book &quot;arithmetic/top-with-meta&quot; :dir :system))
             (encapsulate
              (((iter-step * * *) =&gt; *) ((iter-first * *) =&gt; *)
               ((iter-last * *) =&gt; *) ((iter-fix-val *) =&gt; *))
...">iter-up</a> (lambda (n aux val)
                      (<a class="sym-link external" href="../../std/util/bstar.html#def-b_2A" data-sym="B*">b*</a> (((<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> . ,AUX-VARS) aux) (,RETURNS val))
                        (,TAILREC n . ,(CDR ITER-FORMALS)))))
                  (iter-down (lambda (n aux val)
                      (<a class="sym-link external" href="../../std/util/bstar.html#def-b_2A" data-sym="B*">b*</a> (((<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> . ,AUX-VARS) aux) (,RETURNS val))
                        (,ITER n . ,(CDR ITER-FORMALS))))))
                (aux (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> . ,AUX-VARS))
                (val ,RETURNS)))
             <span class="keyword">:in-theory</span> '(,ITER ,TAILREC
               <a class="sym-link system" href="../../../axioms.html#def-car-cons" data-sym="CAR-CONS">car-cons</a>
               <a class="sym-link system" href="../../../axioms.html#def-cdr-cons" data-sym="CDR-CONS">cdr-cons</a>
               <a class="sym-link external" href="../../std/basic/arith-equivs.html#def-zp-when-integerp" data-sym="ZP-WHEN-INTEGERP">zp-when-integerp</a>
               <a class="sym-link system" href="../../../axioms.html#def-commutativity-of-_2B" data-sym="COMMUTATIVITY-OF-+">commutativity-of-+</a>
               (equal)
               (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a>)
               (unary--)
               (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a>)
               <a class="sym-link external" href="../../std/basic/arith-equivs.html#def-ifix-positive-to-non-zp" data-sym="IFIX-POSITIVE-TO-NON-ZP">ifix-positive-to-non-zp</a>
               <a class="sym-link system" href="../../../axioms.html#def-unicity-of-0" data-sym="UNICITY-OF-0">unicity-of-0</a>
               <a class="sym-link system" href="../../../axioms.html#def-fix" data-sym="FIX">fix</a>
               lnfix
               lifix
               (<span class="keyword">:type-prescription</span> <a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a>))
             <span class="keyword">:do-not-induct</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>) ,@HINTS
            (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> stable-under-simplificationp '(<span class="keyword">:in-theory</span> (enable))))))
      ,@(AND TOP-RETURNS &#39;((SET-IGNORE-OK T)))
      (<a class="sym-link system" href="../../../axioms.html#def-defun-inline" data-sym="DEFUN-INLINE">defun-inline</a> ,NAME
        ,FORMALS
        ,@(IF DOC
      (LIST DOC)
      NIL)
        ,@DECLS
        ,@(AND TOP-GUARD `((DECLARE (XARGS :GUARD ,TOP-GUARD))))
        ,(IF TOP-RETURNS
     `(B*
       (,@INIT-VALS
        (,RETURNS
         (MBE :LOGIC (,ITER ,LAST . ,(CDR ITER-FORMALS)) :EXEC
              (,TAILREC ,FIRST . ,(CDR ITER-FORMALS)))))
       ,TOP-RETURNS)
     `(B* ,INIT-VALS
       (MBE :LOGIC (,ITER ,LAST . ,(CDR ITER-FORMALS)) :EXEC
            (,TAILREC ,FIRST . ,(CDR ITER-FORMALS))))))
      (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (enable (<span class="keyword">:induction</span> ,ITER))))))</pre>
  </div>

<div class="form-block other" id="form-12" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link external" href="../../xdoc/base.html#def-defxdoc" data-sym="DEFXDOC">defxdoc</a> <a class="sym-link local-def" href="#def-defiteration" data-sym="DEFITERATION" title="(defmacro defiteration (name formals &amp;rest args)
  (defiteration-fn name formals args))">defiteration</a>
  <span class="keyword">:parents</span> (programming)
  <span class="keyword">:short</span> <span class="string">"Define a simple for-loop-style iteration, counting up over some
range."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;This macro defines the logic version of this loop as a
non-tail-recursive function that counts down from the maximum value to the
minimum value.  This is often better for reasoning with.  The executable
version is a function that counts up from the minimum to the maximum value and
is tail-recursive, which may be better for execution, especially in terms of
avoiding stack overflows.&lt;/p&gt;

&lt;p&gt;Syntax:&lt;/p&gt;

@({
    (defiteration function-name (a b c)
      &quot;optional doc string&quot;
      (declare ...)        ;; optional declare forms
      (body idx-var a b c) ;; one step of the iteration
      :returns (mv b c)    ;; or a single variable, must be from the formals
      :index idx-var       ;; counter variable
      :first (foo a b)     ;; starting index, default 0
      :last  (bar a c)     ;; final index
      :hints ...           ;; optional, for proving that tailrec and non-tailrec
                           ;; are the same
      :guard-hints ...     ;; for defining the step function
      :package foo)        ;; package witness symbol, default is function-name
})"</span>)</pre>
  </div>

<div class="form-block macro" id="def-defiteration" data-defines="DEFITERATION" data-references="DEFITERATION-FN,ARGS,&REST,FORMALS,NAME,DEFMACRO" data-used-by="DEF-LIST-CONSTRUCTOR-FN,DEFITERATION-FN,DEFITERATION-SORT-ARGS" typeof="Code">
    <div class="form-header"><span class="form-name" property="name" data-sym="DEFITERATION">defiteration</span><span class="form-type">macro</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> <a class="sym-link local-def" href="#def-defiteration" data-sym="DEFITERATION" title="(defmacro defiteration (name formals &amp;rest args)
  (defiteration-fn name formals args))">defiteration</a>
  (name <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> &amp;rest <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)
  (<a class="sym-link local-def" href="#def-defiteration-fn" data-sym="DEFITERATION-FN" title="(defun defiteration-fn (name formals args)
  (b*
   (((mv decls doc body kwlist) (defiteration-sort-args args))
    (first (get-kw :first 0 kwlist)) (last (get-kw :last nil kwlist))
    ((unless last) (er hard? &#39;defiteration &quot;Need :last argument&quot;))
...">defiteration-fn</a> name <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>))</pre>
  </div>

<div class="form-block local" id="form-14" typeof="Code">
    <div class="form-header"><span class="form-type">local</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../../axioms.html#def-progn" data-sym="PROGN">progn</a> (<a class="sym-link local-def" href="#def-defiteration" data-sym="DEFITERATION" title="(defmacro defiteration (name formals &amp;rest args)
  (defiteration-fn name formals args))">defiteration</a> countup
      (a b)
      (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> a) (acl2-numberp b))))
      (<a class="sym-link system" href="../../../axioms.html#def-1_2B" data-sym="1+">1+</a> b)
      <span class="keyword">:returns</span> b
      <span class="keyword">:last</span> a)
    (<a class="sym-link local-def" href="#def-defiteration" data-sym="DEFITERATION" title="(defmacro defiteration (name formals &amp;rest args)
  (defiteration-fn name formals args))">defiteration</a> countup-from
      (s a b)
      (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> a) (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> s) (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> s a) (acl2-numberp b))))
      (<a class="sym-link system" href="../../../axioms.html#def-1_2B" data-sym="1+">1+</a> b)
      <span class="keyword">:index</span> nn
      <span class="keyword">:returns</span> b
      <span class="keyword">:first</span> s
      <span class="keyword">:last</span> a)
    (<a class="sym-link local-def" href="#def-defiteration" data-sym="DEFITERATION" title="(defmacro defiteration (name formals &amp;rest args)
  (defiteration-fn name formals args))">defiteration</a> countup-more
      (s a b)
      (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> a) (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> s) (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> s a) (acl2-numberp b))))
      (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> nn b)
      <span class="keyword">:index</span> nn
      <span class="keyword">:returns</span> b
      <span class="keyword">:first</span> s
      <span class="keyword">:last</span> a)
    (<a class="sym-link local-def" href="#def-defiteration" data-sym="DEFITERATION" title="(defmacro defiteration (name formals &amp;rest args)
  (defiteration-fn name formals args))">defiteration</a> countup-2
      (s a b c)
      (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> a)
            (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> s)
            (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> s a)
            (acl2-numberp b)
            (acl2-numberp c))))
      (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> nn b) (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> c nn))
      <span class="keyword">:index</span> nn
      <span class="keyword">:returns</span> (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> b c)
      <span class="keyword">:first</span> s
      <span class="keyword">:last</span> a)
    (<a class="sym-link local-def" href="#def-defiteration" data-sym="DEFITERATION" title="(defmacro defiteration (name formals &amp;rest args)
  (defiteration-fn name formals args))">defiteration</a> countup-3
      (s a c)
      (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> a) (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> s) (<a class="sym-link system" href="../../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> s a) (acl2-numberp c))))
      (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> nn b) (<a class="sym-link system" href="../../../axioms.html#def--" data-sym="-">-</a> c nn))
      <span class="keyword">:index</span> nn
      <span class="keyword">:returns</span> (<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> b c)
      <span class="keyword">:first</span> s
      <span class="keyword">:last</span> a
      <span class="keyword">:init-vals</span> ((b <span class="number">0</span>))
      <span class="keyword">:iter-guard</span> (acl2-numberp b))))</pre>
  </div>

<div class="form-block other" id="form-15" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../basis-b.html#def-defstub" data-sym="DEFSTUB">defstub</a> listconstr-val (n <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>) nil)</pre>
  </div>

<div class="form-block other" id="form-16" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../basis-b.html#def-defstub" data-sym="DEFSTUB">defstub</a> listconstr-last (<a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>) nil)</pre>
  </div>

<div class="form-block other" id="form-17" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link local-def" href="#def-defiteration" data-sym="DEFITERATION" title="(defmacro defiteration (name formals &amp;rest args)
  (defiteration-fn name formals args))">defiteration</a> listconstr
  (<a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)
  (declare (xargs <span class="keyword">:verify-guards</span> nil))
  (let ((val (listconstr-val n <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)))
    (<a class="sym-link system" href="../../../axioms.html#def-update-nth" data-sym="UPDATE-NTH">update-nth</a> n val lst))
  <span class="keyword">:returns</span> lst
  <span class="keyword">:last</span> (listconstr-last <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)
  <span class="keyword">:init-vals</span> ((lst nil))
  <span class="keyword">:iter-guard</span> (<a class="sym-link system" href="../../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> lst))</pre>
  </div>

<div class="form-block theorem" id="def-nth-of-listconstr-iter" data-defines="NTH-OF-LISTCONSTR-ITER" data-references="LISTCONSTR-VAL,NFIX,<,AND,FORMALS,N,LISTCONSTR-ITER,M,NTH,EQUAL,DEFTHM" data-part-name="NTH-OF-LISTCONSTR-ITER" data-part-term="LISTCONSTR-VAL,NFIX,<,AND,FORMALS,N,LISTCONSTR-ITER,M,NTH,EQUAL" data-part-hints="FORMALS,N,LISTCONSTR-ITER" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="NTH-OF-LISTCONSTR-ITER">nth-of-listconstr-iter</span><span class="form-type">theorem</span></div>
    <div class="part-buttons"><button class="part-btn" data-part="term">term</button><button class="part-btn" data-part="hints">hints</button></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> <a class="sym-link local-def" href="#def-nth-of-listconstr-iter" data-sym="NTH-OF-LISTCONSTR-ITER" title="(defthm nth-of-listconstr-iter
        (equal (nth m (listconstr-iter n nil formals))
               (and (&lt; (nfix m) (nfix n)) (listconstr-val (nfix m) formals)))
        :hints
        ((&quot;goal&quot; :induct (listconstr-iter n nil formals) :expand">nth-of-listconstr-iter</a>
  (equal (<a class="sym-link system" href="../../../axioms.html#def-nth" data-sym="NTH">nth</a> m (listconstr-iter n nil <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>))
    (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (&lt; (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> m) (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> n))
      (listconstr-val (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> m) <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)))
  <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:induct</span> (listconstr-iter n nil <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)
     <span class="keyword">:expand</span> ((listconstr-iter n nil <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)))))</pre>
  </div>

<div class="form-block theorem" id="def-len-of-listconstr-iter" data-defines="LEN-OF-LISTCONSTR-ITER" data-references="NFIX,FORMALS,N,LISTCONSTR-ITER,LEN,EQUAL,DEFTHM" data-part-name="LEN-OF-LISTCONSTR-ITER" data-part-term="NFIX,FORMALS,N,LISTCONSTR-ITER,LEN,EQUAL" data-part-hints="FORMALS,N,LISTCONSTR-ITER" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="LEN-OF-LISTCONSTR-ITER">len-of-listconstr-iter</span><span class="form-type">theorem</span></div>
    <div class="part-buttons"><button class="part-btn" data-part="term">term</button><button class="part-btn" data-part="hints">hints</button></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> <a class="sym-link local-def" href="#def-len-of-listconstr-iter" data-sym="LEN-OF-LISTCONSTR-ITER" title="(defthm len-of-listconstr-iter
        (equal (len (listconstr-iter n nil formals)) (nfix n)) :hints
        ((&quot;goal&quot; :induct (listconstr-iter n nil formals) :expand
          ((listconstr-iter n nil formals)))))">len-of-listconstr-iter</a>
  (equal (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> (listconstr-iter n nil <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)) (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> n))
  <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:induct</span> (listconstr-iter n nil <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)
     <span class="keyword">:expand</span> ((listconstr-iter n nil <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)))))</pre>
  </div>

<div class="form-block theorem" id="def-true-listp-of-listconstr-iter" data-defines="TRUE-LISTP-OF-LISTCONSTR-ITER" data-references="FORMALS,N,LISTCONSTR-ITER,TRUE-LISTP,DEFTHM" data-part-name="TRUE-LISTP-OF-LISTCONSTR-ITER" data-part-term="FORMALS,N,LISTCONSTR-ITER,TRUE-LISTP" data-part-hints="FORMALS,N,LISTCONSTR-ITER" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="TRUE-LISTP-OF-LISTCONSTR-ITER">true-listp-of-listconstr-iter</span><span class="form-type">theorem</span></div>
    <div class="part-buttons"><button class="part-btn" data-part="term">term</button><button class="part-btn" data-part="hints">hints</button></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> <a class="sym-link local-def" href="#def-true-listp-of-listconstr-iter" data-sym="TRUE-LISTP-OF-LISTCONSTR-ITER" title="(defthm true-listp-of-listconstr-iter
        (true-listp (listconstr-iter n nil formals)) :hints
        ((&quot;goal&quot; :induct (listconstr-iter n nil formals) :expand
          ((listconstr-iter n nil formals)))))">true-listp-of-listconstr-iter</a>
  (<a class="sym-link system" href="../../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> (listconstr-iter n nil <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>))
  <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:induct</span> (listconstr-iter n nil <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)
     <span class="keyword">:expand</span> ((listconstr-iter n nil <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)))))</pre>
  </div>

<div class="form-block theorem" id="def-nth-of-listconstr" data-defines="NTH-OF-LISTCONSTR" data-references="LISTCONSTR-VAL,LISTCONSTR-LAST,<,AND,NFIX,LET,FORMALS,LISTCONSTR,N,NTH,EQUAL,DEFTHM" data-used-by="DEF-LIST-CONSTRUCTOR-FN" data-part-name="NTH-OF-LISTCONSTR" data-part-term="LISTCONSTR-VAL,LISTCONSTR-LAST,<,AND,NFIX,LET,FORMALS,LISTCONSTR,N,NTH,EQUAL" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="NTH-OF-LISTCONSTR">nth-of-listconstr</span><span class="form-type">theorem</span></div>
    <div class="part-buttons"><button class="part-btn" data-part="term">term</button></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> <a class="sym-link local-def" href="#def-nth-of-listconstr" data-sym="NTH-OF-LISTCONSTR" title="(defthm nth-of-listconstr
        (equal (nth n (listconstr formals))
               (let ((n (nfix n)))
                 (and (&lt; n (nfix (listconstr-last formals)))
                      (listconstr-val n formals)))))">nth-of-listconstr</a>
  (equal (<a class="sym-link system" href="../../../axioms.html#def-nth" data-sym="NTH">nth</a> n (listconstr <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>))
    (let ((n (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> n)))
      (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (&lt; n (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> (listconstr-last <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)))
        (listconstr-val n <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)))))</pre>
  </div>

<div class="form-block theorem" id="def-len-of-listconstr" data-defines="LEN-OF-LISTCONSTR" data-references="LISTCONSTR-LAST,NFIX,FORMALS,LISTCONSTR,LEN,EQUAL,DEFTHM" data-used-by="DEF-LIST-CONSTRUCTOR-FN" data-part-name="LEN-OF-LISTCONSTR" data-part-term="LISTCONSTR-LAST,NFIX,FORMALS,LISTCONSTR,LEN,EQUAL" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="LEN-OF-LISTCONSTR">len-of-listconstr</span><span class="form-type">theorem</span></div>
    <div class="part-buttons"><button class="part-btn" data-part="term">term</button></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> <a class="sym-link local-def" href="#def-len-of-listconstr" data-sym="LEN-OF-LISTCONSTR" title="(defthm len-of-listconstr
        (equal (len (listconstr formals)) (nfix (listconstr-last formals))))">len-of-listconstr</a>
  (equal (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> (listconstr <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>))
    (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> (listconstr-last <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>))))</pre>
  </div>

<div class="form-block theorem" id="def-true-listp-of-listconstr" data-defines="TRUE-LISTP-OF-LISTCONSTR" data-references="FORMALS,LISTCONSTR,TRUE-LISTP,DEFTHM" data-used-by="DEF-LIST-CONSTRUCTOR-FN" data-part-name="TRUE-LISTP-OF-LISTCONSTR" data-part-term="FORMALS,LISTCONSTR,TRUE-LISTP" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="TRUE-LISTP-OF-LISTCONSTR">true-listp-of-listconstr</span><span class="form-type">theorem</span></div>
    <div class="part-buttons"><button class="part-btn" data-part="term">term</button></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> <a class="sym-link local-def" href="#def-true-listp-of-listconstr" data-sym="TRUE-LISTP-OF-LISTCONSTR" title="(defthm true-listp-of-listconstr (true-listp (listconstr formals)))">true-listp-of-listconstr</a>
  (<a class="sym-link system" href="../../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> (listconstr <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)))</pre>
  </div>

<div class="form-block function" id="def-def-list-constructor-fn" data-defines="DEF-LIST-CONSTRUCTOR-FN" data-references="TRUE-LISTP-OF-LISTCONSTR,LEN-OF-LISTCONSTR,LEN,ENABLE,IMPLIES,DEFTHM,FIX,UNICITY-OF-0,IFIX-POSITIVE-TO-NON-ZP,ZP,UNARY--,IFIX,COMMUTATIVITY-OF-+,ZP-WHEN-INTEGERP,CDR-CONS,CAR-CONS,NTH-OF-LISTCONSTR,<,NFIX,NTH,EQUAL,DEFTHMD,DISABLE,IN-THEORY,TRUE-LISTP,AND,UPDATE-NTH,VAL,LET,DEFITERATION,SET-IRRELEVANT-FORMALS-OK,SET-IGNORE-OK,ENCAPSULATE,LISTCONSTR$INLINE,LISTCONSTR-TAILREC,LISTCONSTR-ITER,LST,LISTCONSTR-STEP$INLINE,LISTCONSTR-LAST,LIST,N,LAMBDA,LISTCONSTR-VAL,QUASIQUOTE,FSUBST,?LEN-THMNAME,?TRUE-LISTP-THMNAME,NTH-SPLIT-THMNAME,?NTH-THMNAME,STEP,STEP-CALL,CONS,ITER-FORMALS,TAILREC,SYMBOL-NAME,STRING,CONCATENATE,ITER,PACKAGE,T,ITER-GUARD,UNLESS,LENGTH,LIST-VAR,DEF-LIST-CONSTRUCTOR,QUOTE,HARD?,ER,MEMBER,WHEN,INTERN-IN-PACKAGE-OF-SYMBOL,GET-KW,INDEX,DEFITERATION-SORT-ARGS,KWLIST,BODY,DOC,DECLS,MV,B*,ARGS,FORMALS,NAME,DEFUN" data-used-by="DEF-LIST-CONSTRUCTOR" data-part-name="DEF-LIST-CONSTRUCTOR-FN" data-part-args="ARGS,FORMALS,NAME" data-part-body="TRUE-LISTP-OF-LISTCONSTR,LEN-OF-LISTCONSTR,LEN,ENABLE,IMPLIES,DEFTHM,FIX,UNICITY-OF-0,IFIX-POSITIVE-TO-NON-ZP,ZP,UNARY--,IFIX,COMMUTATIVITY-OF-+,ZP-WHEN-INTEGERP,CDR-CONS,CAR-CONS,NTH-OF-LISTCONSTR,<,NFIX,NTH,EQUAL,DEFTHMD,DISABLE,IN-THEORY,TRUE-LISTP,AND,UPDATE-NTH,VAL,LET,DEFITERATION,SET-IRRELEVANT-FORMALS-OK,SET-IGNORE-OK,ENCAPSULATE,LISTCONSTR$INLINE,LISTCONSTR-TAILREC,LISTCONSTR-ITER,LST,LISTCONSTR-STEP$INLINE,LISTCONSTR-LAST,LIST,N,LAMBDA,LISTCONSTR-VAL,QUASIQUOTE,FSUBST,?LEN-THMNAME,?TRUE-LISTP-THMNAME,NTH-SPLIT-THMNAME,?NTH-THMNAME,STEP,STEP-CALL,CONS,ITER-FORMALS,TAILREC,SYMBOL-NAME,STRING,CONCATENATE,ITER,PACKAGE,T,ITER-GUARD,UNLESS,LENGTH,LIST-VAR,DEF-LIST-CONSTRUCTOR,QUOTE,HARD?,ER,FORMALS,MEMBER,WHEN,NAME,INTERN-IN-PACKAGE-OF-SYMBOL,GET-KW,INDEX,ARGS,DEFITERATION-SORT-ARGS,KWLIST,BODY,DOC,DECLS,MV,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="DEF-LIST-CONSTRUCTOR-FN">def-list-constructor-fn</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-def-list-constructor-fn" data-sym="DEF-LIST-CONSTRUCTOR-FN" title="(defun def-list-constructor-fn (name formals args)
  (b*
   (((mv decls doc body kwlist) (defiteration-sort-args args))
    (index (get-kw :index (intern-in-package-of-symbol &quot;N&quot; name) kwlist))
    ((when (member index formals))
...">def-list-constructor-fn</a>
  (name <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)
  (<a class="sym-link external" href="../../std/util/bstar.html#def-b_2A" data-sym="B*">b*</a> (((<a class="sym-link system" href="../../../axioms.html#def-mv" data-sym="MV">mv</a> decls <a class="sym-link system" href="../../../history-management.html#def-doc" data-sym="DOC">doc</a> <a class="sym-link system" href="../../../basis-b.html#def-body" data-sym="BODY">body</a> kwlist) (<a class="sym-link local-def" href="#def-defiteration-sort-args" data-sym="DEFITERATION-SORT-ARGS" title="(defun defiteration-sort-args (args)
  (cond
   ((atom args)
    (prog2$ (er hard? &#39;defiteration &quot;not enough args&quot;) (mv nil nil nil nil)))
   ((and (consp (car args)) (eq (caar args) &#39;declare))
...">defiteration-sort-args</a> <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)) (index (<a class="sym-link local-def" href="#def-get-kw" data-sym="GET-KW" title="(defun get-kw (key default kwlist)
  (declare (xargs :guard (keyword-value-listp kwlist)))
  (let ((look (assoc-keyword key kwlist)))
    (if look
        (cadr look)">get-kw</a> <span class="keyword">:index</span> (intern-in-package-of-symbol <span class="string">"N"</span> name)
          kwlist))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-member" data-sym="MEMBER">member</a> index <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)) (<a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> hard?
          '<a class="sym-link local-def" href="#def-def-list-constructor" data-sym="DEF-LIST-CONSTRUCTOR" title="(defmacro def-list-constructor (name formals &amp;rest args)
  (def-list-constructor-fn name formals args))">def-list-constructor</a>
          <span class="string">"Index variable (~x0) must not be in formals"</span>
          index))
      (list-var (<a class="sym-link local-def" href="#def-get-kw" data-sym="GET-KW" title="(defun get-kw (key default kwlist)
  (declare (xargs :guard (keyword-value-listp kwlist)))
  (let ((look (assoc-keyword key kwlist)))
    (if look
        (cadr look)">get-kw</a> <span class="keyword">:list-var</span> (intern-in-package-of-symbol <span class="string">"LST"</span> name)
          kwlist))
      ((when (<a class="sym-link system" href="../../../axioms.html#def-member" data-sym="MEMBER">member</a> list-var <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)) (<a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> hard?
          '<a class="sym-link local-def" href="#def-def-list-constructor" data-sym="DEF-LIST-CONSTRUCTOR" title="(defmacro def-list-constructor (name formals &amp;rest args)
  (def-list-constructor-fn name formals args))">def-list-constructor</a>
          <span class="string">"List variable (~x0) must not be in formals"</span>
          list-var))
      (<a class="sym-link system" href="../../../axioms.html#def-length" data-sym="LENGTH">length</a> (<a class="sym-link local-def" href="#def-get-kw" data-sym="GET-KW" title="(defun get-kw (key default kwlist)
  (declare (xargs :guard (keyword-value-listp kwlist)))
  (let ((look (assoc-keyword key kwlist)))
    (if look
        (cadr look)">get-kw</a> <span class="keyword">:length</span> nil kwlist))
      ((unless <a class="sym-link system" href="../../../axioms.html#def-length" data-sym="LENGTH">length</a>) (<a class="sym-link system" href="../../../axioms.html#def-er" data-sym="ER">er</a> hard? '<a class="sym-link local-def" href="#def-def-list-constructor" data-sym="DEF-LIST-CONSTRUCTOR" title="(defmacro def-list-constructor (name formals &amp;rest args)
  (def-list-constructor-fn name formals args))">def-list-constructor</a> <span class="string">"Need :length argument"</span>))
      (iter-guard (<a class="sym-link local-def" href="#def-get-kw" data-sym="GET-KW" title="(defun get-kw (key default kwlist)
  (declare (xargs :guard (keyword-value-listp kwlist)))
  (let ((look (assoc-keyword key kwlist)))
    (if look
        (cadr look)">get-kw</a> <span class="keyword">:iter-guard</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a> kwlist))
      (package (<a class="sym-link local-def" href="#def-get-kw" data-sym="GET-KW" title="(defun get-kw (key default kwlist)
  (declare (xargs :guard (keyword-value-listp kwlist)))
  (let ((look (assoc-keyword key kwlist)))
    (if look
        (cadr look)">get-kw</a> <span class="keyword">:package</span> name kwlist))
      (iter (intern-in-package-of-symbol (<a class="sym-link system" href="../../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../../axioms.html#def-string" data-sym="STRING">string</a> (symbol-name name) <span class="string">"-ITER"</span>)
          package))
      (tailrec (intern-in-package-of-symbol (<a class="sym-link system" href="../../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../../axioms.html#def-string" data-sym="STRING">string</a> (symbol-name name) <span class="string">"-TAILREC"</span>)
          package))
      (iter-formals (cons index (cons list-var <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)))
      (step-call (cons (intern-in-package-of-symbol (<a class="sym-link system" href="../../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../../axioms.html#def-string" data-sym="STRING">string</a> (symbol-name name) <span class="string">"-STEP"</span>)
            package)
          iter-formals))
      (step (intern-in-package-of-symbol (<a class="sym-link system" href="../../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../../axioms.html#def-string" data-sym="STRING">string</a> (symbol-name name) <span class="string">"-STEP"</span>)
          package))
      (?nth-thmname (intern-in-package-of-symbol (<a class="sym-link system" href="../../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../../axioms.html#def-string" data-sym="STRING">string</a> <span class="string">"NTH-OF-"</span> (symbol-name name))
          package))
      (nth-split-thmname (intern-in-package-of-symbol (<a class="sym-link system" href="../../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../../axioms.html#def-string" data-sym="STRING">string</a> <span class="string">"NTH-OF-"</span> (symbol-name name) <span class="string">"-SPLIT"</span>)
          package))
      (?true-listp-thmname (intern-in-package-of-symbol (<a class="sym-link system" href="../../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../../axioms.html#def-string" data-sym="STRING">string</a> <span class="string">"TRUE-LISTP-OF-"</span> (symbol-name name))
          package))
      (?len-thmname (intern-in-package-of-symbol (<a class="sym-link system" href="../../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../../axioms.html#def-string" data-sym="STRING">string</a> <span class="string">"LEN-OF-"</span> (symbol-name name))
          package))
      (fsubst `((listconstr-val (lambda (n <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)
             (<a class="sym-link external" href="../../std/util/bstar.html#def-b_2A" data-sym="B*">b*</a> (((<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> . ,FORMALS) <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>) (,INDEX n)) ,BODY))) (listconstr-last (lambda (<a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)
              (<a class="sym-link external" href="../../std/util/bstar.html#def-b_2A" data-sym="B*">b*</a> (((<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> . ,FORMALS) <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)) ,LENGTH)))
          (listconstr-step$inline (lambda (n lst <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)
              (<a class="sym-link external" href="../../std/util/bstar.html#def-b_2A" data-sym="B*">b*</a> (((<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> . ,FORMALS) <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>) (,INDEX n) (,LIST-VAR lst))
                ,STEP-CALL)))
          (listconstr-iter (lambda (n lst <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)
              (<a class="sym-link external" href="../../std/util/bstar.html#def-b_2A" data-sym="B*">b*</a> (((<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> . ,FORMALS) <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>) (,INDEX n) (,LIST-VAR lst))
                (,ITER . ,ITER-FORMALS))))
          (listconstr-tailrec (lambda (n lst <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)
              (<a class="sym-link external" href="../../std/util/bstar.html#def-b_2A" data-sym="B*">b*</a> (((<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> . ,FORMALS) <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>) (,INDEX n) (,LIST-VAR lst))
                (,TAILREC . ,ITER-FORMALS))))
          (listconstr$inline (lambda (<a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)
              (<a class="sym-link external" href="../../std/util/bstar.html#def-b_2A" data-sym="B*">b*</a> (((<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> . ,FORMALS) <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)) (,NAME . ,FORMALS)))))))
    `(<a class="sym-link system" href="../../../axioms.html#def-encapsulate" data-sym="ENCAPSULATE">encapsulate</a> nil
      (<a class="sym-link system" href="../../../axioms.html#def-set-ignore-ok" data-sym="SET-IGNORE-OK">set-ignore-ok</a> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
      (<a class="sym-link system" href="../../../axioms.html#def-set-irrelevant-formals-ok" data-sym="SET-IRRELEVANT-FORMALS-OK">set-irrelevant-formals-ok</a> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)
      (<a class="sym-link local-def" href="#def-defiteration" data-sym="DEFITERATION" title="(defmacro defiteration (name formals &amp;rest args)
  (defiteration-fn name formals args))">defiteration</a> ,NAME
        ,FORMALS
        ,@DECLS
        ,@(AND DOC (LIST DOC))
        (let ((val ,BODY))
          (<a class="sym-link system" href="../../../axioms.html#def-update-nth" data-sym="UPDATE-NTH">update-nth</a> ,INDEX val ,LIST-VAR))
        <span class="keyword">:returns</span> ,LIST-VAR
        <span class="keyword">:first</span> <span class="number">0</span>
        <span class="keyword">:last</span> ,LENGTH
        <span class="keyword">:init-vals</span> ((,LIST-VAR nil))
        <span class="keyword">:iter-guard</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> ,LIST-VAR) ,ITER-GUARD) . ,KWLIST)
      (<a class="sym-link system" href="../../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (disable ,NAME))
      (<a class="sym-link system" href="../../../axioms.html#def-defthmd" data-sym="DEFTHMD">defthmd</a> ,NTH-SPLIT-THMNAME
        (equal (<a class="sym-link system" href="../../../axioms.html#def-nth" data-sym="NTH">nth</a> ,INDEX (,NAME . ,FORMALS))
          (let ((,INDEX (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> ,INDEX)))
            (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (&lt; ,INDEX (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> ,LENGTH)) ,BODY)))
        <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:use</span> ((<span class="keyword">:instance</span> (<span class="keyword">:functional-instance</span> <a class="sym-link local-def" href="#def-nth-of-listconstr" data-sym="NTH-OF-LISTCONSTR" title="(defthm nth-of-listconstr
        (equal (nth n (listconstr formals))
               (let ((n (nfix n)))
                 (and (&lt; n (nfix (listconstr-last formals)))
                      (listconstr-val n formals)))))">nth-of-listconstr</a> . ,FSUBST)
              (<a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> . ,FORMALS))
              (n ,INDEX)))
           <span class="keyword">:in-theory</span> '(,ITER ,STEP
             ,NAME
             ,TAILREC
             <a class="sym-link system" href="../../../axioms.html#def-car-cons" data-sym="CAR-CONS">car-cons</a>
             <a class="sym-link system" href="../../../axioms.html#def-cdr-cons" data-sym="CDR-CONS">cdr-cons</a>
             <a class="sym-link external" href="../../std/basic/arith-equivs.html#def-zp-when-integerp" data-sym="ZP-WHEN-INTEGERP">zp-when-integerp</a>
             <a class="sym-link system" href="../../../axioms.html#def-commutativity-of-_2B" data-sym="COMMUTATIVITY-OF-+">commutativity-of-+</a>
             (equal)
             (<a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a>)
             (unary--)
             (<a class="sym-link system" href="../../../axioms.html#def-zp" data-sym="ZP">zp</a>)
             <a class="sym-link external" href="../../std/basic/arith-equivs.html#def-ifix-positive-to-non-zp" data-sym="IFIX-POSITIVE-TO-NON-ZP">ifix-positive-to-non-zp</a>
             <a class="sym-link system" href="../../../axioms.html#def-unicity-of-0" data-sym="UNICITY-OF-0">unicity-of-0</a>
             <a class="sym-link system" href="../../../axioms.html#def-fix" data-sym="FIX">fix</a>
             (<span class="keyword">:type-prescription</span> <a class="sym-link system" href="../../../axioms.html#def-ifix" data-sym="IFIX">ifix</a>))
           <span class="keyword">:do-not-induct</span> <a class="sym-link system" href="../../../axioms.html#def-t" data-sym="T">t</a>)))
      (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,NTH-THMNAME
        (<a class="sym-link system" href="../../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (&lt; (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> ,INDEX) (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> ,LENGTH))
          (equal (<a class="sym-link system" href="../../../axioms.html#def-nth" data-sym="NTH">nth</a> ,INDEX (,NAME . ,FORMALS))
            (let ((,INDEX (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> ,INDEX)))
              ,BODY)))
        <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (enable ,NTH-SPLIT-THMNAME))))
      (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,LEN-THMNAME
        (equal (<a class="sym-link system" href="../../../axioms.html#def-len" data-sym="LEN">len</a> (,NAME . ,FORMALS)) (<a class="sym-link system" href="../../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> ,LENGTH))
        <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:use</span> ((<span class="keyword">:instance</span> (<span class="keyword">:functional-instance</span> <a class="sym-link local-def" href="#def-len-of-listconstr" data-sym="LEN-OF-LISTCONSTR" title="(defthm len-of-listconstr
        (equal (len (listconstr formals)) (nfix (listconstr-last formals))))">len-of-listconstr</a> . ,FSUBST)
              (<a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> . ,FORMALS))))
           <span class="keyword">:in-theory</span> '(<a class="sym-link system" href="../../../axioms.html#def-car-cons" data-sym="CAR-CONS">car-cons</a> <a class="sym-link system" href="../../../axioms.html#def-cdr-cons" data-sym="CDR-CONS">cdr-cons</a>))))
      (<a class="sym-link system" href="../../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,TRUE-LISTP-THMNAME
        (<a class="sym-link system" href="../../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> (,NAME . ,FORMALS))
        <span class="keyword">:hints</span> ((<span class="string">"goal"</span> <span class="keyword">:use</span> ((<span class="keyword">:instance</span> (<span class="keyword">:functional-instance</span> <a class="sym-link local-def" href="#def-true-listp-of-listconstr" data-sym="TRUE-LISTP-OF-LISTCONSTR" title="(defthm true-listp-of-listconstr (true-listp (listconstr formals)))">true-listp-of-listconstr</a> . ,FSUBST)
              (<a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> (<a class="sym-link system" href="../../../axioms.html#def-list" data-sym="LIST">list</a> . ,FORMALS))))
           <span class="keyword">:in-theory</span> '(<a class="sym-link system" href="../../../axioms.html#def-car-cons" data-sym="CAR-CONS">car-cons</a> <a class="sym-link system" href="../../../axioms.html#def-cdr-cons" data-sym="CDR-CONS">cdr-cons</a>)))
        <span class="keyword">:rule-classes</span> (<span class="keyword">:rewrite</span> <span class="keyword">:type-prescription</span>)))))</pre>
  </div>

<div class="form-block other" id="form-25" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link external" href="../../xdoc/base.html#def-defxdoc" data-sym="DEFXDOC">defxdoc</a> <a class="sym-link local-def" href="#def-def-list-constructor" data-sym="DEF-LIST-CONSTRUCTOR" title="(defmacro def-list-constructor (name formals &amp;rest args)
  (def-list-constructor-fn name formals args))">def-list-constructor</a>
  <span class="keyword">:parents</span> (programming)
  <span class="keyword">:short</span> <span class="string">"Define function that constructs a list, just by giving the length and
how to compute the Nth element in terms of the formals and index."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;This takes many of the same arguments as @(see defiteration), and in fact
it uses defiteration.  But instead of giving the step function for the
iteration, you give the value of the Nth element of the list.  You must also
provide the keyword :last, giving the length of the list.&lt;/p&gt;

&lt;p&gt;What you end up with is your top-level function, definition disabled, and
four rules:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;@(&#39;nth-of-fnname&#39;) tells what the Nth element is, for N in bounds&lt;/li&gt;
&lt;li&gt;@(&#39;nth-of-fnname-split&#39;) (disabled), tells what the Nth element is,
    causing a case-split on whether it&#39;s in bounds or not&lt;/li&gt;
&lt;li&gt;@(&#39;len-of-fnname&#39;): gives the length of the list&lt;/li&gt;
&lt;li&gt;@(&#39;true-listp-of-fnname&#39;) shows that the list is true-listp.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;See @(&#39;centaur/misc/equal-by-nths&#39;) for a strategy that proves equivalences
between lists based on length and Nth value.&lt;/p&gt;

&lt;p&gt;Syntax:&lt;/p&gt;

@({
    (def-list-constructor foo (x y)
      &quot;optional doc string&quot;
      (declare (xargs ...))   ;; optional declare forms
      (+ idx-var x y)         ;; value of the IDX-VARth element
      :length  (bar x y)      ;; final index
      :index idx-var          ;; counter variable, default N
      ... defiteration args ...)
})"</span>)</pre>
  </div>

<div class="form-block macro" id="def-def-list-constructor" data-defines="DEF-LIST-CONSTRUCTOR" data-references="DEF-LIST-CONSTRUCTOR-FN,ARGS,&REST,FORMALS,NAME,DEFMACRO" data-used-by="DEF-LIST-CONSTRUCTOR-FN" typeof="Code">
    <div class="form-header"><span class="form-name" property="name" data-sym="DEF-LIST-CONSTRUCTOR">def-list-constructor</span><span class="form-type">macro</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> <a class="sym-link local-def" href="#def-def-list-constructor" data-sym="DEF-LIST-CONSTRUCTOR" title="(defmacro def-list-constructor (name formals &amp;rest args)
  (def-list-constructor-fn name formals args))">def-list-constructor</a>
  (name <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> &amp;rest <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>)
  (<a class="sym-link local-def" href="#def-def-list-constructor-fn" data-sym="DEF-LIST-CONSTRUCTOR-FN" title="(defun def-list-constructor-fn (name formals args)
  (b*
   (((mv decls doc body kwlist) (defiteration-sort-args args))
    (index (get-kw :index (intern-in-package-of-symbol &quot;N&quot; name) kwlist))
    ((when (member index formals))
...">def-list-constructor-fn</a> name <a class="sym-link system" href="../../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> <a class="sym-link system" href="../../../defuns.html#def-args" data-sym="ARGS">args</a>))</pre>
  </div>

<div class="form-block local" id="form-27" typeof="Code">
    <div class="form-header"><span class="form-type">local</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link local-def" href="#def-def-list-constructor" data-sym="DEF-LIST-CONSTRUCTOR" title="(defmacro def-list-constructor (name formals &amp;rest args)
  (def-list-constructor-fn name formals args))">def-list-constructor</a> foo
    (x y)
    (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> x) (<a class="sym-link system" href="../../../axioms.html#def-natp" data-sym="NATP">natp</a> y))))
    (<a class="sym-link system" href="../../../axioms.html#def-_2B" data-sym="+">+</a> n x y)
    <span class="keyword">:length</span> x))</pre>
  </div>


  </main>
  
<script>
// ACL2 Book HTML Documentation - Interactive Features
// Generated by cert2 - build2 system

// State
let activeFilter = null;
let activePartFilter = null;
let activeNameFilter = null;
let currentFontSize = 14;

// Theme management
function getStoredTheme() {
  return localStorage.getItem('acl2-theme') || 'dark';
}

function setTheme(theme) {
  if (theme === 'light') {
    document.documentElement.setAttribute('data-theme', 'light');
    document.getElementById('theme-toggle').textContent = '🌙';
  } else {
    document.documentElement.removeAttribute('data-theme');
    document.getElementById('theme-toggle').textContent = '☀️';
  }
  localStorage.setItem('acl2-theme', theme);
}

function toggleTheme() {
  const current = getStoredTheme();
  setTheme(current === 'dark' ? 'light' : 'dark');
}

// Font size management
function getStoredFontSize() {
  return parseInt(localStorage.getItem('acl2-fontsize') || '14', 10);
}

function setFontSize(size) {
  size = Math.max(10, Math.min(24, size)); // Clamp between 10-24
  currentFontSize = size;
  document.body.style.fontSize = size + 'px';
  localStorage.setItem('acl2-fontsize', size.toString());
}

function increaseFontSize() {
  setFontSize(currentFontSize + 2);
}

function decreaseFontSize() {
  setFontSize(currentFontSize - 2);
}

// Get all form blocks
function getFormBlocks() {
  return document.querySelectorAll('.form-block');
}

// Clear all filters
function clearFilter() {
  activeFilter = null;
  activePartFilter = null;
  activeNameFilter = null;
  getFormBlocks().forEach(b => {
    b.classList.remove('hidden', 'dimmed');
  });
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  const status = document.querySelector('.filter-status');
  status.classList.remove('active');
  // Slide name filter back to original position
  document.querySelector('.controls-left').style.transform = '';
  // Clear the name filter input
  const nameInput = document.getElementById('name-filter');
  if (nameInput) nameInput.value = '';
}

// Show filter status and slide name filter right
function showFilterStatus(text) {
  const status = document.querySelector('.filter-status');
  status.classList.add('active');
  status.querySelector('.filter-text').textContent = text;
  // Slide name filter to the right to make room
  setTimeout(() => {
    const statusWidth = status.offsetWidth;
    document.querySelector('.controls-left').style.transform = `translateX(${statusWidth + 15}px)`;
  }, 10);
}

// Filter to show only forms that define or reference a symbol
function filterBySymbol(symName, showUsedBy) {
  clearFilter();
  activeFilter = symName;
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines;
    const references = (block.dataset.references || '').split(',');
    const usedBy = (block.dataset.usedBy || '').split(',');
    
    let show = false;
    if (showUsedBy) {
      // Show forms that USE this symbol
      show = references.includes(symName) || definesName === symName;
    } else {
      // Show forms that this symbol USES
      show = usedBy.includes(symName) || definesName === symName;
    }
    
    if (show) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering by: ${symName} (${visibleCount} items)`);
}

// Filter by defthm part (term, hints, rule-classes, etc.)
function filterByPart(formId, partName) {
  clearFilter();
  activePartFilter = { formId, partName };
  
  // Get the part's referenced symbols
  // data-part-term becomes dataset.partTerm, data-part-hints becomes dataset.partHints, etc.
  const block = document.getElementById(formId);
  const datasetKey = 'part' + partName.charAt(0).toUpperCase() + partName.slice(1).replace(/-([a-z])/g, (g) => g[1].toUpperCase());
  const partData = block.dataset[datasetKey];
  if (!partData) return;
  
  const partSyms = partData.split(',').filter(s => s);
  
  // Highlight the button
  block.querySelector(`.part-btn[data-part="${partName}"]`).classList.add('active');
  
  // Hide forms not referenced by this part
  getFormBlocks().forEach(b => {
    const definesName = b.dataset.defines;
    if (b.id === formId || partSyms.includes(definesName)) {
      b.classList.remove('hidden');
    } else {
      b.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering ${formId} :${partName} (${partSyms.length} references)`);
}

// Filter by name (substring or regex)
function filterByName(pattern, useRegex) {
  // Clear other filters but keep the input value
  activeFilter = null;
  activePartFilter = null;
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  
  if (!pattern || pattern.trim() === '') {
    // Empty pattern - show all
    activeNameFilter = null;
    getFormBlocks().forEach(b => b.classList.remove('hidden'));
    const status = document.querySelector('.filter-status');
    status.classList.remove('active');
    document.querySelector('.controls-left').style.transform = '';
    return;
  }
  
  activeNameFilter = pattern;
  
  let matcher;
  let isValidRegex = true;
  
  if (useRegex) {
    try {
      matcher = new RegExp(pattern, 'i');
    } catch (e) {
      // Invalid regex - show error in status and don't filter
      showFilterStatus(`Invalid regex: ${e.message}`);
      return;
    }
  } else {
    // Plain substring match (case-insensitive)
    const lowerPattern = pattern.toLowerCase();
    matcher = { test: (s) => s.toLowerCase().includes(lowerPattern) };
  }
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines || '';
    if (matcher.test(definesName)) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  const modeText = useRegex ? 'regex' : 'name';
  showFilterStatus(`Filtering by ${modeText}: "${pattern}" (${visibleCount} matches)`);
}

// Click on a name to show what references it
function handleNameClick(symName) {
  if (activeFilter === symName) {
    clearFilter();
  } else {
    filterBySymbol(symName, true);
  }
}

// Navigate to a definition (same file or different)
function navigateTo(symName, file) {
  if (file) {
    // External file - navigate
    window.location.href = file + '.html#def-' + symName.toLowerCase();
  } else {
    // Same file - scroll
    const target = document.getElementById('def-' + symName.toLowerCase());
    if (target) {
      target.scrollIntoView({ behavior: 'smooth', block: 'center' });
      target.classList.add('highlight');
      setTimeout(() => target.classList.remove('highlight'), 400);
    }
  }
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  // Part buttons
  document.querySelectorAll('.part-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const formId = btn.closest('.form-block').id;
      const partName = btn.dataset.part;
      if (activePartFilter && activePartFilter.formId === formId && 
          activePartFilter.partName === partName) {
        clearFilter();
      } else {
        filterByPart(formId, partName);
      }
    });
  });
  
  // Clear filter button
  document.querySelector('.clear-filter').addEventListener('click', clearFilter);
  
  // Name filter input
  const nameFilter = document.getElementById('name-filter');
  const regexToggle = document.getElementById('regex-toggle');
  
  let filterTimeout = null;
  nameFilter.addEventListener('input', () => {
    // Debounce the filter to avoid excessive updates while typing
    clearTimeout(filterTimeout);
    filterTimeout = setTimeout(() => {
      filterByName(nameFilter.value, regexToggle.checked);
    }, 150);
  });
  
  // Re-filter when regex toggle changes
  regexToggle.addEventListener('change', () => {
    if (nameFilter.value) {
      filterByName(nameFilter.value, regexToggle.checked);
    }
  });
  
  // Allow Escape key to clear filter when in input
  nameFilter.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      clearFilter();
      nameFilter.blur();
    }
  });
  
  // Symbol references (old span-based refs)
  document.querySelectorAll('.sym-ref').forEach(ref => {
    ref.addEventListener('click', (e) => {
      e.stopPropagation();
      const sym = ref.dataset.sym;
      const file = ref.dataset.file;
      if (file) {
        navigateTo(sym, file);
      } else {
        handleNameClick(sym);
      }
    });
  });
  
  // Symbol links (new anchor-based links)
  // These use standard <a> tags so navigation happens automatically
  // But we need to clear filters if target would be hidden
  document.querySelectorAll('.sym-link').forEach(link => {
    link.addEventListener('click', (e) => {
      const href = link.getAttribute('href');
      if (href && href.startsWith('#')) {
        // Local link - check if target is hidden by filter
        const targetId = href.substring(1);
        const target = document.getElementById(targetId);
        if (target) {
          // If target is hidden, clear the filter first
          if (target.classList.contains('hidden')) {
            clearFilter();
          }
          // Add highlight effect after a short delay
          setTimeout(() => {
            target.classList.add('highlight');
            setTimeout(() => target.classList.remove('highlight'), 400);
          }, 100);
        }
      }
      // For external links, default behavior handles navigation
    });
  });
  
  // Form names (show what uses them)
  document.querySelectorAll('.form-name').forEach(name => {
    name.addEventListener('click', (e) => {
      handleNameClick(name.dataset.sym);
    });
  });
  
  // Handle hash navigation (when arriving at page with #anchor)
  if (window.location.hash) {
    const target = document.querySelector(window.location.hash);
    if (target) {
      setTimeout(() => {
        target.scrollIntoView({ behavior: 'smooth', block: 'center' });
        target.classList.add('highlight');
        setTimeout(() => target.classList.remove('highlight'), 400);
      }, 200);
    }
  }
  
  // Initialize theme from storage
  setTheme(getStoredTheme());
  
  // Initialize font size from storage
  currentFontSize = getStoredFontSize();
  setFontSize(currentFontSize);
  
  // Theme toggle button
  document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
  
  // Font size buttons
  document.getElementById('font-larger').addEventListener('click', increaseFontSize);
  document.getElementById('font-smaller').addEventListener('click', decreaseFontSize);
});

</script>

</body>
</html>
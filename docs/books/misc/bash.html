<!DOCTYPE html>
<html lang="en" vocab="http://schema.org/" typeof="SoftwareSourceCode">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>bash - ACL2 Book</title>
  <meta property="name" content="bash">
  <meta property="programmingLanguage" content="ACL2">
  
<style>
/* ACL2 Book HTML Documentation Styles */
/* Generated by cert2 - build2 system */

/* Dark theme (default) */
:root {
  --bg: #1e1e2e;
  --fg: #cdd6f4;
  --comment: #6c7086;
  --keyword: #cba6f7;
  --string: #a6e3a1;
  --function: #89b4fa;
  --type: #f9e2af;
  --link: #89dceb;
  --link-hover: #f5c2e7;
  --highlight: rgba(137, 180, 250, 0.2);
  --border: #313244;
  --block-bg: rgba(49, 50, 68, 0.5);
  --btn-bg: #313244;
  --btn-hover: rgba(137, 180, 250, 0.2);
}

/* Light theme */
[data-theme="light"] {
  --bg: #eff1f5;
  --fg: #4c4f69;
  --comment: #6c6f85;
  --keyword: #8839ef;
  --string: #40a02b;
  --function: #1e66f5;
  --type: #df8e1d;
  --link: #04a5e5;
  --link-hover: #ea76cb;
  --highlight: rgba(30, 102, 245, 0.15);
  --border: #ccd0da;
  --block-bg: rgba(204, 208, 218, 0.3);
  --btn-bg: #ccd0da;
  --btn-hover: rgba(30, 102, 245, 0.15);
}

body {
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  background: var(--bg);
  color: var(--fg);
  margin: 0;
  padding: 20px;
  line-height: 1.6;
  font-size: 14px;
  transition: background 0.1s, color 0.1s;
}

/* Controls toolbar */
.controls-left {
  position: fixed;
  top: 10px;
  left: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
  transition: transform 0.1s ease;
}

.controls-right {
  position: fixed;
  top: 10px;
  right: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
}

.control-btn {
  padding: 6px 12px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-family: inherit;
  font-size: 14px;
  transition: all 0.1s;
}

.control-btn:hover {
  background: var(--btn-hover);
  border-color: var(--link);
}

.name-filter {
  padding: 6px 10px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  font-family: inherit;
  font-size: 13px;
  width: 150px;
  transition: all 0.1s;
}

.name-filter:focus {
  outline: none;
  border-color: var(--link);
  width: 200px;
}

.name-filter::placeholder {
  color: var(--comment);
}

.regex-label {
  display: flex;
  align-items: center;
  gap: 4px;
  color: var(--comment);
  font-size: 12px;
  cursor: pointer;
}

.regex-label input {
  cursor: pointer;
}

.book-header {
  border-bottom: 2px solid var(--border);
  padding-bottom: 20px;
  margin-bottom: 20px;
}

.book-header h1 {
  color: var(--keyword);
  margin: 0;
}

.book-header .path {
  color: var(--comment);
  font-size: 0.9em;
}

.book-header .path .source-link {
  color: var(--comment);
  text-decoration: none;
}

.book-header .path .source-link:hover {
  color: var(--link);
  text-decoration: underline;
}

.form-block {
  margin: 10px 0;
  padding: 15px;
  background: var(--block-bg);
  border-radius: 8px;
  border-left: 3px solid var(--border);
}

.form-block.theorem { border-left-color: var(--keyword); }
.form-block.function { border-left-color: var(--function); }
.form-block.macro { border-left-color: var(--type); }
.form-block.include-book { border-left-color: var(--string); }

.form-block.hidden { display: none; }
.form-block.dimmed { opacity: 0.3; }

.form-block.highlight {
  animation: highlight-pulse 0.4s ease-out;
}

@keyframes highlight-pulse {
  0% { background: var(--highlight); box-shadow: 0 0 20px var(--link); }
  100% { background: rgba(49, 50, 68, 0.5); box-shadow: none; }
}

.form-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.form-name {
  color: var(--function);
  font-weight: bold;
  cursor: pointer;
}

.form-name:hover {
  color: var(--link-hover);
  text-decoration: underline;
}

.form-type {
  color: var(--comment);
  font-size: 0.85em;
}

pre.code {
  margin: 0;
  overflow-x: auto;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.sym-ref {
  color: var(--link);
  cursor: pointer;
  border-radius: 2px;
}

.sym-ref:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.sym-ref.local-def { color: var(--function); font-weight: bold; }
.sym-ref.external { color: var(--type); }

/* Symbol links (clickable hyperlinks) */
.sym-link {
  color: var(--link);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
  position: relative;
}

.sym-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

.sym-link.local-def {
  color: var(--function);
  font-weight: bold;
}

.sym-link.external {
  color: var(--type);
}

/* Tooltips using title attribute with custom styling */
.sym-link[title] {
  /* Browser will show title on hover */
}

/* Syntax highlighting in code blocks */
.keyword {
  color: var(--keyword);
}

.string {
  color: var(--string);
}

.number {
  color: #f77524; /* orange */
}

/* Include-book path links */
.include-path {
  color: var(--string);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
}

.include-path:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

/* Part buttons for defthm */
.part-buttons {
  display: flex;
  gap: 5px;
  margin: 10px 0;
  flex-wrap: wrap;
}

.part-btn {
  padding: 4px 10px;
  background: var(--border);
  border: 1px solid var(--comment);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-size: 0.85em;
  font-family: inherit;
}

.part-btn:hover {
  background: var(--highlight);
  border-color: var(--link);
}

.part-btn.active {
  background: var(--link);
  color: var(--bg);
  border-color: var(--link);
}

/* References panel */
.refs-panel {
  margin-top: 10px;
  padding: 10px;
  background: rgba(0,0,0,0.2);
  border-radius: 4px;
  display: none;
}

.refs-panel.visible { display: block; }

.refs-panel h4 {
  margin: 0 0 5px 0;
  color: var(--comment);
  font-size: 0.9em;
}

.refs-list {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

/* Included books section */
.includes-section {
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(49, 50, 68, 0.3);
  border-radius: 8px;
  border: 1px solid var(--border);
}

.includes-section h2 {
  margin: 0 0 10px 0;
  color: var(--comment);
  font-size: 1em;
  font-weight: normal;
}

.includes-list {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.include-link {
  padding: 6px 12px;
  background: var(--border);
  border-radius: 4px;
  color: var(--link);
  text-decoration: none;
  font-size: 0.9em;
  transition: all 0.1s;
}

.include-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.include-link.local {
  border-left: 2px solid var(--comment);
}

/* Filter status */
.filter-status {
  position: fixed;
  top: 10px;
  left: 20px;
  background: var(--bg);
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: 4px;
  z-index: 201;
  display: none;
  align-items: center;
  gap: 10px;
}

.filter-status.active {
  display: flex;
  align-items: center;
  gap: 10px;
}

.clear-filter {
  padding: 5px 15px;
  background: var(--keyword);
  color: var(--bg);
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

/* RDFa vocab indicator */
[vocab] { /* semantic web annotations present */ }

</style>

</head>
<body>
  <div class="controls-left">
    <input type="text" id="name-filter" class="name-filter" placeholder="Filter by name..." title="Filter definitions by name">
    <label class="regex-label"><input type="checkbox" id="regex-toggle"> regex</label>
  </div>

  <div class="controls-right">
    <button class="control-btn" id="theme-toggle" title="Toggle light/dark theme">‚òÄÔ∏è</button>
    <button class="control-btn" id="font-smaller" title="Decrease font size">A-</button>
    <button class="control-btn" id="font-larger" title="Increase font size">A+</button>
  </div>

  <div class="filter-status">
    <span class="filter-text">Filtering...</span>
    <button class="clear-filter">Clear Filter</button>
  </div>
  
  <div class="book-header">
    <h1 property="name">bash</h1>
    <div class="path"><a href="bash.lisp" class="source-link">books/misc/bash</a></div>
  </div>
  
  <main property="text">
  <div class="includes-section">
    <h2>Included Books</h2>
    <div class="includes-list">
      <a class="include-link" href="../xdoc/top.html" title="xdoc/top">top</a>
    </div>
  </div>

<div class="form-block other" id="form-0" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-in-package" data-sym="IN-PACKAGE">in-package</a> <span class="string">"ACL2"</span>)</pre>
  </div>

<div class="form-block include-book" id="form-1" typeof="Code">
    <div class="form-header"><span class="form-type">include-book</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../xdoc/top.html" title="Open xdoc/top">"xdoc/top"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block other" id="form-2" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-program" data-sym="PROGRAM">program</a>)</pre>
  </div>

<div class="form-block other" id="form-3" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-set-state-ok" data-sym="SET-STATE-OK">set-state-ok</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>)</pre>
  </div>

<div class="form-block function" id="def-simplify-with-prover" data-defines="SIMPLIFY-WITH-PROVER" data-references="VALUE,NO-CHANGE,CAAR,CAR,LENGTH,EQL,AND,UNPROVED-PC-PROVE-CLAUSES,CLAUSES,MV,PC-PROVE,IN-PROVE-FLG,GUARD-CHECKING-ON,STATE-GLOBAL-LET*,TTREE,ERP,MV-LET,TRANSLATE,TTERM,DEFAULT-HINTS,ADD-STRING-VAL-PAIR-TO-STRING-VAL-ALIST!,ELIMINATE-IRRELEVANCE,FERTILIZE,ELIMINATE-DESTRUCTORS,GENERALIZE,LIST,ADD-STRING-VAL-PAIR-TO-STRING-VAL-ALIST,*BASH-SKIP-FORCING-ROUND-HINTS*,APPEND,TRANSLATE-HINTS,THINTS,ER-LET*,T,SOFT,ER,ALISTP,NOT,COND,ER-PROGN,BASH,QUOTE,NAME-TREE,ENS,W,WRLD,LET,STATE,CTX,HINTS,FORM,DEFUN" data-used-by="BASH-TERM-TO-DNF,BASH-FN" data-part-name="SIMPLIFY-WITH-PROVER" data-part-args="STATE,CTX,HINTS,FORM" data-part-body="VALUE,NO-CHANGE,CAAR,CAR,LENGTH,EQL,AND,UNPROVED-PC-PROVE-CLAUSES,CLAUSES,MV,PC-PROVE,IN-PROVE-FLG,GUARD-CHECKING-ON,STATE-GLOBAL-LET*,TTREE,ERP,MV-LET,FORM,TRANSLATE,TTERM,DEFAULT-HINTS,ADD-STRING-VAL-PAIR-TO-STRING-VAL-ALIST!,ELIMINATE-IRRELEVANCE,FERTILIZE,ELIMINATE-DESTRUCTORS,GENERALIZE,LIST,ADD-STRING-VAL-PAIR-TO-STRING-VAL-ALIST,*BASH-SKIP-FORCING-ROUND-HINTS*,APPEND,TRANSLATE-HINTS,THINTS,ER-LET*,T,CTX,SOFT,ER,HINTS,ALISTP,NOT,COND,ER-PROGN,BASH,QUOTE,NAME-TREE,ENS,STATE,W,WRLD,LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="SIMPLIFY-WITH-PROVER">simplify-with-prover</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-simplify-with-prover" data-sym="SIMPLIFY-WITH-PROVER" title="(defun simplify-with-prover (form hints ctx state)
  (let ((wrld (w state)) (ens (ens state)) (name-tree &#39;bash))
    (er-progn
     (cond
      ((not (alistp hints))
...">simplify-with-prover</a>
  (form hints ctx state)
  (let ((wrld (<a class="sym-link system" href="../../axioms.html#def-w" data-sym="W">w</a> state)) (ens (ens state)) (name-tree '<a class="sym-link local-def" href="#def-bash" data-sym="BASH" title="(defmacro bash (term &amp;key verbose hints)
  `(bash-fn &#39;,term &#39;,hints &#39;,verbose &#39;bash state))">bash</a>))
    (<a class="sym-link system" href="../../axioms.html#def-er-progn" data-sym="ER-PROGN">er-progn</a> (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../axioms.html#def-alistp" data-sym="ALISTP">alistp</a> hints)) (<a class="sym-link system" href="../../axioms.html#def-er" data-sym="ER">er</a> soft
            ctx
            <span class="string">"The :hints provided should be an alist, but the following is not ~
            (see :DOC hints):  ~x0."</span>
            hints))
        (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((thints (translate-hints name-tree
                 (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> *bash-skip-forcing-round-hints*
                   (add-string-val-pair-to-string-val-alist <span class="string">"Goal"</span>
                     <span class="keyword">:do-not</span> (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> 'quote
                       '(generalize eliminate-destructors
                         fertilize
                         eliminate-irrelevance))
                     (add-string-val-pair-to-string-val-alist! <span class="string">"Goal"</span>
                       <span class="keyword">:do-not-induct</span> name-tree
                       hints))
                   (<a class="sym-link system" href="../../axioms.html#def-default-hints" data-sym="DEFAULT-HINTS">default-hints</a> wrld))
                 ctx
                 wrld
                 state)) (tterm (translate form <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> ctx wrld state)))
            (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (erp ttree state)
              (<a class="sym-link system" href="../../axioms.html#def-state-global-let_2A" data-sym="STATE-GLOBAL-LET*">state-global-let*</a> ((guard-checking-on nil) (in-prove-flg <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>))
                (pc-prove tterm form thints <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> ens wrld ctx state))
              (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (erp (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> nil state))
                (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (let ((clauses (unproved-pc-prove-clauses ttree)))
                    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> clauses) <span class="number">1</span>)
                         (<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> (car clauses)) <span class="number">1</span>)
                         (<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> (<a class="sym-link system" href="../../axioms.html#def-caar" data-sym="CAAR">caar</a> clauses) tterm)) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> 'no-change nil state))
                      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> clauses)))))))))))))</pre>
  </div>

<div class="form-block function" id="def-bash-fn" data-defines="BASH-FN" data-references="W,LET*-ABSTRACTIONP,PRETTYIFY-CLAUSE-LST,LIST,VALUE,MSG,NO-CHANGE,QUOTE,EQ,WARNING$,PPROGN,*VALID-OUTPUT-NAMES*,INHIBIT-OUTPUT-LST,STATE-GLOBAL-LET*,T,SIMPLIFY-WITH-PROVER,COND,CLAUSES,ERP,MV-LET,STATE,CTX,VERBOSE,HINTS,FORM,DEFUN" data-used-by="BASH" data-part-name="BASH-FN" data-part-args="STATE,CTX,VERBOSE,HINTS,FORM" data-part-body="W,LET*-ABSTRACTIONP,PRETTYIFY-CLAUSE-LST,LIST,VALUE,MSG,NO-CHANGE,QUOTE,EQ,WARNING$,PPROGN,*VALID-OUTPUT-NAMES*,INHIBIT-OUTPUT-LST,STATE-GLOBAL-LET*,T,CTX,HINTS,FORM,SIMPLIFY-WITH-PROVER,VERBOSE,COND,STATE,CLAUSES,ERP,MV-LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="BASH-FN">bash-fn</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-bash-fn" data-sym="BASH-FN" title="(defun bash-fn (form hints verbose ctx state)
  (mv-let (erp clauses state)
          (cond (verbose (simplify-with-prover form hints ctx state))
                (t
                 (state-global-let* ((inhibit-output-lst *valid-output-names*))
...">bash-fn</a>
  (form hints verbose ctx state)
  (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (erp clauses state)
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (verbose (<a class="sym-link local-def" href="#def-simplify-with-prover" data-sym="SIMPLIFY-WITH-PROVER" title="(defun simplify-with-prover (form hints ctx state)
  (let ((wrld (w state)) (ens (ens state)) (name-tree &#39;bash))
    (er-progn
     (cond
      ((not (alistp hints))
...">simplify-with-prover</a> form hints ctx state))
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-state-global-let_2A" data-sym="STATE-GLOBAL-LET*">state-global-let*</a> ((inhibit-output-lst <a class="sym-link system" href="../../axioms.html#def-_2Avalid-output-names_2A" data-sym="*VALID-OUTPUT-NAMES*">*valid-output-names*</a>))
          (<a class="sym-link local-def" href="#def-simplify-with-prover" data-sym="SIMPLIFY-WITH-PROVER" title="(defun simplify-with-prover (form hints ctx state)
  (let ((wrld (w state)) (ens (ens state)) (name-tree &#39;bash))
    (er-progn
     (cond
      ((not (alistp hints))
...">simplify-with-prover</a> form hints ctx state))))
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (erp (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link system" href="../../axioms.html#def-warning_24" data-sym="WARNING$">warning$</a> ctx
            <span class="string">"bash"</span>
            <span class="string">"Unable to simplify the input term~@0"</span>
            (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> erp 'no-change) <span class="string">"."</span>)
              (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">" because an error occurred.~@0"</span>
                  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (verbose <span class="string">""</span>)
                    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> <span class="string">"  Try setting the verbose flag to t in ~
                                    order to see what is going on."</span>))))))
          (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> form))))
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (prettyify-clause-lst clauses
            (<a class="sym-link system" href="../../axioms.html#def-let_2A-abstractionp" data-sym="LET*-ABSTRACTIONP">let*-abstractionp</a> state)
            (<a class="sym-link system" href="../../axioms.html#def-w" data-sym="W">w</a> state)))))))</pre>
  </div>

<div class="form-block macro" id="def-bash" data-defines="BASH" data-references="STATE,QUOTE,BASH-FN,QUASIQUOTE,HINTS,VERBOSE,&KEY,TERM,DEFMACRO" data-used-by="SIMPLIFY-WITH-PROVER" typeof="Code">
    <div class="form-header"><span class="form-name" property="name" data-sym="BASH">bash</span><span class="form-type">macro</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> <a class="sym-link local-def" href="#def-bash" data-sym="BASH" title="(defmacro bash (term &amp;key verbose hints)
  `(bash-fn &#39;,term &#39;,hints &#39;,verbose &#39;bash state))">bash</a>
  (term &amp;key verbose hints)
  `(<a class="sym-link local-def" href="#def-bash-fn" data-sym="BASH-FN" title="(defun bash-fn (form hints verbose ctx state)
  (mv-let (erp clauses state)
          (cond (verbose (simplify-with-prover form hints ctx state))
                (t
                 (state-global-let* ((inhibit-output-lst *valid-output-names*))
...">bash-fn</a> ',TERM ',HINTS ',VERBOSE '<a class="sym-link local-def" href="#def-bash" data-sym="BASH" title="(defmacro bash (term &amp;key verbose hints)
  `(bash-fn &#39;,term &#39;,hints &#39;,verbose &#39;bash state))">bash</a> state))</pre>
  </div>

<div class="form-block function" id="def-goals-to-cnf" data-defines="GOALS-TO-CNF" data-references="CDR,DUMB-NEGATE-LIT,LIST,CAR,GOAL,ACCESS,APPEND,CONS,T,ENDP,COND,GOALS,DEFUN" data-part-name="GOALS-TO-CNF" data-part-args="GOALS" data-part-body="CDR,GOALS-TO-CNF,DUMB-NEGATE-LIT,LIST,CAR,GOAL,ACCESS,APPEND,CONS,T,GOALS,ENDP,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="GOALS-TO-CNF">goals-to-cnf</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-goals-to-cnf" data-sym="GOALS-TO-CNF" title="(defun goals-to-cnf (goals)
  (cond ((endp goals) nil)
        (t
         (cons
          (append (access goal (car goals) :hyps)
...">goals-to-cnf</a>
  (goals)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> goals) nil)
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (cons (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link system" href="../../axioms.html#def-access" data-sym="ACCESS">access</a> goal (car goals) <span class="keyword">:hyps</span>)
          (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (<a class="sym-link system" href="../../basis-b.html#def-dumb-negate-lit" data-sym="DUMB-NEGATE-LIT">dumb-negate-lit</a> (<a class="sym-link system" href="../../axioms.html#def-access" data-sym="ACCESS">access</a> goal (car goals) <span class="keyword">:conc</span>))))
        (<a class="sym-link local-def" href="#def-goals-to-cnf" data-sym="GOALS-TO-CNF" title="(defun goals-to-cnf (goals)
  (cond ((endp goals) nil)
        (t
         (cons
          (append (access goal (car goals) :hyps)
...">goals-to-cnf</a> (cdr goals))))))</pre>
  </div>

<div class="form-block function" id="def-untranslate-lst-lst" data-defines="UNTRANSLATE-LST-LST" data-references="CDR,CAR,UNTRANSLATE-LST,CONS,T,ENDP,COND,WRLD,IFF-FLG,LIST,DEFUN" data-used-by="BASH-TERM-TO-DNF" data-part-name="UNTRANSLATE-LST-LST" data-part-args="WRLD,IFF-FLG,LIST" data-part-body="CDR,UNTRANSLATE-LST-LST,WRLD,IFF-FLG,CAR,UNTRANSLATE-LST,CONS,T,LIST,ENDP,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="UNTRANSLATE-LST-LST">untranslate-lst-lst</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-untranslate-lst-lst" data-sym="UNTRANSLATE-LST-LST" title="(defun untranslate-lst-lst (list iff-flg wrld)
  (cond ((endp list) nil)
        (t
         (cons (untranslate-lst (car list) iff-flg wrld)
               (untranslate-lst-lst (cdr list) iff-flg wrld)))))">untranslate-lst-lst</a>
  (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> iff-flg wrld)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> <a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a>) nil)
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (cons (untranslate-lst (car <a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a>) iff-flg wrld)
        (<a class="sym-link local-def" href="#def-untranslate-lst-lst" data-sym="UNTRANSLATE-LST-LST" title="(defun untranslate-lst-lst (list iff-flg wrld)
  (cond ((endp list) nil)
        (t
         (cons (untranslate-lst (car list) iff-flg wrld)
               (untranslate-lst-lst (cdr list) iff-flg wrld)))))">untranslate-lst-lst</a> (cdr <a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a>) iff-flg wrld)))))</pre>
  </div>

<div class="form-block function" id="def-bash-term-to-dnf" data-defines="BASH-TERM-TO-DNF" data-references="W,UNTRANSLATE-LST-LST,LIST,VALUE,MSG,NO-CHANGE,WARNING$,PPROGN,EQ,PRINT-CLAUSE-IDS,*VALID-OUTPUT-NAMES*,INHIBIT-OUTPUT-LST,SET-GAG-MODE-FN,GAG-MODE,STATE-GLOBAL-LET*,T,SIMPLIFY-WITH-PROVER,COND,CLAUSES,ERP,MV-LET,QUOTE,CTX,LET,STATE,UNTRANSLATE-FLG,VERBOSE,HINTS,FORM,DEFUN" data-part-name="BASH-TERM-TO-DNF" data-part-args="STATE,UNTRANSLATE-FLG,VERBOSE,HINTS,FORM" data-part-body="W,UNTRANSLATE-LST-LST,UNTRANSLATE-FLG,LIST,VALUE,MSG,NO-CHANGE,WARNING$,PPROGN,EQ,PRINT-CLAUSE-IDS,*VALID-OUTPUT-NAMES*,INHIBIT-OUTPUT-LST,SET-GAG-MODE-FN,GAG-MODE,STATE-GLOBAL-LET*,T,HINTS,FORM,SIMPLIFY-WITH-PROVER,VERBOSE,COND,STATE,CLAUSES,ERP,MV-LET,BASH-TERM-TO-DNF,QUOTE,CTX,LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="BASH-TERM-TO-DNF">bash-term-to-dnf</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-bash-term-to-dnf" data-sym="BASH-TERM-TO-DNF" title="(defun bash-term-to-dnf (form hints verbose untranslate-flg state)
  (let ((ctx &#39;bash-term-to-dnf))
    (mv-let (erp clauses state)
            (cond (verbose (simplify-with-prover form hints ctx state))
                  (t
...">bash-term-to-dnf</a>
  (form hints verbose untranslate-flg state)
  (let ((ctx '<a class="sym-link local-def" href="#def-bash-term-to-dnf" data-sym="BASH-TERM-TO-DNF" title="(defun bash-term-to-dnf (form hints verbose untranslate-flg state)
  (let ((ctx &#39;bash-term-to-dnf))
    (mv-let (erp clauses state)
            (cond (verbose (simplify-with-prover form hints ctx state))
                  (t
...">bash-term-to-dnf</a>))
    (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (erp clauses state)
      (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (verbose (<a class="sym-link local-def" href="#def-simplify-with-prover" data-sym="SIMPLIFY-WITH-PROVER" title="(defun simplify-with-prover (form hints ctx state)
  (let ((wrld (w state)) (ens (ens state)) (name-tree &#39;bash))
    (er-progn
     (cond
      ((not (alistp hints))
...">simplify-with-prover</a> form hints ctx state))
        (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-state-global-let_2A" data-sym="STATE-GLOBAL-LET*">state-global-let*</a> ((<a class="sym-link system" href="../../basis-a.html#def-gag-mode" data-sym="GAG-MODE">gag-mode</a> nil <a class="sym-link system" href="../../basis-b.html#def-set-gag-mode-fn" data-sym="SET-GAG-MODE-FN">set-gag-mode-fn</a>) (inhibit-output-lst <a class="sym-link system" href="../../axioms.html#def-_2Avalid-output-names_2A" data-sym="*VALID-OUTPUT-NAMES*">*valid-output-names*</a>)
              (print-clause-ids nil))
            (<a class="sym-link local-def" href="#def-simplify-with-prover" data-sym="SIMPLIFY-WITH-PROVER" title="(defun simplify-with-prover (form hints ctx state)
  (let ((wrld (w state)) (ens (ens state)) (name-tree &#39;bash))
    (er-progn
     (cond
      ((not (alistp hints))
...">simplify-with-prover</a> form hints ctx state))))
      (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (erp (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> verbose <span class="keyword">:all</span>) (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link system" href="../../axioms.html#def-warning_24" data-sym="WARNING$">warning$</a> ctx
                  <span class="string">"bash"</span>
                  <span class="string">"Unable to simplify the input term~@0"</span>
                  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> erp 'no-change) <span class="string">"."</span>)
                    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">" because an error occurred.~@0"</span>
                        (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (verbose <span class="string">""</span>)
                          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> <span class="string">"  Try setting the verbose flag to ~
                                            t in order to see what is going ~
                                            on."</span>))))))
                (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> form)))))
            (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> form))))))
        (untranslate-flg (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link local-def" href="#def-untranslate-lst-lst" data-sym="UNTRANSLATE-LST-LST" title="(defun untranslate-lst-lst (list iff-flg wrld)
  (cond ((endp list) nil)
        (t
         (cons (untranslate-lst (car list) iff-flg wrld)
               (untranslate-lst-lst (cdr list) iff-flg wrld)))))">untranslate-lst-lst</a> clauses <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-w" data-sym="W">w</a> state))))
        (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> clauses))))))</pre>
  </div>

<div class="form-block macro" id="def-preserve-pspv" data-defines="PRESERVE-PSPV" data-references="MV,IGNORE,DECLARE,COMPRESS1,ENS,STATE,VAL,ERR,MV-LET,ENABLED-STRUCTURE,OLD-NAME,PROVE-SPEC-VAR,REWRITE-CONSTANT,ACCESS,OLD-ENS,LET*,LET,QUASIQUOTE,QUOTE,PSPV,&KEY,CALL,DEFMACRO" typeof="Code">
    <div class="form-header"><span class="form-name" property="name" data-sym="PRESERVE-PSPV">preserve-pspv</span><span class="form-type">macro</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> <a class="sym-link local-def" href="#def-preserve-pspv" data-sym="PRESERVE-PSPV" title="(defmacro preserve-pspv (call &amp;key (pspv &#39;pspv))
  `(let ((pspv ,pspv))
     (let* ((old-ens
             (access rewrite-constant
                     (access prove-spec-var pspv :rewrite-constant)
...">preserve-pspv</a>
  (call &amp;key (pspv 'pspv))
  `(let ((pspv ,PSPV))
    (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((old-ens (<a class="sym-link system" href="../../axioms.html#def-access" data-sym="ACCESS">access</a> rewrite-constant
           (<a class="sym-link system" href="../../axioms.html#def-access" data-sym="ACCESS">access</a> prove-spec-var pspv <span class="keyword">:rewrite-constant</span>)
           <span class="keyword">:current-enabled-structure</span>)) (old-name (<a class="sym-link system" href="../../axioms.html#def-access" data-sym="ACCESS">access</a> enabled-structure old-ens <span class="keyword">:array-name</span>)))
      (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (err val state)
        ,CALL
        (let ((ens (<a class="sym-link system" href="../../axioms.html#def-compress1" data-sym="COMPRESS1">compress1</a> old-name
               (<a class="sym-link system" href="../../axioms.html#def-access" data-sym="ACCESS">access</a> enabled-structure old-ens <span class="keyword">:theory-array</span>))))
          (declare (ignore ens))
          (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> err val state))))))</pre>
  </div>

<div class="form-block other" id="form-11" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc <a class="sym-link local-def" href="#def-bash" data-sym="BASH" title="(defmacro bash (term &amp;key verbose hints)
  `(bash-fn &#39;,term &#39;,hints &#39;,verbose &#39;bash state))">bash</a>
  <span class="keyword">:parents</span> (proof-automation)
  <span class="keyword">:short</span> <span class="string">"&lt;tt&gt;Bash&lt;/tt&gt; is a tool that simplifies a term, producing a list of
simplified terms such that if all output terms are theorems, then so is the
input term."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;This utility is defined in community book
&lt;tt&gt;&quot;misc/bash.lisp&quot;&lt;/tt&gt;.  If you submit &lt;tt&gt;(bash term)&lt;/tt&gt; then roughly
speaking, the result is a list of goals produced by ACL2&#39;s simplification
process.  That is, ACL2 might reasonably be expected to produce these goals
when simplifying &lt;tt&gt;term&lt;/tt&gt; during a proof attempt.  In particular, if the
result is &lt;tt&gt;nil&lt;/tt&gt;, then &lt;tt&gt;term&lt;/tt&gt; is a theorem.  More accurately:
&lt;tt&gt;(bash term)&lt;/tt&gt; returns an @(see error-triple), @(&#39;(mv nil val state)&#39;)
where &lt;tt&gt;val&lt;/tt&gt; is a list of terms, in untranslated (user-level) form, whose
provability implies the provability of the input term.  If ACL2 cannot simplify
the input term (e.g., if there is a translation error), then it prints a
warning and returns &lt;tt&gt;(mv nil input-term state)&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;For related utilities, see @(see bash-term-to-dnf) and @(see simp).&lt;/p&gt;

&lt;h3&gt;Examples&lt;/h3&gt;

&lt;p&gt;First we execute:
@({(include-book &quot;misc/bash&quot; :dir :system)})
Then:
@({
ACL2 !&gt;(bash (equal (append x y) (append (car (cons x a)) z)))
Goal&#39;
 ((EQUAL (APPEND X Y) (APPEND X Z)))
ACL2 !&gt;(set-gag-mode nil) ; optional; turns off printing of goal names
&lt;state&gt;
ACL2 !&gt;(bash (equal (append x y) (append (car (cons x a)) z)))
 ((EQUAL (APPEND X Y) (APPEND X Z)))
ACL2 !&gt;(bash (equal (car (cons x y)) x))
 NIL
ACL2 !&gt;(bash (implies (true-listp x) (equal (append x y) zzz))
             :hints ((&quot;Goal&quot; :expand ((true-listp x)
                                      (true-listp (cdr x))
                                      (append x y)))))
 ((EQUAL Y ZZZ)
  (IMPLIES (AND (CONSP X)
                (CONSP (CDR X))
                (TRUE-LISTP (CDDR X)))
           (EQUAL (LIST* (CAR X)
                         (CADR X)
                         (APPEND (CDDR X) Y))
                  ZZZ))
  (IMPLIES (AND (CONSP X) (NOT (CDR X)))
           (EQUAL (CONS (CAR X) Y) ZZZ)))
ACL2 !&gt;(bash (equal x y))

ACL2 Warning [bash] in BASH:  Unable to simplify the input term.

 ((EQUAL X Y))
ACL2 !&gt;(bash (equal x))

ACL2 Warning [bash] in BASH:  Unable to simplify the input term because
an error occurred.  Try setting the verbose flag to t in order to see
what is going on.

 ((EQUAL X))
ACL2 !&gt;(bash (equal x) :verbose t)


ACL2 Error in BASH:  EQUAL takes 2 arguments but in the call (EQUAL X)
it is given 1 argument.   The formal parameters list for EQUAL is (X Y).


ACL2 Warning [bash] in BASH:  Unable to simplify the input term because
an error occurred.

 ((EQUAL X))
ACL2 !&gt;
})&lt;/p&gt;

&lt;p&gt;Here is how we might use this tool to simplify hypotheses.  First execute:

@({
 (defstub p1 (x) t)
 (defstub p2 (x) t)
 (defun p3 (x) (if (atom x) (p2 x) (p1 (car x))))
 (include-book
  &quot;misc/bash&quot; :dir :system)
})

Then:

@({
  ACL2 !&gt;(bash (implies (and (p1 x) (p3 x))
                        (hide aaa)))
   ((IMPLIES (AND (P1 X) (CONSP X) (P1 (CAR X)))
             (HIDE AAA))
    (IMPLIES (AND (P1 X) (NOT (CONSP X)) (P2 X))
             (HIDE AAA)))
  ACL2 !&gt;
})&lt;/p&gt;

&lt;h3&gt;More details&lt;/h3&gt;

&lt;p&gt;This utility is similar to the @(see proof-builder)&#39;s &lt;tt&gt;bash&lt;/tt&gt; command,
but for use in the top-level loop.  The input term can have user-level syntax;
it need not be translated.  The output is an error triple &lt;tt&gt;(mv nil termlist
state)&lt;/tt&gt; such that either &lt;tt&gt;termlist&lt;/tt&gt; is a one-element list containing
the input term, or else &lt;tt&gt;termlist&lt;/tt&gt; is a list of term such that if each
term in this list is a theorem, then the input term is a theorem.  In practice,
these terms are produced by calling the prover with non-simplification
processes --- &lt;tt&gt;generalize&lt;/tt&gt;, &lt;tt&gt;eliminate-destructors&lt;/tt&gt;,
&lt;tt&gt;fertilize&lt;/tt&gt; (heuristic use of equalities), and
&lt;tt&gt;eliminate-irrelevance&lt;/tt&gt;, as well as induction --- turned off, and with
forcing rounds skipped (at least the first 15 of them).  A keyword argument,
&lt;tt&gt;:hints&lt;/tt&gt;, can specify @(see hints) using their usual syntax, as with
@(see defthm).  The other keyword argument, &lt;tt&gt;:verbose&lt;/tt&gt;, is &lt;tt&gt;nil&lt;/tt&gt;
by default, to suppress output; use a non-&lt;tt&gt;nil&lt;/tt&gt; value if you want
output, including the proof attempt.  The keyword values are not evaluated, so
for example &lt;tt&gt;:hints&lt;/tt&gt; could be of the form &lt;tt&gt;((&quot;Goal&quot; ...))&lt;/tt&gt; but
not &lt;tt&gt;&#39;((&quot;Goal&quot; ...))&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;We conclude with an note on the use of @(see hints) that may be important if
you use computed hints (see @(see computed-hints)).  Consider the following
example, supplied courtesy of Harsh Raju Chamarthi.

@({
 (defun drop (n l)
   (if (zp n)
     l
     (drop (1- n) (cdr l))))

 (include-book &quot;misc/bash&quot; :dir :system)

 ; Occur-fn returns the term that has fn has its function symbol.
 (mutual-recursion
  (defun occur-fn (fn term2)
    (cond ((variablep term2) nil)
          ((fquotep term2) nil)
          (t (or (and (eq fn (ffn-symb term2)) term2)
                 (occur-fn-lst fn (fargs term2))))))
  (defun occur-fn-lst (fn args2)
    (cond ((endp args2) nil)
          (t (or (occur-fn fn (car args2))
                 (occur-fn-lst fn (cdr args2)))))))

 ; Doesn&#39;t work as you might expect (see below):
 (bash (drop 3 x)
       :verbose t
       :hints ((if (occur-fn-lst &#39;drop clause)
                   `(:computed-hint-replacement
                     t
                     :expand
                     (,(occur-fn-lst &#39;drop clause)))
                 nil)))
})

The preceding call of &lt;tt&gt;bash&lt;/tt&gt;, at the end of the displayed list of forms
above, causes the theorem prover to use destructor elimination, even though
that proof process is presumably turned off by &lt;tt&gt;bash&lt;/tt&gt;.  What happened?
The problem is that the user-supplied hints are put in front of the hints
generated by &lt;tt&gt;bash&lt;/tt&gt; to form the full list of hints given to the prover,
which cases the &lt;tt&gt;:do-not&lt;/tt&gt; hint on &quot;Goal&quot; to be ignored.  Here is a
solution.

@({
 (bash (drop 3 x)
       :verbose t
       :hints ((if (occur-fn-lst &#39;drop clause)
                   `(:computed-hint-replacement
                     t
                     :do-not-induct :bash
                     :do-not (set-difference-eq *do-not-processes*
                                                &#39;(preprocess simplify))
                     :expand (,(occur-fn-lst &#39;drop clause)))
                 &#39;(:do-not-induct
                   :bash
                   :do-not
                   (set-difference-eq *do-not-processes*
                                      &#39;(preprocess simplify))))))
})&lt;/p&gt;"</span>)</pre>
  </div>

<div class="form-block other" id="form-12" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc <a class="sym-link local-def" href="#def-bash-term-to-dnf" data-sym="BASH-TERM-TO-DNF" title="(defun bash-term-to-dnf (form hints verbose untranslate-flg state)
  (let ((ctx &#39;bash-term-to-dnf))
    (mv-let (erp clauses state)
            (cond (verbose (simplify-with-prover form hints ctx state))
                  (t
...">bash-term-to-dnf</a>
  <span class="keyword">:parents</span> (proof-automation)
  <span class="keyword">:short</span> <span class="string">"&lt;tt&gt;Bash-term-to-dnf&lt;/tt&gt; is a tool that simplifies a term, producing
a list of clauses such that if all output clauses are theorems, then so is the
input term."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;This utility is defined in community book
&lt;tt&gt;&quot;misc/bash.lisp&quot;&lt;/tt&gt;.  We assume here familiarity with the @(&#39;bash&#39;)
tool defined in that book, focusing below on how the present tool differs from
that one.&lt;/p&gt;

&lt;p&gt;If you submit &lt;tt&gt;(bash-term-to-dnf term)&lt;/tt&gt; then the result is a list of
goals produced by ACL2&#39;s simplification process, much as for the result of
&lt;tt&gt;(bash term)&lt;/tt&gt;; see @(&#39;bash&#39;).  However, unlike &lt;tt&gt;bash&lt;/tt&gt;,
&lt;tt&gt;bash-term-to-dnf&lt;/tt&gt; returns a list of &lt;i&gt;clauses&lt;/i&gt;, where each clause
is a list of terms that represents the disjunction of those terms, and the list
of clauses is implicitly conjoined.&lt;/p&gt;

&lt;p&gt;Again: For related utilities, see @(see simp) and @(see bash).&lt;/p&gt;

&lt;h3&gt;Example&lt;/h3&gt;

&lt;p&gt;First we execute:
@({(include-book &quot;misc/bash&quot; :dir :system)})
Then:
@({
ACL2 !&gt;(bash-term-to-dnf
        &#39;(implies (true-listp x) (equal (append x y) zzz))
        &#39;((&quot;Goal&quot; :expand ((true-listp x)
                           (true-listp (cdr x))
                           (append x y))))
        nil t state)
 (((EQUAL Y ZZZ))
  ((NOT (CONSP X))
   (NOT (CONSP (CDR X)))
   (NOT (TRUE-LISTP (CDDR X)))
   (EQUAL (LIST* (CAR X)
                 (CADR X)
                 (APPEND (CDDR X) Y))
          ZZZ))
  ((NOT (CONSP X))
   (CDR X)
   (EQUAL (CONS (CAR X) Y) ZZZ)))
ACL2 !&gt;
})&lt;/p&gt;

&lt;h3&gt;General Form:&lt;/h3&gt;

&lt;p&gt;@({(bash-term-to-dnf form hints verbose untranslate-flg state)})
returns a list of clauses, each of which is a list of terms, where:

&lt;ul&gt;

&lt;li&gt;&lt;tt&gt;form&lt;/tt&gt; is a user-level (untranslated) term;&lt;/li&gt;

&lt;li&gt;&lt;tt&gt;hints&lt;/tt&gt;, if supplied, is a @(see hints) structure (as for
@(&#39;defthm&#39;));&lt;/li&gt;

&lt;li&gt;&lt;tt&gt;verbose&lt;/tt&gt; is &lt;tt&gt;nil&lt;/tt&gt; by default, in which case output is
inhibited; on the other extreme, if &lt;tt&gt;verbose&lt;/tt&gt; is &lt;tt&gt;:all&lt;/tt&gt; then a
warning is printed when no simplification takes place; and&lt;/li&gt;

&lt;li&gt;&lt;tt&gt;untranslate-flg&lt;/tt&gt; is &lt;tt&gt;nil&lt;/tt&gt; by default, in which case each
term in each returned clause is a term in internal (translated) form and
otherwise, each such term is in user-level (untranslated) form;&lt;/li&gt;

&lt;/ul&gt;

If each returned clause (viewed as a disjunction) is a theorem, then the input
&lt;tt&gt;form&lt;/tt&gt; is a theorem.&lt;/p&gt;"</span>)</pre>
  </div>


  </main>
  
<script>
// ACL2 Book HTML Documentation - Interactive Features
// Generated by cert2 - build2 system

// State
let activeFilter = null;
let activePartFilter = null;
let activeNameFilter = null;
let currentFontSize = 14;

// Theme management
function getStoredTheme() {
  return localStorage.getItem('acl2-theme') || 'dark';
}

function setTheme(theme) {
  if (theme === 'light') {
    document.documentElement.setAttribute('data-theme', 'light');
    document.getElementById('theme-toggle').textContent = 'üåô';
  } else {
    document.documentElement.removeAttribute('data-theme');
    document.getElementById('theme-toggle').textContent = '‚òÄÔ∏è';
  }
  localStorage.setItem('acl2-theme', theme);
}

function toggleTheme() {
  const current = getStoredTheme();
  setTheme(current === 'dark' ? 'light' : 'dark');
}

// Font size management
function getStoredFontSize() {
  return parseInt(localStorage.getItem('acl2-fontsize') || '14', 10);
}

function setFontSize(size) {
  size = Math.max(10, Math.min(24, size)); // Clamp between 10-24
  currentFontSize = size;
  document.body.style.fontSize = size + 'px';
  localStorage.setItem('acl2-fontsize', size.toString());
}

function increaseFontSize() {
  setFontSize(currentFontSize + 2);
}

function decreaseFontSize() {
  setFontSize(currentFontSize - 2);
}

// Get all form blocks
function getFormBlocks() {
  return document.querySelectorAll('.form-block');
}

// Clear all filters
function clearFilter() {
  activeFilter = null;
  activePartFilter = null;
  activeNameFilter = null;
  getFormBlocks().forEach(b => {
    b.classList.remove('hidden', 'dimmed');
  });
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  const status = document.querySelector('.filter-status');
  status.classList.remove('active');
  // Slide name filter back to original position
  document.querySelector('.controls-left').style.transform = '';
  // Clear the name filter input
  const nameInput = document.getElementById('name-filter');
  if (nameInput) nameInput.value = '';
}

// Show filter status and slide name filter right
function showFilterStatus(text) {
  const status = document.querySelector('.filter-status');
  status.classList.add('active');
  status.querySelector('.filter-text').textContent = text;
  // Slide name filter to the right to make room
  setTimeout(() => {
    const statusWidth = status.offsetWidth;
    document.querySelector('.controls-left').style.transform = `translateX(${statusWidth + 15}px)`;
  }, 10);
}

// Filter to show only forms that define or reference a symbol
function filterBySymbol(symName, showUsedBy) {
  clearFilter();
  activeFilter = symName;
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines;
    const references = (block.dataset.references || '').split(',');
    const usedBy = (block.dataset.usedBy || '').split(',');
    
    let show = false;
    if (showUsedBy) {
      // Show forms that USE this symbol
      show = references.includes(symName) || definesName === symName;
    } else {
      // Show forms that this symbol USES
      show = usedBy.includes(symName) || definesName === symName;
    }
    
    if (show) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering by: ${symName} (${visibleCount} items)`);
}

// Filter by defthm part (term, hints, rule-classes, etc.)
function filterByPart(formId, partName) {
  clearFilter();
  activePartFilter = { formId, partName };
  
  // Get the part's referenced symbols
  // data-part-term becomes dataset.partTerm, data-part-hints becomes dataset.partHints, etc.
  const block = document.getElementById(formId);
  const datasetKey = 'part' + partName.charAt(0).toUpperCase() + partName.slice(1).replace(/-([a-z])/g, (g) => g[1].toUpperCase());
  const partData = block.dataset[datasetKey];
  if (!partData) return;
  
  const partSyms = partData.split(',').filter(s => s);
  
  // Highlight the button
  block.querySelector(`.part-btn[data-part="${partName}"]`).classList.add('active');
  
  // Hide forms not referenced by this part
  getFormBlocks().forEach(b => {
    const definesName = b.dataset.defines;
    if (b.id === formId || partSyms.includes(definesName)) {
      b.classList.remove('hidden');
    } else {
      b.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering ${formId} :${partName} (${partSyms.length} references)`);
}

// Filter by name (substring or regex)
function filterByName(pattern, useRegex) {
  // Clear other filters but keep the input value
  activeFilter = null;
  activePartFilter = null;
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  
  if (!pattern || pattern.trim() === '') {
    // Empty pattern - show all
    activeNameFilter = null;
    getFormBlocks().forEach(b => b.classList.remove('hidden'));
    const status = document.querySelector('.filter-status');
    status.classList.remove('active');
    document.querySelector('.controls-left').style.transform = '';
    return;
  }
  
  activeNameFilter = pattern;
  
  let matcher;
  let isValidRegex = true;
  
  if (useRegex) {
    try {
      matcher = new RegExp(pattern, 'i');
    } catch (e) {
      // Invalid regex - show error in status and don't filter
      showFilterStatus(`Invalid regex: ${e.message}`);
      return;
    }
  } else {
    // Plain substring match (case-insensitive)
    const lowerPattern = pattern.toLowerCase();
    matcher = { test: (s) => s.toLowerCase().includes(lowerPattern) };
  }
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines || '';
    if (matcher.test(definesName)) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  const modeText = useRegex ? 'regex' : 'name';
  showFilterStatus(`Filtering by ${modeText}: "${pattern}" (${visibleCount} matches)`);
}

// Click on a name to show what references it
function handleNameClick(symName) {
  if (activeFilter === symName) {
    clearFilter();
  } else {
    filterBySymbol(symName, true);
  }
}

// Navigate to a definition (same file or different)
function navigateTo(symName, file) {
  if (file) {
    // External file - navigate
    window.location.href = file + '.html#def-' + symName.toLowerCase();
  } else {
    // Same file - scroll
    const target = document.getElementById('def-' + symName.toLowerCase());
    if (target) {
      target.scrollIntoView({ behavior: 'smooth', block: 'center' });
      target.classList.add('highlight');
      setTimeout(() => target.classList.remove('highlight'), 400);
    }
  }
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  // Part buttons
  document.querySelectorAll('.part-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const formId = btn.closest('.form-block').id;
      const partName = btn.dataset.part;
      if (activePartFilter && activePartFilter.formId === formId && 
          activePartFilter.partName === partName) {
        clearFilter();
      } else {
        filterByPart(formId, partName);
      }
    });
  });
  
  // Clear filter button
  document.querySelector('.clear-filter').addEventListener('click', clearFilter);
  
  // Name filter input
  const nameFilter = document.getElementById('name-filter');
  const regexToggle = document.getElementById('regex-toggle');
  
  let filterTimeout = null;
  nameFilter.addEventListener('input', () => {
    // Debounce the filter to avoid excessive updates while typing
    clearTimeout(filterTimeout);
    filterTimeout = setTimeout(() => {
      filterByName(nameFilter.value, regexToggle.checked);
    }, 150);
  });
  
  // Re-filter when regex toggle changes
  regexToggle.addEventListener('change', () => {
    if (nameFilter.value) {
      filterByName(nameFilter.value, regexToggle.checked);
    }
  });
  
  // Allow Escape key to clear filter when in input
  nameFilter.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      clearFilter();
      nameFilter.blur();
    }
  });
  
  // Symbol references (old span-based refs)
  document.querySelectorAll('.sym-ref').forEach(ref => {
    ref.addEventListener('click', (e) => {
      e.stopPropagation();
      const sym = ref.dataset.sym;
      const file = ref.dataset.file;
      if (file) {
        navigateTo(sym, file);
      } else {
        handleNameClick(sym);
      }
    });
  });
  
  // Symbol links (new anchor-based links)
  // These use standard <a> tags so navigation happens automatically
  // But we need to clear filters if target would be hidden
  document.querySelectorAll('.sym-link').forEach(link => {
    link.addEventListener('click', (e) => {
      const href = link.getAttribute('href');
      if (href && href.startsWith('#')) {
        // Local link - check if target is hidden by filter
        const targetId = href.substring(1);
        const target = document.getElementById(targetId);
        if (target) {
          // If target is hidden, clear the filter first
          if (target.classList.contains('hidden')) {
            clearFilter();
          }
          // Add highlight effect after a short delay
          setTimeout(() => {
            target.classList.add('highlight');
            setTimeout(() => target.classList.remove('highlight'), 400);
          }, 100);
        }
      }
      // For external links, default behavior handles navigation
    });
  });
  
  // Form names (show what uses them)
  document.querySelectorAll('.form-name').forEach(name => {
    name.addEventListener('click', (e) => {
      handleNameClick(name.dataset.sym);
    });
  });
  
  // Handle hash navigation (when arriving at page with #anchor)
  if (window.location.hash) {
    const target = document.querySelector(window.location.hash);
    if (target) {
      setTimeout(() => {
        target.scrollIntoView({ behavior: 'smooth', block: 'center' });
        target.classList.add('highlight');
        setTimeout(() => target.classList.remove('highlight'), 400);
      }, 200);
    }
  }
  
  // Initialize theme from storage
  setTheme(getStoredTheme());
  
  // Initialize font size from storage
  currentFontSize = getStoredFontSize();
  setFontSize(currentFontSize);
  
  // Theme toggle button
  document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
  
  // Font size buttons
  document.getElementById('font-larger').addEventListener('click', increaseFontSize);
  document.getElementById('font-smaller').addEventListener('click', decreaseFontSize);
});

</script>

</body>
</html>
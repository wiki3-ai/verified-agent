<!DOCTYPE html>
<html lang="en" vocab="http://schema.org/" typeof="SoftwareSourceCode">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>simplify-defuns - ACL2 Book</title>
  <meta property="name" content="simplify-defuns">
  <meta property="programmingLanguage" content="ACL2">
  
<style>
/* ACL2 Book HTML Documentation Styles */
/* Generated by cert2 - build2 system */

/* Dark theme (default) */
:root {
  --bg: #1e1e2e;
  --fg: #cdd6f4;
  --comment: #6c7086;
  --keyword: #cba6f7;
  --string: #a6e3a1;
  --function: #89b4fa;
  --type: #f9e2af;
  --link: #89dceb;
  --link-hover: #f5c2e7;
  --highlight: rgba(137, 180, 250, 0.2);
  --border: #313244;
  --block-bg: rgba(49, 50, 68, 0.5);
  --btn-bg: #313244;
  --btn-hover: rgba(137, 180, 250, 0.2);
}

/* Light theme */
[data-theme="light"] {
  --bg: #eff1f5;
  --fg: #4c4f69;
  --comment: #6c6f85;
  --keyword: #8839ef;
  --string: #40a02b;
  --function: #1e66f5;
  --type: #df8e1d;
  --link: #04a5e5;
  --link-hover: #ea76cb;
  --highlight: rgba(30, 102, 245, 0.15);
  --border: #ccd0da;
  --block-bg: rgba(204, 208, 218, 0.3);
  --btn-bg: #ccd0da;
  --btn-hover: rgba(30, 102, 245, 0.15);
}

body {
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  background: var(--bg);
  color: var(--fg);
  margin: 0;
  padding: 20px;
  line-height: 1.6;
  font-size: 14px;
  transition: background 0.1s, color 0.1s;
}

/* Controls toolbar */
.controls-left {
  position: fixed;
  top: 10px;
  left: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
  transition: transform 0.1s ease;
}

.controls-right {
  position: fixed;
  top: 10px;
  right: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
}

.control-btn {
  padding: 6px 12px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-family: inherit;
  font-size: 14px;
  transition: all 0.1s;
}

.control-btn:hover {
  background: var(--btn-hover);
  border-color: var(--link);
}

.name-filter {
  padding: 6px 10px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  font-family: inherit;
  font-size: 13px;
  width: 150px;
  transition: all 0.1s;
}

.name-filter:focus {
  outline: none;
  border-color: var(--link);
  width: 200px;
}

.name-filter::placeholder {
  color: var(--comment);
}

.regex-label {
  display: flex;
  align-items: center;
  gap: 4px;
  color: var(--comment);
  font-size: 12px;
  cursor: pointer;
}

.regex-label input {
  cursor: pointer;
}

.book-header {
  border-bottom: 2px solid var(--border);
  padding-bottom: 20px;
  margin-bottom: 20px;
}

.book-header h1 {
  color: var(--keyword);
  margin: 0;
}

.book-header .path {
  color: var(--comment);
  font-size: 0.9em;
}

.book-header .path .source-link {
  color: var(--comment);
  text-decoration: none;
}

.book-header .path .source-link:hover {
  color: var(--link);
  text-decoration: underline;
}

.form-block {
  margin: 10px 0;
  padding: 15px;
  background: var(--block-bg);
  border-radius: 8px;
  border-left: 3px solid var(--border);
}

.form-block.theorem { border-left-color: var(--keyword); }
.form-block.function { border-left-color: var(--function); }
.form-block.macro { border-left-color: var(--type); }
.form-block.include-book { border-left-color: var(--string); }

.form-block.hidden { display: none; }
.form-block.dimmed { opacity: 0.3; }

.form-block.highlight {
  animation: highlight-pulse 0.4s ease-out;
}

@keyframes highlight-pulse {
  0% { background: var(--highlight); box-shadow: 0 0 20px var(--link); }
  100% { background: rgba(49, 50, 68, 0.5); box-shadow: none; }
}

.form-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.form-name {
  color: var(--function);
  font-weight: bold;
  cursor: pointer;
}

.form-name:hover {
  color: var(--link-hover);
  text-decoration: underline;
}

.form-type {
  color: var(--comment);
  font-size: 0.85em;
}

pre.code {
  margin: 0;
  overflow-x: auto;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.sym-ref {
  color: var(--link);
  cursor: pointer;
  border-radius: 2px;
}

.sym-ref:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.sym-ref.local-def { color: var(--function); font-weight: bold; }
.sym-ref.external { color: var(--type); }

/* Symbol links (clickable hyperlinks) */
.sym-link {
  color: var(--link);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
  position: relative;
}

.sym-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

.sym-link.local-def {
  color: var(--function);
  font-weight: bold;
}

.sym-link.external {
  color: var(--type);
}

/* Tooltips using title attribute with custom styling */
.sym-link[title] {
  /* Browser will show title on hover */
}

/* Syntax highlighting in code blocks */
.keyword {
  color: var(--keyword);
}

.string {
  color: var(--string);
}

.number {
  color: #f77524; /* orange */
}

/* Include-book path links */
.include-path {
  color: var(--string);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
}

.include-path:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

/* Part buttons for defthm */
.part-buttons {
  display: flex;
  gap: 5px;
  margin: 10px 0;
  flex-wrap: wrap;
}

.part-btn {
  padding: 4px 10px;
  background: var(--border);
  border: 1px solid var(--comment);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-size: 0.85em;
  font-family: inherit;
}

.part-btn:hover {
  background: var(--highlight);
  border-color: var(--link);
}

.part-btn.active {
  background: var(--link);
  color: var(--bg);
  border-color: var(--link);
}

/* References panel */
.refs-panel {
  margin-top: 10px;
  padding: 10px;
  background: rgba(0,0,0,0.2);
  border-radius: 4px;
  display: none;
}

.refs-panel.visible { display: block; }

.refs-panel h4 {
  margin: 0 0 5px 0;
  color: var(--comment);
  font-size: 0.9em;
}

.refs-list {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

/* Included books section */
.includes-section {
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(49, 50, 68, 0.3);
  border-radius: 8px;
  border: 1px solid var(--border);
}

.includes-section h2 {
  margin: 0 0 10px 0;
  color: var(--comment);
  font-size: 1em;
  font-weight: normal;
}

.includes-list {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.include-link {
  padding: 6px 12px;
  background: var(--border);
  border-radius: 4px;
  color: var(--link);
  text-decoration: none;
  font-size: 0.9em;
  transition: all 0.1s;
}

.include-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.include-link.local {
  border-left: 2px solid var(--comment);
}

/* Filter status */
.filter-status {
  position: fixed;
  top: 10px;
  left: 20px;
  background: var(--bg);
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: 4px;
  z-index: 201;
  display: none;
  align-items: center;
  gap: 10px;
}

.filter-status.active {
  display: flex;
  align-items: center;
  gap: 10px;
}

.clear-filter {
  padding: 5px 15px;
  background: var(--keyword);
  color: var(--bg);
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

/* RDFa vocab indicator */
[vocab] { /* semantic web annotations present */ }

</style>

</head>
<body>
  <div class="controls-left">
    <input type="text" id="name-filter" class="name-filter" placeholder="Filter by name..." title="Filter definitions by name">
    <label class="regex-label"><input type="checkbox" id="regex-toggle"> regex</label>
  </div>

  <div class="controls-right">
    <button class="control-btn" id="theme-toggle" title="Toggle light/dark theme">☀️</button>
    <button class="control-btn" id="font-smaller" title="Decrease font size">A-</button>
    <button class="control-btn" id="font-larger" title="Increase font size">A+</button>
  </div>

  <div class="filter-status">
    <span class="filter-text">Filtering...</span>
    <button class="clear-filter">Clear Filter</button>
  </div>
  
  <div class="book-header">
    <h1 property="name">simplify-defuns</h1>
    <div class="path"><a href="simplify-defuns.lisp" class="source-link">books/misc/simplify-defuns</a></div>
  </div>
  
  <main property="text">
  <div class="includes-section">
    <h2>Included Books</h2>
    <div class="includes-list">
      <a class="include-link" href="file-io.html" title="file-io">file-io</a>
    </div>
  </div>

<div class="form-block other" id="form-0" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-in-package" data-sym="IN-PACKAGE">in-package</a> <span class="string">"ACL2"</span>)</pre>
  </div>

<div class="form-block other" id="form-1" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-program" data-sym="PROGRAM">program</a>)</pre>
  </div>

<div class="form-block other" id="form-2" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-set-state-ok" data-sym="SET-STATE-OK">set-state-ok</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>)</pre>
  </div>

<div class="form-block function" id="def-simplify-term1" data-defines="SIMPLIFY-TERM1" data-references="CONS-TAG-TREES,PROVE-LOOP1,NEW-TTREE,VALUE,ACCUMULATE-TTREE-AND-STEP-LIMIT-INTO-STATE,SET-CL-IDS-OF-ASSUMPTIONS,PROCESS-ASSUMPTIONS,PAIRS,RESUME-SUSPENDED-ASSUMPTION-REWRITING,BAD-ASS,CURRENT-ACL2-WORLD,CONGRUENCES,GETPROP,LAST,CADR,STEP-LIMIT,?,REWRITE-STACK-LIMIT,REWRITE,REWRITE-ENTRY,REWRITTEN-TERM,SIMPLIFY-CLAUSE,INITIAL-GSTACK,GSTACK,CURRENT-LITERAL,MAKE,LOCAL-RCNST,INITIAL-STEP-LIMIT,PTS-TO-TTREE-LST,SETUP-SIMPLIFY-CLAUSE-POT-LST,SIMPLIFY-CLAUSE-POT-LST,SL-LET,IGNORE,DECLARE,FORWARD-CHAIN,FC-PAIR-LST,TYPE-ALIST,CONTRADICTIONP,PTS,WEAK,FFNNAMEP-LST,IF,PROVE-SPEC-VAR,ACCESS,REWRITE-CONSTANT,CHANGE,RCNST,CONJOIN,IMPLICATE,LIST,INITIALIZE-PROOF-TREE,PPROGN,CONS,SOFT,ER,STRIP-CARS,INTERSECTP-EQ,LOAD-HINT-SETTINGS-INTO-PSPV,PSPV,THANKS-FOR-THE-HINT,MV,NULL,COND,MV-LET,CDR,CAR,HINT-SETTINGS,LET,*INITIAL-CLAUSE-ID*,FIND-APPLICABLE-HINT-SETTINGS,PAIR,ER-LET*,T,DUMB-NEGATE-LIT-LST,ADD-LITERAL,CURRENT-CLAUSE,XXX,HIDE,EQUAL,QUOTE,FCONS-TERM*,NEW-LIT,MAKE-PSPV,SAVED-PSPV,ENS,LET*,SEMI-INITIALIZE-BRR-WORMHOLE,PROG2$,STATE,WRLD,CTX,PROVE-ASSUMPTIONS,THINTS,EQUIV,HYPS,TERM,TTREE,DEFUN" data-used-by="SIMPLIFY-TERM*" data-part-name="SIMPLIFY-TERM1" data-part-args="STATE,WRLD,CTX,PROVE-ASSUMPTIONS,THINTS,EQUIV,HYPS,TERM,TTREE" data-part-body="CONS-TAG-TREES,PROVE-LOOP1,NEW-TTREE,VALUE,ACCUMULATE-TTREE-AND-STEP-LIMIT-INTO-STATE,SET-CL-IDS-OF-ASSUMPTIONS,PROCESS-ASSUMPTIONS,PAIRS,PROVE-ASSUMPTIONS,RESUME-SUSPENDED-ASSUMPTION-REWRITING,BAD-ASS,CURRENT-ACL2-WORLD,CONGRUENCES,EQUIV,GETPROP,LAST,CADR,STEP-LIMIT,?,REWRITE-STACK-LIMIT,REWRITE,REWRITE-ENTRY,TTREE,REWRITTEN-TERM,SIMPLIFY-CLAUSE,INITIAL-GSTACK,GSTACK,CURRENT-LITERAL,MAKE,LOCAL-RCNST,INITIAL-STEP-LIMIT,PTS-TO-TTREE-LST,SETUP-SIMPLIFY-CLAUSE-POT-LST,SIMPLIFY-CLAUSE-POT-LST,SL-LET,IGNORE,DECLARE,FORWARD-CHAIN,FC-PAIR-LST,TYPE-ALIST,CONTRADICTIONP,PTS,WEAK,FFNNAMEP-LST,IF,PROVE-SPEC-VAR,ACCESS,REWRITE-CONSTANT,CHANGE,RCNST,CONJOIN,IMPLICATE,LIST,INITIALIZE-PROOF-TREE,PPROGN,CONS,SOFT,ER,STRIP-CARS,INTERSECTP-EQ,LOAD-HINT-SETTINGS-INTO-PSPV,PSPV,THANKS-FOR-THE-HINT,MV,NULL,COND,MV-LET,CDR,CAR,HINT-SETTINGS,LET,CTX,*INITIAL-CLAUSE-ID*,FIND-APPLICABLE-HINT-SETTINGS,PAIR,ER-LET*,T,HYPS,DUMB-NEGATE-LIT-LST,ADD-LITERAL,CURRENT-CLAUSE,XXX,HIDE,EQUAL,QUOTE,FCONS-TERM*,NEW-LIT,THINTS,TERM,WRLD,MAKE-PSPV,SAVED-PSPV,ENS,LET*,STATE,SEMI-INITIALIZE-BRR-WORMHOLE,PROG2$" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="SIMPLIFY-TERM1">simplify-term1</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-simplify-term1" data-sym="SIMPLIFY-TERM1" title="(defun simplify-term1
       (ttree term hyps equiv thints prove-assumptions ctx wrld state)
  (prog2$ (semi-initialize-brr-wormhole state)
          (let* ((ens (ens state))
                 (saved-pspv
...">simplify-term1</a>
  (ttree term
    hyps
    equiv
    thints
    prove-assumptions
    ctx
    wrld
    state)
  (<a class="sym-link system" href="../../axioms.html#def-prog2_24" data-sym="PROG2$">prog2$</a> (<a class="sym-link system" href="../../rewrite.html#def-semi-initialize-brr-wormhole" data-sym="SEMI-INITIALIZE-BRR-WORMHOLE">semi-initialize-brr-wormhole</a> state)
    (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((ens (ens state)) (saved-pspv (<a class="sym-link system" href="../../prove.html#def-make-pspv" data-sym="MAKE-PSPV">make-pspv</a> ens
            wrld
            state
            <span class="keyword">:displayed-goal</span> term
            <span class="keyword">:user-supplied-term</span> term
            <span class="keyword">:orig-hints</span> thints))
        (new-lit (<a class="sym-link system" href="../../axioms.html#def-fcons-term_2A" data-sym="FCONS-TERM*">fcons-term*</a> 'equal (<a class="sym-link system" href="../../axioms.html#def-fcons-term_2A" data-sym="FCONS-TERM*">fcons-term*</a> '<a class="sym-link system" href="../../axioms.html#def-hide" data-sym="HIDE">hide</a> 'xxx) term))
        (current-clause (add-literal new-lit (<a class="sym-link system" href="../../basis-b.html#def-dumb-negate-lit-lst" data-sym="DUMB-NEGATE-LIT-LST">dumb-negate-lit-lst</a> hyps) <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>)))
      (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((pair (find-applicable-hint-settings *initial-clause-id*
             current-clause
             nil
             saved-pspv
             ctx
             thints
             wrld
             nil
             state)))
        (let ((hint-settings (car pair)) (thints (cdr pair)))
          (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (hint-settings state)
            (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> hint-settings) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil state))
              (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (thanks-for-the-hint nil hint-settings nil state)))
            (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((pspv (load-hint-settings-into-pspv <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>
                   hint-settings
                   saved-pspv
                   nil
                   wrld
                   ctx
                   state)))
              (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-intersectp-eq" data-sym="INTERSECTP-EQ">intersectp-eq</a> '(<span class="keyword">:do-not-induct</span> <span class="keyword">:do-not</span> <span class="keyword">:induct</span> <span class="keyword">:use</span> <span class="keyword">:cases</span> <span class="keyword">:by</span>)
                   (<a class="sym-link system" href="../../axioms.html#def-strip-cars" data-sym="STRIP-CARS">strip-cars</a> hint-settings)) (<a class="sym-link system" href="../../axioms.html#def-er" data-sym="ER">er</a> soft
                    ctx
                    <span class="string">"It makes no sense for SIMPLIFY-TERM to be given hints for ~
                  &quot;Goal&quot; that include any of :do-not-induct, :do-not, ~
                  :induct, :use, :cases, or :by.  The hint ~p0 is therefore ~
                  illegal."</span>
                    (cons <span class="string">"Goal"</span> hint-settings)))
                (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link system" href="../../history-management.html#def-initialize-proof-tree" data-sym="INITIALIZE-PROOF-TREE">initialize-proof-tree</a> *initial-clause-id*
                      (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (implicate (<a class="sym-link system" href="../../axioms.html#def-conjoin" data-sym="CONJOIN">conjoin</a> hyps) term)))
                      ctx
                      state)
                    (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((rcnst (<a class="sym-link system" href="../../basis-a.html#def-change" data-sym="CHANGE">change</a> rewrite-constant
                           (<a class="sym-link system" href="../../axioms.html#def-access" data-sym="ACCESS">access</a> prove-spec-var pspv <span class="keyword">:rewrite-constant</span>)
                           <span class="keyword">:force-info</span> (if (ffnnamep-lst 'if current-clause)
                             'weak
                             <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>))) (pts nil))
                      (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (contradictionp type-alist fc-pair-lst)
                        (forward-chain current-clause
                          pts
                          (<a class="sym-link system" href="../../axioms.html#def-access" data-sym="ACCESS">access</a> rewrite-constant rcnst <span class="keyword">:force-info</span>)
                          nil
                          wrld
                          ens
                          (<a class="sym-link system" href="../../axioms.html#def-access" data-sym="ACCESS">access</a> rewrite-constant rcnst <span class="keyword">:oncep-override</span>)
                          state)
                        (declare (ignore fc-pair-lst))
                        (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (contradictionp (<a class="sym-link system" href="../../axioms.html#def-er" data-sym="ER">er</a> soft
                              ctx
                              <span class="string">"Contradiction found in hypotheses using type-set ~
                          reasoning!"</span>))
                          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../rewrite.html#def-sl-let" data-sym="SL-LET">sl-let</a> (contradictionp simplify-clause-pot-lst)
                              (setup-simplify-clause-pot-lst current-clause
                                (pts-to-ttree-lst pts)
                                nil
                                type-alist
                                rcnst
                                wrld
                                state
                                (<a class="sym-link system" href="../../rewrite.html#def-initial-step-limit" data-sym="INITIAL-STEP-LIMIT">initial-step-limit</a> wrld state))
                              (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (contradictionp (<a class="sym-link system" href="../../axioms.html#def-er" data-sym="ER">er</a> soft
                                    ctx
                                    <span class="string">"Contradiction found in hypotheses using linear ~
                             reasoning!"</span>))
                                (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (let ((local-rcnst (<a class="sym-link system" href="../../basis-a.html#def-change" data-sym="CHANGE">change</a> rewrite-constant
                                         rcnst
                                         <span class="keyword">:current-literal</span> (<a class="sym-link system" href="../../basis-a.html#def-make" data-sym="MAKE">make</a> current-literal <span class="keyword">:not-flg</span> nil <span class="keyword">:atm</span> term))) (gstack (<a class="sym-link system" href="../../rewrite.html#def-initial-gstack" data-sym="INITIAL-GSTACK">initial-gstack</a> 'simplify-clause nil current-clause)))
                                    (<a class="sym-link system" href="../../rewrite.html#def-sl-let" data-sym="SL-LET">sl-let</a> (rewritten-term ttree)
                                      (<a class="sym-link system" href="../../rewrite.html#def-rewrite-entry" data-sym="REWRITE-ENTRY">rewrite-entry</a> (<a class="sym-link system" href="../../rewrite.html#def-rewrite" data-sym="REWRITE">rewrite</a> term nil <span class="number">1</span>)
                                        <span class="keyword">:rdepth</span> (<a class="sym-link system" href="../../axioms.html#def-rewrite-stack-limit" data-sym="REWRITE-STACK-LIMIT">rewrite-stack-limit</a> wrld)
                                        <span class="keyword">:obj</span> '?
                                        <span class="keyword">:fnstack</span> nil
                                        <span class="keyword">:ancestors</span> nil
                                        <span class="keyword">:step-limit</span> step-limit
                                        <span class="keyword">:pre-dwp</span> nil
                                        <span class="keyword">:backchain-limit</span> <span class="number">500</span>
                                        <span class="keyword">:geneqv</span> (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> (car (<a class="sym-link system" href="../../axioms.html#def-last" data-sym="LAST">last</a> (<a class="sym-link system" href="../../axioms.html#def-getprop" data-sym="GETPROP">getprop</a> equiv 'congruences nil 'current-acl2-world wrld))))
                                        <span class="keyword">:pequiv-info</span> nil)
                                      (<a class="sym-link system" href="../../rewrite.html#def-sl-let" data-sym="SL-LET">sl-let</a> (bad-ass ttree)
                                        (resume-suspended-assumption-rewriting ttree
                                          nil
                                          gstack
                                          simplify-clause-pot-lst
                                          local-rcnst
                                          wrld
                                          state
                                          step-limit)
                                        (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (bad-ass (<a class="sym-link system" href="../../axioms.html#def-er" data-sym="ER">er</a> soft
                                              ctx
                                              <span class="string">"Generated false assumption, ~p0!  So, ~
                                   rewriting is aborted, just as it would be ~
                                   in the course of a regular ACL2 proof."</span>
                                              bad-ass))
                                          (prove-assumptions (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (pairs pspv state)
                                              (<a class="sym-link system" href="../../prove.html#def-process-assumptions" data-sym="PROCESS-ASSUMPTIONS">process-assumptions</a> <span class="number">0</span>
                                                (<a class="sym-link system" href="../../basis-a.html#def-change" data-sym="CHANGE">change</a> prove-spec-var
                                                  saved-pspv
                                                  <span class="keyword">:tag-tree</span> (<a class="sym-link system" href="../../prove.html#def-set-cl-ids-of-assumptions" data-sym="SET-CL-IDS-OF-ASSUMPTIONS">set-cl-ids-of-assumptions</a> ttree *initial-clause-id*))
                                                wrld
                                                state)
                                              (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((ttree (accumulate-ttree-and-step-limit-into-state (<a class="sym-link system" href="../../axioms.html#def-access" data-sym="ACCESS">access</a> prove-spec-var pspv <span class="keyword">:tag-tree</span>)
                                                     step-limit
                                                     state)) (thints (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> thints)))
                                                (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((new-ttree (<a class="sym-link system" href="../../prove.html#def-prove-loop1" data-sym="PROVE-LOOP1">prove-loop1</a> <span class="number">1</span> nil pairs pspv thints ens wrld ctx state)))
                                                  (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (cons rewritten-term (cons-tag-trees ttree new-ttree)))))))
                                          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (cons rewritten-term ttree))))))))))))))))))))))))</pre>
  </div>

<div class="form-block function" id="def-simplify-term_2A" data-defines="SIMPLIFY-TERM*" data-references="CDR,1-,CAR,EQUAL,SIMPLIFY-TERM1,TERM-TTREE,ER-LET*,T,LIST*,VALUE,ZP,IF,STATE,WRLD,CTX,PROVE-ASSUMPTIONS,THINTS,EQUIV,HYPS,TERM,TTREE,REMAINING-ITERS,DEFUN" data-used-by="SIMPLIFY-TERM" data-part-name="SIMPLIFY-TERM*" data-part-args="STATE,WRLD,CTX,PROVE-ASSUMPTIONS,THINTS,EQUIV,HYPS,TERM,TTREE,REMAINING-ITERS" data-part-body="CDR,1-,SIMPLIFY-TERM*,CAR,EQUAL,STATE,WRLD,CTX,PROVE-ASSUMPTIONS,THINTS,EQUIV,HYPS,SIMPLIFY-TERM1,TERM-TTREE,ER-LET*,TTREE,T,TERM,LIST*,VALUE,REMAINING-ITERS,ZP,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="SIMPLIFY-TERM*">simplify-term*</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-simplify-term_2A" data-sym="SIMPLIFY-TERM*" title="(defun simplify-term*
       (remaining-iters ttree term hyps equiv thints prove-assumptions ctx wrld
        state)
  (if (zp remaining-iters)
      (value (list* term t ttree))
...">simplify-term*</a>
  (remaining-iters ttree
    term
    hyps
    equiv
    thints
    prove-assumptions
    ctx
    wrld
    state)
  (if (<a class="sym-link system" href="../../axioms.html#def-zp" data-sym="ZP">zp</a> remaining-iters)
    (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> term <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> ttree))
    (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((term-ttree (<a class="sym-link local-def" href="#def-simplify-term1" data-sym="SIMPLIFY-TERM1" title="(defun simplify-term1
       (ttree term hyps equiv thints prove-assumptions ctx wrld state)
  (prog2$ (semi-initialize-brr-wormhole state)
          (let* ((ens (ens state))
                 (saved-pspv
...">simplify-term1</a> ttree
           term
           hyps
           equiv
           thints
           prove-assumptions
           ctx
           wrld
           state)))
      (if (equal term (car term-ttree))
        (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> term nil ttree))
        (<a class="sym-link local-def" href="#def-simplify-term_2A" data-sym="SIMPLIFY-TERM*" title="(defun simplify-term*
       (remaining-iters ttree term hyps equiv thints prove-assumptions ctx wrld
        state)
  (if (zp remaining-iters)
      (value (list* term t ttree))
...">simplify-term*</a> (<a class="sym-link system" href="../../axioms.html#def-1-" data-sym="1-">1-</a> remaining-iters)
          (cdr term-ttree)
          (car term-ttree)
          hyps
          equiv
          thints
          prove-assumptions
          ctx
          wrld
          state)))))</pre>
  </div>

<div class="form-block function" id="def-simplify-term" data-defines="SIMPLIFY-TERM" data-references="SIMPLIFY-TERM*,TRANSLATE,TERM,VALUE,T,TRANSLATE-TERM-LST,THYPS,TRANSLATE-HINTS,THINTS,ER-LET*,NAME-TREE,LET,@,PROVE,PROOF-TREE,QUOTE,UNION-EQ,IF,INHIBIT-OUTPUT-LST,STATE-GLOBAL-LET*,STATE,WRLD,CTX,PROVE-ASSUMPTIONS,HINTS,EQUIV,HYPS,FORM,INHIBIT-OUTPUT,TRANSLATE-FLG,REPEAT-LIMIT,DEFUN" data-used-by="SIMPLIFY-DEFUN" data-part-name="SIMPLIFY-TERM" data-part-args="STATE,WRLD,CTX,PROVE-ASSUMPTIONS,HINTS,EQUIV,HYPS,FORM,INHIBIT-OUTPUT,TRANSLATE-FLG,REPEAT-LIMIT" data-part-body="PROVE-ASSUMPTIONS,EQUIV,REPEAT-LIMIT,SIMPLIFY-TERM*,FORM,TRANSLATE,TERM,VALUE,T,HYPS,TRANSLATE-TERM-LST,TRANSLATE-FLG,THYPS,STATE,WRLD,CTX,HINTS,TRANSLATE-HINTS,THINTS,ER-LET*,SIMPLIFY-TERM,NAME-TREE,LET,@,PROVE,PROOF-TREE,QUOTE,UNION-EQ,INHIBIT-OUTPUT,IF,INHIBIT-OUTPUT-LST,STATE-GLOBAL-LET*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="SIMPLIFY-TERM">simplify-term</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-simplify-term" data-sym="SIMPLIFY-TERM" title="(defun simplify-term
       (repeat-limit translate-flg inhibit-output form hyps equiv hints
        prove-assumptions ctx wrld state)
  (state-global-let*
   ((inhibit-output-lst
...">simplify-term</a>
  (repeat-limit translate-flg
    inhibit-output
    form
    hyps
    equiv
    hints
    prove-assumptions
    ctx
    wrld
    state)
  (<a class="sym-link system" href="../../axioms.html#def-state-global-let_2A" data-sym="STATE-GLOBAL-LET*">state-global-let*</a> ((inhibit-output-lst (if inhibit-output
         (<a class="sym-link system" href="../../axioms.html#def-union-eq" data-sym="UNION-EQ">union-eq</a> '(proof-tree <a class="sym-link system" href="../../prove.html#def-prove" data-sym="PROVE">prove</a>) (<a class="sym-link system" href="../../axioms.html#def-_40" data-sym="@">@</a> inhibit-output-lst))
         (<a class="sym-link system" href="../../axioms.html#def-_40" data-sym="@">@</a> inhibit-output-lst))))
    (let ((name-tree '<a class="sym-link local-def" href="#def-simplify-term" data-sym="SIMPLIFY-TERM" title="(defun simplify-term
       (repeat-limit translate-flg inhibit-output form hyps equiv hints
        prove-assumptions ctx wrld state)
  (state-global-let*
   ((inhibit-output-lst
...">simplify-term</a>))
      (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((thints (translate-hints name-tree hints ctx wrld state)) (thyps (if translate-flg
              (translate-term-lst hyps <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> ctx wrld state)
              (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> hyps)))
          (term (if translate-flg
              (translate form <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> ctx wrld state)
              (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> form))))
        (<a class="sym-link local-def" href="#def-simplify-term_2A" data-sym="SIMPLIFY-TERM*" title="(defun simplify-term*
       (remaining-iters ttree term hyps equiv thints prove-assumptions ctx wrld
        state)
  (if (zp remaining-iters)
      (value (list* term t ttree))
...">simplify-term*</a> repeat-limit
          nil
          term
          hyps
          equiv
          thints
          prove-assumptions
          ctx
          wrld
          state)))))</pre>
  </div>

<div class="form-block function" id="def-strip-leading-percent-from-symbol" data-defines="STRIP-LEADING-PERCENT-FROM-SYMBOL" data-references="SUBSEQ,INTERN-IN-PACKAGE-OF-SYMBOL,CHAR,EQ,INT=,NOT,AND,IF,LENGTH,LEN,SYMBOL-NAME,NAME,LET*,SYM,DEFUN" data-used-by="STRIP-PERCENTS-FROM-LEMMA,MY-TRANSLATE-RULE-CLASS-ALIST,F-IS-%F-LIST,SIMPLIFY-DEFUN,STRIP-PERCENTS,STRIP-LEADING-PERCENT-FROM-SYMBOL-LIST" data-part-name="STRIP-LEADING-PERCENT-FROM-SYMBOL" data-part-args="SYM" data-part-body="SUBSEQ,INTERN-IN-PACKAGE-OF-SYMBOL,CHAR,EQ,INT=,NOT,AND,IF,LENGTH,LEN,SYM,SYMBOL-NAME,NAME,LET*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="STRIP-LEADING-PERCENT-FROM-SYMBOL">strip-leading-percent-from-symbol</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-strip-leading-percent-from-symbol" data-sym="STRIP-LEADING-PERCENT-FROM-SYMBOL" title="(defun strip-leading-percent-from-symbol (sym)
  (let* ((name (symbol-name sym)) (len (length name)))
    (if (and (not (int= len 0)) (eq (char name 0) #\%))
        (intern-in-package-of-symbol (subseq name 1 len) sym)
        sym)))">strip-leading-percent-from-symbol</a>
  (sym)
  (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((name (symbol-name sym)) (<a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> name)))
    (if (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../axioms.html#def-int_3D" data-sym="INT=">int=</a> <a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> <span class="number">0</span>)) (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (<a class="sym-link system" href="../../axioms.html#def-char" data-sym="CHAR">char</a> name <span class="number">0</span>) #\%))
      (intern-in-package-of-symbol (<a class="sym-link system" href="../../axioms.html#def-subseq" data-sym="SUBSEQ">subseq</a> name <span class="number">1</span> <a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a>) sym)
      sym)))</pre>
  </div>

<div class="form-block function" id="def-strip-leading-percent-from-symbol-list" data-defines="STRIP-LEADING-PERCENT-FROM-SYMBOL-LIST" data-references="CAR,STRIP-LEADING-PERCENT-FROM-SYMBOL,CONS,CDR,ENDP,IF,ACC,SYM-LIST,DEFUN" data-used-by="MY-TRANSLATE-RULE-CLASS-ALIST" data-part-name="STRIP-LEADING-PERCENT-FROM-SYMBOL-LIST" data-part-args="ACC,SYM-LIST" data-part-body="CAR,STRIP-LEADING-PERCENT-FROM-SYMBOL,CONS,CDR,STRIP-LEADING-PERCENT-FROM-SYMBOL-LIST,ACC,SYM-LIST,ENDP,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="STRIP-LEADING-PERCENT-FROM-SYMBOL-LIST">strip-leading-percent-from-symbol-list</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-strip-leading-percent-from-symbol-list" data-sym="STRIP-LEADING-PERCENT-FROM-SYMBOL-LIST" title="(defun strip-leading-percent-from-symbol-list (sym-list acc)
  (if (endp sym-list)
      acc
      (strip-leading-percent-from-symbol-list (cdr sym-list)
       (cons (strip-leading-percent-from-symbol (car sym-list)) acc))))">strip-leading-percent-from-symbol-list</a>
  (sym-list acc)
  (if (<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> sym-list)
    acc
    (<a class="sym-link local-def" href="#def-strip-leading-percent-from-symbol-list" data-sym="STRIP-LEADING-PERCENT-FROM-SYMBOL-LIST" title="(defun strip-leading-percent-from-symbol-list (sym-list acc)
  (if (endp sym-list)
      acc
      (strip-leading-percent-from-symbol-list (cdr sym-list)
       (cons (strip-leading-percent-from-symbol (car sym-list)) acc))))">strip-leading-percent-from-symbol-list</a> (cdr sym-list)
      (cons (<a class="sym-link local-def" href="#def-strip-leading-percent-from-symbol" data-sym="STRIP-LEADING-PERCENT-FROM-SYMBOL" title="(defun strip-leading-percent-from-symbol (sym)
  (let* ((name (symbol-name sym)) (len (length name)))
    (if (and (not (int= len 0)) (eq (char name 0) #\%))
        (intern-in-package-of-symbol (subseq name 1 len) sym)
        sym)))">strip-leading-percent-from-symbol</a> (car sym-list))
        acc))))</pre>
  </div>

<div class="form-block mutual-recursion" id="def-strip-percents" data-defines="STRIP-PERCENTS" data-references="CAR,CONS,CDR,REVERSE,ENDP,ACC,X,STRIP-LEADING-PERCENT-FROM-SYMBOL,T,STRIP-PERCENTS-LST,MAKE-LAMBDA,FCONS-TERM,FARGS,ARGS,LAMBDA-BODY,BODY,LAMBDA-FORMALS,VARS,LET,FFN-SYMB,FLAMBDAP,FQUOTEP,VARIABLEP,COND,TERM,DEFUN,MUTUAL-RECURSION" data-used-by="MY-TRANSLATE-RULE-CLASS1,MY-TRANSLATE-RULE-CLASS-ALIST,SIMPLIFY-DEFUN" typeof="Code">
    <div class="form-header"><span class="form-name" property="name" data-sym="STRIP-PERCENTS">strip-percents</span><span class="form-type">mutual-recursion</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-mutual-recursion" data-sym="MUTUAL-RECURSION">mutual-recursion</a> (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-strip-percents" data-sym="STRIP-PERCENTS" title="(mutual-recursion
 (defun strip-percents (term)
   (cond ((variablep term) term) ((fquotep term) term)
         ((flambdap (ffn-symb term))
          (let ((vars (lambda-formals (ffn-symb term)))
...">strip-percents</a>
    (term)
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-variablep" data-sym="VARIABLEP">variablep</a> term) term)
      ((<a class="sym-link system" href="../../axioms.html#def-fquotep" data-sym="FQUOTEP">fquotep</a> term) term)
      ((<a class="sym-link system" href="../../basis-b.html#def-flambdap" data-sym="FLAMBDAP">flambdap</a> (<a class="sym-link system" href="../../axioms.html#def-ffn-symb" data-sym="FFN-SYMB">ffn-symb</a> term)) (let ((vars (<a class="sym-link system" href="../../basis-b.html#def-lambda-formals" data-sym="LAMBDA-FORMALS">lambda-formals</a> (<a class="sym-link system" href="../../axioms.html#def-ffn-symb" data-sym="FFN-SYMB">ffn-symb</a> term))) (<a class="sym-link system" href="../../basis-b.html#def-body" data-sym="BODY">body</a> (<a class="sym-link system" href="../../basis-b.html#def-lambda-body" data-sym="LAMBDA-BODY">lambda-body</a> (<a class="sym-link system" href="../../axioms.html#def-ffn-symb" data-sym="FFN-SYMB">ffn-symb</a> term)))
            (<a class="sym-link system" href="../../defuns.html#def-args" data-sym="ARGS">args</a> (<a class="sym-link system" href="../../axioms.html#def-fargs" data-sym="FARGS">fargs</a> term)))
          (<a class="sym-link system" href="../../basis-b.html#def-fcons-term" data-sym="FCONS-TERM">fcons-term</a> (<a class="sym-link system" href="../../basis-b.html#def-make-lambda" data-sym="MAKE-LAMBDA">make-lambda</a> vars (<a class="sym-link local-def" href="#def-strip-percents" data-sym="STRIP-PERCENTS" title="(mutual-recursion
 (defun strip-percents (term)
   (cond ((variablep term) term) ((fquotep term) term)
         ((flambdap (ffn-symb term))
          (let ((vars (lambda-formals (ffn-symb term)))
...">strip-percents</a> <a class="sym-link system" href="../../basis-b.html#def-body" data-sym="BODY">body</a>))
            (strip-percents-lst <a class="sym-link system" href="../../defuns.html#def-args" data-sym="ARGS">args</a> nil))))
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../basis-b.html#def-fcons-term" data-sym="FCONS-TERM">fcons-term</a> (<a class="sym-link local-def" href="#def-strip-leading-percent-from-symbol" data-sym="STRIP-LEADING-PERCENT-FROM-SYMBOL" title="(defun strip-leading-percent-from-symbol (sym)
  (let* ((name (symbol-name sym)) (len (length name)))
    (if (and (not (int= len 0)) (eq (char name 0) #\%))
        (intern-in-package-of-symbol (subseq name 1 len) sym)
        sym)))">strip-leading-percent-from-symbol</a> (<a class="sym-link system" href="../../axioms.html#def-ffn-symb" data-sym="FFN-SYMB">ffn-symb</a> term))
          (strip-percents-lst (<a class="sym-link system" href="../../axioms.html#def-fargs" data-sym="FARGS">fargs</a> term) nil)))))
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> strip-percents-lst
    (x acc)
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> x) (<a class="sym-link system" href="../../axioms.html#def-reverse" data-sym="REVERSE">reverse</a> acc))
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (strip-percents-lst (cdr x)
          (cons (<a class="sym-link local-def" href="#def-strip-percents" data-sym="STRIP-PERCENTS" title="(mutual-recursion
 (defun strip-percents (term)
   (cond ((variablep term) term) ((fquotep term) term)
         ((flambdap (ffn-symb term))
          (let ((vars (lambda-formals (ffn-symb term)))
...">strip-percents</a> (car x)) acc))))))</pre>
  </div>

<div class="form-block function" id="def-percentify" data-defines="PERCENTIFY" data-references="STRING,QUOTE,CONCATENATE,NAME,DEFUN" data-used-by="%F-IS-F-LEMMAS-REV" data-part-name="PERCENTIFY" data-part-args="NAME" data-part-body="NAME,STRING,QUOTE,CONCATENATE" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="PERCENTIFY">percentify</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-percentify" data-sym="PERCENTIFY" title="(defun percentify (name) (concatenate &#39;string &quot;%&quot; name))">percentify</a> (name) (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> <span class="string">"%"</span> name))</pre>
  </div>

<div class="form-block constant" id="def-_2A_25_25p_2A" data-defines="*%%P*" data-references="DEFCONST" data-used-by="MUTUAL-RECURSION-LEMMAS" typeof="Code">
    <div class="form-header"><span class="form-name" property="name" data-sym="*%%P*">*%%p*</span><span class="form-type">constant</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> <a class="sym-link local-def" href="#def-_2A_25_25p_2A" data-sym="*%%P*" title="(defconst *%%p* &quot;%%P&quot;)">*%%p*</a> <span class="string">"%%P"</span>)</pre>
  </div>

<div class="form-block function" id="def-sublis-fn_21" data-defines="SUBLIS-FN!" data-references="NULL,ASSERT$,SUBLIS-FN,NEW-TERM,ERP,MV-LET,TERM,ALIST,DEFUN" data-part-name="SUBLIS-FN!" data-part-args="TERM,ALIST" data-part-body="NULL,ASSERT$,TERM,ALIST,SUBLIS-FN,NEW-TERM,ERP,MV-LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="SUBLIS-FN!">sublis-fn!</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-sublis-fn_21" data-sym="SUBLIS-FN!" title="(defun sublis-fn! (alist term)
  (mv-let (erp new-term) (sublis-fn alist term nil)
          (assert$ (null erp) new-term)))">sublis-fn!</a>
  (alist term)
  (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (erp new-term)
    (<a class="sym-link system" href="../../history-management.html#def-sublis-fn" data-sym="SUBLIS-FN">sublis-fn</a> alist term nil)
    (<a class="sym-link system" href="../../axioms.html#def-assert_24" data-sym="ASSERT$">assert$</a> (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> erp) new-term)))</pre>
  </div>

<div class="form-block function" id="def-_25f-is-f-lemmas-rev" data-defines="%F-IS-F-LEMMAS-REV" data-references="DEFTHM,THEORY,UNION-THEORIES,DEFTHEORY,LOCAL,QUASIQUOTE,EQUAL,NOT,AND,EQUAL-BODIES,F-FORMALS,%F-FORMALS,CONS,%%F-FORMALS,CAR,FORMALS,CURRENT-ACL2-WORLD,RECURSIVEP,GETPROP,RECP,1+,EXPLODE-ATOM,COERCE,INTERN,NEW-THEORY,F-IS-%F,%%F-IS-F,STRING,QUOTE,CONCATENATE,F-BODY-IS-%F-BODY_S,INTERN-IN-PACKAGE-OF-SYMBOL,%%F,PERCENTIFY,%%F-NAME,F-NAME,SYMBOL-NAME,%F-NAME,LET*,WRLD,OLD-THEORY,COUNTER,TRANSLATED-NEW-BODY,UNTRANSLATED-NEW-BODY,ORIG-BODY,FORMALS-DECLS,F,%F,DEFUN" data-used-by="SIMPLIFY-DEFUN" data-part-name="%F-IS-F-LEMMAS-REV" data-part-args="WRLD,OLD-THEORY,COUNTER,TRANSLATED-NEW-BODY,UNTRANSLATED-NEW-BODY,ORIG-BODY,FORMALS-DECLS,F,%F" data-part-body="DEFTHM,THEORY,UNION-THEORIES,DEFTHEORY,LOCAL,QUASIQUOTE,ORIG-BODY,UNTRANSLATED-NEW-BODY,EQUAL,NOT,AND,EQUAL-BODIES,F-FORMALS,%F-FORMALS,CONS,%%F-FORMALS,FORMALS-DECLS,CAR,FORMALS,WRLD,CURRENT-ACL2-WORLD,RECURSIVEP,GETPROP,RECP,COUNTER,1+,EXPLODE-ATOM,COERCE,INTERN,NEW-THEORY,F-IS-%F,%%F-IS-F,STRING,QUOTE,CONCATENATE,F-BODY-IS-%F-BODY_S,INTERN-IN-PACKAGE-OF-SYMBOL,%%F,PERCENTIFY,%%F-NAME,F,F-NAME,%F,SYMBOL-NAME,%F-NAME,LET*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="%F-IS-F-LEMMAS-REV">%f-is-f-lemmas-rev</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-_25f-is-f-lemmas-rev" data-sym="%F-IS-F-LEMMAS-REV" title="(defun %f-is-f-lemmas-rev
       (%f f formals-decls orig-body untranslated-new-body translated-new-body
        counter old-theory wrld)
  (let* ((%f-name (symbol-name %f))
         (f-name (symbol-name f))
...">%f-is-f-lemmas-rev</a>
  (%f f
    formals-decls
    orig-body
    untranslated-new-body
    translated-new-body
    counter
    old-theory
    wrld)
  (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((%f-name (symbol-name %f)) (f-name (symbol-name f))
      (%%f-name (<a class="sym-link local-def" href="#def-percentify" data-sym="PERCENTIFY" title="(defun percentify (name) (concatenate &#39;string &quot;%&quot; name))">percentify</a> %f-name))
      (%%f (intern-in-package-of-symbol %%f-name %f))
      (f-body-is-%f-body_s (intern-in-package-of-symbol (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> f-name <span class="string">"-BODY-IS-"</span> %f-name <span class="string">"-BODY_S"</span>)
          %f))
      (%%f-is-f (intern-in-package-of-symbol (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> %%f-name <span class="string">"-IS-"</span> f-name)
          %f))
      (f-is-%f (intern-in-package-of-symbol (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> f-name <span class="string">"-IS-"</span> %f-name)
          %f))
      (new-theory (<a class="sym-link system" href="../../axioms.html#def-intern" data-sym="INTERN">intern</a> (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a>
            <span class="string">"THEORY-"</span>
            (coerce (<a class="sym-link system" href="../../axioms.html#def-explode-atom" data-sym="EXPLODE-ATOM">explode-atom</a> (<a class="sym-link system" href="../../axioms.html#def-1_2B" data-sym="1+">1+</a> counter) <span class="number">10</span>) '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a>))
          <span class="string">"ACL2"</span>))
      (recp (<a class="sym-link system" href="../../axioms.html#def-getprop" data-sym="GETPROP">getprop</a> %f 'recursivep nil 'current-acl2-world wrld))
      (<a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> (car formals-decls))
      (%%f-formals (cons %%f <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>))
      (%f-formals (cons %f <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>))
      (f-formals (cons f <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>))
      (equal-bodies (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> recp) (equal untranslated-new-body orig-body))))
    `((<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-deftheory" data-sym="DEFTHEORY">deftheory</a> ,NEW-THEORY
         (union-theories '(,F-IS-%F) (theory ',OLD-THEORY)))) (<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,F-IS-%F
        (equal ,F-FORMALS ,%F-FORMALS)
        <span class="keyword">:hints</span> (,(IF RECP
     `(&quot;Goal&quot; :BY (:FUNCTIONAL-INSTANCE ,%%F-IS-F (,%%F ,%F)) :DO-NOT
       &#39;(PREPROCESS) :EXPAND (,%F-FORMALS))
     `(&quot;Goal&quot; :EXPAND
       ((:FREE ,FORMALS ,%F-FORMALS) (:FREE ,FORMALS ,F-FORMALS)) :IN-THEORY
       (THEORY &#39;,OLD-THEORY) :DO-NOT &#39;(PREPROCESS)
       ,@(AND (NOT EQUAL-BODIES) `(:USE ,F-BODY-IS-%F-BODY_S))))))
      ,@(COND
   (RECP
    `((LOCAL
       (DEFTHM ,%%F-IS-F (EQUAL ,%%F-FORMALS ,F-FORMALS) :HINTS
               ((&quot;Goal&quot; :IN-THEORY
                 (UNION-THEORIES &#39;((:INDUCTION ,%%F)) (THEORY &#39;,OLD-THEORY))
                 :DO-NOT &#39;(PREPROCESS) :EXPAND (,%%F-FORMALS ,F-FORMALS)
                 :INDUCT T))))
      (LOCAL
       (DEFUN ,%%F ,FORMALS
         ,@(CDR FORMALS-DECLS)
         ,(UNTRANSLATE (SUBLIS-FN! (LIST (CONS %F %%F)) TRANSLATED-NEW-BODY)
                       NIL WRLD)))))
   (EQUAL-BODIES NIL)
   (T
    `((LOCAL
       (DEFTHM ,F-BODY-IS-%F-BODY_S (EQUAL ,UNTRANSLATED-NEW-BODY ,ORIG-BODY)
               :HINTS ((&quot;Goal&quot; :DO-NOT &#39;(PREPROCESS))) :RULE-CLASSES NIL))))))))</pre>
  </div>

<div class="form-block function" id="def-get-state-value" data-defines="GET-STATE-VALUE" data-references="F-GET-GLOBAL,F-BOUNDP-GLOBAL,IF,STATE,SYM,DEFUN" data-used-by="SIMPLIFY-INHIBIT,SIMPLIFY-REPEAT-LIMIT" data-part-name="GET-STATE-VALUE" data-part-args="STATE,SYM" data-part-body="F-GET-GLOBAL,STATE,SYM,F-BOUNDP-GLOBAL,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="GET-STATE-VALUE">get-state-value</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-get-state-value" data-sym="GET-STATE-VALUE" title="(defun get-state-value (sym state)
  (if (f-boundp-global sym state)
      (f-get-global sym state)
      nil))">get-state-value</a>
  (sym state)
  (if (<a class="sym-link system" href="../../axioms.html#def-f-boundp-global" data-sym="F-BOUNDP-GLOBAL">f-boundp-global</a> sym state)
    (<a class="sym-link system" href="../../axioms.html#def-f-get-global" data-sym="F-GET-GLOBAL">f-get-global</a> sym state)
    nil))</pre>
  </div>

<div class="form-block function" id="def-simplify-repeat-limit" data-defines="SIMPLIFY-REPEAT-LIMIT" data-references="QUOTE,GET-STATE-VALUE,OR,STATE,DEFUN" data-used-by="SIMPLIFY-DEFUN" data-part-name="SIMPLIFY-REPEAT-LIMIT" data-part-args="STATE" data-part-body="STATE,SIMPLIFY-REPEAT-LIMIT,QUOTE,GET-STATE-VALUE,OR" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="SIMPLIFY-REPEAT-LIMIT">simplify-repeat-limit</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-simplify-repeat-limit" data-sym="SIMPLIFY-REPEAT-LIMIT" title="(defun simplify-repeat-limit (state)
  (or (get-state-value &#39;simplify-repeat-limit state) 3))">simplify-repeat-limit</a>
  (state)
  (<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link local-def" href="#def-get-state-value" data-sym="GET-STATE-VALUE" title="(defun get-state-value (sym state)
  (if (f-boundp-global sym state)
      (f-get-global sym state)
      nil))">get-state-value</a> '<a class="sym-link local-def" href="#def-simplify-repeat-limit" data-sym="SIMPLIFY-REPEAT-LIMIT" title="(defun simplify-repeat-limit (state)
  (or (get-state-value &#39;simplify-repeat-limit state) 3))">simplify-repeat-limit</a> state) <span class="number">3</span>))</pre>
  </div>

<div class="form-block function" id="def-simplify-inhibit" data-defines="SIMPLIFY-INHIBIT" data-references="OTHERWISE,SUMMARY,EVENT,OBSERVATION,WARNING,PROOF-TREE,PROVE,T,CASE,QUOTE,GET-STATE-VALUE,VAL,LET,STATE,DEFUN" data-used-by="SIMPLIFY-DEFUN" data-part-name="SIMPLIFY-INHIBIT" data-part-args="STATE" data-part-body="OTHERWISE,SUMMARY,EVENT,OBSERVATION,WARNING,PROOF-TREE,PROVE,T,CASE,STATE,SIMPLIFY-INHIBIT,QUOTE,GET-STATE-VALUE,VAL,LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="SIMPLIFY-INHIBIT">simplify-inhibit</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-simplify-inhibit" data-sym="SIMPLIFY-INHIBIT" title="(defun simplify-inhibit (state)
  (let ((val (get-state-value &#39;simplify-inhibit state)))
    (case val
      ((t) nil)
      ((nil) &#39;(prove proof-tree warning observation event summary))">simplify-inhibit</a>
  (state)
  (let ((val (<a class="sym-link local-def" href="#def-get-state-value" data-sym="GET-STATE-VALUE" title="(defun get-state-value (sym state)
  (if (f-boundp-global sym state)
      (f-get-global sym state)
      nil))">get-state-value</a> '<a class="sym-link local-def" href="#def-simplify-inhibit" data-sym="SIMPLIFY-INHIBIT" title="(defun simplify-inhibit (state)
  (let ((val (get-state-value &#39;simplify-inhibit state)))
    (case val
      ((t) nil)
      ((nil) &#39;(prove proof-tree warning observation event summary))">simplify-inhibit</a> state)))
    (<a class="sym-link system" href="../../axioms.html#def-case" data-sym="CASE">case</a> val
      ((<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>) nil)
      ((nil) '(<a class="sym-link system" href="../../prove.html#def-prove" data-sym="PROVE">prove</a> proof-tree warning <a class="sym-link system" href="../../basis-a.html#def-observation" data-sym="OBSERVATION">observation</a> event summary))
      (otherwise val))))</pre>
  </div>

<div class="form-block function" id="def-simplify-defun" data-defines="SIMPLIFY-DEFUN" data-references="APPEND,QUASIQUOTE,1+,NEW-COUNTER,NEW-THEORY,&,DEFTHEORY,LOCAL,CASE-MATCH,NEW-THEORY-P,FIRST-NEW-LEMMA,%F-IS-F-LEMMAS-REV,MUT-REC,NEW-LEMMAS,CDDR,BUTLAST,FORMALS-DECLS,UNTRANSLATED-NEW-BODY-STRIPPED,STRIP-PERCENTS,NEW-BODY-STRIPPED,UNTRANSLATE,UNTRANSLATED-NEW-BODY,NEW-BODY,IGNORE,DECLARE,SOFT,ER,VAL,EQUAL,QUOTE,SIMPLIFY-INHIBIT,T,SIMPLIFY-REPEAT-LIMIT,SIMPLIFY-TERM,*STANDARD-CO*,CONS,LIST,FMS,PPROGN,SIMP,ERP,MV-LET,MV,EQ,IF,LAST,CAR,ORIG-BODY,STRIP-LEADING-PERCENT-FROM-SYMBOL,NEW-FN,CADR,FN,LET*,STATE,WRLD,ENS,OLD-THEORY,COUNTER,LEMMAS,DEF,INFO,DEFUN" data-used-by="SIMPLIFY-FORM,SIMPLIFY-DEFUNS" data-part-name="SIMPLIFY-DEFUN" data-part-args="STATE,WRLD,ENS,OLD-THEORY,COUNTER,LEMMAS,DEF,INFO" data-part-body="APPEND,QUASIQUOTE,1+,NEW-COUNTER,NEW-THEORY,&,DEFTHEORY,LOCAL,CASE-MATCH,NEW-THEORY-P,FIRST-NEW-LEMMA,%F-IS-F-LEMMAS-REV,MUT-REC,INFO,NEW-LEMMAS,CDDR,BUTLAST,FORMALS-DECLS,UNTRANSLATED-NEW-BODY-STRIPPED,STRIP-PERCENTS,NEW-BODY-STRIPPED,UNTRANSLATE,UNTRANSLATED-NEW-BODY,NEW-BODY,IGNORE,DECLARE,SOFT,ER,VAL,WRLD,SIMPLIFY-DEFUN,EQUAL,QUOTE,SIMPLIFY-INHIBIT,T,SIMPLIFY-REPEAT-LIMIT,SIMPLIFY-TERM,*STANDARD-CO*,CONS,LIST,FMS,PPROGN,SIMP,ERP,MV-LET,STATE,OLD-THEORY,COUNTER,LEMMAS,MV,EQ,IF,LAST,CAR,ORIG-BODY,STRIP-LEADING-PERCENT-FROM-SYMBOL,NEW-FN,DEF,CADR,FN,LET*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="SIMPLIFY-DEFUN">simplify-defun</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-simplify-defun" data-sym="SIMPLIFY-DEFUN" title="(defun simplify-defun (info def lemmas counter old-theory ens wrld state)
  (let* ((fn (cadr def))
         (new-fn (strip-leading-percent-from-symbol fn))
         (orig-body (car (last def))))
    (if (eq new-fn fn)
...">simplify-defun</a>
  (info def lemmas counter old-theory ens wrld state)
  (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((fn (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> def)) (new-fn (<a class="sym-link local-def" href="#def-strip-leading-percent-from-symbol" data-sym="STRIP-LEADING-PERCENT-FROM-SYMBOL" title="(defun strip-leading-percent-from-symbol (sym)
  (let* ((name (symbol-name sym)) (len (length name)))
    (if (and (not (int= len 0)) (eq (char name 0) #\%))
        (intern-in-package-of-symbol (subseq name 1 len) sym)
        sym)))">strip-leading-percent-from-symbol</a> fn))
      (orig-body (car (<a class="sym-link system" href="../../axioms.html#def-last" data-sym="LAST">last</a> def))))
    (if (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> new-fn fn)
      (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil nil lemmas counter old-theory state)
      (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (erp simp state)
        (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link system" href="../../basis-a.html#def-fms" data-sym="FMS">fms</a> <span class="string">"~x0"</span>
            (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (cons #\0 (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> def)))
            <a class="sym-link system" href="../../axioms.html#def-_2Astandard-co_2A" data-sym="*STANDARD-CO*">*standard-co*</a>
            state
            nil)
          (<a class="sym-link local-def" href="#def-simplify-term" data-sym="SIMPLIFY-TERM" title="(defun simplify-term
       (repeat-limit translate-flg inhibit-output form hyps equiv hints
        prove-assumptions ctx wrld state)
  (state-global-let*
   ((inhibit-output-lst
...">simplify-term</a> (<a class="sym-link local-def" href="#def-simplify-repeat-limit" data-sym="SIMPLIFY-REPEAT-LIMIT" title="(defun simplify-repeat-limit (state)
  (or (get-state-value &#39;simplify-repeat-limit state) 3))">simplify-repeat-limit</a> state)
            <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>
            (<a class="sym-link local-def" href="#def-simplify-inhibit" data-sym="SIMPLIFY-INHIBIT" title="(defun simplify-inhibit (state)
  (let ((val (get-state-value &#39;simplify-inhibit state)))
    (case val
      ((t) nil)
      ((nil) &#39;(prove proof-tree warning observation event summary))">simplify-inhibit</a> state)
            orig-body
            nil
            'equal
            nil
            <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>
            '<a class="sym-link local-def" href="#def-simplify-defun" data-sym="SIMPLIFY-DEFUN" title="(defun simplify-defun (info def lemmas counter old-theory ens wrld state)
  (let* ((fn (cadr def))
         (new-fn (strip-leading-percent-from-symbol fn))
         (orig-body (car (last def))))
    (if (eq new-fn fn)
...">simplify-defun</a>
            wrld
            state))
        (if erp
          (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (erp val state)
            (<a class="sym-link system" href="../../axioms.html#def-er" data-sym="ER">er</a> soft
              '<a class="sym-link local-def" href="#def-simplify-defun" data-sym="SIMPLIFY-DEFUN" title="(defun simplify-defun (info def lemmas counter old-theory ens wrld state)
  (let* ((fn (cadr def))
         (new-fn (strip-leading-percent-from-symbol fn))
         (orig-body (car (last def))))
    (if (eq new-fn fn)
...">simplify-defun</a>
              <span class="string">"Simplification failed for the definition of ~x0."</span>
              fn)
            (declare (ignore erp val))
            (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> nil nil counter old-theory state))
          (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((new-body (car simp)) (untranslated-new-body (untranslate new-body nil wrld))
              (new-body-stripped (<a class="sym-link local-def" href="#def-strip-percents" data-sym="STRIP-PERCENTS" title="(mutual-recursion
 (defun strip-percents (term)
   (cond ((variablep term) term) ((fquotep term) term)
         ((flambdap (ffn-symb term))
          (let ((vars (lambda-formals (ffn-symb term)))
...">strip-percents</a> new-body))
              (untranslated-new-body-stripped (untranslate new-body-stripped nil wrld))
              (formals-decls (<a class="sym-link system" href="../../axioms.html#def-butlast" data-sym="BUTLAST">butlast</a> (<a class="sym-link system" href="../../axioms.html#def-cddr" data-sym="CDDR">cddr</a> def) <span class="number">1</span>))
              (new-lemmas (if (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> info 'mut-rec)
                  nil
                  (<a class="sym-link local-def" href="#def-_25f-is-f-lemmas-rev" data-sym="%F-IS-F-LEMMAS-REV" title="(defun %f-is-f-lemmas-rev
       (%f f formals-decls orig-body untranslated-new-body translated-new-body
        counter old-theory wrld)
  (let* ((%f-name (symbol-name %f))
         (f-name (symbol-name f))
...">%f-is-f-lemmas-rev</a> fn
                    new-fn
                    formals-decls
                    orig-body
                    untranslated-new-body
                    new-body
                    counter
                    old-theory
                    wrld)))
              (first-new-lemma (car new-lemmas))
              (new-theory-p (<a class="sym-link system" href="../../basis-a.html#def-case-match" data-sym="CASE-MATCH">case-match</a> first-new-lemma
                  (('<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> ('<a class="sym-link system" href="../../axioms.html#def-deftheory" data-sym="DEFTHEORY">deftheory</a> . &amp;)) <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>)
                  (&amp; nil)))
              (new-theory (if new-theory-p
                  (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> first-new-lemma))
                  old-theory))
              (new-counter (if new-theory-p
                  (<a class="sym-link system" href="../../axioms.html#def-1_2B" data-sym="1+">1+</a> counter)
                  counter)))
            (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil
              `(,(IF (ENABLED-RUNEP (LIST :DEFINITION FN) ENS WRLD)
     &#39;DEFUN
     &#39;DEFUND) ,NEW-FN
                ,@FORMALS-DECLS
                ,UNTRANSLATED-NEW-BODY-STRIPPED)
              (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> new-lemmas lemmas)
              new-counter
              new-theory
              state)))))))</pre>
  </div>

<div class="form-block function" id="def-mut-rec-formals" data-defines="MUT-REC-FORMALS" data-references="CDR,NULL,CONSP,EQUAL,FORMALS-OKP,CADDR,TRUE-LISTP,AND,NEW-FORMALS,CAR,DEF,LET*,ENDP,IF,FORMALS,DEFS,DEFUN" data-used-by="SIMPLIFY-DEFUNS" data-part-name="MUT-REC-FORMALS" data-part-args="FORMALS,DEFS" data-part-body="MUT-REC-FORMALS,CDR,NULL,CONSP,EQUAL,FORMALS-OKP,CADDR,TRUE-LISTP,AND,NEW-FORMALS,CAR,DEF,LET*,FORMALS,DEFS,ENDP,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="MUT-REC-FORMALS">mut-rec-formals</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-mut-rec-formals" data-sym="MUT-REC-FORMALS" title="(defun mut-rec-formals (defs formals)
  (if (endp defs)
      formals
      (let* ((def (car defs))
             (new-formals (and (true-listp def) (caddr def)))
...">mut-rec-formals</a>
  (defs <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)
  (if (<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> defs)
    <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>
    (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((def (car defs)) (new-formals (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> def) (<a class="sym-link system" href="../../axioms.html#def-caddr" data-sym="CADDR">caddr</a> def)))
        (formals-okp (if <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>
            (equal <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> new-formals)
            (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (consp new-formals)
              new-formals
              (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> (cdr new-formals))))))
      (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> formals-okp (<a class="sym-link local-def" href="#def-mut-rec-formals" data-sym="MUT-REC-FORMALS" title="(defun mut-rec-formals (defs formals)
  (if (endp defs)
      formals
      (let* ((def (car defs))
             (new-formals (and (true-listp def) (caddr def)))
...">mut-rec-formals</a> (cdr defs) new-formals)))))</pre>
  </div>

<div class="form-block function" id="def-f-is-_25f-list" data-defines="F-IS-%F-LIST" data-references="EQUAL,QUASIQUOTE,CONS,EQ,STRIP-LEADING-PERCENT-FROM-SYMBOL,F,CADAR,%F,LET*,CDR,ENDP,IF,ACC,FORMALS,DEFS,DEFUN" data-used-by="SIMPLIFY-DEFUNS,MUTUAL-RECURSION-LEMMAS,F-IS-%F-LEMMAS-MUT-REC,F-IS-%F-INDUCTION-STEP-LEMMAS,F-IS-%F-BASE-LEMMAS" data-part-name="F-IS-%F-LIST" data-part-args="ACC,FORMALS,DEFS" data-part-body="EQUAL,QUASIQUOTE,CONS,EQ,STRIP-LEADING-PERCENT-FROM-SYMBOL,F,CADAR,%F,LET*,FORMALS,CDR,F-IS-%F-LIST,ACC,DEFS,ENDP,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="F-IS-%F-LIST">f-is-%f-list</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-f-is-_25f-list" data-sym="F-IS-%F-LIST" title="(defun f-is-%f-list (defs formals acc)
  (if (endp defs)
      acc
      (f-is-%f-list (cdr defs) formals
       (let* ((%f (cadar defs)) (f (strip-leading-percent-from-symbol %f)))
...">f-is-%f-list</a>
  (defs <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> acc)
  (if (<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> defs)
    acc
    (<a class="sym-link local-def" href="#def-f-is-_25f-list" data-sym="F-IS-%F-LIST" title="(defun f-is-%f-list (defs formals acc)
  (if (endp defs)
      acc
      (f-is-%f-list (cdr defs) formals
       (let* ((%f (cadar defs)) (f (strip-leading-percent-from-symbol %f)))
...">f-is-%f-list</a> (cdr defs)
      <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>
      (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((%f (<a class="sym-link system" href="../../axioms.html#def-cadar" data-sym="CADAR">cadar</a> defs)) (f (<a class="sym-link local-def" href="#def-strip-leading-percent-from-symbol" data-sym="STRIP-LEADING-PERCENT-FROM-SYMBOL" title="(defun strip-leading-percent-from-symbol (sym)
  (let* ((name (symbol-name sym)) (len (length name)))
    (if (and (not (int= len 0)) (eq (char name 0) #\%))
        (intern-in-package-of-symbol (subseq name 1 len) sym)
        sym)))">strip-leading-percent-from-symbol</a> %f)))
        (if (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> %f f)
          acc
          (cons `(equal (,F ,@FORMALS) (,%F ,@FORMALS)) acc))))))</pre>
  </div>

<div class="form-block function" id="def-f-is-_25f-base-lemmas" data-defines="F-IS-%F-BASE-LEMMAS" data-references="IMPLIES,DEFTHM,LOCAL,QUASIQUOTE,SYMBOL-NAME,STRING,QUOTE,CONCATENATE,INTERN,LEMMA-NAME,CADDR,%F,CADR,F,CAR,EQUALITY,LET*,CONS,CDR,ENDP,IF,ACC,ZP-FORMALS,FORMALS,F-IS-%F-LIST,DEFUN" data-part-name="F-IS-%F-BASE-LEMMAS" data-part-args="ACC,ZP-FORMALS,FORMALS,F-IS-%F-LIST" data-part-body="IMPLIES,DEFTHM,LOCAL,QUASIQUOTE,SYMBOL-NAME,STRING,QUOTE,CONCATENATE,INTERN,LEMMA-NAME,CADDR,%F,CADR,F,CAR,EQUALITY,LET*,CONS,ZP-FORMALS,FORMALS,CDR,F-IS-%F-BASE-LEMMAS,ACC,F-IS-%F-LIST,ENDP,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="F-IS-%F-BASE-LEMMAS">f-is-%f-base-lemmas</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-f-is-_25f-base-lemmas" data-sym="F-IS-%F-BASE-LEMMAS" title="(defun f-is-%f-base-lemmas (f-is-%f-list formals zp-formals acc)
  (if (endp f-is-%f-list)
      acc
      (f-is-%f-base-lemmas (cdr f-is-%f-list) formals zp-formals
       (cons
...">f-is-%f-base-lemmas</a>
  (<a class="sym-link local-def" href="#def-f-is-_25f-list" data-sym="F-IS-%F-LIST" title="(defun f-is-%f-list (defs formals acc)
  (if (endp defs)
      acc
      (f-is-%f-list (cdr defs) formals
       (let* ((%f (cadar defs)) (f (strip-leading-percent-from-symbol %f)))
...">f-is-%f-list</a> <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> zp-formals acc)
  (if (<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> <a class="sym-link local-def" href="#def-f-is-_25f-list" data-sym="F-IS-%F-LIST" title="(defun f-is-%f-list (defs formals acc)
  (if (endp defs)
      acc
      (f-is-%f-list (cdr defs) formals
       (let* ((%f (cadar defs)) (f (strip-leading-percent-from-symbol %f)))
...">f-is-%f-list</a>)
    acc
    (<a class="sym-link local-def" href="#def-f-is-_25f-base-lemmas" data-sym="F-IS-%F-BASE-LEMMAS" title="(defun f-is-%f-base-lemmas (f-is-%f-list formals zp-formals acc)
  (if (endp f-is-%f-list)
      acc
      (f-is-%f-base-lemmas (cdr f-is-%f-list) formals zp-formals
       (cons
...">f-is-%f-base-lemmas</a> (cdr <a class="sym-link local-def" href="#def-f-is-_25f-list" data-sym="F-IS-%F-LIST" title="(defun f-is-%f-list (defs formals acc)
  (if (endp defs)
      acc
      (f-is-%f-list (cdr defs) formals
       (let* ((%f (cadar defs)) (f (strip-leading-percent-from-symbol %f)))
...">f-is-%f-list</a>)
      <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>
      zp-formals
      (cons (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((equality (car <a class="sym-link local-def" href="#def-f-is-_25f-list" data-sym="F-IS-%F-LIST" title="(defun f-is-%f-list (defs formals acc)
  (if (endp defs)
      acc
      (f-is-%f-list (cdr defs) formals
       (let* ((%f (cadar defs)) (f (strip-leading-percent-from-symbol %f)))
...">f-is-%f-list</a>)) (f (car (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> equality)))
            (%f (car (<a class="sym-link system" href="../../axioms.html#def-caddr" data-sym="CADDR">caddr</a> equality)))
            (lemma-name (<a class="sym-link system" href="../../axioms.html#def-intern" data-sym="INTERN">intern</a> (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a>
                  (symbol-name f)
                  <span class="string">"-IS-"</span>
                  (symbol-name %f)
                  <span class="string">"-BASE"</span>)
                <span class="string">"ACL2"</span>)))
          `(<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,LEMMA-NAME
              (<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> ,ZP-FORMALS ,EQUALITY)
              <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:expand</span> ((,F ,@FORMALS) (,%F ,@FORMALS)))))))
        acc))))</pre>
  </div>

<div class="form-block function" id="def-f-is-_25f-induction-step-lemmas" data-defines="F-IS-%F-INDUCTION-STEP-LEMMAS" data-references="EQUAL,IMPLIES,DEFTHM,LOCAL,QUASIQUOTE,%F-FORMALS,F-FORMALS,SYMBOL-NAME,STRING,QUOTE,CONCATENATE,INTERN,LEMMA-NAME,CADDR,%F,CADR,F,CAR,EQUALITY,LET*,CONS,CDR,ENDP,IF,ACC,HYP,FORMALS,F-IS-%F-LIST,DEFUN" data-part-name="F-IS-%F-INDUCTION-STEP-LEMMAS" data-part-args="ACC,HYP,FORMALS,F-IS-%F-LIST" data-part-body="EQUAL,IMPLIES,DEFTHM,LOCAL,QUASIQUOTE,%F-FORMALS,F-FORMALS,SYMBOL-NAME,STRING,QUOTE,CONCATENATE,INTERN,LEMMA-NAME,CADDR,%F,CADR,F,CAR,EQUALITY,LET*,CONS,HYP,FORMALS,CDR,F-IS-%F-INDUCTION-STEP-LEMMAS,ACC,F-IS-%F-LIST,ENDP,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="F-IS-%F-INDUCTION-STEP-LEMMAS">f-is-%f-induction-step-lemmas</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-f-is-_25f-induction-step-lemmas" data-sym="F-IS-%F-INDUCTION-STEP-LEMMAS" title="(defun f-is-%f-induction-step-lemmas (f-is-%f-list formals hyp acc)
  (if (endp f-is-%f-list)
      acc
      (f-is-%f-induction-step-lemmas (cdr f-is-%f-list) formals hyp
       (cons
...">f-is-%f-induction-step-lemmas</a>
  (<a class="sym-link local-def" href="#def-f-is-_25f-list" data-sym="F-IS-%F-LIST" title="(defun f-is-%f-list (defs formals acc)
  (if (endp defs)
      acc
      (f-is-%f-list (cdr defs) formals
       (let* ((%f (cadar defs)) (f (strip-leading-percent-from-symbol %f)))
...">f-is-%f-list</a> <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> hyp acc)
  (if (<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> <a class="sym-link local-def" href="#def-f-is-_25f-list" data-sym="F-IS-%F-LIST" title="(defun f-is-%f-list (defs formals acc)
  (if (endp defs)
      acc
      (f-is-%f-list (cdr defs) formals
       (let* ((%f (cadar defs)) (f (strip-leading-percent-from-symbol %f)))
...">f-is-%f-list</a>)
    acc
    (<a class="sym-link local-def" href="#def-f-is-_25f-induction-step-lemmas" data-sym="F-IS-%F-INDUCTION-STEP-LEMMAS" title="(defun f-is-%f-induction-step-lemmas (f-is-%f-list formals hyp acc)
  (if (endp f-is-%f-list)
      acc
      (f-is-%f-induction-step-lemmas (cdr f-is-%f-list) formals hyp
       (cons
...">f-is-%f-induction-step-lemmas</a> (cdr <a class="sym-link local-def" href="#def-f-is-_25f-list" data-sym="F-IS-%F-LIST" title="(defun f-is-%f-list (defs formals acc)
  (if (endp defs)
      acc
      (f-is-%f-list (cdr defs) formals
       (let* ((%f (cadar defs)) (f (strip-leading-percent-from-symbol %f)))
...">f-is-%f-list</a>)
      <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>
      hyp
      (cons (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((equality (car <a class="sym-link local-def" href="#def-f-is-_25f-list" data-sym="F-IS-%F-LIST" title="(defun f-is-%f-list (defs formals acc)
  (if (endp defs)
      acc
      (f-is-%f-list (cdr defs) formals
       (let* ((%f (cadar defs)) (f (strip-leading-percent-from-symbol %f)))
...">f-is-%f-list</a>)) (f (car (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> equality)))
            (%f (car (<a class="sym-link system" href="../../axioms.html#def-caddr" data-sym="CADDR">caddr</a> equality)))
            (lemma-name (<a class="sym-link system" href="../../axioms.html#def-intern" data-sym="INTERN">intern</a> (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a>
                  (symbol-name f)
                  <span class="string">"-IS-"</span>
                  (symbol-name %f)
                  <span class="string">"-INDUCTION_STEP"</span>)
                <span class="string">"ACL2"</span>))
            (f-formals (cons f <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>))
            (%f-formals (cons %f <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>)))
          `(<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,LEMMA-NAME
              (<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> ,HYP (equal ,F-FORMALS ,%F-FORMALS))
              <span class="keyword">:instructions</span> (<span class="keyword">:promote</span> (<span class="keyword">:dv</span> <span class="number">1</span>)
                <span class="keyword">:x-dumb</span> <span class="keyword">:nx</span> <span class="keyword">:x-dumb</span> <span class="keyword">:top</span> (<span class="keyword">:s</span> <span class="keyword">:normalize</span> nil
                  <span class="keyword">:backchain-limit</span> <span class="number">1000</span>
                  <span class="keyword">:expand</span> <span class="keyword">:lambdas</span> <span class="keyword">:repeat</span> <span class="number">4</span>)))))
        acc))))</pre>
  </div>

<div class="form-block function" id="def-f-is-_25f-lemmas-mut-rec" data-defines="F-IS-%F-LEMMAS-MUT-REC" data-references="PREPROCESS,EQUAL,DEFTHM,QUASIQUOTE,SYMBOL-NAME,STRING,QUOTE,CONCATENATE,INTERN,LEMMA-NAME,CADDR,%F,CADR,F,CAR,EQUALITY,LET*,CONS,CDR,ENDP,IF,ACC,FORMALS,F-IS-%F-LIST,DEFUN" data-part-name="F-IS-%F-LEMMAS-MUT-REC" data-part-args="ACC,FORMALS,F-IS-%F-LIST" data-part-body="PREPROCESS,EQUAL,DEFTHM,QUASIQUOTE,SYMBOL-NAME,STRING,QUOTE,CONCATENATE,INTERN,LEMMA-NAME,CADDR,%F,CADR,F,CAR,EQUALITY,LET*,CONS,FORMALS,CDR,F-IS-%F-LEMMAS-MUT-REC,ACC,F-IS-%F-LIST,ENDP,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="F-IS-%F-LEMMAS-MUT-REC">f-is-%f-lemmas-mut-rec</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-f-is-_25f-lemmas-mut-rec" data-sym="F-IS-%F-LEMMAS-MUT-REC" title="(defun f-is-%f-lemmas-mut-rec (f-is-%f-list formals acc)
  (if (endp f-is-%f-list)
      acc
      (f-is-%f-lemmas-mut-rec (cdr f-is-%f-list) formals
       (cons
...">f-is-%f-lemmas-mut-rec</a>
  (<a class="sym-link local-def" href="#def-f-is-_25f-list" data-sym="F-IS-%F-LIST" title="(defun f-is-%f-list (defs formals acc)
  (if (endp defs)
      acc
      (f-is-%f-list (cdr defs) formals
       (let* ((%f (cadar defs)) (f (strip-leading-percent-from-symbol %f)))
...">f-is-%f-list</a> <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> acc)
  (if (<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> <a class="sym-link local-def" href="#def-f-is-_25f-list" data-sym="F-IS-%F-LIST" title="(defun f-is-%f-list (defs formals acc)
  (if (endp defs)
      acc
      (f-is-%f-list (cdr defs) formals
       (let* ((%f (cadar defs)) (f (strip-leading-percent-from-symbol %f)))
...">f-is-%f-list</a>)
    acc
    (<a class="sym-link local-def" href="#def-f-is-_25f-lemmas-mut-rec" data-sym="F-IS-%F-LEMMAS-MUT-REC" title="(defun f-is-%f-lemmas-mut-rec (f-is-%f-list formals acc)
  (if (endp f-is-%f-list)
      acc
      (f-is-%f-lemmas-mut-rec (cdr f-is-%f-list) formals
       (cons
...">f-is-%f-lemmas-mut-rec</a> (cdr <a class="sym-link local-def" href="#def-f-is-_25f-list" data-sym="F-IS-%F-LIST" title="(defun f-is-%f-list (defs formals acc)
  (if (endp defs)
      acc
      (f-is-%f-list (cdr defs) formals
       (let* ((%f (cadar defs)) (f (strip-leading-percent-from-symbol %f)))
...">f-is-%f-list</a>)
      <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>
      (cons (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((equality (car <a class="sym-link local-def" href="#def-f-is-_25f-list" data-sym="F-IS-%F-LIST" title="(defun f-is-%f-list (defs formals acc)
  (if (endp defs)
      acc
      (f-is-%f-list (cdr defs) formals
       (let* ((%f (cadar defs)) (f (strip-leading-percent-from-symbol %f)))
...">f-is-%f-list</a>)) (f (car (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> equality)))
            (%f (car (<a class="sym-link system" href="../../axioms.html#def-caddr" data-sym="CADDR">caddr</a> equality)))
            (lemma-name (<a class="sym-link system" href="../../axioms.html#def-intern" data-sym="INTERN">intern</a> (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a>
                  (symbol-name f)
                  <span class="string">"-IS-"</span>
                  (symbol-name %f))
                <span class="string">"ACL2"</span>)))
          `(<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,LEMMA-NAME
            (equal (,F ,@FORMALS) (,%F ,@FORMALS))
            <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:do-not</span> '(preprocess)))))
        acc))))</pre>
  </div>

<div class="form-block function" id="def-mutual-recursion-lemmas" data-defines="MUTUAL-RECURSION-LEMMAS" data-references="XARGS,DECLARE,%%AND-TREE,IMPLIES,%%INDUCTION-START,DEFLABEL,DISABLE,MINIMAL-THEORY,PREPROCESS,%%SUB1-INDUCTION,DEFTHM,IN-THEORY,ENCAPSULATE,THEORY,CURRENT-THEORY,SET-DIFFERENCE-THEORIES,UNION-THEORIES,DEFTHEORY,LOCAL,1+,NEW-THEORY,%%P-IMPLIES-F-IS-%F-THEORY,%%P-HOLDS,AND,INDUCTION-HYP,1-,%%P-FORMAL-MINUS-1,CAR,FORMAL,ZP,NOT,QUASIQUOTE,NOT-ZP-FORMAL,%%P-INDUCTION-STEP,%%P-BASE,%%P-PROPERTY,CONS,%%P-FORMALS,INTERN,%%P,EXPLODE-ATOM,COERCE,*%%P*,STRING,QUOTE,CONCATENATE,%%P-NAME,LET*,OLD-THEORY,COUNTER,F-IS-%F-LIST,FORMALS,DEFUN" data-used-by="SIMPLIFY-DEFUNS" data-part-name="MUTUAL-RECURSION-LEMMAS" data-part-args="OLD-THEORY,COUNTER,F-IS-%F-LIST,FORMALS" data-part-body="XARGS,DECLARE,DEFUN,%%AND-TREE,IMPLIES,%%INDUCTION-START,DEFLABEL,DISABLE,MINIMAL-THEORY,PREPROCESS,%%SUB1-INDUCTION,DEFTHM,IN-THEORY,ENCAPSULATE,THEORY,CURRENT-THEORY,SET-DIFFERENCE-THEORIES,UNION-THEORIES,DEFTHEORY,LOCAL,1+,NEW-THEORY,%%P-IMPLIES-F-IS-%F-THEORY,%%P-HOLDS,AND,INDUCTION-HYP,1-,%%P-FORMAL-MINUS-1,CAR,FORMAL,ZP,NOT,QUASIQUOTE,NOT-ZP-FORMAL,%%P-INDUCTION-STEP,%%P-BASE,%%P-PROPERTY,FORMALS,CONS,%%P-FORMALS,INTERN,%%P,COUNTER,EXPLODE-ATOM,COERCE,*%%P*,STRING,QUOTE,CONCATENATE,%%P-NAME,LET*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="MUTUAL-RECURSION-LEMMAS">mutual-recursion-lemmas</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-mutual-recursion-lemmas" data-sym="MUTUAL-RECURSION-LEMMAS" title="(defun mutual-recursion-lemmas (formals f-is-%f-list counter old-theory)
  (let* ((%%p-name
          (concatenate &#39;string *%%p*
                       (coerce (explode-atom counter 10) &#39;string)))
         (%%p (intern %%p-name &quot;ACL2&quot;))
...">mutual-recursion-lemmas</a>
  (<a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> <a class="sym-link local-def" href="#def-f-is-_25f-list" data-sym="F-IS-%F-LIST" title="(defun f-is-%f-list (defs formals acc)
  (if (endp defs)
      acc
      (f-is-%f-list (cdr defs) formals
       (let* ((%f (cadar defs)) (f (strip-leading-percent-from-symbol %f)))
...">f-is-%f-list</a> counter old-theory)
  (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((%%p-name (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a>
         <a class="sym-link local-def" href="#def-_2A_25_25p_2A" data-sym="*%%P*" title="(defconst *%%p* &quot;%%P&quot;)">*%%p*</a>
         (coerce (<a class="sym-link system" href="../../axioms.html#def-explode-atom" data-sym="EXPLODE-ATOM">explode-atom</a> counter <span class="number">10</span>) '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a>))) (%%p (<a class="sym-link system" href="../../axioms.html#def-intern" data-sym="INTERN">intern</a> %%p-name <span class="string">"ACL2"</span>))
      (%%p-formals (cons %%p <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>))
      (%%p-property (<a class="sym-link system" href="../../axioms.html#def-intern" data-sym="INTERN">intern</a> (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> %%p-name <span class="string">"-PROPERTY"</span>) <span class="string">"ACL2"</span>))
      (%%p-base (<a class="sym-link system" href="../../axioms.html#def-intern" data-sym="INTERN">intern</a> (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> %%p-name <span class="string">"-BASE"</span>) <span class="string">"ACL2"</span>))
      (%%p-induction-step (<a class="sym-link system" href="../../axioms.html#def-intern" data-sym="INTERN">intern</a> (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> %%p-name <span class="string">"-INDUCTION_STEP"</span>)
          <span class="string">"ACL2"</span>))
      (not-zp-formal `(<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../axioms.html#def-zp" data-sym="ZP">zp</a> ,@FORMALS)))
      (formal (car <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>))
      (%%p-formal-minus-1 `(,%%P (<a class="sym-link system" href="../../axioms.html#def-1-" data-sym="1-">1-</a> ,FORMAL)))
      (induction-hyp `(<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> ,NOT-ZP-FORMAL ,%%P-FORMAL-MINUS-1))
      (%%p-holds (<a class="sym-link system" href="../../axioms.html#def-intern" data-sym="INTERN">intern</a> (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> %%p-name <span class="string">"-HOLDS"</span>) <span class="string">"ACL2"</span>))
      (%%p-implies-f-is-%f-theory (<a class="sym-link system" href="../../axioms.html#def-intern" data-sym="INTERN">intern</a> (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> %%p-name <span class="string">"-IMPLIES-F-IS-%F-THEORY"</span>)
          <span class="string">"ACL2"</span>))
      (new-theory (<a class="sym-link system" href="../../axioms.html#def-intern" data-sym="INTERN">intern</a> (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a>
            <span class="string">"THEORY-"</span>
            (coerce (<a class="sym-link system" href="../../axioms.html#def-explode-atom" data-sym="EXPLODE-ATOM">explode-atom</a> (<a class="sym-link system" href="../../axioms.html#def-1_2B" data-sym="1+">1+</a> counter) <span class="number">10</span>) '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a>))
          <span class="string">"ACL2"</span>)))
    `((<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-deftheory" data-sym="DEFTHEORY">deftheory</a> ,NEW-THEORY
         (union-theories (set-difference-theories (current-theory <span class="keyword">:here</span>)
             (current-theory ',%%P-HOLDS))
           (theory ',OLD-THEORY)))) (<a class="sym-link system" href="../../axioms.html#def-encapsulate" data-sym="ENCAPSULATE">encapsulate</a> nil
        (<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (union-theories '(,%%P-HOLDS)
              (theory ',%%P-IMPLIES-F-IS-%F-THEORY))))
        ,@(F-IS-%F-LEMMAS-MUT-REC F-IS-%F-LIST FORMALS NIL))
      (<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,%%P-HOLDS
          ,%%P-FORMALS
          <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:induct</span> (%%sub1-induction ,@FORMALS)
             <span class="keyword">:do-not</span> '(preprocess)
             <span class="keyword">:in-theory</span> (union-theories '(,%%P-BASE ,%%P-INDUCTION-STEP
                 (<span class="keyword">:induction</span> %%sub1-induction))
               (theory 'minimal-theory))))))
      (<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-encapsulate" data-sym="ENCAPSULATE">encapsulate</a> nil
          (<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (disable ,%%P ,%%P-BASE)))
          (<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-deflabel" data-sym="DEFLABEL">deflabel</a> %%induction-start))
          ,@(F-IS-%F-INDUCTION-STEP-LEMMAS F-IS-%F-LIST FORMALS INDUCTION-HYP NIL)
          (<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,%%P-INDUCTION-STEP
            (<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> ,INDUCTION-HYP ,%%P-FORMALS)
            <span class="keyword">:instructions</span> (<span class="keyword">:promote</span> <span class="keyword">:x-dumb</span> (<span class="keyword">:s</span> <span class="keyword">:normalize</span> nil)))))
      (<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-encapsulate" data-sym="ENCAPSULATE">encapsulate</a> nil
          (<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-in-theory" data-sym="IN-THEORY">in-theory</a> (disable ,%%P-PROPERTY)))
          ,@(F-IS-%F-BASE-LEMMAS F-IS-%F-LIST FORMALS `(ZP ,@FORMALS) NIL)
          (<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,%%P-BASE
            (<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../axioms.html#def-zp" data-sym="ZP">zp</a> ,@FORMALS) ,%%P-FORMALS)
            <span class="keyword">:instructions</span> (<span class="keyword">:promote</span> <span class="keyword">:x-dumb</span> (<span class="keyword">:s</span> <span class="keyword">:normalize</span> nil)))))
      (<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-deftheory" data-sym="DEFTHEORY">deftheory</a> ,%%P-IMPLIES-F-IS-%F-THEORY
          (union-theories (set-difference-theories (current-theory <span class="keyword">:here</span>)
              (current-theory ',%%P))
            (theory 'minimal-theory))))
      (<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> ,%%P-PROPERTY
          (<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (,%%P ,@FORMALS) (%%and-tree ,@F-IS-%F-LIST))
          <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:in-theory</span> (union-theories '(,%%P) (theory 'minimal-theory))))))
      (<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> ,%%P
          ,FORMALS
          (declare (xargs <span class="keyword">:normalize</span> nil))
          (%%and-tree ,@F-IS-%F-LIST))))))</pre>
  </div>

<div class="form-block function" id="def-my-translate-rule-class-alist" data-defines="MY-TRANSLATE-RULE-CLASS-ALIST" data-references="QUASIQUOTE,EQ,CONS,NEW-SEEN,IF,CDDR,SOFT,ER,OTHERWISE,STRIP-LEADING-PERCENT-FROM-SYMBOL,ATOM,CLIQUE,LET,STRIP-PERCENTS,TRANSLATE,TERM,STRIP-PERCENTS-LST,TRANSLATE-TERM-LST,TERMS,STRIP-LEADING-PERCENT-FROM-SYMBOL-LIST,REVERSE,CADR,CAR,CASE,VAL,ER-LET*,T,ALIST-TO-KEYWORD-ALIST,VALUE,NULL,COND,STATE,WRLD,CTX,COROLLARY,ORIG-NAME,SEEN,ALIST,TOKEN,DEFUN" data-used-by="MY-TRANSLATE-RULE-CLASS1" data-part-name="MY-TRANSLATE-RULE-CLASS-ALIST" data-part-args="STATE,WRLD,CTX,COROLLARY,ORIG-NAME,SEEN,ALIST,TOKEN" data-part-body="ORIG-NAME,QUASIQUOTE,EQ,CONS,NEW-SEEN,IF,CDDR,TOKEN,MY-TRANSLATE-RULE-CLASS-ALIST,SOFT,ER,OTHERWISE,STRIP-LEADING-PERCENT-FROM-SYMBOL,ATOM,CLIQUE,LET,STRIP-PERCENTS,TRANSLATE,TERM,STRIP-PERCENTS-LST,STATE,WRLD,CTX,TRANSLATE-TERM-LST,TERMS,STRIP-LEADING-PERCENT-FROM-SYMBOL-LIST,REVERSE,CADR,COROLLARY,CAR,CASE,VAL,ER-LET*,T,SEEN,ALIST-TO-KEYWORD-ALIST,VALUE,ALIST,NULL,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="MY-TRANSLATE-RULE-CLASS-ALIST">my-translate-rule-class-alist</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-my-translate-rule-class-alist" data-sym="MY-TRANSLATE-RULE-CLASS-ALIST" title="(defun my-translate-rule-class-alist
       (token alist seen orig-name corollary ctx wrld state)
  (cond ((null alist) (value (alist-to-keyword-alist seen nil)))
        (t
         (er-let*
...">my-translate-rule-class-alist</a>
  (token alist seen orig-name <a class="sym-link system" href="../../history-management.html#def-corollary" data-sym="COROLLARY">corollary</a> ctx wrld state)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> alist) (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../defthm.html#def-alist-to-keyword-alist" data-sym="ALIST-TO-KEYWORD-ALIST">alist-to-keyword-alist</a> seen nil)))
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((val (<a class="sym-link system" href="../../axioms.html#def-case" data-sym="CASE">case</a> (car alist)
             (<span class="keyword">:corollary</span> (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> <a class="sym-link system" href="../../history-management.html#def-corollary" data-sym="COROLLARY">corollary</a>))
             (<span class="keyword">:hints</span> (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> nil))
             (<span class="keyword">:instructions</span> (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> nil))
             (<span class="keyword">:otf-flg</span> (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> alist)))
             (<span class="keyword">:trigger-fns</span> (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-reverse" data-sym="REVERSE">reverse</a> (<a class="sym-link local-def" href="#def-strip-leading-percent-from-symbol-list" data-sym="STRIP-LEADING-PERCENT-FROM-SYMBOL-LIST" title="(defun strip-leading-percent-from-symbol-list (sym-list acc)
  (if (endp sym-list)
      acc
      (strip-leading-percent-from-symbol-list (cdr sym-list)
       (cons (strip-leading-percent-from-symbol (car sym-list)) acc))))">strip-leading-percent-from-symbol-list</a> (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> alist) nil))))
             (<span class="keyword">:trigger-terms</span> (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((terms (translate-term-lst (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> alist) <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> ctx wrld state)))
                 (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (strip-percents-lst terms nil))))
             (<span class="keyword">:typed-term</span> (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((term (translate (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> alist) <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> ctx wrld state)))
                 (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link local-def" href="#def-strip-percents" data-sym="STRIP-PERCENTS" title="(mutual-recursion
 (defun strip-percents (term)
   (cond ((variablep term) term) ((fquotep term) term)
         ((flambdap (ffn-symb term))
          (let ((vars (lambda-formals (ffn-symb term)))
...">strip-percents</a> term))))
             (<span class="keyword">:backchain-limit-lst</span> (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> alist)))
             (<span class="keyword">:match-free</span> (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> alist)))
             (<span class="keyword">:clique</span> (let ((clique (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> alist)) nil)
                      ((<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> alist)) (<a class="sym-link local-def" href="#def-strip-leading-percent-from-symbol" data-sym="STRIP-LEADING-PERCENT-FROM-SYMBOL" title="(defun strip-leading-percent-from-symbol (sym)
  (let* ((name (symbol-name sym)) (len (length name)))
    (if (and (not (int= len 0)) (eq (char name 0) #\%))
        (intern-in-package-of-symbol (subseq name 1 len) sym)
        sym)))">strip-leading-percent-from-symbol</a> (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> alist)))
                      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link local-def" href="#def-strip-leading-percent-from-symbol-list" data-sym="STRIP-LEADING-PERCENT-FROM-SYMBOL-LIST" title="(defun strip-leading-percent-from-symbol-list (sym-list acc)
  (if (endp sym-list)
      acc
      (strip-leading-percent-from-symbol-list (cdr sym-list)
       (cons (strip-leading-percent-from-symbol (car sym-list)) acc))))">strip-leading-percent-from-symbol-list</a> (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> alist) nil)))))
                 (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> clique)))
             (<span class="keyword">:type-set</span> (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> alist)))
             (otherwise (<a class="sym-link system" href="../../axioms.html#def-er" data-sym="ER">er</a> soft
                 ctx
                 <span class="string">"The key ~x0 is not yet implemented for rule class ~
                   translation."</span>
                 (car alist))))))
        (<a class="sym-link local-def" href="#def-my-translate-rule-class-alist" data-sym="MY-TRANSLATE-RULE-CLASS-ALIST" title="(defun my-translate-rule-class-alist
       (token alist seen orig-name corollary ctx wrld state)
  (cond ((null alist) (value (alist-to-keyword-alist seen nil)))
        (t
         (er-let*
...">my-translate-rule-class-alist</a> token
          (<a class="sym-link system" href="../../axioms.html#def-cddr" data-sym="CDDR">cddr</a> alist)
          (if val
            (let ((new-seen (cons (cons (car alist) val) seen)))
              (if (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (car alist) <span class="keyword">:corollary</span>)
                (cons (cons <span class="keyword">:hints</span> `((<span class="string">"Goal"</span> <span class="keyword">:use</span> (,TOKEN ,ORIG-NAME))))
                  new-seen)
                new-seen))
            seen)
          orig-name
          <a class="sym-link system" href="../../history-management.html#def-corollary" data-sym="COROLLARY">corollary</a>
          ctx
          wrld
          state)))))</pre>
  </div>

<div class="form-block function" id="def-my-translate-rule-class1" data-defines="MY-TRANSLATE-RULE-CLASS1" data-references="CONS,STRIP-PERCENTS,UNTRANSLATE,AND,CAR,MY-TRANSLATE-RULE-CLASS-ALIST,ALIST,VALUE,T,TRANSLATE,COND,COROLLARY,ER-LET*,CDR,ASSOC-KEYWORD,CADR,ORIG-COROLLARY,LET,STATE,WRLD,CTX,CLASS,NAME,DEFUN" data-used-by="MY-TRANSLATE-RULE-CLASS" data-part-name="MY-TRANSLATE-RULE-CLASS1" data-part-args="STATE,WRLD,CTX,CLASS,NAME" data-part-body="CONS,STRIP-PERCENTS,UNTRANSLATE,AND,NAME,CAR,MY-TRANSLATE-RULE-CLASS-ALIST,ALIST,VALUE,STATE,WRLD,CTX,T,TRANSLATE,COND,COROLLARY,ER-LET*,CLASS,CDR,ASSOC-KEYWORD,CADR,ORIG-COROLLARY,LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="MY-TRANSLATE-RULE-CLASS1">my-translate-rule-class1</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-my-translate-rule-class1" data-sym="MY-TRANSLATE-RULE-CLASS1" title="(defun my-translate-rule-class1 (name class ctx wrld state)
  (let ((orig-corollary (cadr (assoc-keyword :corollary (cdr class)))))
    (er-let*
     ((corollary
       (cond (orig-corollary (translate orig-corollary t t t ctx wrld state))
...">my-translate-rule-class1</a>
  (name class ctx wrld state)
  (let ((orig-corollary (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> (<a class="sym-link system" href="../../axioms.html#def-assoc-keyword" data-sym="ASSOC-KEYWORD">assoc-keyword</a> <span class="keyword">:corollary</span> (cdr class)))))
    (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((<a class="sym-link system" href="../../history-management.html#def-corollary" data-sym="COROLLARY">corollary</a> (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (orig-corollary (translate orig-corollary <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> ctx wrld state))
           (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> nil)))) (alist (<a class="sym-link local-def" href="#def-my-translate-rule-class-alist" data-sym="MY-TRANSLATE-RULE-CLASS-ALIST" title="(defun my-translate-rule-class-alist
       (token alist seen orig-name corollary ctx wrld state)
  (cond ((null alist) (value (alist-to-keyword-alist seen nil)))
        (t
         (er-let*
...">my-translate-rule-class-alist</a> (car class)
            (cdr class)
            nil
            name
            (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> <a class="sym-link system" href="../../history-management.html#def-corollary" data-sym="COROLLARY">corollary</a>
              (untranslate (<a class="sym-link local-def" href="#def-strip-percents" data-sym="STRIP-PERCENTS" title="(mutual-recursion
 (defun strip-percents (term)
   (cond ((variablep term) term) ((fquotep term) term)
         ((flambdap (ffn-symb term))
          (let ((vars (lambda-formals (ffn-symb term)))
...">strip-percents</a> <a class="sym-link system" href="../../history-management.html#def-corollary" data-sym="COROLLARY">corollary</a>) <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> wrld))
            ctx
            wrld
            state)))
      (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (cons (car class) alist)))))</pre>
  </div>

<div class="form-block function" id="def-my-translate-rule-class" data-defines="MY-TRANSLATE-RULE-CLASS" data-references="MY-TRANSLATE-RULE-CLASS1,T,VALUE,SYMBOLP,COND,STATE,WRLD,CTX,X,NAME,DEFUN" data-used-by="MY-TRANSLATE-RULE-CLASSES1" data-part-name="MY-TRANSLATE-RULE-CLASS" data-part-args="STATE,WRLD,CTX,X,NAME" data-part-body="STATE,WRLD,CTX,NAME,MY-TRANSLATE-RULE-CLASS1,T,VALUE,X,SYMBOLP,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="MY-TRANSLATE-RULE-CLASS">my-translate-rule-class</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-my-translate-rule-class" data-sym="MY-TRANSLATE-RULE-CLASS" title="(defun my-translate-rule-class (name x ctx wrld state)
  (cond ((symbolp x) (value x))
        (t (my-translate-rule-class1 name x ctx wrld state))))">my-translate-rule-class</a>
  (name x ctx wrld state)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((symbolp x) (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> x))
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link local-def" href="#def-my-translate-rule-class1" data-sym="MY-TRANSLATE-RULE-CLASS1" title="(defun my-translate-rule-class1 (name class ctx wrld state)
  (let ((orig-corollary (cadr (assoc-keyword :corollary (cdr class)))))
    (er-let*
     ((corollary
       (cond (orig-corollary (translate orig-corollary t t t ctx wrld state))
...">my-translate-rule-class1</a> name x ctx wrld state))))</pre>
  </div>

<div class="form-block function" id="def-my-translate-rule-classes1" data-defines="MY-TRANSLATE-RULE-CLASSES1" data-references="CONS,CDR,RST,CAR,MY-TRANSLATE-RULE-CLASS,CLASS,ER-LET*,T,VALUE,ATOM,COND,STATE,WRLD,CTX,CLASSES,NAME,DEFUN" data-used-by="MY-TRANSLATE-RULE-CLASSES" data-part-name="MY-TRANSLATE-RULE-CLASSES1" data-part-args="STATE,WRLD,CTX,CLASSES,NAME" data-part-body="CONS,CDR,MY-TRANSLATE-RULE-CLASSES1,RST,STATE,WRLD,CTX,CAR,NAME,MY-TRANSLATE-RULE-CLASS,CLASS,ER-LET*,T,VALUE,CLASSES,ATOM,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="MY-TRANSLATE-RULE-CLASSES1">my-translate-rule-classes1</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-my-translate-rule-classes1" data-sym="MY-TRANSLATE-RULE-CLASSES1" title="(defun my-translate-rule-classes1 (name classes ctx wrld state)
  (cond ((atom classes) (value nil))
        (t
         (er-let*
          ((class (my-translate-rule-class name (car classes) ctx wrld state))
...">my-translate-rule-classes1</a>
  (name classes ctx wrld state)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> classes) (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> nil))
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((class (<a class="sym-link local-def" href="#def-my-translate-rule-class" data-sym="MY-TRANSLATE-RULE-CLASS" title="(defun my-translate-rule-class (name x ctx wrld state)
  (cond ((symbolp x) (value x))
        (t (my-translate-rule-class1 name x ctx wrld state))))">my-translate-rule-class</a> name (car classes) ctx wrld state)) (rst (<a class="sym-link local-def" href="#def-my-translate-rule-classes1" data-sym="MY-TRANSLATE-RULE-CLASSES1" title="(defun my-translate-rule-classes1 (name classes ctx wrld state)
  (cond ((atom classes) (value nil))
        (t
         (er-let*
          ((class (my-translate-rule-class name (car classes) ctx wrld state))
...">my-translate-rule-classes1</a> name
              (cdr classes)
              ctx
              wrld
              state)))
        (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (cons class rst))))))</pre>
  </div>

<div class="form-block function" id="def-my-translate-rule-classes" data-defines="MY-TRANSLATE-RULE-CLASSES" data-references="MY-TRANSLATE-RULE-CLASSES1,T,VALUE,ATOM,COND,STATE,WRLD,CTX,CLASSES,NAME,DEFUN" data-used-by="STRIP-PERCENTS-FROM-LEMMA" data-part-name="MY-TRANSLATE-RULE-CLASSES" data-part-args="STATE,WRLD,CTX,CLASSES,NAME" data-part-body="STATE,WRLD,CTX,NAME,MY-TRANSLATE-RULE-CLASSES1,T,VALUE,CLASSES,ATOM,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="MY-TRANSLATE-RULE-CLASSES">my-translate-rule-classes</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-my-translate-rule-classes" data-sym="MY-TRANSLATE-RULE-CLASSES" title="(defun my-translate-rule-classes (name classes ctx wrld state)
  (cond ((atom classes) (value classes))
        (t (my-translate-rule-classes1 name classes ctx wrld state))))">my-translate-rule-classes</a>
  (name classes ctx wrld state)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> classes) (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> classes))
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link local-def" href="#def-my-translate-rule-classes1" data-sym="MY-TRANSLATE-RULE-CLASSES1" title="(defun my-translate-rule-classes1 (name classes ctx wrld state)
  (cond ((atom classes) (value nil))
        (t
         (er-let*
          ((class (my-translate-rule-class name (car classes) ctx wrld state))
...">my-translate-rule-classes1</a> name classes ctx wrld state))))</pre>
  </div>

<div class="form-block function" id="def-strip-percents-from-lemma" data-defines="STRIP-PERCENTS-FROM-LEMMA" data-references="&,QUASIQUOTE,MY-TRANSLATE-RULE-CLASSES,CLASSES,T,TRANSLATE,TERM,ER-LET*,ASSOC-KEYWORD,CADR,RCS,VALUE,EQ,IF,STRIP-LEADING-PERCENT-FROM-SYMBOL,NEW-NAME,LET,DEFTHMD,QUOTE,MEMBER-EQ,COND,OTHER,FORMULA,NAME,DEFTHM,CASE-MATCH,STATE,WRLD,CTX,LEMMA,DEFUN" data-used-by="STRIP-PERCENTS-FROM-LEMMAS" data-part-name="STRIP-PERCENTS-FROM-LEMMA" data-part-args="STATE,WRLD,CTX,LEMMA" data-part-body="&,QUASIQUOTE,MY-TRANSLATE-RULE-CLASSES,CLASSES,STATE,WRLD,CTX,T,TRANSLATE,TERM,ER-LET*,ASSOC-KEYWORD,CADR,RCS,VALUE,EQ,IF,STRIP-LEADING-PERCENT-FROM-SYMBOL,NEW-NAME,LET,DEFTHMD,QUOTE,MEMBER-EQ,COND,OTHER,FORMULA,NAME,DEFTHM,LEMMA,CASE-MATCH" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="STRIP-PERCENTS-FROM-LEMMA">strip-percents-from-lemma</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-strip-percents-from-lemma" data-sym="STRIP-PERCENTS-FROM-LEMMA" title="(defun strip-percents-from-lemma (lemma ctx wrld state)
  (case-match lemma
              ((defthm name formula . other)
               (cond
                ((member-eq defthm &#39;(defthm defthmd))
...">strip-percents-from-lemma</a>
  (lemma ctx wrld state)
  (<a class="sym-link system" href="../../basis-a.html#def-case-match" data-sym="CASE-MATCH">case-match</a> lemma
    ((<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> name <a class="sym-link system" href="../../history-management.html#def-formula" data-sym="FORMULA">formula</a> . other) (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-member-eq" data-sym="MEMBER-EQ">member-eq</a> <a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> '(<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> <a class="sym-link system" href="../../axioms.html#def-defthmd" data-sym="DEFTHMD">defthmd</a>)) (let ((new-name (<a class="sym-link local-def" href="#def-strip-leading-percent-from-symbol" data-sym="STRIP-LEADING-PERCENT-FROM-SYMBOL" title="(defun strip-leading-percent-from-symbol (sym)
  (let* ((name (symbol-name sym)) (len (length name)))
    (if (and (not (int= len 0)) (eq (char name 0) #\%))
        (intern-in-package-of-symbol (subseq name 1 len) sym)
        sym)))">strip-leading-percent-from-symbol</a> name)))
            (if (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> name new-name)
              (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> nil)
              (let ((rcs (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> (<a class="sym-link system" href="../../axioms.html#def-assoc-keyword" data-sym="ASSOC-KEYWORD">assoc-keyword</a> <span class="keyword">:rule-classes</span> other))))
                (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((term (translate <a class="sym-link system" href="../../history-management.html#def-formula" data-sym="FORMULA">formula</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> ctx wrld state)) (classes (<a class="sym-link local-def" href="#def-my-translate-rule-classes" data-sym="MY-TRANSLATE-RULE-CLASSES" title="(defun my-translate-rule-classes (name classes ctx wrld state)
  (cond ((atom classes) (value classes))
        (t (my-translate-rule-classes1 name classes ctx wrld state))))">my-translate-rule-classes</a> name rcs ctx wrld state)))
                  (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> `(,DEFTHM ,NEW-NAME
                      ,(UNTRANSLATE (STRIP-PERCENTS TERM) T WRLD)
                      <span class="keyword">:hints</span> ((<span class="string">"Goal"</span> <span class="keyword">:use</span> ,NAME))
                      ,@(AND CLASSES (LIST :RULE-CLASSES CLASSES)))))))))
        (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> nil))))
    (&amp; (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> nil))))</pre>
  </div>

<div class="form-block function" id="def-strip-percents-from-lemmas" data-defines="STRIP-PERCENTS-FROM-LEMMAS" data-references="CONS,CDR,CAR,STRIP-PERCENTS-FROM-LEMMA,NEW-LEMMA,ER-LET*,REVERSE,VALUE,ENDP,IF,STATE,WRLD,CTX,ACC,LEMMAS,DEFUN" data-used-by="WRITE-LEMMA-FILE" data-part-name="STRIP-PERCENTS-FROM-LEMMAS" data-part-args="STATE,WRLD,CTX,ACC,LEMMAS" data-part-body="CONS,CDR,STRIP-PERCENTS-FROM-LEMMAS,STATE,WRLD,CTX,CAR,STRIP-PERCENTS-FROM-LEMMA,NEW-LEMMA,ER-LET*,ACC,REVERSE,VALUE,LEMMAS,ENDP,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="STRIP-PERCENTS-FROM-LEMMAS">strip-percents-from-lemmas</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-strip-percents-from-lemmas" data-sym="STRIP-PERCENTS-FROM-LEMMAS" title="(defun strip-percents-from-lemmas (lemmas acc ctx wrld state)
  (if (endp lemmas)
      (value (reverse acc))
      (er-let*
       ((new-lemma (strip-percents-from-lemma (car lemmas) ctx wrld state)))
...">strip-percents-from-lemmas</a>
  (lemmas acc ctx wrld state)
  (if (<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> lemmas)
    (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-reverse" data-sym="REVERSE">reverse</a> acc))
    (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((new-lemma (<a class="sym-link local-def" href="#def-strip-percents-from-lemma" data-sym="STRIP-PERCENTS-FROM-LEMMA" title="(defun strip-percents-from-lemma (lemma ctx wrld state)
  (case-match lemma
              ((defthm name formula . other)
               (cond
                ((member-eq defthm &#39;(defthm defthmd))
...">strip-percents-from-lemma</a> (car lemmas) ctx wrld state)))
      (<a class="sym-link local-def" href="#def-strip-percents-from-lemmas" data-sym="STRIP-PERCENTS-FROM-LEMMAS" title="(defun strip-percents-from-lemmas (lemmas acc ctx wrld state)
  (if (endp lemmas)
      (value (reverse acc))
      (er-let*
       ((new-lemma (strip-percents-from-lemma (car lemmas) ctx wrld state)))
...">strip-percents-from-lemmas</a> (cdr lemmas)
        (if new-lemma
          (cons new-lemma acc)
          acc)
        ctx
        wrld
        state))))</pre>
  </div>

<div class="form-block function" id="def-simplify-defuns" data-defines="SIMPLIFY-DEFUNS" data-references="CDR,MUT-REC,SIMPLIFY-DEFUN,NEW-THEORY,DEF,T,IGNORE,DECLARE,SOFT,ER,VAL,ERP,MV-LET,1+,APPEND,REVERSE,MUTUAL-RECURSION,QUOTE,CONS,MV,CAR,CADR,NEW-DEFTHEORY,F-IS-%F-LIST,MUTUAL-RECURSION-LEMMAS,NEW-LEMMAS,LET*,IF,MUT-REC-FORMALS,FORMALS,LET,ENDP,COND,STATE,WRLD,ENS,OLD-THEORY,COUNTER,LEMMAS,ACC,ALL-DEFS,DEFS,DEFUN" data-used-by="SIMPLIFY-FORM" data-part-name="SIMPLIFY-DEFUNS" data-part-args="STATE,WRLD,ENS,OLD-THEORY,COUNTER,LEMMAS,ACC,ALL-DEFS,DEFS" data-part-body="CDR,WRLD,ENS,MUT-REC,SIMPLIFY-DEFUN,NEW-THEORY,DEF,T,IGNORE,DECLARE,SIMPLIFY-DEFUNS,SOFT,ER,VAL,ERP,MV-LET,STATE,1+,LEMMAS,APPEND,ACC,REVERSE,MUTUAL-RECURSION,QUOTE,CONS,MV,CAR,CADR,NEW-DEFTHEORY,OLD-THEORY,COUNTER,F-IS-%F-LIST,MUTUAL-RECURSION-LEMMAS,NEW-LEMMAS,LET*,IF,ALL-DEFS,MUT-REC-FORMALS,FORMALS,LET,DEFS,ENDP,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="SIMPLIFY-DEFUNS">simplify-defuns</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-simplify-defuns" data-sym="SIMPLIFY-DEFUNS" title="(defun simplify-defuns
       (defs all-defs acc lemmas counter old-theory ens wrld state)
  (cond
   ((endp defs)
    (let ((formals (mut-rec-formals all-defs nil)))
...">simplify-defuns</a>
  (defs all-defs acc lemmas counter old-theory ens wrld state)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> defs) (let ((<a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> (<a class="sym-link local-def" href="#def-mut-rec-formals" data-sym="MUT-REC-FORMALS" title="(defun mut-rec-formals (defs formals)
  (if (endp defs)
      formals
      (let* ((def (car defs))
             (new-formals (and (true-listp def) (caddr def)))
...">mut-rec-formals</a> all-defs nil)))
        (if <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>
          (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((new-lemmas (<a class="sym-link local-def" href="#def-mutual-recursion-lemmas" data-sym="MUTUAL-RECURSION-LEMMAS" title="(defun mutual-recursion-lemmas (formals f-is-%f-list counter old-theory)
  (let* ((%%p-name
          (concatenate &#39;string *%%p*
                       (coerce (explode-atom counter 10) &#39;string)))
         (%%p (intern %%p-name &quot;ACL2&quot;))
...">mutual-recursion-lemmas</a> <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a>
                 (<a class="sym-link local-def" href="#def-f-is-_25f-list" data-sym="F-IS-%F-LIST" title="(defun f-is-%f-list (defs formals acc)
  (if (endp defs)
      acc
      (f-is-%f-list (cdr defs) formals
       (let* ((%f (cadar defs)) (f (strip-leading-percent-from-symbol %f)))
...">f-is-%f-list</a> all-defs <a class="sym-link system" href="../../basis-b.html#def-formals" data-sym="FORMALS">formals</a> nil)
                 counter
                 old-theory)) (new-deftheory (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> (car new-lemmas))))
            (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil
              (cons '<a class="sym-link system" href="../../axioms.html#def-mutual-recursion" data-sym="MUTUAL-RECURSION">mutual-recursion</a> (<a class="sym-link system" href="../../axioms.html#def-reverse" data-sym="REVERSE">reverse</a> acc))
              (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> new-lemmas lemmas)
              (<a class="sym-link system" href="../../axioms.html#def-1_2B" data-sym="1+">1+</a> counter)
              (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> new-deftheory)
              state))
          (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (erp val state)
            (<a class="sym-link system" href="../../axioms.html#def-er" data-sym="ER">er</a> soft
              '<a class="sym-link local-def" href="#def-simplify-defuns" data-sym="SIMPLIFY-DEFUNS" title="(defun simplify-defuns
       (defs all-defs acc lemmas counter old-theory ens wrld state)
  (cond
   ((endp defs)
    (let ((formals (mut-rec-formals all-defs nil)))
...">simplify-defuns</a>
              <span class="string">"Did not find a unique singleton list of formals for the ~
                     mutual-recursion nest starting with:~%~x0."</span>
              (car all-defs))
            (declare (ignore erp val))
            (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> nil nil counter old-theory state)))))
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (erp def new-lemmas counter new-theory state)
        (<a class="sym-link local-def" href="#def-simplify-defun" data-sym="SIMPLIFY-DEFUN" title="(defun simplify-defun (info def lemmas counter old-theory ens wrld state)
  (let* ((fn (cadr def))
         (new-fn (strip-leading-percent-from-symbol fn))
         (orig-body (car (last def))))
    (if (eq new-fn fn)
...">simplify-defun</a> 'mut-rec
          (car defs)
          lemmas
          counter
          old-theory
          ens
          wrld
          state)
        (if erp
          (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> nil nil counter new-theory state)
          (<a class="sym-link local-def" href="#def-simplify-defuns" data-sym="SIMPLIFY-DEFUNS" title="(defun simplify-defuns
       (defs all-defs acc lemmas counter old-theory ens wrld state)
  (cond
   ((endp defs)
    (let ((formals (mut-rec-formals all-defs nil)))
...">simplify-defuns</a> (cdr defs)
            all-defs
            (if def
              (cons def acc)
              acc)
            new-lemmas
            counter
            new-theory
            ens
            wrld
            state))))))</pre>
  </div>

<div class="form-block function" id="def-simplify-form" data-defines="SIMPLIFY-FORM" data-references="OTHERWISE,T,MV,IGNORE,DECLARE,QUOTE,SOFT,ER,VAL,ERP,MV-LET,DEFUNS,CDR,SIMPLIFY-DEFUNS,MUTUAL-RECURSION,SIMPLIFY-DEFUN,DEFUND,CASE,CAR,CONSP,AND,CAR-FORM,LET,STATE,WRLD,ENS,OLD-THEORY,COUNTER,LEMMAS,FORM,DEFUN" data-used-by="SIMPLIFY-FORMS" data-part-name="SIMPLIFY-FORM" data-part-args="STATE,WRLD,ENS,OLD-THEORY,COUNTER,LEMMAS,FORM" data-part-body="OTHERWISE,T,MV,IGNORE,DECLARE,SIMPLIFY-FORM,QUOTE,SOFT,ER,VAL,ERP,MV-LET,DEFUNS,CDR,SIMPLIFY-DEFUNS,MUTUAL-RECURSION,STATE,WRLD,ENS,OLD-THEORY,COUNTER,LEMMAS,SIMPLIFY-DEFUN,DEFUND,DEFUN,CASE,CAR,FORM,CONSP,AND,CAR-FORM,LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="SIMPLIFY-FORM">simplify-form</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-simplify-form" data-sym="SIMPLIFY-FORM" title="(defun simplify-form (form lemmas counter old-theory ens wrld state)
  (let ((car-form (and (consp form) (car form))))
    (case car-form
      ((defun defund)
       (simplify-defun nil form lemmas counter old-theory ens wrld state))
...">simplify-form</a>
  (form lemmas counter old-theory ens wrld state)
  (let ((car-form (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (consp form) (car form))))
    (<a class="sym-link system" href="../../axioms.html#def-case" data-sym="CASE">case</a> car-form
      ((<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> defund) (<a class="sym-link local-def" href="#def-simplify-defun" data-sym="SIMPLIFY-DEFUN" title="(defun simplify-defun (info def lemmas counter old-theory ens wrld state)
  (let* ((fn (cadr def))
         (new-fn (strip-leading-percent-from-symbol fn))
         (orig-body (car (last def))))
    (if (eq new-fn fn)
...">simplify-defun</a> nil
          form
          lemmas
          counter
          old-theory
          ens
          wrld
          state))
      (<a class="sym-link system" href="../../axioms.html#def-mutual-recursion" data-sym="MUTUAL-RECURSION">mutual-recursion</a> (<a class="sym-link local-def" href="#def-simplify-defuns" data-sym="SIMPLIFY-DEFUNS" title="(defun simplify-defuns
       (defs all-defs acc lemmas counter old-theory ens wrld state)
  (cond
   ((endp defs)
    (let ((formals (mut-rec-formals all-defs nil)))
...">simplify-defuns</a> (cdr form)
          (cdr form)
          nil
          lemmas
          counter
          old-theory
          ens
          wrld
          state))
      (<a class="sym-link system" href="../../axioms.html#def-defuns" data-sym="DEFUNS">defuns</a> (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (erp val state)
          (<a class="sym-link system" href="../../axioms.html#def-er" data-sym="ER">er</a> soft
            '<a class="sym-link local-def" href="#def-simplify-form" data-sym="SIMPLIFY-FORM" title="(defun simplify-form (form lemmas counter old-theory ens wrld state)
  (let ((car-form (and (consp form) (car form))))
    (case car-form
      ((defun defund)
       (simplify-defun nil form lemmas counter old-theory ens wrld state))
...">simplify-form</a>
            <span class="string">"Simplify-form does not yet handle DEFUNS, but it ~
                           could."</span>)
          (declare (ignore erp val))
          (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> nil nil counter old-theory state)))
      (otherwise (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil nil lemmas counter old-theory state)))))</pre>
  </div>

<div class="form-block function" id="def-simplify-forms" data-defines="SIMPLIFY-FORMS" data-references="CONS,CAR,SIMPLIFY-FORM,NEW-THEORY,NEW-COUNTER,SIMP-FORM,ERP,MV-LET,T,CDR,&,DEFTHEORY,LOCAL,QUOTE,CASE-MATCH,REVERSE,MV,*STANDARD-CO*,NEWLINE,PPROGN,ENDP,COND,STATE,WRLD,ENS,OLD-THEORY,COUNTER,LEMMAS,DEFS,FORMS,DEFUN" data-used-by="TRANSFORM-DEFUNS-FN" data-part-name="SIMPLIFY-FORMS" data-part-args="STATE,WRLD,ENS,OLD-THEORY,COUNTER,LEMMAS,DEFS,FORMS" data-part-body="CONS,SIMPLIFY-FORMS,WRLD,ENS,OLD-THEORY,COUNTER,CAR,SIMPLIFY-FORM,NEW-THEORY,NEW-COUNTER,SIMP-FORM,ERP,MV-LET,T,CDR,&,DEFTHEORY,LOCAL,QUOTE,LEMMAS,CASE-MATCH,DEFS,REVERSE,MV,STATE,*STANDARD-CO*,NEWLINE,PPROGN,FORMS,ENDP,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="SIMPLIFY-FORMS">simplify-forms</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-simplify-forms" data-sym="SIMPLIFY-FORMS" title="(defun simplify-forms (forms defs lemmas counter old-theory ens wrld state)
  (cond
   ((endp forms)
    (pprogn (newline *standard-co* state)
            (mv nil (reverse defs)
...">simplify-forms</a>
  (forms defs lemmas counter old-theory ens wrld state)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> forms) (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link system" href="../../basis-a.html#def-newline" data-sym="NEWLINE">newline</a> <a class="sym-link system" href="../../axioms.html#def-_2Astandard-co_2A" data-sym="*STANDARD-CO*">*standard-co*</a> state)
        (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil
          (<a class="sym-link system" href="../../axioms.html#def-reverse" data-sym="REVERSE">reverse</a> defs)
          (<a class="sym-link system" href="../../basis-a.html#def-case-match" data-sym="CASE-MATCH">case-match</a> lemmas
            ((('<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> ('<a class="sym-link system" href="../../axioms.html#def-deftheory" data-sym="DEFTHEORY">deftheory</a> . &amp;)) . &amp;) (cdr lemmas))
            (&amp; lemmas))
          state)))
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (erp simp-form lemmas new-counter new-theory state)
        (<a class="sym-link local-def" href="#def-simplify-form" data-sym="SIMPLIFY-FORM" title="(defun simplify-form (form lemmas counter old-theory ens wrld state)
  (let ((car-form (and (consp form) (car form))))
    (case car-form
      ((defun defund)
       (simplify-defun nil form lemmas counter old-theory ens wrld state))
...">simplify-form</a> (car forms)
          lemmas
          counter
          old-theory
          ens
          wrld
          state)
        (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (erp (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> nil nil state))
          (simp-form (<a class="sym-link local-def" href="#def-simplify-forms" data-sym="SIMPLIFY-FORMS" title="(defun simplify-forms (forms defs lemmas counter old-theory ens wrld state)
  (cond
   ((endp forms)
    (pprogn (newline *standard-co* state)
            (mv nil (reverse defs)
...">simplify-forms</a> (cdr forms)
              (cons simp-form defs)
              lemmas
              new-counter
              new-theory
              ens
              wrld
              state))
          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link local-def" href="#def-simplify-forms" data-sym="SIMPLIFY-FORMS" title="(defun simplify-forms (forms defs lemmas counter old-theory ens wrld state)
  (cond
   ((endp forms)
    (pprogn (newline *standard-co* state)
            (mv nil (reverse defs)
...">simplify-forms</a> (cdr forms)
              defs
              lemmas
              new-counter
              new-theory
              ens
              wrld
              state)))))))</pre>
  </div>

<div class="form-block function" id="def-final-deftheory-1" data-defines="FINAL-DEFTHEORY-1" data-references="T,CDDAR,ENCAPSULATE,CADAR,CONS,CDR,DEFTHM,QUOTE,CAAR,EQ,ENDP,COND,ACC,LEMMAS,DEFUN" data-part-name="FINAL-DEFTHEORY-1" data-part-args="ACC,LEMMAS" data-part-body="T,CDDAR,ENCAPSULATE,CADAR,CONS,CDR,FINAL-DEFTHEORY-1,DEFTHM,QUOTE,CAAR,EQ,ACC,LEMMAS,ENDP,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FINAL-DEFTHEORY-1">final-deftheory-1</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-final-deftheory-1" data-sym="FINAL-DEFTHEORY-1" title="(defun final-deftheory-1 (lemmas acc)
  (cond ((endp lemmas) acc)
        ((eq (caar lemmas) &#39;defthm)
         (final-deftheory-1 (cdr lemmas) (cons (cadar lemmas) acc)))
        ((eq (caar lemmas) &#39;encapsulate)
...">final-deftheory-1</a>
  (lemmas acc)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> lemmas) acc)
    ((<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (<a class="sym-link system" href="../../axioms.html#def-caar" data-sym="CAAR">caar</a> lemmas) '<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a>) (<a class="sym-link local-def" href="#def-final-deftheory-1" data-sym="FINAL-DEFTHEORY-1" title="(defun final-deftheory-1 (lemmas acc)
  (cond ((endp lemmas) acc)
        ((eq (caar lemmas) &#39;defthm)
         (final-deftheory-1 (cdr lemmas) (cons (cadar lemmas) acc)))
        ((eq (caar lemmas) &#39;encapsulate)
...">final-deftheory-1</a> (cdr lemmas) (cons (<a class="sym-link system" href="../../axioms.html#def-cadar" data-sym="CADAR">cadar</a> lemmas) acc)))
    ((<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (<a class="sym-link system" href="../../axioms.html#def-caar" data-sym="CAAR">caar</a> lemmas) '<a class="sym-link system" href="../../axioms.html#def-encapsulate" data-sym="ENCAPSULATE">encapsulate</a>) (<a class="sym-link local-def" href="#def-final-deftheory-1" data-sym="FINAL-DEFTHEORY-1" title="(defun final-deftheory-1 (lemmas acc)
  (cond ((endp lemmas) acc)
        ((eq (caar lemmas) &#39;defthm)
         (final-deftheory-1 (cdr lemmas) (cons (cadar lemmas) acc)))
        ((eq (caar lemmas) &#39;encapsulate)
...">final-deftheory-1</a> (cdr lemmas)
        (<a class="sym-link local-def" href="#def-final-deftheory-1" data-sym="FINAL-DEFTHEORY-1" title="(defun final-deftheory-1 (lemmas acc)
  (cond ((endp lemmas) acc)
        ((eq (caar lemmas) &#39;defthm)
         (final-deftheory-1 (cdr lemmas) (cons (cadar lemmas) acc)))
        ((eq (caar lemmas) &#39;encapsulate)
...">final-deftheory-1</a> (<a class="sym-link system" href="../../axioms.html#def-cddar" data-sym="CDDAR">cddar</a> lemmas) acc)))
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link local-def" href="#def-final-deftheory-1" data-sym="FINAL-DEFTHEORY-1" title="(defun final-deftheory-1 (lemmas acc)
  (cond ((endp lemmas) acc)
        ((eq (caar lemmas) &#39;defthm)
         (final-deftheory-1 (cdr lemmas) (cons (cadar lemmas) acc)))
        ((eq (caar lemmas) &#39;encapsulate)
...">final-deftheory-1</a> (cdr lemmas) acc))))</pre>
  </div>

<div class="form-block function" id="def-final-deftheory" data-defines="FINAL-DEFTHEORY" data-references="MINIMAL-THEORY,THEORY,QUOTE,UNION-THEORIES,%-REMOVAL-THEORY,DEFTHEORY,QUASIQUOTE,LEMMAS,DEFUN" data-used-by="TRANSFORM-DEFUNS-FN" data-part-name="FINAL-DEFTHEORY" data-part-args="LEMMAS" data-part-body="MINIMAL-THEORY,THEORY,QUOTE,UNION-THEORIES,%-REMOVAL-THEORY,DEFTHEORY,QUASIQUOTE" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FINAL-DEFTHEORY">final-deftheory</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-final-deftheory" data-sym="FINAL-DEFTHEORY" title="(defun final-deftheory (lemmas)
  `(deftheory %-removal-theory
              (union-theories &#39;,(final-deftheory-1 lemmas nil)
                              (theory &#39;minimal-theory))))">final-deftheory</a>
  (lemmas)
  `(<a class="sym-link system" href="../../axioms.html#def-deftheory" data-sym="DEFTHEORY">deftheory</a> %-removal-theory
    (union-theories ',(FINAL-DEFTHEORY-1 LEMMAS NIL)
      (theory 'minimal-theory))))</pre>
  </div>

<div class="form-block function" id="def-initial-equality-events" data-defines="INITIAL-EQUALITY-EVENTS" data-references="LENGTH,&REST,%%AND-TREE,DEFMACRO,-,NTHCDR,TAKE,FLOOR,LEN2,LET*,AND,CONS,<,XARGS,LEN,ARGS,%%AND-TREE-FN,1-,ZP,IF,N,%%SUB1-INDUCTION,LOCAL,QUOTE,CAR,LIST,IGNORE,DECLARE,OUT-DEFS,IN-DEFS,DEFUN" data-used-by="TRANSFORM-DEFUNS-FN" data-part-name="INITIAL-EQUALITY-EVENTS" data-part-args="OUT-DEFS,IN-DEFS" data-part-declare="OUT-DEFS,IGNORE,DECLARE" data-part-body="LENGTH,&REST,%%AND-TREE,DEFMACRO,-,NTHCDR,TAKE,FLOOR,LEN2,LET*,AND,CONS,<,XARGS,DECLARE,LEN,ARGS,%%AND-TREE-FN,1-,ZP,IF,N,%%SUB1-INDUCTION,DEFUN,LOCAL,QUOTE,IN-DEFS,CAR,LIST" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="INITIAL-EQUALITY-EVENTS">initial-equality-events</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-initial-equality-events" data-sym="INITIAL-EQUALITY-EVENTS" title="(defun initial-equality-events (in-defs out-defs)
  (declare (ignore out-defs))
  (list (car in-defs)
        &#39;(local
          (defun %%sub1-induction (n)
...">initial-equality-events</a>
  (in-defs out-defs)
  (declare (ignore out-defs))
  (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (car in-defs)
    '(<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> %%sub1-induction
        (n)
        (if (<a class="sym-link system" href="../../axioms.html#def-zp" data-sym="ZP">zp</a> n)
          n
          (%%sub1-induction (<a class="sym-link system" href="../../axioms.html#def-1-" data-sym="1-">1-</a> n)))))
    '(<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> %%and-tree-fn
        (<a class="sym-link system" href="../../defuns.html#def-args" data-sym="ARGS">args</a> <a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a>)
        (declare (xargs <span class="keyword">:mode</span> <span class="keyword">:program</span>))
        (if (&lt; <a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> <span class="number">20</span>)
          (cons '<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> <a class="sym-link system" href="../../defuns.html#def-args" data-sym="ARGS">args</a>)
          (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((len2 (floor <a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> <span class="number">2</span>)))
            (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> '<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a>
              (%%and-tree-fn (<a class="sym-link system" href="../../axioms.html#def-take" data-sym="TAKE">take</a> len2 <a class="sym-link system" href="../../defuns.html#def-args" data-sym="ARGS">args</a>) len2)
              (%%and-tree-fn (<a class="sym-link system" href="../../axioms.html#def-nthcdr" data-sym="NTHCDR">nthcdr</a> len2 <a class="sym-link system" href="../../defuns.html#def-args" data-sym="ARGS">args</a>) (<a class="sym-link system" href="../../axioms.html#def--" data-sym="-">-</a> <a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> len2)))))))
    '(<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> %%and-tree
        (&amp;rest <a class="sym-link system" href="../../defuns.html#def-args" data-sym="ARGS">args</a>)
        (%%and-tree-fn <a class="sym-link system" href="../../defuns.html#def-args" data-sym="ARGS">args</a> (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> <a class="sym-link system" href="../../defuns.html#def-args" data-sym="ARGS">args</a>))))))</pre>
  </div>

<div class="form-block include-book" id="form-36" typeof="Code">
    <div class="form-header"><span class="form-type">include-book</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="file-io.html" title="Open file-io">"file-io"</a>)</pre>
  </div>

<div class="form-block function" id="def-write-lemma-file" data-defines="WRITE-LEMMA-FILE" data-references="APPEND,CAR,CONS,WRITE-LIST,W,STRIP-PERCENTS-FROM-LEMMAS,OUT-LEMMAS,READ-LIST,IN-LEMMAS,ER-LET*,STATE,CTX,INITIAL-EVENTS,OUTFILE,INFILE,DEFUN" data-used-by="WRITE-LEMMA-FILES" data-part-name="WRITE-LEMMA-FILE" data-part-args="STATE,CTX,INITIAL-EVENTS,OUTFILE,INFILE" data-part-body="OUTFILE,INITIAL-EVENTS,APPEND,CAR,CONS,WRITE-LIST,W,STRIP-PERCENTS-FROM-LEMMAS,OUT-LEMMAS,STATE,CTX,INFILE,READ-LIST,IN-LEMMAS,ER-LET*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="WRITE-LEMMA-FILE">write-lemma-file</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-write-lemma-file" data-sym="WRITE-LEMMA-FILE" title="(defun write-lemma-file (infile outfile initial-events ctx state)
  (er-let*
   ((in-lemmas (read-list infile ctx state))
    (out-lemmas
     (strip-percents-from-lemmas in-lemmas nil ctx (w state) state)))
...">write-lemma-file</a>
  (infile outfile initial-events ctx state)
  (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((in-lemmas (<a class="sym-link external" href="file-io.html#def-read-list" data-sym="READ-LIST">read-list</a> infile ctx state)) (out-lemmas (<a class="sym-link local-def" href="#def-strip-percents-from-lemmas" data-sym="STRIP-PERCENTS-FROM-LEMMAS" title="(defun strip-percents-from-lemmas (lemmas acc ctx wrld state)
  (if (endp lemmas)
      (value (reverse acc))
      (er-let*
       ((new-lemma (strip-percents-from-lemma (car lemmas) ctx wrld state)))
...">strip-percents-from-lemmas</a> in-lemmas
          nil
          ctx
          (<a class="sym-link system" href="../../axioms.html#def-w" data-sym="W">w</a> state)
          state)))
    (<a class="sym-link external" href="file-io.html#def-write-list" data-sym="WRITE-LIST">write-list</a> (cons (car in-lemmas) (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> initial-events out-lemmas))
      outfile
      ctx
      state)))</pre>
  </div>

<div class="form-block function" id="def-write-lemma-files" data-defines="WRITE-LEMMA-FILES" data-references="CDR,IGNORE,DECLARE,CDDAR,CADAR,CAAR,WRITE-LEMMA-FILE,VAL,MV-LET,MV,ENDP,IF,STATE,CTX,ERP,THM-FILE-PAIRS,DEFUN" data-used-by="TRANSFORM-DEFUNS-FN" data-part-name="WRITE-LEMMA-FILES" data-part-args="STATE,CTX,ERP,THM-FILE-PAIRS" data-part-body="CDR,WRITE-LEMMA-FILES,IGNORE,DECLARE,CTX,CDDAR,CADAR,CAAR,WRITE-LEMMA-FILE,VAL,MV-LET,STATE,ERP,MV,THM-FILE-PAIRS,ENDP,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="WRITE-LEMMA-FILES">write-lemma-files</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-write-lemma-files" data-sym="WRITE-LEMMA-FILES" title="(defun write-lemma-files (thm-file-pairs erp ctx state)
  (if (endp thm-file-pairs)
      (mv erp nil state)
      (mv-let (erp val state)
              (write-lemma-file (caar thm-file-pairs) (cadar thm-file-pairs)
...">write-lemma-files</a>
  (thm-file-pairs erp ctx state)
  (if (<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> thm-file-pairs)
    (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> erp nil state)
    (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (erp val state)
      (<a class="sym-link local-def" href="#def-write-lemma-file" data-sym="WRITE-LEMMA-FILE" title="(defun write-lemma-file (infile outfile initial-events ctx state)
  (er-let*
   ((in-lemmas (read-list infile ctx state))
    (out-lemmas
     (strip-percents-from-lemmas in-lemmas nil ctx (w state) state)))
...">write-lemma-file</a> (<a class="sym-link system" href="../../axioms.html#def-caar" data-sym="CAAR">caar</a> thm-file-pairs)
        (<a class="sym-link system" href="../../axioms.html#def-cadar" data-sym="CADAR">cadar</a> thm-file-pairs)
        (<a class="sym-link system" href="../../axioms.html#def-cddar" data-sym="CDDAR">cddar</a> thm-file-pairs)
        ctx
        state)
      (declare (ignore val))
      (<a class="sym-link local-def" href="#def-write-lemma-files" data-sym="WRITE-LEMMA-FILES" title="(defun write-lemma-files (thm-file-pairs erp ctx state)
  (if (endp thm-file-pairs)
      (mv erp nil state)
      (mv-let (erp val state)
              (write-lemma-file (caar thm-file-pairs) (cadar thm-file-pairs)
...">write-lemma-files</a> (cdr thm-file-pairs) erp ctx state))))</pre>
  </div>

<div class="form-block function" id="def-transform-defuns-fn" data-defines="TRANSFORM-DEFUNS-FN" data-references="WRITE-LEMMA-FILES,FINAL-DEFTHEORY,CONS,REVERSE,INITIAL-EQUALITY-EVENTS,VALUE,SET-BOGUS-MUTUAL-RECURSION-OK,SET-IRRELEVANT-FORMALS-OK,T,SET-IGNORE-OK,CAR,APPEND,WRITE-LIST,ER-PROGN,MV,W,ENS,LIST,SIMPLIFY-FORMS,OR,LEMMAS,OUT-DEFS,SILENT-ERROR,IF,READ-LIST,IN-DEFS,ERP,MV-LET,MINIMAL-THEORY,THEORY,THEORY-0,DEFTHEORY,LOCAL,FIRST-LEMMA,TRANSFORM-DEFUNS,QUOTE,CTX,LET,STATE,THM-FILE-PAIRS,EXTRA-INITIAL-EVENTS-FOR-LEMMAS,EXTRA-INITIAL-EVENTS-FOR-DEFS,EQUALITIES-FILE,OUT-DEFS-FILE,IN-DEFS-FILE,DEFUN" data-used-by="TRANSFORM-DEFUNS" data-part-name="TRANSFORM-DEFUNS-FN" data-part-args="STATE,THM-FILE-PAIRS,EXTRA-INITIAL-EVENTS-FOR-LEMMAS,EXTRA-INITIAL-EVENTS-FOR-DEFS,EQUALITIES-FILE,OUT-DEFS-FILE,IN-DEFS-FILE" data-part-body="THM-FILE-PAIRS,WRITE-LEMMA-FILES,FINAL-DEFTHEORY,CONS,REVERSE,EXTRA-INITIAL-EVENTS-FOR-LEMMAS,INITIAL-EQUALITY-EVENTS,VALUE,EXTRA-INITIAL-EVENTS-FOR-DEFS,SET-BOGUS-MUTUAL-RECURSION-OK,SET-IRRELEVANT-FORMALS-OK,T,SET-IGNORE-OK,CAR,APPEND,WRITE-LIST,ER-PROGN,MV,W,ENS,LIST,SIMPLIFY-FORMS,EQUALITIES-FILE,OUT-DEFS-FILE,OR,LEMMAS,OUT-DEFS,SILENT-ERROR,IF,IN-DEFS-FILE,READ-LIST,STATE,IN-DEFS,ERP,MV-LET,MINIMAL-THEORY,THEORY,THEORY-0,DEFTHEORY,LOCAL,FIRST-LEMMA,TRANSFORM-DEFUNS,QUOTE,CTX,LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="TRANSFORM-DEFUNS-FN">transform-defuns-fn</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-transform-defuns-fn" data-sym="TRANSFORM-DEFUNS-FN" title="(defun transform-defuns-fn
       (in-defs-file out-defs-file equalities-file
        extra-initial-events-for-defs extra-initial-events-for-lemmas
        thm-file-pairs state)
  (let ((ctx &#39;transform-defuns)
...">transform-defuns-fn</a>
  (in-defs-file out-defs-file
    equalities-file
    extra-initial-events-for-defs
    extra-initial-events-for-lemmas
    thm-file-pairs
    state)
  (let ((ctx '<a class="sym-link local-def" href="#def-transform-defuns" data-sym="TRANSFORM-DEFUNS" title="(defmacro transform-defuns
          (in-defs-file
           &amp;key out-defs equalities defs-extra eq-extra thm-file-pairs)
  `(transform-defuns-fn ,in-defs-file ,out-defs ,equalities ,defs-extra
    ,eq-extra ,thm-file-pairs state))">transform-defuns</a>) (first-lemma '(<a class="sym-link system" href="../../axioms.html#def-local" data-sym="LOCAL">local</a> (<a class="sym-link system" href="../../axioms.html#def-deftheory" data-sym="DEFTHEORY">deftheory</a> theory-0 (theory 'minimal-theory)))))
    (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (erp in-defs state)
      (<a class="sym-link external" href="file-io.html#def-read-list" data-sym="READ-LIST">read-list</a> in-defs-file ctx state)
      (if erp
        (silent-error state)
        (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (erp out-defs lemmas state)
          (if (<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> out-defs-file equalities-file)
            (<a class="sym-link local-def" href="#def-simplify-forms" data-sym="SIMPLIFY-FORMS" title="(defun simplify-forms (forms defs lemmas counter old-theory ens wrld state)
  (cond
   ((endp forms)
    (pprogn (newline *standard-co* state)
            (mv nil (reverse defs)
...">simplify-forms</a> in-defs
              nil
              (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> first-lemma)
              <span class="number">0</span>
              'theory-0
              (ens state)
              (<a class="sym-link system" href="../../axioms.html#def-w" data-sym="W">w</a> state)
              state)
            (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil nil nil state))
          (if erp
            (silent-error state)
            (<a class="sym-link system" href="../../axioms.html#def-er-progn" data-sym="ER-PROGN">er-progn</a> (if out-defs-file
                (<a class="sym-link external" href="file-io.html#def-write-list" data-sym="WRITE-LIST">write-list</a> (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (car in-defs)
                      '(<a class="sym-link system" href="../../axioms.html#def-set-ignore-ok" data-sym="SET-IGNORE-OK">set-ignore-ok</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>)
                      '(<a class="sym-link system" href="../../axioms.html#def-set-irrelevant-formals-ok" data-sym="SET-IRRELEVANT-FORMALS-OK">set-irrelevant-formals-ok</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>)
                      '(<a class="sym-link system" href="../../axioms.html#def-set-bogus-mutual-recursion-ok" data-sym="SET-BOGUS-MUTUAL-RECURSION-OK">set-bogus-mutual-recursion-ok</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>))
                    extra-initial-events-for-defs
                    out-defs)
                  out-defs-file
                  ctx
                  state)
                (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> nil))
              (if equalities-file
                (<a class="sym-link external" href="file-io.html#def-write-list" data-sym="WRITE-LIST">write-list</a> (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link local-def" href="#def-initial-equality-events" data-sym="INITIAL-EQUALITY-EVENTS" title="(defun initial-equality-events (in-defs out-defs)
  (declare (ignore out-defs))
  (list (car in-defs)
        &#39;(local
          (defun %%sub1-induction (n)
...">initial-equality-events</a> in-defs out-defs)
                    extra-initial-events-for-lemmas
                    (<a class="sym-link system" href="../../axioms.html#def-reverse" data-sym="REVERSE">reverse</a> (cons (<a class="sym-link local-def" href="#def-final-deftheory" data-sym="FINAL-DEFTHEORY" title="(defun final-deftheory (lemmas)
  `(deftheory %-removal-theory
              (union-theories &#39;,(final-deftheory-1 lemmas nil)
                              (theory &#39;minimal-theory))))">final-deftheory</a> lemmas) lemmas)))
                  equalities-file
                  ctx
                  state)
                (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> nil))
              (<a class="sym-link local-def" href="#def-write-lemma-files" data-sym="WRITE-LEMMA-FILES" title="(defun write-lemma-files (thm-file-pairs erp ctx state)
  (if (endp thm-file-pairs)
      (mv erp nil state)
      (mv-let (erp val state)
              (write-lemma-file (caar thm-file-pairs) (cadar thm-file-pairs)
...">write-lemma-files</a> thm-file-pairs nil ctx state))))))))</pre>
  </div>

<div class="form-block macro" id="def-transform-defuns" data-defines="TRANSFORM-DEFUNS" data-references="STATE,TRANSFORM-DEFUNS-FN,QUASIQUOTE,THM-FILE-PAIRS,EQ-EXTRA,DEFS-EXTRA,EQUALITIES,OUT-DEFS,&KEY,IN-DEFS-FILE,DEFMACRO" data-used-by="TRANSFORM-DEFUNS-FN" typeof="Code">
    <div class="form-header"><span class="form-name" property="name" data-sym="TRANSFORM-DEFUNS">transform-defuns</span><span class="form-type">macro</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> <a class="sym-link local-def" href="#def-transform-defuns" data-sym="TRANSFORM-DEFUNS" title="(defmacro transform-defuns
          (in-defs-file
           &amp;key out-defs equalities defs-extra eq-extra thm-file-pairs)
  `(transform-defuns-fn ,in-defs-file ,out-defs ,equalities ,defs-extra
    ,eq-extra ,thm-file-pairs state))">transform-defuns</a>
  (in-defs-file &amp;key
    out-defs
    equalities
    defs-extra
    eq-extra
    thm-file-pairs)
  `(<a class="sym-link local-def" href="#def-transform-defuns-fn" data-sym="TRANSFORM-DEFUNS-FN" title="(defun transform-defuns-fn
       (in-defs-file out-defs-file equalities-file
        extra-initial-events-for-defs extra-initial-events-for-lemmas
        thm-file-pairs state)
  (let ((ctx &#39;transform-defuns)
...">transform-defuns-fn</a> ,IN-DEFS-FILE
    ,OUT-DEFS
    ,EQUALITIES
    ,DEFS-EXTRA
    ,EQ-EXTRA
    ,THM-FILE-PAIRS
    state))</pre>
  </div>


  </main>
  
<script>
// ACL2 Book HTML Documentation - Interactive Features
// Generated by cert2 - build2 system

// State
let activeFilter = null;
let activePartFilter = null;
let activeNameFilter = null;
let currentFontSize = 14;

// Theme management
function getStoredTheme() {
  return localStorage.getItem('acl2-theme') || 'dark';
}

function setTheme(theme) {
  if (theme === 'light') {
    document.documentElement.setAttribute('data-theme', 'light');
    document.getElementById('theme-toggle').textContent = '🌙';
  } else {
    document.documentElement.removeAttribute('data-theme');
    document.getElementById('theme-toggle').textContent = '☀️';
  }
  localStorage.setItem('acl2-theme', theme);
}

function toggleTheme() {
  const current = getStoredTheme();
  setTheme(current === 'dark' ? 'light' : 'dark');
}

// Font size management
function getStoredFontSize() {
  return parseInt(localStorage.getItem('acl2-fontsize') || '14', 10);
}

function setFontSize(size) {
  size = Math.max(10, Math.min(24, size)); // Clamp between 10-24
  currentFontSize = size;
  document.body.style.fontSize = size + 'px';
  localStorage.setItem('acl2-fontsize', size.toString());
}

function increaseFontSize() {
  setFontSize(currentFontSize + 2);
}

function decreaseFontSize() {
  setFontSize(currentFontSize - 2);
}

// Get all form blocks
function getFormBlocks() {
  return document.querySelectorAll('.form-block');
}

// Clear all filters
function clearFilter() {
  activeFilter = null;
  activePartFilter = null;
  activeNameFilter = null;
  getFormBlocks().forEach(b => {
    b.classList.remove('hidden', 'dimmed');
  });
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  const status = document.querySelector('.filter-status');
  status.classList.remove('active');
  // Slide name filter back to original position
  document.querySelector('.controls-left').style.transform = '';
  // Clear the name filter input
  const nameInput = document.getElementById('name-filter');
  if (nameInput) nameInput.value = '';
}

// Show filter status and slide name filter right
function showFilterStatus(text) {
  const status = document.querySelector('.filter-status');
  status.classList.add('active');
  status.querySelector('.filter-text').textContent = text;
  // Slide name filter to the right to make room
  setTimeout(() => {
    const statusWidth = status.offsetWidth;
    document.querySelector('.controls-left').style.transform = `translateX(${statusWidth + 15}px)`;
  }, 10);
}

// Filter to show only forms that define or reference a symbol
function filterBySymbol(symName, showUsedBy) {
  clearFilter();
  activeFilter = symName;
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines;
    const references = (block.dataset.references || '').split(',');
    const usedBy = (block.dataset.usedBy || '').split(',');
    
    let show = false;
    if (showUsedBy) {
      // Show forms that USE this symbol
      show = references.includes(symName) || definesName === symName;
    } else {
      // Show forms that this symbol USES
      show = usedBy.includes(symName) || definesName === symName;
    }
    
    if (show) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering by: ${symName} (${visibleCount} items)`);
}

// Filter by defthm part (term, hints, rule-classes, etc.)
function filterByPart(formId, partName) {
  clearFilter();
  activePartFilter = { formId, partName };
  
  // Get the part's referenced symbols
  // data-part-term becomes dataset.partTerm, data-part-hints becomes dataset.partHints, etc.
  const block = document.getElementById(formId);
  const datasetKey = 'part' + partName.charAt(0).toUpperCase() + partName.slice(1).replace(/-([a-z])/g, (g) => g[1].toUpperCase());
  const partData = block.dataset[datasetKey];
  if (!partData) return;
  
  const partSyms = partData.split(',').filter(s => s);
  
  // Highlight the button
  block.querySelector(`.part-btn[data-part="${partName}"]`).classList.add('active');
  
  // Hide forms not referenced by this part
  getFormBlocks().forEach(b => {
    const definesName = b.dataset.defines;
    if (b.id === formId || partSyms.includes(definesName)) {
      b.classList.remove('hidden');
    } else {
      b.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering ${formId} :${partName} (${partSyms.length} references)`);
}

// Filter by name (substring or regex)
function filterByName(pattern, useRegex) {
  // Clear other filters but keep the input value
  activeFilter = null;
  activePartFilter = null;
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  
  if (!pattern || pattern.trim() === '') {
    // Empty pattern - show all
    activeNameFilter = null;
    getFormBlocks().forEach(b => b.classList.remove('hidden'));
    const status = document.querySelector('.filter-status');
    status.classList.remove('active');
    document.querySelector('.controls-left').style.transform = '';
    return;
  }
  
  activeNameFilter = pattern;
  
  let matcher;
  let isValidRegex = true;
  
  if (useRegex) {
    try {
      matcher = new RegExp(pattern, 'i');
    } catch (e) {
      // Invalid regex - show error in status and don't filter
      showFilterStatus(`Invalid regex: ${e.message}`);
      return;
    }
  } else {
    // Plain substring match (case-insensitive)
    const lowerPattern = pattern.toLowerCase();
    matcher = { test: (s) => s.toLowerCase().includes(lowerPattern) };
  }
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines || '';
    if (matcher.test(definesName)) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  const modeText = useRegex ? 'regex' : 'name';
  showFilterStatus(`Filtering by ${modeText}: "${pattern}" (${visibleCount} matches)`);
}

// Click on a name to show what references it
function handleNameClick(symName) {
  if (activeFilter === symName) {
    clearFilter();
  } else {
    filterBySymbol(symName, true);
  }
}

// Navigate to a definition (same file or different)
function navigateTo(symName, file) {
  if (file) {
    // External file - navigate
    window.location.href = file + '.html#def-' + symName.toLowerCase();
  } else {
    // Same file - scroll
    const target = document.getElementById('def-' + symName.toLowerCase());
    if (target) {
      target.scrollIntoView({ behavior: 'smooth', block: 'center' });
      target.classList.add('highlight');
      setTimeout(() => target.classList.remove('highlight'), 400);
    }
  }
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  // Part buttons
  document.querySelectorAll('.part-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const formId = btn.closest('.form-block').id;
      const partName = btn.dataset.part;
      if (activePartFilter && activePartFilter.formId === formId && 
          activePartFilter.partName === partName) {
        clearFilter();
      } else {
        filterByPart(formId, partName);
      }
    });
  });
  
  // Clear filter button
  document.querySelector('.clear-filter').addEventListener('click', clearFilter);
  
  // Name filter input
  const nameFilter = document.getElementById('name-filter');
  const regexToggle = document.getElementById('regex-toggle');
  
  let filterTimeout = null;
  nameFilter.addEventListener('input', () => {
    // Debounce the filter to avoid excessive updates while typing
    clearTimeout(filterTimeout);
    filterTimeout = setTimeout(() => {
      filterByName(nameFilter.value, regexToggle.checked);
    }, 150);
  });
  
  // Re-filter when regex toggle changes
  regexToggle.addEventListener('change', () => {
    if (nameFilter.value) {
      filterByName(nameFilter.value, regexToggle.checked);
    }
  });
  
  // Allow Escape key to clear filter when in input
  nameFilter.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      clearFilter();
      nameFilter.blur();
    }
  });
  
  // Symbol references (old span-based refs)
  document.querySelectorAll('.sym-ref').forEach(ref => {
    ref.addEventListener('click', (e) => {
      e.stopPropagation();
      const sym = ref.dataset.sym;
      const file = ref.dataset.file;
      if (file) {
        navigateTo(sym, file);
      } else {
        handleNameClick(sym);
      }
    });
  });
  
  // Symbol links (new anchor-based links)
  // These use standard <a> tags so navigation happens automatically
  // But we need to clear filters if target would be hidden
  document.querySelectorAll('.sym-link').forEach(link => {
    link.addEventListener('click', (e) => {
      const href = link.getAttribute('href');
      if (href && href.startsWith('#')) {
        // Local link - check if target is hidden by filter
        const targetId = href.substring(1);
        const target = document.getElementById(targetId);
        if (target) {
          // If target is hidden, clear the filter first
          if (target.classList.contains('hidden')) {
            clearFilter();
          }
          // Add highlight effect after a short delay
          setTimeout(() => {
            target.classList.add('highlight');
            setTimeout(() => target.classList.remove('highlight'), 400);
          }, 100);
        }
      }
      // For external links, default behavior handles navigation
    });
  });
  
  // Form names (show what uses them)
  document.querySelectorAll('.form-name').forEach(name => {
    name.addEventListener('click', (e) => {
      handleNameClick(name.dataset.sym);
    });
  });
  
  // Handle hash navigation (when arriving at page with #anchor)
  if (window.location.hash) {
    const target = document.querySelector(window.location.hash);
    if (target) {
      setTimeout(() => {
        target.scrollIntoView({ behavior: 'smooth', block: 'center' });
        target.classList.add('highlight');
        setTimeout(() => target.classList.remove('highlight'), 400);
      }, 200);
    }
  }
  
  // Initialize theme from storage
  setTheme(getStoredTheme());
  
  // Initialize font size from storage
  currentFontSize = getStoredFontSize();
  setFontSize(currentFontSize);
  
  // Theme toggle button
  document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
  
  // Font size buttons
  document.getElementById('font-larger').addEventListener('click', increaseFontSize);
  document.getElementById('font-smaller').addEventListener('click', decreaseFontSize);
});

</script>

</body>
</html>
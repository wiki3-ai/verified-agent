<!DOCTYPE html>
<html lang="en" vocab="http://schema.org/" typeof="SoftwareSourceCode">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>utilities - ACL2 Book</title>
  <meta property="name" content="utilities">
  <meta property="programmingLanguage" content="ACL2">
  
<style>
/* ACL2 Book HTML Documentation Styles */
/* Generated by cert2 - build2 system */

/* Dark theme (default) */
:root {
  --bg: #1e1e2e;
  --fg: #cdd6f4;
  --comment: #6c7086;
  --keyword: #cba6f7;
  --string: #a6e3a1;
  --function: #89b4fa;
  --type: #f9e2af;
  --link: #89dceb;
  --link-hover: #f5c2e7;
  --highlight: rgba(137, 180, 250, 0.2);
  --border: #313244;
  --block-bg: rgba(49, 50, 68, 0.5);
  --btn-bg: #313244;
  --btn-hover: rgba(137, 180, 250, 0.2);
}

/* Light theme */
[data-theme="light"] {
  --bg: #eff1f5;
  --fg: #4c4f69;
  --comment: #6c6f85;
  --keyword: #8839ef;
  --string: #40a02b;
  --function: #1e66f5;
  --type: #df8e1d;
  --link: #04a5e5;
  --link-hover: #ea76cb;
  --highlight: rgba(30, 102, 245, 0.15);
  --border: #ccd0da;
  --block-bg: rgba(204, 208, 218, 0.3);
  --btn-bg: #ccd0da;
  --btn-hover: rgba(30, 102, 245, 0.15);
}

body {
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  background: var(--bg);
  color: var(--fg);
  margin: 0;
  padding: 20px;
  line-height: 1.6;
  font-size: 14px;
  transition: background 0.1s, color 0.1s;
}

/* Controls toolbar */
.controls-left {
  position: fixed;
  top: 10px;
  left: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
  transition: transform 0.1s ease;
}

.controls-right {
  position: fixed;
  top: 10px;
  right: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
}

.control-btn {
  padding: 6px 12px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-family: inherit;
  font-size: 14px;
  transition: all 0.1s;
}

.control-btn:hover {
  background: var(--btn-hover);
  border-color: var(--link);
}

.name-filter {
  padding: 6px 10px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  font-family: inherit;
  font-size: 13px;
  width: 150px;
  transition: all 0.1s;
}

.name-filter:focus {
  outline: none;
  border-color: var(--link);
  width: 200px;
}

.name-filter::placeholder {
  color: var(--comment);
}

.regex-label {
  display: flex;
  align-items: center;
  gap: 4px;
  color: var(--comment);
  font-size: 12px;
  cursor: pointer;
}

.regex-label input {
  cursor: pointer;
}

.book-header {
  border-bottom: 2px solid var(--border);
  padding-bottom: 20px;
  margin-bottom: 20px;
}

.book-header h1 {
  color: var(--keyword);
  margin: 0;
}

.book-header .path {
  color: var(--comment);
  font-size: 0.9em;
}

.book-header .path .source-link {
  color: var(--comment);
  text-decoration: none;
}

.book-header .path .source-link:hover {
  color: var(--link);
  text-decoration: underline;
}

.form-block {
  margin: 10px 0;
  padding: 15px;
  background: var(--block-bg);
  border-radius: 8px;
  border-left: 3px solid var(--border);
}

.form-block.theorem { border-left-color: var(--keyword); }
.form-block.function { border-left-color: var(--function); }
.form-block.macro { border-left-color: var(--type); }
.form-block.include-book { border-left-color: var(--string); }

.form-block.hidden { display: none; }
.form-block.dimmed { opacity: 0.3; }

.form-block.highlight {
  animation: highlight-pulse 0.4s ease-out;
}

@keyframes highlight-pulse {
  0% { background: var(--highlight); box-shadow: 0 0 20px var(--link); }
  100% { background: rgba(49, 50, 68, 0.5); box-shadow: none; }
}

.form-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.form-name {
  color: var(--function);
  font-weight: bold;
  cursor: pointer;
}

.form-name:hover {
  color: var(--link-hover);
  text-decoration: underline;
}

.form-type {
  color: var(--comment);
  font-size: 0.85em;
}

pre.code {
  margin: 0;
  overflow-x: auto;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.sym-ref {
  color: var(--link);
  cursor: pointer;
  border-radius: 2px;
}

.sym-ref:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.sym-ref.local-def { color: var(--function); font-weight: bold; }
.sym-ref.external { color: var(--type); }

/* Symbol links (clickable hyperlinks) */
.sym-link {
  color: var(--link);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
  position: relative;
}

.sym-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

.sym-link.local-def {
  color: var(--function);
  font-weight: bold;
}

.sym-link.external {
  color: var(--type);
}

/* Tooltips using title attribute with custom styling */
.sym-link[title] {
  /* Browser will show title on hover */
}

/* Syntax highlighting in code blocks */
.keyword {
  color: var(--keyword);
}

.string {
  color: var(--string);
}

.number {
  color: #f77524; /* orange */
}

/* Include-book path links */
.include-path {
  color: var(--string);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
}

.include-path:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

/* Part buttons for defthm */
.part-buttons {
  display: flex;
  gap: 5px;
  margin: 10px 0;
  flex-wrap: wrap;
}

.part-btn {
  padding: 4px 10px;
  background: var(--border);
  border: 1px solid var(--comment);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-size: 0.85em;
  font-family: inherit;
}

.part-btn:hover {
  background: var(--highlight);
  border-color: var(--link);
}

.part-btn.active {
  background: var(--link);
  color: var(--bg);
  border-color: var(--link);
}

/* References panel */
.refs-panel {
  margin-top: 10px;
  padding: 10px;
  background: rgba(0,0,0,0.2);
  border-radius: 4px;
  display: none;
}

.refs-panel.visible { display: block; }

.refs-panel h4 {
  margin: 0 0 5px 0;
  color: var(--comment);
  font-size: 0.9em;
}

.refs-list {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

/* Included books section */
.includes-section {
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(49, 50, 68, 0.3);
  border-radius: 8px;
  border: 1px solid var(--border);
}

.includes-section h2 {
  margin: 0 0 10px 0;
  color: var(--comment);
  font-size: 1em;
  font-weight: normal;
}

.includes-list {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.include-link {
  padding: 6px 12px;
  background: var(--border);
  border-radius: 4px;
  color: var(--link);
  text-decoration: none;
  font-size: 0.9em;
  transition: all 0.1s;
}

.include-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.include-link.local {
  border-left: 2px solid var(--comment);
}

/* Filter status */
.filter-status {
  position: fixed;
  top: 10px;
  left: 20px;
  background: var(--bg);
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: 4px;
  z-index: 201;
  display: none;
  align-items: center;
  gap: 10px;
}

.filter-status.active {
  display: flex;
  align-items: center;
  gap: 10px;
}

.clear-filter {
  padding: 5px 15px;
  background: var(--keyword);
  color: var(--bg);
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

/* RDFa vocab indicator */
[vocab] { /* semantic web annotations present */ }

</style>

</head>
<body>
  <div class="controls-left">
    <input type="text" id="name-filter" class="name-filter" placeholder="Filter by name..." title="Filter definitions by name">
    <label class="regex-label"><input type="checkbox" id="regex-toggle"> regex</label>
  </div>

  <div class="controls-right">
    <button class="control-btn" id="theme-toggle" title="Toggle light/dark theme">☀️</button>
    <button class="control-btn" id="font-smaller" title="Decrease font size">A-</button>
    <button class="control-btn" id="font-larger" title="Increase font size">A+</button>
  </div>

  <div class="filter-status">
    <span class="filter-text">Filtering...</span>
    <button class="clear-filter">Clear Filter</button>
  </div>
  
  <div class="book-header">
    <h1 property="name">utilities</h1>
    <div class="path"><a href="utilities.lisp" class="source-link">books/data-structures/utilities</a></div>
  </div>
  
  <main property="text">
<div class="form-block other" id="form-0" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-in-package" data-sym="IN-PACKAGE">in-package</a> <span class="string">"U"</span>)</pre>
  </div>

<div class="form-block other" id="form-1" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../xdoc/top.html" title="Open xdoc/top">"xdoc/top"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block other" id="form-2" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc utilities
  <span class="keyword">:parents</span> (data-structures)
  <span class="keyword">:short</span> <span class="string">"A book of utility functions residing in the package &quot;U&quot;."</span>)</pre>
  </div>

<div class="form-block function" id="def-import-as-macros-fn" data-defines="IMPORT-AS-MACROS-FN" data-references="CDR,QUOTE,FORMS,&REST,DEFMACRO,QUASIQUOTE,CAR,SYM,LET,CONS,T,ATOM,COND,SYMBOL-LISTP,SYMBOLP,AND,XARGS,DECLARE,SYMBOLS,PACKAGE-SYMBOL,DEFUN" data-part-name="IMPORT-AS-MACROS-FN" data-part-args="SYMBOLS,PACKAGE-SYMBOL" data-part-declare="SYMBOLS,SYMBOL-LISTP,PACKAGE-SYMBOL,SYMBOLP,AND,XARGS,DECLARE" data-part-body="CDR,PACKAGE-SYMBOL,IMPORT-AS-MACROS-FN,QUOTE,FORMS,&REST,DEFMACRO,QUASIQUOTE,CAR,SYM,LET,CONS,T,SYMBOLS,ATOM,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="IMPORT-AS-MACROS-FN">import-as-macros-fn</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-import-as-macros-fn" data-sym="IMPORT-AS-MACROS-FN" title="(defun u::import-as-macros-fn (u::package-symbol u::symbols)
  (declare
   (u::xargs :guard (and (symbolp u::package-symbol) (symbol-listp u::symbols))
    :verify-guards nil))
  (cond ((atom u::symbols) nil)
...">import-as-macros-fn</a>
  (package-symbol symbols)
  (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (symbolp package-symbol) (<a class="sym-link system" href="../../axioms.html#def-symbol-listp" data-sym="SYMBOL-LISTP">symbol-listp</a> symbols))
      <span class="keyword">:verify-guards</span> nil))
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> symbols) nil)
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (cons (let ((sym (car symbols)))
          `(<a class="sym-link system" href="../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> ,U::SYM
            (&amp;rest forms)
            (cons ',(INTERN-IN-PACKAGE-OF-SYMBOL (STRING U::SYM) U::PACKAGE-SYMBOL)
              forms)))
        (<a class="sym-link local-def" href="#def-import-as-macros-fn" data-sym="IMPORT-AS-MACROS-FN" title="(defun u::import-as-macros-fn (u::package-symbol u::symbols)
  (declare
   (u::xargs :guard (and (symbolp u::package-symbol) (symbol-listp u::symbols))
    :verify-guards nil))
  (cond ((atom u::symbols) nil)
...">import-as-macros-fn</a> package-symbol (cdr symbols))))))</pre>
  </div>

<div class="form-block macro" id="def-import-as-macros" data-defines="IMPORT-AS-MACROS" data-references="PROGN,QUASIQUOTE,SYMBOLS,&REST,PACKAGE-SYMBOL,DEFMACRO" typeof="Code">
    <div class="form-header"><span class="form-name" property="name" data-sym="IMPORT-AS-MACROS">import-as-macros</span><span class="form-type">macro</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> <a class="sym-link local-def" href="#def-import-as-macros" data-sym="IMPORT-AS-MACROS" title="(defmacro u::import-as-macros (u::package-symbol &amp;rest u::symbols)
  `(progn ,@(u::import-as-macros-fn u::package-symbol u::symbols)))">import-as-macros</a>
  (package-symbol &amp;rest symbols)
  `(<a class="sym-link system" href="../../axioms.html#def-progn" data-sym="PROGN">progn</a> ,@(U::IMPORT-AS-MACROS-FN U::PACKAGE-SYMBOL U::SYMBOLS)))</pre>
  </div>

<div class="form-block other" id="form-5" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link local-def" href="#def-import-as-macros" data-sym="IMPORT-AS-MACROS" title="(defmacro u::import-as-macros (u::package-symbol &amp;rest u::symbols)
  `(progn ,@(u::import-as-macros-fn u::package-symbol u::symbols)))">import-as-macros</a> a-symbol-unique-to-the-acl2-package
  <a class="sym-link system" href="../../basis-a.html#def-arglistp" data-sym="ARGLISTP">arglistp</a>
  <a class="sym-link system" href="../../axioms.html#def-conjoin" data-sym="CONJOIN">conjoin</a>
  translate-declaration-to-guard-var-lst)</pre>
  </div>

<div class="form-block other" id="form-6" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defxdoc defloop
  <span class="keyword">:parents</span> (utilities)
  <span class="keyword">:short</span> <span class="string">"Macro for defining simple iteration schemes as functions."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;Syntax:&lt;/p&gt;

@({
   DEFLOOP name arglist [documentation] {declaration}* loop-form

   loop-form ::= (FOR ({!for-clause}+) main-clause)

   for-clause ::= for-in-clause | for-on-clause

   for-in-clause ::= (var IN arg [ BY fn ])

   for-on-clause ::= (var ON arg [ BY fn ])

   main-clause ::= !list-accumulation | (!conditional form !value-clause) |
                   (!termination-test form)

   value-clause ::= !list-accumulation | (RETURN form)

   list-accumulation ::= ({COLLECT | APPEND} form)

   value-clause ::= ({COLLECT | APPEND | RETURN} form)

   conditional ::= IF | WHEN | UNLESS

   termination-test ::= ALWAYS | THEREIS | NEVER
})

&lt;p&gt;Arguments and Values:&lt;/p&gt;

@({
   arg -- a symbol appearing in the arglist.

   arglist -- an argument list satisfying ACL2::ARGLISTP.

   declaration -- any valid declaration.

   documentation -- a string; not evaluated.

   form -- a form.

   fn -- a symbol; must be the function symbol of a unary function
         well-defined on true lists.

   var -- a symbol.

   name -- a symbol.
})

&lt;p&gt;Special Note: The symbols FOR, IN, ON, BY, RETURN, COLLECT, APPEND, IF,
WHEN, UNLESS, ALWAYS, THEREIS, and NEVER appearing above may be in any package;
DEFLOOP checks the print name of the symbol, not the symbol itself.&lt;/p&gt;

&lt;h3&gt;Description&lt;/h3&gt;

&lt;p&gt;DEFLOOP is a macro that creates iterative functions.  The description of the
iteration is specified with an abstract syntax based on a small but useful
subset of the Common Lisp LOOP construct (as defined by ANSI X3J13).  Using
DEFLOOP one can easily define functions analogous to MAPCAR and MAPCAN, list
type recognizers, and MEMBER- and ASSOC-like functions.&lt;/p&gt;

&lt;p&gt;The syntax of DEFLOOP is similar to DEFUN: The function name is followed by
the arglist, optional documentation and declarations, and the function body.
Note that any guards on any of the arguments are the responsibility of the
user.&lt;/p&gt;

&lt;p&gt;The function body is in a special format, i.e., the loop-form as defined in
the Syntax description.&lt;/p&gt;

&lt;p&gt;Each for-clause defines an iteration on one of the args in arglist.  The
 for-in-clause&lt;/p&gt;

@({ (var IN arg [ BY fn ]) })

&lt;p&gt;specifies that in each iteration, var will be bound to successive CARs of
 arg, and arg will be reduced by fn on each iteration.  The default value of fn
 is CDR.  The for-on-clause&lt;/p&gt;

@({ (var ON arg [ BY fn ]) })

&lt;p&gt;specifies that var will first be bound to arg, and then reduced by fn on
each iteration.  Again, the default value of fn is CDR.&lt;/p&gt;

&lt;p&gt;Using a list-accumulation one can specify MAPCAR- and MAPCAN-like functions.
 Here is an example of how the Acl2 function STRIP-CARS could be defined with
 DEFLOOP:&lt;/p&gt;

@({
 (DEFLOOP STRIP-CARS (L)
   (DECLARE (XARGS :GUARD (ALISTP L)))
   (FOR ((X IN L))
        (COLLECT (CAR X))))
})

&lt;p&gt;Iteration on multiple lists may be specified; iteration will terminate as
soon as any of the lists are ATOMic, e.g.,&lt;/p&gt;

@({
 (DEFLOOP PAIRLIS$ (KEYS VALS)
   (DECLARE (XARGS :GUARD (AND (TRUE-LISTP KEYS)
                               (TRUE-LISTP VALS))))
   (FOR ((KEY IN KEYS) (VAL IN VALS))
        (COLLECT (CONS KEY VAL))))
})

&lt;p&gt;This example shows reduction by a function other than CDR:&lt;/p&gt;

@({ (DEFLOOP EVENS (L) (FOR ((X IN L BY CDDR)) (COLLECT X))) })

&lt;p&gt;List-accumulations can be coupled with a test, e.g., this function that
 selects all of the numbers &amp;lt;= n from l, and the ODDS function:&lt;/p&gt;

@({
 (DEFLOOP &lt;=-LIST (N L)
   (DECLARE (XARGS :GUARD (AND (INTEGERP N)
                               (INTEGERP-LISTP L))))
   (FOR ((X IN L))
        (WHEN (&lt;= X N)
          (COLLECT X))))

 (DEFLOOP ODDS (L)
   (DECLARE (XARGS :GUARD (TRUE-LISTP L)))
   (FOR ((TAIL ON L BY CDDR))
        (UNLESS (NULL (CDR TAIL))
          (COLLECT (CADR TAIL)))))
})

&lt;p&gt;The definition of @(&#39;&lt;=-LIST&#39;) shows that any functional arguments may
 appear free in the various DEFLOOP forms.  Non-iterated arguments are simply
 passed unchanged during recursive calls.  Also note that IF and WHEN are
 synonymous as DEFLOOP tests.&lt;/p&gt;

&lt;p&gt;A RETURN can also be coupled with a test.  If the test is never satisfied
 then the resulting function will return NIL.  Here are examples of how
 ASSOC-EQUAL and MEMBER-EQUAL could have been defined with DEFLOOP:&lt;/p&gt;

@({
 (DEFLOOP ASSOC-EQUAL (KEY ALIST)
   (DECLARE (XARGS :GUARD (ALISTP ALIST)))
   (FOR ((PAIR IN ALIST))
        (WHEN (EQUAL KEY (CAR PAIR))
          (RETURN PAIR))))

 (DEFLOOP MEMBER-EQUAL (X L)
   (DECLARE (XARGS :GUARD (TRUE-LISTP L)))
   (FOR ((TAIL ON L))
        (WHEN (EQUAL X (CAR TAIL))
          (RETURN TAIL))))
})

&lt;p&gt;The termination-tests can be used to create various recognizers and
 `un&#39;-recognizers.  Note that a DEFLOOP with a termination test of ALWAYS or
 NEVER will only return T if iteration terminates on NIL, i.e, they only
 recognize true lists.  The termination test (THEREIS form) will return
 the first non-NIL value returned by form, or NIL if there is none.
 Here for example are functions that recognize true lists of integers,
 true lists of un-integers, and lists containing an integer:&lt;/p&gt;

@({
 (DEFLOOP INTEGERP-LISTP (L) (FOR ((X IN L)) (ALWAYS (INTEGERP X))))

 (DEFLOOP NO-INTEGERP-LISTP (L) (FOR ((X IN L)) (NEVER (INTEGERP X))))

 (DEFLOOP HAS-INTEGERP-LISTP (L) (FOR ((X IN L)) (THEREIS (INTEGERP X))))
})

&lt;p&gt;Note that in accordance with the semantics of the LOOP construct, the
 THEREIS form above simply returns the first non-NIL result computed.  If you
 want a function that returns the first integer in a list then you can use a
 conditional return:&lt;/p&gt;

@({
 (DEFLOOP FIRST-INTEGER (L)
   (FOR ((X IN L)) (IF (INTEGERP X) (RETURN X))))
})

&lt;p&gt;Final note: If in doubt, simply TRANS1 the DEFLOOP form and have a look at
 the generated function.&lt;/p&gt;"</span>)</pre>
  </div>

<div class="form-block other" id="form-7" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-encapsulate" data-sym="ENCAPSULATE">encapsulate</a> nil
  (<a class="sym-link system" href="../../axioms.html#def-program" data-sym="PROGRAM">program</a>)
  (<a class="sym-link system" href="../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> bomb
    (ctx str &amp;rest <a class="sym-link system" href="../../defuns.html#def-args" data-sym="ARGS">args</a>)
    `(<a class="sym-link system" href="../../axioms.html#def-er" data-sym="ER">er</a> hard ,U::CTX ,U::STR ,@U::ARGS))
  (<a class="sym-link system" href="../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> *defloop-accumulators*
    '(<span class="string">"COLLECT"</span> <span class="string">"APPEND"</span>))
  (<a class="sym-link system" href="../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> *defloop-conditionals*
    '(<span class="string">"IF"</span> <span class="string">"WHEN"</span> <span class="string">"UNLESS"</span>))
  (<a class="sym-link system" href="../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> *defloop-terminators*
    '(<span class="string">"ALWAYS"</span> <span class="string">"NEVER"</span> <span class="string">"THEREIS"</span>))
  (<a class="sym-link system" href="../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> *defloop-main-clause-legal-cars*
    (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> *defloop-accumulators*
      *defloop-conditionals*
      *defloop-terminators*))
  (<a class="sym-link system" href="../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> *defloop-value-clause-legal-cars*
    (cons <span class="string">"RETURN"</span> *defloop-accumulators*))
  (<a class="sym-link system" href="../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> *defloop-accum/terms*
    (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> *defloop-accumulators* *defloop-terminators*))
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> defloop-strip-nth
    (n l)
    (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (integerp n) (<a class="sym-link system" href="../../axioms.html#def-_3E_3D" data-sym="&gt;=">&gt;=</a> n <span class="number">0</span>) (<a class="sym-link system" href="../../axioms.html#def-true-list-listp" data-sym="TRUE-LIST-LISTP">true-list-listp</a> l))))
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> l) nil)
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (cons (<a class="sym-link system" href="../../axioms.html#def-nth" data-sym="NTH">nth</a> n (car l))
          (defloop-strip-nth n (cdr l))))))
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> defloop-main-clause-syntax-error
    (main-clause)
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> main-clause)
           (symbolp (<a class="sym-link system" href="../../axioms.html#def-first" data-sym="FIRST">first</a> main-clause))
           (<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> (<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> (<a class="sym-link system" href="../../axioms.html#def-first" data-sym="FIRST">first</a> main-clause))
             *defloop-main-clause-legal-cars*))) (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"The main-clause must be a true list whose first ~
          element is a symbol whose print name is one of ~v0."</span>
          *defloop-main-clause-legal-cars*))
      ((<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> (<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> (<a class="sym-link system" href="../../axioms.html#def-first" data-sym="FIRST">first</a> main-clause))
         *defloop-accumulators*) (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (equal (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> main-clause) <span class="number">2</span>))
          (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"Invalid list-accumulation: ~p0."</span> main-clause)))
      ((<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> (<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> (<a class="sym-link system" href="../../axioms.html#def-first" data-sym="FIRST">first</a> main-clause))
         *defloop-terminators*) (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (equal (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> main-clause) <span class="number">2</span>))
          (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"Invalid termination form: ~p0."</span> main-clause)))
      ((<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> (<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> (<a class="sym-link system" href="../../axioms.html#def-first" data-sym="FIRST">first</a> main-clause))
         *defloop-conditionals*) (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (equal (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> main-clause) <span class="number">3</span>)) (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"Invalid conditional form: ~p0."</span> main-clause))
          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (let ((value-clause (<a class="sym-link system" href="../../axioms.html#def-third" data-sym="THIRD">third</a> main-clause)))
              (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> value-clause))
                (<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (equal (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> value-clause) <span class="number">2</span>))
                (<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (symbolp (<a class="sym-link system" href="../../axioms.html#def-first" data-sym="FIRST">first</a> value-clause)))
                (<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> (<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> (<a class="sym-link system" href="../../axioms.html#def-first" data-sym="FIRST">first</a> value-clause))
                    *defloop-value-clause-legal-cars*))
                (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"Invalid value-clause: ~p0."</span> value-clause))))))))
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> defloop-for-clauses-syntax-error1
    (for-clauses arglist)
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> for-clauses) nil)
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (let ((clause (car for-clauses)))
          (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> clause)
                 (<a class="sym-link system" href="../../axioms.html#def-_3E_3D" data-sym="&gt;=">&gt;=</a> (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> clause) <span class="number">3</span>)
                 (symbolp (<a class="sym-link system" href="../../axioms.html#def-first" data-sym="FIRST">first</a> clause))
                 (symbolp (<a class="sym-link system" href="../../axioms.html#def-second" data-sym="SECOND">second</a> clause))
                 (<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> (<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> (<a class="sym-link system" href="../../axioms.html#def-second" data-sym="SECOND">second</a> clause)) '(<span class="string">"IN"</span> <span class="string">"ON"</span>))
                 (symbolp (<a class="sym-link system" href="../../axioms.html#def-third" data-sym="THIRD">third</a> clause))
                 (<a class="sym-link system" href="../../axioms.html#def-member" data-sym="MEMBER">member</a> (<a class="sym-link system" href="../../axioms.html#def-third" data-sym="THIRD">third</a> clause) arglist)
                 (<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (<a class="sym-link system" href="../../axioms.html#def-_3E" data-sym="&gt;">&gt;</a> (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> clause) <span class="number">3</span>)
                   (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (equal (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> clause) <span class="number">5</span>)
                     (symbolp (<a class="sym-link system" href="../../axioms.html#def-fourth" data-sym="FOURTH">fourth</a> clause))
                     (equal (<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> (<a class="sym-link system" href="../../axioms.html#def-fourth" data-sym="FOURTH">fourth</a> clause)) <span class="string">"BY"</span>)
                     (symbolp (<a class="sym-link system" href="../../axioms.html#def-fifth" data-sym="FIFTH">fifth</a> clause)))))) (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"A for-clause must be of the form:
 (var {IN | ON} arg [ BY fn ])
where var is a symbol, arg is a symbol in ~
the arglist, and fn is a symbol, but ~p0 does not satisfy these constraints."</span>
                clause))
            (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (defloop-for-clauses-syntax-error1 (cdr for-clauses)
                arglist)))))))
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> defloop-for-clauses-syntax-error
    (for-clauses arglist)
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> for-clauses) for-clauses)) (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"The for-clauses must be a non-empty true list but ~p0 is not."</span>
          for-clauses))
      ((defloop-for-clauses-syntax-error1 for-clauses
         arglist))
      ((<a class="sym-link system" href="../../axioms.html#def-duplicates" data-sym="DUPLICATES">duplicates</a> (defloop-strip-nth <span class="number">0</span> for-clauses)) (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"Multiple bindings for free-var~#0~[~/s~] ~&amp;0."</span>
          (<a class="sym-link system" href="../../axioms.html#def-duplicates" data-sym="DUPLICATES">duplicates</a> (defloop-strip-nth <span class="number">0</span> arglist))))
      ((<a class="sym-link system" href="../../axioms.html#def-duplicates" data-sym="DUPLICATES">duplicates</a> (defloop-strip-nth <span class="number">2</span> for-clauses)) (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"Multiple for-clauses for arg~#0~[~/s~] ~&amp;0."</span>
          (<a class="sym-link system" href="../../axioms.html#def-duplicates" data-sym="DUPLICATES">duplicates</a> (defloop-strip-nth <span class="number">2</span> arglist))))
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> nil)))
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> defloop-syntax-error
    (name arglist forms)
    (let ((err (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (symbolp name)) (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"The name must be a symbol, but ~p0 is not."</span>
               name))
           ((<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../basis-a.html#def-arglistp" data-sym="ARGLISTP">arglistp</a> arglist)) (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"The arglist must be a valid functional argument list as defined ~
          by ACL2::ARGLISTP, but ~p0 is not."</span>
               arglist))
           ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> forms) (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"You neglected to include a function body!"</span>))
           (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (let ((loop-form (car (<a class="sym-link system" href="../../axioms.html#def-last" data-sym="LAST">last</a> forms))))
               (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> loop-form)
                      (equal (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> loop-form) <span class="number">3</span>)
                      (symbolp (<a class="sym-link system" href="../../axioms.html#def-first" data-sym="FIRST">first</a> loop-form))
                      (equal (<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> (<a class="sym-link system" href="../../axioms.html#def-first" data-sym="FIRST">first</a> loop-form)) <span class="string">"FOR"</span>))) (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"The loop-form must be a true list of length 3 whose CAR is ~
              a symbol named FOR, but ~p0 is not."</span>
                     loop-form))
                 ((defloop-for-clauses-syntax-error (<a class="sym-link system" href="../../axioms.html#def-second" data-sym="SECOND">second</a> loop-form)
                    arglist))
                 ((defloop-main-clause-syntax-error (<a class="sym-link system" href="../../axioms.html#def-third" data-sym="THIRD">third</a> loop-form)))
                 (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> nil)))))))
      (if err
        (bomb 'defloop <span class="string">"Syntax error. ~@0"</span> err)
        nil)))
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> defloop-atomize
    (l)
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> l) nil)
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (cons `(<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> ,(CAR U::L)) (defloop-atomize (cdr l))))))
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> defloop-disjoin
    (l)
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> l) l)
      ((<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (consp l) (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> (cdr l))) (car l))
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> `(<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> ,@U::L))))
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> defloop-by-alist
    (for-clauses)
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> for-clauses) nil)
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (let ((clause (car for-clauses)))
          (cons (cons (<a class="sym-link system" href="../../axioms.html#def-third" data-sym="THIRD">third</a> clause)
              (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-fifth" data-sym="FIFTH">fifth</a> clause) `(,(FIFTH U::CLAUSE) ,(THIRD U::CLAUSE)))
                (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> `(cdr ,(THIRD U::CLAUSE)))))
            (defloop-by-alist (cdr for-clauses)))))))
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> defloop-reduce-args1
    (arglist alist)
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> arglist) nil)
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (cons (let ((pair (<a class="sym-link system" href="../../axioms.html#def-assoc" data-sym="ASSOC">assoc</a> (car arglist) alist)))
            (if pair
              (cdr pair)
              (car arglist)))
          (defloop-reduce-args1 (cdr arglist) alist)))))
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> defloop-reduce-args
    (arglist for-clauses)
    (defloop-reduce-args1 arglist
      (defloop-by-alist for-clauses)))
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> defloop-lambda-args
    (for-clauses)
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> for-clauses) nil)
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (cons (let ((clause (car for-clauses)))
            (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((equal (<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> (<a class="sym-link system" href="../../axioms.html#def-second" data-sym="SECOND">second</a> clause)) <span class="string">"IN"</span>) `(car ,(THIRD U::CLAUSE)))
              ((equal (<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> (<a class="sym-link system" href="../../axioms.html#def-second" data-sym="SECOND">second</a> clause)) <span class="string">"ON"</span>) (<a class="sym-link system" href="../../axioms.html#def-third" data-sym="THIRD">third</a> clause))
              (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (bomb 'defloop-lambda-args <span class="string">"Bug."</span>))))
          (defloop-lambda-args (cdr for-clauses))))))
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> defloop-applied-lambda
    (for-clauses <a class="sym-link system" href="../../basis-b.html#def-body" data-sym="BODY">body</a> invertp)
    `((lambda ,(U::DEFLOOP-STRIP-NTH 0 U::FOR-CLAUSES)
       ,(IF U::INVERTP
     `(NOT ,U::BODY)
     U::BODY)) ,@(U::DEFLOOP-LAMBDA-ARGS U::FOR-CLAUSES)))
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> defloop-atom-null-check
    (for-clauses)
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> (cdr for-clauses)) `(<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> ,(NTH 2 (CAR U::FOR-CLAUSES))))
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> `(if (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> ,(NTH 2 (CAR U::FOR-CLAUSES)))
          (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> ,(NTH 2 (CAR U::FOR-CLAUSES)))
          ,(U::DEFLOOP-ATOM-NULL-CHECK (CDR U::FOR-CLAUSES))))))
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> defloop-accum/term
    (name arglist
      decls
      for-clauses
      main-clause
      main-car)
    `(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> ,U::NAME
      ,U::ARGLIST
      ,@U::DECLS
      (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (,(U::DEFLOOP-DISJOIN
  (U::DEFLOOP-ATOMIZE (U::DEFLOOP-STRIP-NTH 2 U::FOR-CLAUSES))) ,(COND ((U::MEMBER-EQUAL U::MAIN-CAR &#39;(&quot;COLLECT&quot; &quot;APPEND&quot; &quot;THEREIS&quot;)) &#39;NIL)
       ((U::MEMBER-EQUAL U::MAIN-CAR &#39;(&quot;ALWAYS&quot; &quot;NEVER&quot;))
        (U::DEFLOOP-ATOM-NULL-CHECK U::FOR-CLAUSES))))
        (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (,(COND ((EQUAL U::MAIN-CAR &quot;COLLECT&quot;) &#39;CONS)
       ((EQUAL U::MAIN-CAR &quot;APPEND&quot;) &#39;APPEND)
       ((EQUAL U::MAIN-CAR &quot;ALWAYS&quot;) &#39;AND) ((EQUAL U::MAIN-CAR &quot;NEVER&quot;) &#39;AND)
       ((EQUAL U::MAIN-CAR &quot;THEREIS&quot;) &#39;OR)
       (T (U::BOMB &#39;U::DEFLOOP-ACCUM/TERM &quot;Bug.&quot;))) ,(U::DEFLOOP-APPLIED-LAMBDA U::FOR-CLAUSES (SECOND U::MAIN-CLAUSE)
  (EQUAL U::MAIN-CAR &quot;NEVER&quot;))
            (,U::NAME ,@(U::DEFLOOP-REDUCE-ARGS U::ARGLIST U::FOR-CLAUSES)))))))
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> defloop-conditional
    (name arglist
      decls
      for-clauses
      main-clause
      main-car)
    (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((test (<a class="sym-link system" href="../../axioms.html#def-second" data-sym="SECOND">second</a> main-clause)) (value-clause (<a class="sym-link system" href="../../axioms.html#def-third" data-sym="THIRD">third</a> main-clause))
        (value-car (<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> (car value-clause))))
      `(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> ,U::NAME
        ,U::ARGLIST
        ,@U::DECLS
        (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (,(U::DEFLOOP-DISJOIN
  (U::DEFLOOP-ATOMIZE (U::DEFLOOP-STRIP-NTH 2 U::FOR-CLAUSES))) 'nil)
          (,(U::DEFLOOP-APPLIED-LAMBDA U::FOR-CLAUSES U::TEST (EQUAL U::MAIN-CAR &quot;UNLESS&quot;)) ,(COND
  ((EQUAL U::VALUE-CAR &quot;COLLECT&quot;)
   `(CONS
     ,(U::DEFLOOP-APPLIED-LAMBDA U::FOR-CLAUSES (SECOND U::VALUE-CLAUSE) NIL)
     (,U::NAME ,@(U::DEFLOOP-REDUCE-ARGS U::ARGLIST U::FOR-CLAUSES))))
  ((EQUAL U::VALUE-CAR &quot;APPEND&quot;)
   `(APPEND
     ,(U::DEFLOOP-APPLIED-LAMBDA U::FOR-CLAUSES (SECOND U::VALUE-CLAUSE) NIL)
     (,U::NAME ,@(U::DEFLOOP-REDUCE-ARGS U::ARGLIST U::FOR-CLAUSES))))
  ((EQUAL U::VALUE-CAR &quot;RETURN&quot;)
   (U::DEFLOOP-APPLIED-LAMBDA U::FOR-CLAUSES (SECOND U::VALUE-CLAUSE) NIL))
  (T (U::BOMB &#39;U::DEFLOOP-CONDITIONAL &quot;Bug.&quot;))))
          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (,U::NAME ,@(U::DEFLOOP-REDUCE-ARGS U::ARGLIST U::FOR-CLAUSES)))))))
  (<a class="sym-link system" href="../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> defloop
    (name arglist &amp;rest forms)
    (let ((ignre (defloop-syntax-error name arglist forms)))
      (declare (ignore ignre))
      (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((loop-form (car (<a class="sym-link system" href="../../axioms.html#def-last" data-sym="LAST">last</a> forms))) (for-clauses (<a class="sym-link system" href="../../axioms.html#def-second" data-sym="SECOND">second</a> loop-form))
          (main-clause (<a class="sym-link system" href="../../axioms.html#def-third" data-sym="THIRD">third</a> loop-form))
          (main-car (<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> (<a class="sym-link system" href="../../axioms.html#def-first" data-sym="FIRST">first</a> main-clause))))
        (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> main-car *defloop-accum/terms*) (defloop-accum/term name
              arglist
              (<a class="sym-link system" href="../../axioms.html#def-butlast" data-sym="BUTLAST">butlast</a> forms <span class="number">1</span>)
              for-clauses
              main-clause
              main-car))
          ((<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> main-car *defloop-conditionals*) (defloop-conditional name
              arglist
              (<a class="sym-link system" href="../../axioms.html#def-butlast" data-sym="BUTLAST">butlast</a> forms <span class="number">1</span>)
              for-clauses
              main-clause
              main-car))
          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (bomb 'defloop <span class="string">"Bug."</span>)))))))</pre>
  </div>

<div class="form-block other" id="form-8" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defloop keyword-listp
  (l)
  <span class="string">"Recognizes lists of keywords."</span>
  (declare (xargs <span class="keyword">:guard</span> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>))
  (for ((x in l)) (always (<a class="sym-link system" href="../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> x))))</pre>
  </div>

<div class="form-block other" id="form-9" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defloop keyword-pair-alistp
  (l)
  <span class="string">"Recognizes alists whose entries are all pairs of keywords."</span>
  (declare (xargs <span class="keyword">:guard</span> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>))
  (for ((pair in l))
    (always (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (consp pair)
        (<a class="sym-link system" href="../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> (car pair))
        (<a class="sym-link system" href="../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> (cdr pair))))))</pre>
  </div>

<div class="form-block function" id="def-string-designator-p" data-defines="STRING-DESIGNATOR-P" data-references="STANDARD-CHAR-P,CHARACTERP,AND,SYMBOLP,STRINGP,OR,T,XARGS,DECLARE,X,DEFUN" data-used-by="GET-OPTION-ARGUMENT-MV" data-part-name="STRING-DESIGNATOR-P" data-part-args="X" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="STRING-DESIGNATOR-P">string-designator-p</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-string-designator-p" data-sym="STRING-DESIGNATOR-P" title="(defun u::string-designator-p (u::x)
  &quot;The guard of the Common Lisp function STRING.&quot;
  (declare (u::xargs :guard t))
  (or (stringp u::x) (symbolp u::x)
      (and (characterp u::x) (standard-char-p u::x))))">string-designator-p</a>
  (x)
  <span class="string">"The guard of the Common Lisp function STRING."</span>
  (declare (xargs <span class="keyword">:guard</span> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>))
  (<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (stringp x)
    (symbolp x)
    (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (characterp x) (<a class="sym-link system" href="../../axioms.html#def-standard-char-p" data-sym="STANDARD-CHAR-P">standard-char-p</a> x))))</pre>
  </div>

<div class="form-block other" id="form-11" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection get-option
  <span class="keyword">:parents</span> (utilities)
  <span class="keyword">:short</span> <span class="string">"A set of routines for parsing keyword option lists."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;A keyword option list is a true list, each element of which is
either a keyword, or a true list whose car is a keyword. Here is an
example:&lt;/p&gt;

@({
   (:READ-ONLY (:PREFIX &quot;Foo&quot;) (:DO-NOT :TAG :NORMALIZE))
})

&lt;p&gt;The GET-OPTION routines provide an easy to use interface that in can handle
a lot of the parsing and syntax checking for keyword option lists.  Some
routines exist in 2 forms: The first form, e.g.,&lt;/p&gt;

@({ (GET-OPTION-AS-FLAG ctx option option-list) })

&lt;p&gt;takes a context (a name printed in case of an error), an option keyword, an
  option list, (possible other args as well) and looks for the option in the
  list.  The function will abort if any syntax errors occur.  The second form,
  e.g.,&lt;/p&gt;

@({ (GET-OPTION-AS-FLAG-MV option option-list) })

&lt;p&gt;returns 2 values.  The first value, if non-NIL, is an object produced by
  ACL2::MSG that describes the syntax error.  The second value is the actual
  return value of the function.  To avoid redundancy the -MV forms of the
  functions are not documnented.&lt;/p&gt;

&lt;p&gt;To begin processing, use the function:&lt;/p&gt;

@({
  (GET-OPTION-CHECK-SYNTAX ctx option-list valid-options duplicate-options
                           mutex-options)
})

&lt;p&gt;(or GET-OPTION-CHECK-SYNTAX-MV) to check for basic option list syntax, and
  then use the various option list parsing functions listed above to get the
  values associated with the individual options.&lt;/p&gt;"</span>)</pre>
  </div>

<div class="form-block other" id="form-12" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection keyword-option-listp
  <span class="keyword">:parents</span> (get-option)
  <span class="keyword">:short</span> <span class="string">"Checks a list for basic syntax as a keyword option list."</span>
  (defloop keyword-option-listp
    (l)
    (declare (xargs <span class="keyword">:guard</span> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>))
    (for ((x in l))
      (always (if (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
          (<a class="sym-link system" href="../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> x)
          (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> x) (<a class="sym-link system" href="../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> (car x))))))))</pre>
  </div>

<div class="form-block function" id="def-reason-for-not-keyword-option-listp" data-defines="REASON-FOR-NOT-KEYWORD-OPTION-LISTP" data-references="T,TRUE-LISTP,CAAR,AND,CDR,KEYWORDP,CAR,MSG,NULL,IF,ATOM,COND,L,DEFUN" data-used-by="GET-OPTION-CHECK-SYNTAX-MV" data-part-name="REASON-FOR-NOT-KEYWORD-OPTION-LISTP" data-part-args="L" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="REASON-FOR-NOT-KEYWORD-OPTION-LISTP">reason-for-not-keyword-option-listp</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-reason-for-not-keyword-option-listp" data-sym="REASON-FOR-NOT-KEYWORD-OPTION-LISTP" title="(defun u::reason-for-not-keyword-option-listp (u::l)
  &quot;Completes the sentence `L is not a keyword option list because ...&quot;
  (cond
   ((atom u::l)
    (if (null u::l)
...">reason-for-not-keyword-option-listp</a>
  (l)
  <span class="string">"Completes the sentence `L is not a keyword option list because ..."</span>
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> l) (if (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> l)
        (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"BUG! BUG! BUG!"</span>)
        (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"it is not a proper list."</span>)))
    ((<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> (car l)) (if (<a class="sym-link system" href="../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> (car l))
        (<a class="sym-link local-def" href="#def-reason-for-not-keyword-option-listp" data-sym="REASON-FOR-NOT-KEYWORD-OPTION-LISTP" title="(defun u::reason-for-not-keyword-option-listp (u::l)
  &quot;Completes the sentence `L is not a keyword option list because ...&quot;
  (cond
   ((atom u::l)
    (if (null u::l)
...">reason-for-not-keyword-option-listp</a> (cdr l))
        (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"the entry ~p0 is not a keyword."</span> (car l))))
    ((<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> (<a class="sym-link system" href="../../axioms.html#def-caar" data-sym="CAAR">caar</a> l)) (<a class="sym-link system" href="../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> (car l))) (<a class="sym-link local-def" href="#def-reason-for-not-keyword-option-listp" data-sym="REASON-FOR-NOT-KEYWORD-OPTION-LISTP" title="(defun u::reason-for-not-keyword-option-listp (u::l)
  &quot;Completes the sentence `L is not a keyword option list because ...&quot;
  (cond
   ((atom u::l)
    (if (null u::l)
...">reason-for-not-keyword-option-listp</a> (cdr l)))
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"the entry ~p0 is not a proper list whose car is a keyword."</span>
        (car l)))))</pre>
  </div>

<div class="form-block other" id="form-14" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection get-option-keywords
  <span class="keyword">:parents</span> (get-option)
  <span class="keyword">:short</span> <span class="string">"Strip the option keywords from a keyword option list."</span>
  (defloop get-option-keywords
    (l)
    (declare (xargs <span class="keyword">:guard</span> (keyword-option-listp l)))
    (for ((x in l))
      (collect (if (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
          x
          (car x))))))</pre>
  </div>

<div class="form-block other" id="form-15" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection get-option-entry
  <span class="keyword">:parents</span> (get-option)
  <span class="keyword">:short</span> <span class="string">"Returns the first occurrence of an option entry for option in l."</span>
  (defloop get-option-entry
    (option l)
    (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> option) (keyword-option-listp l))))
    (for ((x in l))
      (when (<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> option x)
          (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (consp x) (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> option (car x))))
        (return x)))))</pre>
  </div>

<div class="form-block other" id="form-16" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection get-option-entries
  <span class="keyword">:parents</span> (get-option)
  <span class="keyword">:short</span> <span class="string">"Returns all occurrences of option entries for option in l."</span>
  (defloop get-option-entries
    (option l)
    (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> option) (keyword-option-listp l))))
    (for ((x in l))
      (when (<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> option x)
          (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (consp x) (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> option (car x))))
        (collect x)))))</pre>
  </div>

<div class="form-block function" id="def-get-option-check-mutex-mv" data-defines="GET-OPTION-CHECK-MUTEX-MV" data-references="CDR,MSG,CDAR,CAAR,MEMBER,T,MV,ATOM,COND,KEYWORD-PAIR-ALISTP,KEYWORD-LISTP,AND,XARGS,DECLARE,MUTEX-OPTIONS,OPTIONS,DEFUN" data-used-by="GET-OPTION-CHECK-SYNTAX-MV" data-part-name="GET-OPTION-CHECK-MUTEX-MV" data-part-args="MUTEX-OPTIONS,OPTIONS" data-part-declare="MUTEX-OPTIONS,KEYWORD-PAIR-ALISTP,OPTIONS,KEYWORD-LISTP,AND,XARGS,DECLARE" data-part-body="CDR,GET-OPTION-CHECK-MUTEX-MV,MSG,CDAR,OPTIONS,CAAR,MEMBER,AND,T,MV,MUTEX-OPTIONS,ATOM,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="GET-OPTION-CHECK-MUTEX-MV">get-option-check-mutex-mv</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-get-option-check-mutex-mv" data-sym="GET-OPTION-CHECK-MUTEX-MV" title="(defun u::get-option-check-mutex-mv (u::options u::mutex-options)
  (declare
   (u::xargs :guard
    (and (u::keyword-listp u::options)
         (u::keyword-pair-alistp u::mutex-options))))
...">get-option-check-mutex-mv</a>
  (options mutex-options)
  (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (keyword-listp options)
        (keyword-pair-alistp mutex-options))))
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> mutex-options) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>))
    ((<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-member" data-sym="MEMBER">member</a> (<a class="sym-link system" href="../../axioms.html#def-caar" data-sym="CAAR">caar</a> mutex-options) options)
       (<a class="sym-link system" href="../../axioms.html#def-member" data-sym="MEMBER">member</a> (<a class="sym-link system" href="../../axioms.html#def-cdar" data-sym="CDAR">cdar</a> mutex-options) options)) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"it contains the options ~p0 and ~p1 which are mutually ~
              exclusive."</span>
          (<a class="sym-link system" href="../../axioms.html#def-caar" data-sym="CAAR">caar</a> mutex-options)
          (<a class="sym-link system" href="../../axioms.html#def-cdar" data-sym="CDAR">cdar</a> mutex-options))
        nil))
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link local-def" href="#def-get-option-check-mutex-mv" data-sym="GET-OPTION-CHECK-MUTEX-MV" title="(defun u::get-option-check-mutex-mv (u::options u::mutex-options)
  (declare
   (u::xargs :guard
    (and (u::keyword-listp u::options)
         (u::keyword-pair-alistp u::mutex-options))))
...">get-option-check-mutex-mv</a> options
        (cdr mutex-options)))))</pre>
  </div>

<div class="form-block function" id="def-get-option-check-syntax-mv" data-defines="GET-OPTION-CHECK-SYNTAX-MV" data-references="GET-OPTION-CHECK-MUTEX-MV,IF,SET-DIFFERENCE-EQUAL,MSG,SUBSETP,DUPLICATES,DUPES,GET-OPTION-KEYWORDS,OPTIONS,LET*,T,REASON-FOR-NOT-KEYWORD-OPTION-LISTP,MV,KEYWORD-OPTION-LISTP,NOT,COND,KEYWORD-PAIR-ALISTP,KEYWORD-LISTP,AND,XARGS,DECLARE,MUTEX-OPTIONS,DUPLICATE-OPTIONS,VALID-OPTIONS,OPTION-LIST,DEFUN" data-part-name="GET-OPTION-CHECK-SYNTAX-MV" data-part-args="MUTEX-OPTIONS,DUPLICATE-OPTIONS,VALID-OPTIONS,OPTION-LIST" data-part-declare="MUTEX-OPTIONS,KEYWORD-PAIR-ALISTP,DUPLICATE-OPTIONS,VALID-OPTIONS,KEYWORD-LISTP,AND,XARGS,DECLARE" data-part-body="MUTEX-OPTIONS,GET-OPTION-CHECK-MUTEX-MV,IF,DUPLICATE-OPTIONS,SET-DIFFERENCE-EQUAL,MSG,VALID-OPTIONS,SUBSETP,DUPLICATES,DUPES,GET-OPTION-KEYWORDS,OPTIONS,LET*,T,REASON-FOR-NOT-KEYWORD-OPTION-LISTP,MV,OPTION-LIST,KEYWORD-OPTION-LISTP,NOT,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="GET-OPTION-CHECK-SYNTAX-MV">get-option-check-syntax-mv</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-get-option-check-syntax-mv" data-sym="GET-OPTION-CHECK-SYNTAX-MV" title="(defun u::get-option-check-syntax-mv
       (u::option-list u::valid-options u::duplicate-options u::mutex-options)
  (declare
   (u::xargs :guard
    (and (u::keyword-listp u::valid-options)
...">get-option-check-syntax-mv</a>
  (option-list valid-options
    duplicate-options
    mutex-options)
  (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (keyword-listp valid-options)
        (keyword-listp duplicate-options)
        (keyword-pair-alistp mutex-options))
      <span class="keyword">:mode</span> <span class="keyword">:program</span>))
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (keyword-option-listp option-list)) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (<a class="sym-link local-def" href="#def-reason-for-not-keyword-option-listp" data-sym="REASON-FOR-NOT-KEYWORD-OPTION-LISTP" title="(defun u::reason-for-not-keyword-option-listp (u::l)
  &quot;Completes the sentence `L is not a keyword option list because ...&quot;
  (cond
   ((atom u::l)
    (if (null u::l)
...">reason-for-not-keyword-option-listp</a> option-list)
        nil))
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((options (get-option-keywords option-list)) (dupes (<a class="sym-link system" href="../../axioms.html#def-duplicates" data-sym="DUPLICATES">duplicates</a> options)))
        (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../axioms.html#def-subsetp" data-sym="SUBSETP">subsetp</a> options valid-options)) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"it contains the option~#0~[~/s~] ~&amp;0 ~
                  which ~#0~[is~/are~] not ~
                  recognized.  The only recognized option~#1~[~/s~] ~
                  ~#1~[is~/are~] ~&amp;1."</span>
                (<a class="sym-link system" href="../../axioms.html#def-set-difference-equal" data-sym="SET-DIFFERENCE-EQUAL">set-difference-equal</a> options valid-options)
                valid-options)
              nil))
          ((<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../axioms.html#def-subsetp" data-sym="SUBSETP">subsetp</a> dupes duplicate-options)) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"it contains duplicate occurrences of the ~
                  option~#0~[~/s~] ~&amp;0. ~#1~[~
                  The only option~#2~[~/s~] which may be duplicated ~
                  ~#2~[is~/are~] ~&amp;2.~/.~]"</span>
                (<a class="sym-link system" href="../../axioms.html#def-set-difference-equal" data-sym="SET-DIFFERENCE-EQUAL">set-difference-equal</a> duplicate-options dupes)
                (if duplicate-options
                  <span class="number">0</span>
                  <span class="number">1</span>)
                duplicate-options)
              nil))
          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link local-def" href="#def-get-option-check-mutex-mv" data-sym="GET-OPTION-CHECK-MUTEX-MV" title="(defun u::get-option-check-mutex-mv (u::options u::mutex-options)
  (declare
   (u::xargs :guard
    (and (u::keyword-listp u::options)
         (u::keyword-pair-alistp u::mutex-options))))
...">get-option-check-mutex-mv</a> options mutex-options)))))))</pre>
  </div>

<div class="form-block other" id="form-19" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection get-option-check-syntax
  <span class="keyword">:parents</span> (get-option)
  <span class="keyword">:short</span> <span class="string">"Check the option list for gross syntax, returning NIL if it&#39;s OK, and
  crashing otherwise."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;The argument option-list is the option list entered by the user.
  Valid-options is a list of keywords that specifies which options are valid.
  Duplicate-options is a list of keywords which specifies which options may be
  duplicated.  Mutex-options is an alist of pairs (keyword1 . keyword2) which
  has the meaning `if keyword1 appears as an option then keyword2 may not
  appear as an option&#39;.&lt;/p&gt;"</span>
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> get-option-check-syntax
    (ctx option-list
      valid-options
      duplicate-options
      mutex-options)
    (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (keyword-listp valid-options)
          (keyword-listp duplicate-options)
          (keyword-pair-alistp mutex-options))
        <span class="keyword">:mode</span> <span class="keyword">:program</span>))
    (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> flag)
      (<a class="sym-link local-def" href="#def-get-option-check-syntax-mv" data-sym="GET-OPTION-CHECK-SYNTAX-MV" title="(defun u::get-option-check-syntax-mv
       (u::option-list u::valid-options u::duplicate-options u::mutex-options)
  (declare
   (u::xargs :guard
    (and (u::keyword-listp u::valid-options)
...">get-option-check-syntax-mv</a> option-list
        valid-options
        duplicate-options
        mutex-options)
      (declare (ignore flag))
      (if <a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a>
        (bomb ctx
          <span class="string">"The keyword option list ~p0 is invalid because ~@1"</span>
          option-list
          <a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a>)
        nil))))</pre>
  </div>

<div class="form-block function" id="def-get-option-as-flag-mv" data-defines="GET-OPTION-AS-FLAG-MV" data-references="T,MSG,MV,CONSP,COND,GET-OPTION-ENTRY,OPT,LET,KEYWORD-OPTION-LISTP,KEYWORDP,AND,XARGS,DECLARE,OPTION-LIST,OPTION,DEFUN" data-part-name="GET-OPTION-AS-FLAG-MV" data-part-args="OPTION-LIST,OPTION" data-part-declare="OPTION-LIST,KEYWORD-OPTION-LISTP,OPTION,KEYWORDP,AND,XARGS,DECLARE" data-part-body="T,MSG,MV,CONSP,COND,OPTION-LIST,OPTION,GET-OPTION-ENTRY,OPT,LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="GET-OPTION-AS-FLAG-MV">get-option-as-flag-mv</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-get-option-as-flag-mv" data-sym="GET-OPTION-AS-FLAG-MV" title="(defun u::get-option-as-flag-mv (u::option u::option-list)
  (declare
   (u::xargs :guard
    (and (keywordp u::option) (u::keyword-option-listp u::option-list))))
  (let ((u::opt (u::get-option-entry u::option u::option-list)))
...">get-option-as-flag-mv</a>
  (option option-list)
  (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> option)
        (keyword-option-listp option-list))))
  (let ((opt (get-option-entry option option-list)))
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (opt (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((consp opt) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"The ~p0 option descriptor may only be specified as ~p0, ~
                  thus ~p1 is illegal."</span>
                option
                opt)
              nil))
          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>))))
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil nil)))))</pre>
  </div>

<div class="form-block other" id="form-21" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection get-option-as-flag
  <span class="keyword">:parents</span> (get-option)
  <span class="keyword">:short</span> <span class="string">"Look for an stand-alone option, check the syntax, and return T if the
  option is found and NIL otherwise."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;This function is for options that take no arguments, where the
  simple presence or absence of the option is meant to signal the user&#39;s
  intention.&lt;/p&gt;"</span>
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> get-option-as-flag
    (ctx option option-list)
    (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> option)
          (keyword-option-listp option-list))
        <span class="keyword">:mode</span> <span class="keyword">:program</span>))
    (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> flag)
      (<a class="sym-link local-def" href="#def-get-option-as-flag-mv" data-sym="GET-OPTION-AS-FLAG-MV" title="(defun u::get-option-as-flag-mv (u::option u::option-list)
  (declare
   (u::xargs :guard
    (and (keywordp u::option) (u::keyword-option-listp u::option-list))))
  (let ((u::opt (u::get-option-entry u::option u::option-list)))
...">get-option-as-flag-mv</a> option option-list)
      (if <a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a>
        (bomb ctx <span class="string">"~@0"</span> <a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a>)
        flag))))</pre>
  </div>

<div class="form-block function" id="def-get-option-member-mv" data-defines="GET-OPTION-MEMBER-MV" data-references="T,MSG,CADR,MEMBER,NOT,CDDR,MV,CDR,ATOM,OR,COND,GET-OPTION-ENTRY,OPT,LET,EQLABLE-LISTP,KEYWORD-OPTION-LISTP,KEYWORDP,AND,XARGS,DECLARE,DEFAULT-IF-UNSPECIFIED,DEFAULT-IF-MISSING,CHOICES,OPTION-LIST,OPTION,DEFUN" data-part-name="GET-OPTION-MEMBER-MV" data-part-args="DEFAULT-IF-UNSPECIFIED,DEFAULT-IF-MISSING,CHOICES,OPTION-LIST,OPTION" data-part-declare="CHOICES,EQLABLE-LISTP,OPTION-LIST,KEYWORD-OPTION-LISTP,OPTION,KEYWORDP,AND,XARGS,DECLARE" data-part-body="DEFAULT-IF-MISSING,T,MSG,CHOICES,CADR,MEMBER,NOT,CDDR,DEFAULT-IF-UNSPECIFIED,MV,CDR,ATOM,OR,COND,OPTION-LIST,OPTION,GET-OPTION-ENTRY,OPT,LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="GET-OPTION-MEMBER-MV">get-option-member-mv</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-get-option-member-mv" data-sym="GET-OPTION-MEMBER-MV" title="(defun u::get-option-member-mv
       (u::option u::option-list u::choices u::default-if-missing
        u::default-if-unspecified)
  (declare
   (u::xargs :guard
...">get-option-member-mv</a>
  (option option-list
    choices
    default-if-missing
    default-if-unspecified)
  (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> option)
        (keyword-option-listp option-list)
        (<a class="sym-link system" href="../../axioms.html#def-eqlable-listp" data-sym="EQLABLE-LISTP">eqlable-listp</a> choices))))
  (let ((opt (get-option-entry option option-list)))
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (opt (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> opt) (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> (cdr opt))) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil default-if-unspecified))
          ((<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../axioms.html#def-cddr" data-sym="CDDR">cddr</a> opt) (<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../axioms.html#def-member" data-sym="MEMBER">member</a> (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> opt) choices))) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"The option specification ~p0 is illegal because the ~
                  ~p1 option requires at most one ~
                   argument which is one of ~v2."</span>
                opt
                option
                choices)
              nil))
          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> opt)))))
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil default-if-missing)))))</pre>
  </div>

<div class="form-block other" id="form-23" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection get-option-member
  <span class="keyword">:parents</span> (get-option)
  <span class="keyword">:short</span> <span class="string">"Process an option whose (optional) argument is a MEMBER of a set of
  choices."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;This function checks for an option that may be specified as either
  :OPTION, (:OPTION), or (:OPTION choice), where in the latter form the
  choice must be a member of the set of choices.  The choice is returned if
  the option is specified by the latter form, otherwise the
  default-if-missing is returned if the option is not present in the
  option-list, and default-if-unspecified is returned if the option if
  specified as :OPTION or (:OPTION).&lt;/p&gt;"</span>
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> get-option-member
    (ctx option
      option-list
      choices
      default-if-missing
      default-if-unspecified)
    (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> option)
          (keyword-option-listp option-list)
          (<a class="sym-link system" href="../../axioms.html#def-eqlable-listp" data-sym="EQLABLE-LISTP">eqlable-listp</a> choices))
        <span class="keyword">:mode</span> <span class="keyword">:program</span>))
    (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a>)
      (<a class="sym-link local-def" href="#def-get-option-member-mv" data-sym="GET-OPTION-MEMBER-MV" title="(defun u::get-option-member-mv
       (u::option u::option-list u::choices u::default-if-missing
        u::default-if-unspecified)
  (declare
   (u::xargs :guard
...">get-option-member-mv</a> option
        option-list
        choices
        default-if-missing
        default-if-unspecified)
      (if <a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a>
        (bomb ctx <span class="string">"~@0"</span> <a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a>)
        <a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a>))))</pre>
  </div>

<div class="form-block function" id="def-get-option-subset-mv" data-defines="GET-OPTION-SUBSET-MV" data-references="T,MSG,MV,CDR,SUBSETP,NOT,ATOM,OR,COND,GET-OPTION-ENTRY,OPT,LET,EQLABLE-LISTP,KEYWORD-OPTION-LISTP,KEYWORDP,AND,XARGS,DECLARE,DEFAULT,THE-SET,OPTION-LIST,OPTION,DEFUN" data-part-name="GET-OPTION-SUBSET-MV" data-part-args="DEFAULT,THE-SET,OPTION-LIST,OPTION" data-part-declare="THE-SET,EQLABLE-LISTP,OPTION-LIST,KEYWORD-OPTION-LISTP,OPTION,KEYWORDP,AND,XARGS,DECLARE" data-part-body="DEFAULT,T,MSG,MV,THE-SET,CDR,SUBSETP,NOT,ATOM,OR,COND,OPTION-LIST,OPTION,GET-OPTION-ENTRY,OPT,LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="GET-OPTION-SUBSET-MV">get-option-subset-mv</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-get-option-subset-mv" data-sym="GET-OPTION-SUBSET-MV" title="(defun u::get-option-subset-mv (u::option u::option-list u::the-set u::default)
  (declare
   (u::xargs :guard
    (and (keywordp u::option) (u::keyword-option-listp u::option-list)
         (u::eqlable-listp u::the-set))
...">get-option-subset-mv</a>
  (option option-list the-set <a class="sym-link system" href="../../axioms.html#def-default" data-sym="DEFAULT">default</a>)
  (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> option)
        (keyword-option-listp option-list)
        (<a class="sym-link system" href="../../axioms.html#def-eqlable-listp" data-sym="EQLABLE-LISTP">eqlable-listp</a> the-set))
      <span class="keyword">:verify-guards</span> nil))
  (let ((opt (get-option-entry option option-list)))
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (opt (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> opt) (<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link system" href="../../axioms.html#def-subsetp" data-sym="SUBSETP">subsetp</a> (cdr opt) the-set))) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"The ~p0 option must be specified as ~p0 consed to a ~
                  true-list l, where l is a subset of the set whose ~
                  elements are ~&amp;1. Thus ~p2 is illegal."</span>
                option
                the-set
                opt)
              nil))
          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil (cdr opt)))))
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil <a class="sym-link system" href="../../axioms.html#def-default" data-sym="DEFAULT">default</a>)))))</pre>
  </div>

<div class="form-block other" id="form-25" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defthm" data-sym="DEFTHM">defthm</a> true-listp-cdr-get-option-entry
  (<a class="sym-link system" href="../../axioms.html#def-implies" data-sym="IMPLIES">implies</a> (keyword-option-listp option-list)
    (<a class="sym-link system" href="../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> (cdr (get-option-entry option option-list)))))</pre>
  </div>

<div class="form-block other" id="form-26" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-verify-guards" data-sym="VERIFY-GUARDS">verify-guards</a> <a class="sym-link local-def" href="#def-get-option-subset-mv" data-sym="GET-OPTION-SUBSET-MV" title="(defun u::get-option-subset-mv (u::option u::option-list u::the-set u::default)
  (declare
   (u::xargs :guard
    (and (keywordp u::option) (u::keyword-option-listp u::option-list)
         (u::eqlable-listp u::the-set))
...">get-option-subset-mv</a>)</pre>
  </div>

<div class="form-block other" id="form-27" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection get-option-subset
  <span class="keyword">:parents</span> (get-option)
  <span class="keyword">:short</span> <span class="string">"Process an option of the form (:OPTION . l), where l must be a SUBSETP
  of a given set."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;This function checks for an option that is specified as (:OPTION . l),
  where l must be a proper list and a SUBSETP of the-set. Thus (:OPTION)
  specifies the empty set, and :OPTION by itself is illegal.  If the option
  is missing then the default value is returned, otherwise the subset l
  is returned.&lt;/p&gt;"</span>
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> get-option-subset
    (ctx option option-list the-set <a class="sym-link system" href="../../axioms.html#def-default" data-sym="DEFAULT">default</a>)
    (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> option)
          (keyword-option-listp option-list)
          (<a class="sym-link system" href="../../axioms.html#def-eqlable-listp" data-sym="EQLABLE-LISTP">eqlable-listp</a> the-set))
        <span class="keyword">:mode</span> <span class="keyword">:program</span>))
    (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a>)
      (<a class="sym-link local-def" href="#def-get-option-subset-mv" data-sym="GET-OPTION-SUBSET-MV" title="(defun u::get-option-subset-mv (u::option u::option-list u::the-set u::default)
  (declare
   (u::xargs :guard
    (and (keywordp u::option) (u::keyword-option-listp u::option-list)
         (u::eqlable-listp u::the-set))
...">get-option-subset-mv</a> option
        option-list
        the-set
        <a class="sym-link system" href="../../axioms.html#def-default" data-sym="DEFAULT">default</a>)
      (if <a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a>
        (bomb ctx <span class="string">"~@0"</span> <a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a>)
        <a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a>))))</pre>
  </div>

<div class="form-block function" id="def-get-option-argument-mv" data-defines="GET-OPTION-ARGUMENT-MV" data-references="MSG,T,STRING-DESIGNATOR-P,STRINGP,CADR,SYMBOLP,NOT,CASE,CDDR,MV,CDR,ATOM,OR,COND,GET-OPTION-ENTRY,OPT,LET,QUOTE,MEMBER,KEYWORD-OPTION-LISTP,KEYWORDP,AND,XARGS,DECLARE,DEFAULT-IF-UNSPECIFIED,DEFAULT-IF-MISSING,KIND,OPTION-LIST,OPTION,DEFUN" data-part-name="GET-OPTION-ARGUMENT-MV" data-part-args="DEFAULT-IF-UNSPECIFIED,DEFAULT-IF-MISSING,KIND,OPTION-LIST,OPTION" data-part-declare="QUOTE,KIND,MEMBER,OPTION-LIST,KEYWORD-OPTION-LISTP,OPTION,KEYWORDP,AND,XARGS,DECLARE" data-part-body="DEFAULT-IF-MISSING,MSG,T,STRING-DESIGNATOR-P,STRINGP,CADR,SYMBOLP,NOT,KIND,CASE,CDDR,DEFAULT-IF-UNSPECIFIED,MV,CDR,ATOM,OR,COND,OPTION-LIST,OPTION,GET-OPTION-ENTRY,OPT,LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="GET-OPTION-ARGUMENT-MV">get-option-argument-mv</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-get-option-argument-mv" data-sym="GET-OPTION-ARGUMENT-MV" title="(defun u::get-option-argument-mv
       (u::option u::option-list u::kind u::default-if-missing
        u::default-if-unspecified)
  (declare
   (u::xargs :guard
...">get-option-argument-mv</a>
  (option option-list
    kind
    default-if-missing
    default-if-unspecified)
  (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> option)
        (keyword-option-listp option-list)
        (<a class="sym-link system" href="../../axioms.html#def-member" data-sym="MEMBER">member</a> kind '(<span class="keyword">:form</span> <span class="keyword">:symbol</span> <span class="keyword">:string</span> <span class="keyword">:string-designator</span>)))))
  (let ((opt (get-option-entry option option-list)))
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (opt (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> opt) (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> (cdr opt))) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil default-if-unspecified))
          ((<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../axioms.html#def-cddr" data-sym="CDDR">cddr</a> opt)
             (<a class="sym-link system" href="../../axioms.html#def-case" data-sym="CASE">case</a> kind
               (<span class="keyword">:symbol</span> (<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (symbolp (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> opt))))
               (<span class="keyword">:string</span> (<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (stringp (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> opt))))
               (<span class="keyword">:string-designator</span> (<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (<a class="sym-link local-def" href="#def-string-designator-p" data-sym="STRING-DESIGNATOR-P" title="(defun u::string-designator-p (u::x)
  &quot;The guard of the Common Lisp function STRING.&quot;
  (declare (u::xargs :guard t))
  (or (stringp u::x) (symbolp u::x)
      (and (characterp u::x) (standard-char-p u::x))))">string-designator-p</a> (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> opt))))
               (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> nil))) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <span class="string">"The option specification ~p0 is illegal because the ~p1 ~
                  option requires at most 1 argument~@2."</span>
                opt
                option
                (<a class="sym-link system" href="../../axioms.html#def-case" data-sym="CASE">case</a> kind
                  (<span class="keyword">:symbolp</span> <span class="string">" which must be a symbol"</span>)
                  (<span class="keyword">:string</span> <span class="string">" which must be a string"</span>)
                  (<span class="keyword">:string-designator</span> <span class="string">" which must be a symbol, ~
                                               string, or character"</span>)
                  (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> <span class="string">""</span>)))
              nil))
          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> opt)))))
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil default-if-missing)))))</pre>
  </div>

<div class="form-block other" id="form-29" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection get-option-argument
  <span class="keyword">:parents</span> (get-option)
  <span class="keyword">:short</span> <span class="string">"Process an option of the form :OPTION, (:OPTION), or (:OPTION arg),
  where arg is required to be of a certain type."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;This function checks for an option that in the full form is specified as
  (:OPTION arg), where arg must be of a certain kind.  Recognized values
  for kind include:&lt;/p&gt;

  @({
  :FORM              -- arg can be anything.
  :SYMBOL            -- arg must be a symbol.
  :STRING            -- arg must be a string.
  :STRING-DESIGNATOR -- arg must be a symbol, string, or character.
  })

  &lt;p&gt;If the option is missing from the option-list, then default-if-missing is
  returned.  If the option is specified as :OPTION or (:OPTION), then
  default-if-unspecified is returned.  Otherwise the arg is returned.&lt;/p&gt;"</span>
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> get-option-argument
    (ctx option
      option-list
      kind
      default-if-missing
      default-if-unspecified)
    (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-keywordp" data-sym="KEYWORDP">keywordp</a> option)
          (keyword-option-listp option-list)
          (<a class="sym-link system" href="../../axioms.html#def-member" data-sym="MEMBER">member</a> kind '(<span class="keyword">:form</span> <span class="keyword">:symbol</span> <span class="keyword">:string</span> <span class="keyword">:string-designator</span>)))
        <span class="keyword">:mode</span> <span class="keyword">:program</span>))
    (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (<a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a> <a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a>)
      (<a class="sym-link local-def" href="#def-get-option-argument-mv" data-sym="GET-OPTION-ARGUMENT-MV" title="(defun u::get-option-argument-mv
       (u::option u::option-list u::kind u::default-if-missing
        u::default-if-unspecified)
  (declare
   (u::xargs :guard
...">get-option-argument-mv</a> option
        option-list
        kind
        default-if-missing
        default-if-unspecified)
      (if <a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a>
        (bomb ctx <span class="string">"~@0"</span> <a class="sym-link system" href="../../axioms.html#def-msg" data-sym="MSG">msg</a>)
        <a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a>))))</pre>
  </div>

<div class="form-block macro" id="def-naturalp" data-defines="NATURALP" data-references="<=,INTEGERP,AND,QUASIQUOTE,X,DEFMACRO" data-used-by="UNIQUE-SYMBOLS1" typeof="Code">
    <div class="form-header"><span class="form-name" property="name" data-sym="NATURALP">naturalp</span><span class="form-type">macro</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> <a class="sym-link local-def" href="#def-naturalp" data-sym="NATURALP" title="(defmacro u::naturalp (u::x) `(and (integerp ,u::x) (&lt;= 0 ,u::x)))">naturalp</a>
  (x)
  `(<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (integerp ,U::X) (<a class="sym-link system" href="../../axioms.html#def-_3C_3D" data-sym="&lt;=">&lt;=</a> <span class="number">0</span> ,U::X)))</pre>
  </div>

<div class="form-block other" id="form-31" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defloop string-designator-listp
  (l)
  <span class="string">"Recognizes lists of STRING-DESIGNATOR-P objects."</span>
  (declare (xargs <span class="keyword">:guard</span> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>))
  (for ((x in l))
    (always (<a class="sym-link local-def" href="#def-string-designator-p" data-sym="STRING-DESIGNATOR-P" title="(defun u::string-designator-p (u::x)
  &quot;The guard of the Common Lisp function STRING.&quot;
  (declare (u::xargs :guard t))
  (or (stringp u::x) (symbolp u::x)
      (and (characterp u::x) (standard-char-p u::x))))">string-designator-p</a> x))))</pre>
  </div>

<div class="form-block other" id="form-32" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defloop mapcar-string
  (l)
  <span class="string">"STRING each element of l."</span>
  (declare (xargs <span class="keyword">:guard</span> (string-designator-listp l)))
  (for ((sd in l)) (collect (<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> sd))))</pre>
  </div>

<div class="form-block other" id="form-33" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defloop coerce-string-designator-list
  (l)
  <span class="string">"Coerce a list of string-designators to a list of characters."</span>
  (declare (xargs <span class="keyword">:guard</span> (string-designator-listp l)))
  (for ((sd in l))
    (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> (coerce (<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> sd) '<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a>))))</pre>
  </div>

<div class="form-block other" id="form-34" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection pack-string
  <span class="keyword">:parents</span> (utilities)
  <span class="keyword">:short</span> <span class="string">"Given a series of string-designators l, append the STRING of each and
   return the resulting string."</span>
  (<a class="sym-link system" href="../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> pack-string
    (&amp;rest l)
    `(coerce (coerce-string-designator-list (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> ,@U::L))
      '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a>)))</pre>
  </div>

<div class="form-block other" id="form-35" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection pack-intern
  <span class="keyword">:parents</span> (utilities)
  <span class="keyword">:short</span> <span class="string">"Given a list of string-designators l, append the STRING of each and
   intern the resulting string in the package of sym."</span>
  (<a class="sym-link system" href="../../axioms.html#def-defmacro" data-sym="DEFMACRO">defmacro</a> pack-intern
    (sym &amp;rest l)
    `(intern-in-package-of-symbol (pack-string ,@U::L)
      ,U::SYM)))</pre>
  </div>

<div class="form-block function" id="def-unique-symbols1" data-defines="UNIQUE-SYMBOLS1" data-references="CONS,1-,1+,REMOVE,MEMBER,STRING,QUOTE,EXPLODE-NONNEGATIVE-INTEGER,COERCE,PACK-INTERN,SYM,LET,T,EQUAL,COND,SYMBOL-LISTP,SYMBOLP,NATURALP,AND,XARGS,DECLARE,GEN-LIST,COUNTER,SYM-LIST,SEED,N,DEFUN" data-part-name="UNIQUE-SYMBOLS1" data-part-args="GEN-LIST,COUNTER,SYM-LIST,SEED,N" data-part-declare="COUNTER,SYM-LIST,SYMBOL-LISTP,SEED,SYMBOLP,N,NATURALP,AND,XARGS,DECLARE" data-part-body="CONS,1-,1+,REMOVE,UNIQUE-SYMBOLS1,SYM-LIST,MEMBER,STRING,QUOTE,COUNTER,EXPLODE-NONNEGATIVE-INTEGER,COERCE,SEED,PACK-INTERN,SYM,LET,T,GEN-LIST,N,EQUAL,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="UNIQUE-SYMBOLS1">unique-symbols1</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-unique-symbols1" data-sym="UNIQUE-SYMBOLS1" title="(defun u::unique-symbols1 (u::n u::seed u::sym-list u::counter u::gen-list)
  (declare
   (u::xargs :guard
    (and (u::naturalp u::n) (symbolp u::seed) (u::symbol-listp u::sym-list)
         (u::naturalp u::counter))
...">unique-symbols1</a>
  (n seed sym-list counter gen-list)
  (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link local-def" href="#def-naturalp" data-sym="NATURALP" title="(defmacro u::naturalp (u::x) `(and (integerp ,u::x) (&lt;= 0 ,u::x)))">naturalp</a> n)
        (symbolp seed)
        (<a class="sym-link system" href="../../axioms.html#def-symbol-listp" data-sym="SYMBOL-LISTP">symbol-listp</a> sym-list)
        (<a class="sym-link local-def" href="#def-naturalp" data-sym="NATURALP" title="(defmacro u::naturalp (u::x) `(and (integerp ,u::x) (&lt;= 0 ,u::x)))">naturalp</a> counter))
      <span class="keyword">:mode</span> <span class="keyword">:program</span>))
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((equal n <span class="number">0</span>) gen-list)
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (let ((sym (pack-intern seed
             seed
             (coerce (<a class="sym-link system" href="../../axioms.html#def-explode-nonnegative-integer" data-sym="EXPLODE-NONNEGATIVE-INTEGER">explode-nonnegative-integer</a> counter <span class="number">10</span> nil)
               '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a>))))
        (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-member" data-sym="MEMBER">member</a> sym sym-list) (<a class="sym-link local-def" href="#def-unique-symbols1" data-sym="UNIQUE-SYMBOLS1" title="(defun u::unique-symbols1 (u::n u::seed u::sym-list u::counter u::gen-list)
  (declare
   (u::xargs :guard
    (and (u::naturalp u::n) (symbolp u::seed) (u::symbol-listp u::sym-list)
         (u::naturalp u::counter))
...">unique-symbols1</a> n
              seed
              (<a class="sym-link system" href="../../axioms.html#def-remove" data-sym="REMOVE">remove</a> sym sym-list)
              (<a class="sym-link system" href="../../axioms.html#def-1_2B" data-sym="1+">1+</a> counter)
              gen-list))
          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link local-def" href="#def-unique-symbols1" data-sym="UNIQUE-SYMBOLS1" title="(defun u::unique-symbols1 (u::n u::seed u::sym-list u::counter u::gen-list)
  (declare
   (u::xargs :guard
    (and (u::naturalp u::n) (symbolp u::seed) (u::symbol-listp u::sym-list)
         (u::naturalp u::counter))
...">unique-symbols1</a> (<a class="sym-link system" href="../../axioms.html#def-1-" data-sym="1-">1-</a> n)
              seed
              sym-list
              (<a class="sym-link system" href="../../axioms.html#def-1_2B" data-sym="1+">1+</a> counter)
              (cons sym gen-list))))))))</pre>
  </div>

<div class="form-block other" id="form-37" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection unique-symbols
  <span class="keyword">:parents</span> (utilities)
  <span class="keyword">:short</span> <span class="string">"Return a list of symbols guaranteed unique with respect to a symbolic
  seed and every symbol in a list of symbols."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;Given a symbolic seed, we generate symbols @(&#39;&lt;seed&gt;0&#39;), @(&#39;&lt;seed&gt;1&#39;),
  etc. until we have generated n symbols not appearing in sym-list.  This is a
  &#39;poor-man&#39;s&#39; GENSYM, and is the best we can do without STATE.  All generated
  symbols are INTERNed in the package of seed.&lt;/p&gt;"</span>
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> unique-symbols
    (n seed sym-list)
    (declare (xargs <span class="keyword">:guard</span> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link local-def" href="#def-naturalp" data-sym="NATURALP" title="(defmacro u::naturalp (u::x) `(and (integerp ,u::x) (&lt;= 0 ,u::x)))">naturalp</a> n)
          (symbolp seed)
          (<a class="sym-link system" href="../../axioms.html#def-symbol-listp" data-sym="SYMBOL-LISTP">symbol-listp</a> sym-list))
        <span class="keyword">:mode</span> <span class="keyword">:program</span>))
    (<a class="sym-link system" href="../../axioms.html#def-reverse" data-sym="REVERSE">reverse</a> (<a class="sym-link local-def" href="#def-unique-symbols1" data-sym="UNIQUE-SYMBOLS1" title="(defun u::unique-symbols1 (u::n u::seed u::sym-list u::counter u::gen-list)
  (declare
   (u::xargs :guard
    (and (u::naturalp u::n) (symbolp u::seed) (u::symbol-listp u::sym-list)
         (u::naturalp u::counter))
...">unique-symbols1</a> n seed sym-list <span class="number">0</span> nil))))</pre>
  </div>

<div class="form-block other" id="form-38" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defloop force-term-list
  (l)
  <span class="string">"Given a list of terms, `FORCE&#39; each term."</span>
  (for ((x in l)) (collect `(<a class="sym-link system" href="../../axioms.html#def-force" data-sym="FORCE">force</a> ,U::X))))</pre>
  </div>

<div class="form-block other" id="form-39" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defloop get-guards-from-declare-body
  (declare-body)
  <span class="string">"This is similar to ACL2::GET-GUARDS-1, but is believed to be `fail-safe&#39;."</span>
  (declare (xargs <span class="keyword">:mode</span> <span class="keyword">:program</span>))
  (for ((form in declare-body))
    (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> form)
           (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (car form) 'xargs)
           (<a class="sym-link system" href="../../axioms.html#def-keyword-value-listp" data-sym="KEYWORD-VALUE-LISTP">keyword-value-listp</a> (cdr form))) (let ((temp (<a class="sym-link system" href="../../axioms.html#def-assoc-keyword" data-sym="ASSOC-KEYWORD">assoc-keyword</a> <span class="keyword">:guard</span> (cdr form))))
            (if temp
              (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> temp))
              nil)))
        ((<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> form)
           (equal (car form) 'type)
           (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> form)
           (<a class="sym-link system" href="../../axioms.html#def-cddr" data-sym="CDDR">cddr</a> form)
           (<a class="sym-link system" href="../../axioms.html#def-symbol-listp" data-sym="SYMBOL-LISTP">symbol-listp</a> (<a class="sym-link system" href="../../axioms.html#def-cddr" data-sym="CDDR">cddr</a> form))) (translate-declaration-to-guard-var-lst (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> form)
            (<a class="sym-link system" href="../../axioms.html#def-cddr" data-sym="CDDR">cddr</a> form)
            nil))
        (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> nil)))))</pre>
  </div>

<div class="form-block other" id="form-40" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defloop get-guards-from-body1
  (<a class="sym-link system" href="../../basis-b.html#def-body" data-sym="BODY">body</a>)
  (declare (xargs <span class="keyword">:mode</span> <span class="keyword">:program</span>))
  (for ((form in <a class="sym-link system" href="../../basis-b.html#def-body" data-sym="BODY">body</a>))
    (when (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-true-listp" data-sym="TRUE-LISTP">true-listp</a> form) (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (car form) 'declare))
      (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> (get-guards-from-declare-body (cdr form))))))</pre>
  </div>

<div class="form-block other" id="form-41" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(defsection get-guards-from-body
  <span class="keyword">:parents</span> (utilities)
  <span class="keyword">:short</span> <span class="string">"A user-level function to extract guards from a definition body."</span>
  <span class="keyword">:long</span> <span class="string">"&lt;p&gt;This function takes a definition body, that is, a list of forms valid as
  the body of a DEFUN, and returns a guard for the DEFUN that consists of all
  guards specified either by (DECLARE (XARGS ... :GUARD g ...)) or (DECLARE
  (TYPE ...)) forms in body. This function is designed to be used by macros
  that create function definitions and lemmas that may depend on the guards
  of the newly defined function.  The guard will be returned as a
  conjunction: either T, NIL (?) a single conjunct, or (AND . conjuncts)
  where conjuncts is a list of the conjuncts.&lt;/p&gt;

  &lt;p&gt;Restrictions on the form of macros in Acl2 make it impossible for a macro
  to query the ACL2 database to determine any property of a function, including
  its guards. Therefore we provide this function which parses function bodies
  and extracts the guards from the source text of a function.&lt;/p&gt;

  &lt;p&gt;This is a `fail-safe&#39; procedure.  If any syntax errors are encountered
  during guard parsing, those illegal guard specifications are simply ignored,
  under the assumption that when the function is finally submitted to Acl2 that
  Acl2&#39;s more powerful error checking facilities will uncover and report the
  errors to the user.  Thus this routine may return garbage, but it shouldn&#39;t
  crash!&lt;/p&gt;"</span>
  (<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> get-guards-from-body
    (<a class="sym-link system" href="../../basis-b.html#def-body" data-sym="BODY">body</a>)
    (declare (xargs <span class="keyword">:mode</span> <span class="keyword">:program</span>))
    (untranslate (<a class="sym-link system" href="../../axioms.html#def-conjoin" data-sym="CONJOIN">conjoin</a> (get-guards-from-body1 <a class="sym-link system" href="../../basis-b.html#def-body" data-sym="BODY">body</a>))
      nil
      nil)))</pre>
  </div>


  </main>
  
<script>
// ACL2 Book HTML Documentation - Interactive Features
// Generated by cert2 - build2 system

// State
let activeFilter = null;
let activePartFilter = null;
let activeNameFilter = null;
let currentFontSize = 14;

// Theme management
function getStoredTheme() {
  return localStorage.getItem('acl2-theme') || 'dark';
}

function setTheme(theme) {
  if (theme === 'light') {
    document.documentElement.setAttribute('data-theme', 'light');
    document.getElementById('theme-toggle').textContent = '🌙';
  } else {
    document.documentElement.removeAttribute('data-theme');
    document.getElementById('theme-toggle').textContent = '☀️';
  }
  localStorage.setItem('acl2-theme', theme);
}

function toggleTheme() {
  const current = getStoredTheme();
  setTheme(current === 'dark' ? 'light' : 'dark');
}

// Font size management
function getStoredFontSize() {
  return parseInt(localStorage.getItem('acl2-fontsize') || '14', 10);
}

function setFontSize(size) {
  size = Math.max(10, Math.min(24, size)); // Clamp between 10-24
  currentFontSize = size;
  document.body.style.fontSize = size + 'px';
  localStorage.setItem('acl2-fontsize', size.toString());
}

function increaseFontSize() {
  setFontSize(currentFontSize + 2);
}

function decreaseFontSize() {
  setFontSize(currentFontSize - 2);
}

// Get all form blocks
function getFormBlocks() {
  return document.querySelectorAll('.form-block');
}

// Clear all filters
function clearFilter() {
  activeFilter = null;
  activePartFilter = null;
  activeNameFilter = null;
  getFormBlocks().forEach(b => {
    b.classList.remove('hidden', 'dimmed');
  });
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  const status = document.querySelector('.filter-status');
  status.classList.remove('active');
  // Slide name filter back to original position
  document.querySelector('.controls-left').style.transform = '';
  // Clear the name filter input
  const nameInput = document.getElementById('name-filter');
  if (nameInput) nameInput.value = '';
}

// Show filter status and slide name filter right
function showFilterStatus(text) {
  const status = document.querySelector('.filter-status');
  status.classList.add('active');
  status.querySelector('.filter-text').textContent = text;
  // Slide name filter to the right to make room
  setTimeout(() => {
    const statusWidth = status.offsetWidth;
    document.querySelector('.controls-left').style.transform = `translateX(${statusWidth + 15}px)`;
  }, 10);
}

// Filter to show only forms that define or reference a symbol
function filterBySymbol(symName, showUsedBy) {
  clearFilter();
  activeFilter = symName;
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines;
    const references = (block.dataset.references || '').split(',');
    const usedBy = (block.dataset.usedBy || '').split(',');
    
    let show = false;
    if (showUsedBy) {
      // Show forms that USE this symbol
      show = references.includes(symName) || definesName === symName;
    } else {
      // Show forms that this symbol USES
      show = usedBy.includes(symName) || definesName === symName;
    }
    
    if (show) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering by: ${symName} (${visibleCount} items)`);
}

// Filter by defthm part (term, hints, rule-classes, etc.)
function filterByPart(formId, partName) {
  clearFilter();
  activePartFilter = { formId, partName };
  
  // Get the part's referenced symbols
  // data-part-term becomes dataset.partTerm, data-part-hints becomes dataset.partHints, etc.
  const block = document.getElementById(formId);
  const datasetKey = 'part' + partName.charAt(0).toUpperCase() + partName.slice(1).replace(/-([a-z])/g, (g) => g[1].toUpperCase());
  const partData = block.dataset[datasetKey];
  if (!partData) return;
  
  const partSyms = partData.split(',').filter(s => s);
  
  // Highlight the button
  block.querySelector(`.part-btn[data-part="${partName}"]`).classList.add('active');
  
  // Hide forms not referenced by this part
  getFormBlocks().forEach(b => {
    const definesName = b.dataset.defines;
    if (b.id === formId || partSyms.includes(definesName)) {
      b.classList.remove('hidden');
    } else {
      b.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering ${formId} :${partName} (${partSyms.length} references)`);
}

// Filter by name (substring or regex)
function filterByName(pattern, useRegex) {
  // Clear other filters but keep the input value
  activeFilter = null;
  activePartFilter = null;
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  
  if (!pattern || pattern.trim() === '') {
    // Empty pattern - show all
    activeNameFilter = null;
    getFormBlocks().forEach(b => b.classList.remove('hidden'));
    const status = document.querySelector('.filter-status');
    status.classList.remove('active');
    document.querySelector('.controls-left').style.transform = '';
    return;
  }
  
  activeNameFilter = pattern;
  
  let matcher;
  let isValidRegex = true;
  
  if (useRegex) {
    try {
      matcher = new RegExp(pattern, 'i');
    } catch (e) {
      // Invalid regex - show error in status and don't filter
      showFilterStatus(`Invalid regex: ${e.message}`);
      return;
    }
  } else {
    // Plain substring match (case-insensitive)
    const lowerPattern = pattern.toLowerCase();
    matcher = { test: (s) => s.toLowerCase().includes(lowerPattern) };
  }
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines || '';
    if (matcher.test(definesName)) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  const modeText = useRegex ? 'regex' : 'name';
  showFilterStatus(`Filtering by ${modeText}: "${pattern}" (${visibleCount} matches)`);
}

// Click on a name to show what references it
function handleNameClick(symName) {
  if (activeFilter === symName) {
    clearFilter();
  } else {
    filterBySymbol(symName, true);
  }
}

// Navigate to a definition (same file or different)
function navigateTo(symName, file) {
  if (file) {
    // External file - navigate
    window.location.href = file + '.html#def-' + symName.toLowerCase();
  } else {
    // Same file - scroll
    const target = document.getElementById('def-' + symName.toLowerCase());
    if (target) {
      target.scrollIntoView({ behavior: 'smooth', block: 'center' });
      target.classList.add('highlight');
      setTimeout(() => target.classList.remove('highlight'), 400);
    }
  }
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  // Part buttons
  document.querySelectorAll('.part-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const formId = btn.closest('.form-block').id;
      const partName = btn.dataset.part;
      if (activePartFilter && activePartFilter.formId === formId && 
          activePartFilter.partName === partName) {
        clearFilter();
      } else {
        filterByPart(formId, partName);
      }
    });
  });
  
  // Clear filter button
  document.querySelector('.clear-filter').addEventListener('click', clearFilter);
  
  // Name filter input
  const nameFilter = document.getElementById('name-filter');
  const regexToggle = document.getElementById('regex-toggle');
  
  let filterTimeout = null;
  nameFilter.addEventListener('input', () => {
    // Debounce the filter to avoid excessive updates while typing
    clearTimeout(filterTimeout);
    filterTimeout = setTimeout(() => {
      filterByName(nameFilter.value, regexToggle.checked);
    }, 150);
  });
  
  // Re-filter when regex toggle changes
  regexToggle.addEventListener('change', () => {
    if (nameFilter.value) {
      filterByName(nameFilter.value, regexToggle.checked);
    }
  });
  
  // Allow Escape key to clear filter when in input
  nameFilter.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      clearFilter();
      nameFilter.blur();
    }
  });
  
  // Symbol references (old span-based refs)
  document.querySelectorAll('.sym-ref').forEach(ref => {
    ref.addEventListener('click', (e) => {
      e.stopPropagation();
      const sym = ref.dataset.sym;
      const file = ref.dataset.file;
      if (file) {
        navigateTo(sym, file);
      } else {
        handleNameClick(sym);
      }
    });
  });
  
  // Symbol links (new anchor-based links)
  // These use standard <a> tags so navigation happens automatically
  // But we need to clear filters if target would be hidden
  document.querySelectorAll('.sym-link').forEach(link => {
    link.addEventListener('click', (e) => {
      const href = link.getAttribute('href');
      if (href && href.startsWith('#')) {
        // Local link - check if target is hidden by filter
        const targetId = href.substring(1);
        const target = document.getElementById(targetId);
        if (target) {
          // If target is hidden, clear the filter first
          if (target.classList.contains('hidden')) {
            clearFilter();
          }
          // Add highlight effect after a short delay
          setTimeout(() => {
            target.classList.add('highlight');
            setTimeout(() => target.classList.remove('highlight'), 400);
          }, 100);
        }
      }
      // For external links, default behavior handles navigation
    });
  });
  
  // Form names (show what uses them)
  document.querySelectorAll('.form-name').forEach(name => {
    name.addEventListener('click', (e) => {
      handleNameClick(name.dataset.sym);
    });
  });
  
  // Handle hash navigation (when arriving at page with #anchor)
  if (window.location.hash) {
    const target = document.querySelector(window.location.hash);
    if (target) {
      setTimeout(() => {
        target.scrollIntoView({ behavior: 'smooth', block: 'center' });
        target.classList.add('highlight');
        setTimeout(() => target.classList.remove('highlight'), 400);
      }, 200);
    }
  }
  
  // Initialize theme from storage
  setTheme(getStoredTheme());
  
  // Initialize font size from storage
  currentFontSize = getStoredFontSize();
  setFontSize(currentFontSize);
  
  // Theme toggle button
  document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
  
  // Font size buttons
  document.getElementById('font-larger').addEventListener('click', increaseFontSize);
  document.getElementById('font-smaller').addEventListener('click', decreaseFontSize);
});

</script>

</body>
</html>
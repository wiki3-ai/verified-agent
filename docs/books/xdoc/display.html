<!DOCTYPE html>
<html lang="en" vocab="http://schema.org/" typeof="SoftwareSourceCode">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>display - ACL2 Book</title>
  <meta property="name" content="display">
  <meta property="programmingLanguage" content="ACL2">
  
<style>
/* ACL2 Book HTML Documentation Styles */
/* Generated by cert2 - build2 system */

/* Dark theme (default) */
:root {
  --bg: #1e1e2e;
  --fg: #cdd6f4;
  --comment: #6c7086;
  --keyword: #cba6f7;
  --string: #a6e3a1;
  --function: #89b4fa;
  --type: #f9e2af;
  --link: #89dceb;
  --link-hover: #f5c2e7;
  --highlight: rgba(137, 180, 250, 0.2);
  --border: #313244;
  --block-bg: rgba(49, 50, 68, 0.5);
  --btn-bg: #313244;
  --btn-hover: rgba(137, 180, 250, 0.2);
}

/* Light theme */
[data-theme="light"] {
  --bg: #eff1f5;
  --fg: #4c4f69;
  --comment: #6c6f85;
  --keyword: #8839ef;
  --string: #40a02b;
  --function: #1e66f5;
  --type: #df8e1d;
  --link: #04a5e5;
  --link-hover: #ea76cb;
  --highlight: rgba(30, 102, 245, 0.15);
  --border: #ccd0da;
  --block-bg: rgba(204, 208, 218, 0.3);
  --btn-bg: #ccd0da;
  --btn-hover: rgba(30, 102, 245, 0.15);
}

body {
  font-family: 'JetBrains Mono', 'Fira Code', monospace;
  background: var(--bg);
  color: var(--fg);
  margin: 0;
  padding: 20px;
  line-height: 1.6;
  font-size: 14px;
  transition: background 0.1s, color 0.1s;
}

/* Controls toolbar */
.controls-left {
  position: fixed;
  top: 10px;
  left: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
  transition: transform 0.1s ease;
}

.controls-right {
  position: fixed;
  top: 10px;
  right: 20px;
  display: flex;
  gap: 8px;
  align-items: center;
  z-index: 200;
}

.control-btn {
  padding: 6px 12px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-family: inherit;
  font-size: 14px;
  transition: all 0.1s;
}

.control-btn:hover {
  background: var(--btn-hover);
  border-color: var(--link);
}

.name-filter {
  padding: 6px 10px;
  background: var(--btn-bg);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--fg);
  font-family: inherit;
  font-size: 13px;
  width: 150px;
  transition: all 0.1s;
}

.name-filter:focus {
  outline: none;
  border-color: var(--link);
  width: 200px;
}

.name-filter::placeholder {
  color: var(--comment);
}

.regex-label {
  display: flex;
  align-items: center;
  gap: 4px;
  color: var(--comment);
  font-size: 12px;
  cursor: pointer;
}

.regex-label input {
  cursor: pointer;
}

.book-header {
  border-bottom: 2px solid var(--border);
  padding-bottom: 20px;
  margin-bottom: 20px;
}

.book-header h1 {
  color: var(--keyword);
  margin: 0;
}

.book-header .path {
  color: var(--comment);
  font-size: 0.9em;
}

.book-header .path .source-link {
  color: var(--comment);
  text-decoration: none;
}

.book-header .path .source-link:hover {
  color: var(--link);
  text-decoration: underline;
}

.form-block {
  margin: 10px 0;
  padding: 15px;
  background: var(--block-bg);
  border-radius: 8px;
  border-left: 3px solid var(--border);
}

.form-block.theorem { border-left-color: var(--keyword); }
.form-block.function { border-left-color: var(--function); }
.form-block.macro { border-left-color: var(--type); }
.form-block.include-book { border-left-color: var(--string); }

.form-block.hidden { display: none; }
.form-block.dimmed { opacity: 0.3; }

.form-block.highlight {
  animation: highlight-pulse 0.4s ease-out;
}

@keyframes highlight-pulse {
  0% { background: var(--highlight); box-shadow: 0 0 20px var(--link); }
  100% { background: rgba(49, 50, 68, 0.5); box-shadow: none; }
}

.form-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.form-name {
  color: var(--function);
  font-weight: bold;
  cursor: pointer;
}

.form-name:hover {
  color: var(--link-hover);
  text-decoration: underline;
}

.form-type {
  color: var(--comment);
  font-size: 0.85em;
}

pre.code {
  margin: 0;
  overflow-x: auto;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.sym-ref {
  color: var(--link);
  cursor: pointer;
  border-radius: 2px;
}

.sym-ref:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.sym-ref.local-def { color: var(--function); font-weight: bold; }
.sym-ref.external { color: var(--type); }

/* Symbol links (clickable hyperlinks) */
.sym-link {
  color: var(--link);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
  position: relative;
}

.sym-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

.sym-link.local-def {
  color: var(--function);
  font-weight: bold;
}

.sym-link.external {
  color: var(--type);
}

/* Tooltips using title attribute with custom styling */
.sym-link[title] {
  /* Browser will show title on hover */
}

/* Syntax highlighting in code blocks */
.keyword {
  color: var(--keyword);
}

.string {
  color: var(--string);
}

.number {
  color: #f77524; /* orange */
}

/* Include-book path links */
.include-path {
  color: var(--string);
  text-decoration: none;
  border-radius: 2px;
  cursor: pointer;
}

.include-path:hover {
  background: var(--highlight);
  color: var(--link-hover);
  text-decoration: underline;
}

/* Part buttons for defthm */
.part-buttons {
  display: flex;
  gap: 5px;
  margin: 10px 0;
  flex-wrap: wrap;
}

.part-btn {
  padding: 4px 10px;
  background: var(--border);
  border: 1px solid var(--comment);
  border-radius: 4px;
  color: var(--fg);
  cursor: pointer;
  font-size: 0.85em;
  font-family: inherit;
}

.part-btn:hover {
  background: var(--highlight);
  border-color: var(--link);
}

.part-btn.active {
  background: var(--link);
  color: var(--bg);
  border-color: var(--link);
}

/* References panel */
.refs-panel {
  margin-top: 10px;
  padding: 10px;
  background: rgba(0,0,0,0.2);
  border-radius: 4px;
  display: none;
}

.refs-panel.visible { display: block; }

.refs-panel h4 {
  margin: 0 0 5px 0;
  color: var(--comment);
  font-size: 0.9em;
}

.refs-list {
  display: flex;
  flex-wrap: wrap;
  gap: 5px;
}

/* Included books section */
.includes-section {
  margin-bottom: 20px;
  padding: 15px;
  background: rgba(49, 50, 68, 0.3);
  border-radius: 8px;
  border: 1px solid var(--border);
}

.includes-section h2 {
  margin: 0 0 10px 0;
  color: var(--comment);
  font-size: 1em;
  font-weight: normal;
}

.includes-list {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.include-link {
  padding: 6px 12px;
  background: var(--border);
  border-radius: 4px;
  color: var(--link);
  text-decoration: none;
  font-size: 0.9em;
  transition: all 0.1s;
}

.include-link:hover {
  background: var(--highlight);
  color: var(--link-hover);
}

.include-link.local {
  border-left: 2px solid var(--comment);
}

/* Filter status */
.filter-status {
  position: fixed;
  top: 10px;
  left: 20px;
  background: var(--bg);
  padding: 6px 12px;
  border: 1px solid var(--border);
  border-radius: 4px;
  z-index: 201;
  display: none;
  align-items: center;
  gap: 10px;
}

.filter-status.active {
  display: flex;
  align-items: center;
  gap: 10px;
}

.clear-filter {
  padding: 5px 15px;
  background: var(--keyword);
  color: var(--bg);
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

/* RDFa vocab indicator */
[vocab] { /* semantic web annotations present */ }

</style>

</head>
<body>
  <div class="controls-left">
    <input type="text" id="name-filter" class="name-filter" placeholder="Filter by name..." title="Filter definitions by name">
    <label class="regex-label"><input type="checkbox" id="regex-toggle"> regex</label>
  </div>

  <div class="controls-right">
    <button class="control-btn" id="theme-toggle" title="Toggle light/dark theme">☀️</button>
    <button class="control-btn" id="font-smaller" title="Decrease font size">A-</button>
    <button class="control-btn" id="font-larger" title="Increase font size">A+</button>
  </div>

  <div class="filter-status">
    <span class="filter-text">Filtering...</span>
    <button class="clear-filter">Clear Filter</button>
  </div>
  
  <div class="book-header">
    <h1 property="name">display</h1>
    <div class="path"><a href="display.lisp" class="source-link">books/xdoc/display</a></div>
  </div>
  
  <main property="text">
<div class="form-block other" id="form-0" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-in-package" data-sym="IN-PACKAGE">in-package</a> <span class="string">"XDOC"</span>)</pre>
  </div>

<div class="form-block other" id="form-1" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="prepare-topic.html" title="Open prepare-topic">"prepare-topic"</a>)</pre>
  </div>

<div class="form-block other" id="form-2" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="spellcheck.html" title="Open spellcheck">"spellcheck"</a>)</pre>
  </div>

<div class="form-block other" id="form-3" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="word-wrap.html" title="Open word-wrap">"word-wrap"</a>)</pre>
  </div>

<div class="form-block other" id="form-4" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="defxdoc-raw.html" title="Open defxdoc-raw">"defxdoc-raw"</a>)</pre>
  </div>

<div class="form-block other" id="form-5" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-include-book" data-sym="INCLUDE-BOOK">include-book</a> <a class="include-path" href="../../std/strings/fast-cat.html" title="Open std/strings/fast-cat">"std/strings/fast-cat"</a> <span class="keyword">:dir</span> <span class="keyword">:system</span>)</pre>
  </div>

<div class="form-block other" id="form-6" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-set-state-ok" data-sym="SET-STATE-OK">set-state-ok</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>)</pre>
  </div>

<div class="form-block other" id="form-7" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-program" data-sym="PROGRAM">program</a>)</pre>
  </div>

<div class="form-block other" id="form-8" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> *xdoc-tag-alist-simple*
  '((<span class="string">"b"</span> <span class="string">"__"</span> . <span class="string">"__"</span>) (<span class="string">"i"</span> <span class="string">"_"</span> . <span class="string">"_"</span>)
    (<span class="string">"u"</span> <span class="string">"_"</span> . <span class="string">"_"</span>)
    (<span class="string">"tt"</span>)
    (<span class="string">"v"</span>)
    (<span class="string">"em"</span> <span class="string">"_"</span> . <span class="string">"_"</span>)
    (<span class="string">"color"</span>)
    (<span class="string">"sf"</span>)
    (<span class="string">"box"</span>)
    (<span class="string">"img"</span>)
    (<span class="string">"icon"</span>)
    (<span class="string">"page"</span>)
    (<span class="string">"mathfrag"</span>)
    (<span class="string">"stv"</span> <span class="string">"{STV display}"</span>)))</pre>
  </div>

<div class="form-block function" id="def-sgr-prefix" data-defines="SGR-PREFIX" data-references="*SGR-PREFIX*,STRING,QUOTE,CONCATENATE,N,DEFUN" data-part-name="SGR-PREFIX" data-part-args="N" data-part-body="N,*SGR-PREFIX*,STRING,QUOTE,CONCATENATE" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="SGR-PREFIX">sgr-prefix</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-sgr-prefix" data-sym="SGR-PREFIX" title="(defun xdoc::sgr-prefix (xdoc::n)
  (concatenate &#39;string xdoc::*sgr-prefix* xdoc::n &quot;m&quot;))">sgr-prefix</a>
  (n)
  (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a> *sgr-prefix* n <span class="string">"m"</span>))</pre>
  </div>

<div class="form-block other" id="form-10" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> *sgr-suffix* (<a class="sym-link local-def" href="#def-sgr-prefix" data-sym="SGR-PREFIX" title="(defun xdoc::sgr-prefix (xdoc::n)
  (concatenate &#39;string xdoc::*sgr-prefix* xdoc::n &quot;m&quot;))">sgr-prefix</a> <span class="string">"0"</span>))</pre>
  </div>

<div class="form-block other" id="form-11" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> *xdoc-tag-alist-fancy*
  (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> <span class="string">"b"</span> (<a class="sym-link local-def" href="#def-sgr-prefix" data-sym="SGR-PREFIX" title="(defun xdoc::sgr-prefix (xdoc::n)
  (concatenate &#39;string xdoc::*sgr-prefix* xdoc::n &quot;m&quot;))">sgr-prefix</a> <span class="string">"31;1"</span>) *sgr-suffix*)
    (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> <span class="string">"i"</span> (<a class="sym-link local-def" href="#def-sgr-prefix" data-sym="SGR-PREFIX" title="(defun xdoc::sgr-prefix (xdoc::n)
  (concatenate &#39;string xdoc::*sgr-prefix* xdoc::n &quot;m&quot;))">sgr-prefix</a> <span class="string">"3"</span>) *sgr-suffix*)
    (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> <span class="string">"u"</span> (<a class="sym-link local-def" href="#def-sgr-prefix" data-sym="SGR-PREFIX" title="(defun xdoc::sgr-prefix (xdoc::n)
  (concatenate &#39;string xdoc::*sgr-prefix* xdoc::n &quot;m&quot;))">sgr-prefix</a> <span class="string">"4"</span>) *sgr-suffix*)
    (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> <span class="string">"tt"</span> (<a class="sym-link local-def" href="#def-sgr-prefix" data-sym="SGR-PREFIX" title="(defun xdoc::sgr-prefix (xdoc::n)
  (concatenate &#39;string xdoc::*sgr-prefix* xdoc::n &quot;m&quot;))">sgr-prefix</a> <span class="string">"47"</span>) *sgr-suffix*)
    (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> <span class="string">"v"</span> (<a class="sym-link local-def" href="#def-sgr-prefix" data-sym="SGR-PREFIX" title="(defun xdoc::sgr-prefix (xdoc::n)
  (concatenate &#39;string xdoc::*sgr-prefix* xdoc::n &quot;m&quot;))">sgr-prefix</a> <span class="string">"47"</span>) *sgr-suffix*)
    (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> <span class="string">"em"</span> (<a class="sym-link local-def" href="#def-sgr-prefix" data-sym="SGR-PREFIX" title="(defun xdoc::sgr-prefix (xdoc::n)
  (concatenate &#39;string xdoc::*sgr-prefix* xdoc::n &quot;m&quot;))">sgr-prefix</a> <span class="string">"3"</span>) *sgr-suffix*)
    '((<span class="string">"color"</span>) (<span class="string">"sf"</span>)
      (<span class="string">"box"</span>)
      (<span class="string">"img"</span>)
      (<span class="string">"icon"</span>)
      (<span class="string">"page"</span>)
      (<span class="string">"mathfrag"</span>)
      (<span class="string">"stv"</span> <span class="string">"{STV display}"</span>))))</pre>
  </div>

<div class="form-block other" id="form-12" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> *xdoc-tag-alist-plain*
  '((<span class="string">"b"</span>) (<span class="string">"i"</span>)
    (<span class="string">"u"</span>)
    (<span class="string">"tt"</span>)
    (<span class="string">"v"</span>)
    (<span class="string">"em"</span>)
    (<span class="string">"color"</span>)
    (<span class="string">"sf"</span>)
    (<span class="string">"box"</span>)
    (<span class="string">"img"</span>)
    (<span class="string">"icon"</span>)
    (<span class="string">"page"</span>)
    (<span class="string">"mathfrag"</span>)
    (<span class="string">"stv"</span> <span class="string">"{STV display}"</span>)))</pre>
  </div>

<div class="form-block function" id="def-xdoc-tag-alist-fancy-p" data-defines="XDOC-TAG-ALIST-FANCY-P" data-references="STRING-EQUAL,EQUAL,NULL,OR,VAL,DEFUN" data-used-by="XDOC-TAG-ALIST" data-part-name="XDOC-TAG-ALIST-FANCY-P" data-part-args="VAL" data-part-body="STRING-EQUAL,EQUAL,VAL,NULL,OR" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="XDOC-TAG-ALIST-FANCY-P">xdoc-tag-alist-fancy-p</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-xdoc-tag-alist-fancy-p" data-sym="XDOC-TAG-ALIST-FANCY-P" title="(defun xdoc::xdoc-tag-alist-fancy-p (xdoc::val)
  (or (null xdoc::val) (equal xdoc::val &quot;&quot;) (string-equal xdoc::val &quot;FANCY&quot;)))">xdoc-tag-alist-fancy-p</a>
  (val)
  (<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> val)
    (equal val <span class="string">""</span>)
    (<a class="sym-link system" href="../../axioms.html#def-string-equal" data-sym="STRING-EQUAL">string-equal</a> val <span class="string">"FANCY"</span>)))</pre>
  </div>

<div class="form-block function" id="def-xdoc-tag-alist" data-defines="XDOC-TAG-ALIST" data-references="UPDATE-TAGS-DISPLAY,QUOTE,HARD,*XDOC-TAG-ALIST-PLAIN*,*XDOC-TAG-ALIST-SIMPLE*,STRING-EQUAL,*XDOC-TAG-ALIST-FANCY*,XDOC-TAG-ALIST-FANCY-P,COND,VALUE,GETENV$,VAL,ER,B*,T,XARGS,DECLARE,STATE,DEFUN" data-used-by="SUMMARIZE-NEARBY-TOPIC,TOPIC-TO-TEXT,MERGE-TEXT" data-part-name="XDOC-TAG-ALIST" data-part-args="STATE" data-part-declare="T,XARGS,DECLARE" data-part-body="UPDATE-TAGS-DISPLAY,QUOTE,HARD,T,*XDOC-TAG-ALIST-PLAIN*,*XDOC-TAG-ALIST-SIMPLE*,STRING-EQUAL,*XDOC-TAG-ALIST-FANCY*,XDOC-TAG-ALIST-FANCY-P,COND,VALUE,STATE,GETENV$,VAL,ER,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="XDOC-TAG-ALIST">xdoc-tag-alist</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
  (state)
  (declare (xargs <span class="keyword">:guard</span> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>))
  (b* (((<a class="sym-link system" href="../../axioms.html#def-er" data-sym="ER">er</a> val) (<a class="sym-link system" href="../../axioms.html#def-getenv_24" data-sym="GETENV$">getenv$</a> <span class="string">"ACL2_XDOC_TAGS"</span> state)))
    (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link local-def" href="#def-xdoc-tag-alist-fancy-p" data-sym="XDOC-TAG-ALIST-FANCY-P" title="(defun xdoc::xdoc-tag-alist-fancy-p (xdoc::val)
  (or (null xdoc::val) (equal xdoc::val &quot;&quot;) (string-equal xdoc::val &quot;FANCY&quot;)))">xdoc-tag-alist-fancy-p</a> val) *xdoc-tag-alist-fancy*)
        ((<a class="sym-link system" href="../../axioms.html#def-string-equal" data-sym="STRING-EQUAL">string-equal</a> val <span class="string">"SIMPLE"</span>) *xdoc-tag-alist-simple*)
        ((<a class="sym-link system" href="../../axioms.html#def-string-equal" data-sym="STRING-EQUAL">string-equal</a> val <span class="string">"PLAIN"</span>) *xdoc-tag-alist-plain*)
        (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-er" data-sym="ER">er</a> hard
            'update-tags-display
            <span class="string">"When environment variable ACL2_XDOC_TAGS has a non-empty ~
                    value, that value must be (up to case) ~v0.  The value ~
                    ~x1 is thus illegal.  See :DOC terminal."</span>
            '(<span class="string">"FANCY"</span> <span class="string">"SIMPLE"</span> <span class="string">"PLAIN"</span>)
            val))))))</pre>
  </div>

<div class="form-block function" id="def-topic-to-rendered" data-defines="TOPIC-TO-RENDERED" data-references="INTERN,HONS-GET,CDR,TOPIC-TO-RENDERED-TABLE,TOPIC,DEFUN" data-used-by="TEXT-MATCHES-MANGLE" data-part-name="TOPIC-TO-RENDERED" data-part-args="TOPIC-TO-RENDERED-TABLE,TOPIC" data-part-body="TOPIC-TO-RENDERED-TABLE,TOPIC,INTERN,HONS-GET,CDR" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="TOPIC-TO-RENDERED">topic-to-rendered</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-topic-to-rendered" data-sym="TOPIC-TO-RENDERED" title="(defun xdoc::topic-to-rendered (xdoc::topic xdoc::topic-to-rendered-table)
  (cdr
   (xdoc::hons-get (intern xdoc::topic &quot;ACL2&quot;) xdoc::topic-to-rendered-table)))">topic-to-rendered</a>
  (topic topic-to-rendered-table)
  (cdr (hons-get (<a class="sym-link system" href="../../axioms.html#def-intern" data-sym="INTERN">intern</a> topic <span class="string">"ACL2"</span>)
      topic-to-rendered-table)))</pre>
  </div>

<div class="form-block function" id="def-print-missing-topic-name" data-defines="PRINT-MISSING-TOPIC-NAME" data-references="WORMHOLE-DATA,CONS,SET-WORMHOLE-DATA,WHS,LAMBDA,XDOC-MISSING-LINK,QUOTE,WORMHOLE-EVAL,NAME,DEFUN" data-used-by="TEXT-MATCHES-MANGLE" data-part-name="PRINT-MISSING-TOPIC-NAME" data-part-args="NAME" data-part-body="WORMHOLE-DATA,NAME,CONS,SET-WORMHOLE-DATA,WHS,LAMBDA,XDOC-MISSING-LINK,QUOTE,WORMHOLE-EVAL" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="PRINT-MISSING-TOPIC-NAME">print-missing-topic-name</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-print-missing-topic-name" data-sym="PRINT-MISSING-TOPIC-NAME" title="(defun xdoc::print-missing-topic-name (xdoc::name)
  (xdoc::wormhole-eval &#39;xdoc::xdoc-missing-link
   &#39;(lambda (whs)
      (xdoc::set-wormhole-data whs
       (cons xdoc::name (xdoc::wormhole-data whs))))">print-missing-topic-name</a>
  (name)
  (<a class="sym-link system" href="../../basis-a.html#def-wormhole-eval" data-sym="WORMHOLE-EVAL">wormhole-eval</a> 'xdoc-missing-link
    '(lambda (whs)
      (<a class="sym-link system" href="../../basis-a.html#def-set-wormhole-data" data-sym="SET-WORMHOLE-DATA">set-wormhole-data</a> whs
        (cons name (<a class="sym-link system" href="../../basis-a.html#def-wormhole-data" data-sym="WORMHOLE-DATA">wormhole-data</a> whs))))
    nil))</pre>
  </div>

<div class="form-block function" id="def-left-bracket-start" data-defines="LEFT-BRACKET-START" data-references="*ESCAPE-CHAR*,1-,CHAR,EQL,COND,AND,T,SEARCH,P,LET,BOUND,TEXT,DEFUN" data-used-by="MERGE-TEXT,TEXT-MATCHES-MANGLE" data-part-name="LEFT-BRACKET-START" data-part-args="BOUND,TEXT" data-part-body="LEFT-BRACKET-START,*ESCAPE-CHAR*,1-,CHAR,EQL,COND,AND,BOUND,T,TEXT,SEARCH,P,LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="LEFT-BRACKET-START">left-bracket-start</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-left-bracket-start" data-sym="LEFT-BRACKET-START" title="(defun xdoc::left-bracket-start (xdoc::text xdoc::bound)
  (let ((xdoc::p (search &quot;[&quot; xdoc::text :from-end t :end2 xdoc::bound)))
    (and xdoc::p
         (cond ((eql xdoc::p 0) 0)
               ((eql (char xdoc::text (1- xdoc::p)) xdoc::*escape-char*)
...">left-bracket-start</a>
  (text bound)
  (let ((p (<a class="sym-link system" href="../../axioms.html#def-search" data-sym="SEARCH">search</a> <span class="string">"["</span> text <span class="keyword">:from-end</span> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> <span class="keyword">:end2</span> bound)))
    (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> p
      (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> p <span class="number">0</span>) <span class="number">0</span>)
        ((<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> (<a class="sym-link system" href="../../axioms.html#def-char" data-sym="CHAR">char</a> text (<a class="sym-link system" href="../../axioms.html#def-1-" data-sym="1-">1-</a> p)) *escape-char*) (<a class="sym-link local-def" href="#def-left-bracket-start" data-sym="LEFT-BRACKET-START" title="(defun xdoc::left-bracket-start (xdoc::text xdoc::bound)
  (let ((xdoc::p (search &quot;[&quot; xdoc::text :from-end t :end2 xdoc::bound)))
    (and xdoc::p
         (cond ((eql xdoc::p 0) 0)
               ((eql (char xdoc::text (1- xdoc::p)) xdoc::*escape-char*)
...">left-bracket-start</a> text (<a class="sym-link system" href="../../axioms.html#def-1-" data-sym="1-">1-</a> p)))
        (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> p)))))</pre>
  </div>

<div class="form-block function" id="def-text-matches-mangle" data-defines="TEXT-MATCHES-MANGLE" data-references="STRING-DOWNCASE,STRING,CONCATENATE,+,POSN,LET,LIST,STRING-EQUAL,IF,TEXT-TOPIC,CHAR-EQUAL,QUOTE,SEARCH,ACL2-PREFIX-POSN,TEXT-TOPIC0,T,SUBSEQ,PRINT-MISSING-TOPIC-NAME,NULL,COND,TOPIC-TO-RENDERED,RENDERED,1+,AND,START,LENGTH,LEFT-BRACKET-START,BRACKET-POSN,LET*,TOPIC-TO-RENDERED-TABLE,MANGLE,TEXT,DEFUN" data-used-by="MERGE-TEXT" data-part-name="TEXT-MATCHES-MANGLE" data-part-args="TOPIC-TO-RENDERED-TABLE,MANGLE,TEXT" data-part-body="STRING-DOWNCASE,STRING,CONCATENATE,+,POSN,LET,LIST,STRING-EQUAL,IF,TEXT-TOPIC,CHAR-EQUAL,QUOTE,SEARCH,ACL2-PREFIX-POSN,TEXT-TOPIC0,T,SUBSEQ,PRINT-MISSING-TOPIC-NAME,NULL,COND,TOPIC-TO-RENDERED-TABLE,MANGLE,TOPIC-TO-RENDERED,RENDERED,1+,AND,START,LENGTH,TEXT,LEFT-BRACKET-START,BRACKET-POSN,LET*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="TEXT-MATCHES-MANGLE">text-matches-mangle</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-text-matches-mangle" data-sym="TEXT-MATCHES-MANGLE" title="(defun xdoc::text-matches-mangle
       (xdoc::text xdoc::mangle xdoc::topic-to-rendered-table)
  (let* ((xdoc::bracket-posn
          (xdoc::left-bracket-start xdoc::text (length xdoc::text)))
         (xdoc::start (and xdoc::bracket-posn (1+ xdoc::bracket-posn)))
...">text-matches-mangle</a>
  (text mangle topic-to-rendered-table)
  (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((bracket-posn (<a class="sym-link local-def" href="#def-left-bracket-start" data-sym="LEFT-BRACKET-START" title="(defun xdoc::left-bracket-start (xdoc::text xdoc::bound)
  (let ((xdoc::p (search &quot;[&quot; xdoc::text :from-end t :end2 xdoc::bound)))
    (and xdoc::p
         (cond ((eql xdoc::p 0) 0)
               ((eql (char xdoc::text (1- xdoc::p)) xdoc::*escape-char*)
...">left-bracket-start</a> text (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> text))) (start (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> bracket-posn (<a class="sym-link system" href="../../axioms.html#def-1_2B" data-sym="1+">1+</a> bracket-posn)))
      (rendered (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> start
          (<a class="sym-link local-def" href="#def-topic-to-rendered" data-sym="TOPIC-TO-RENDERED" title="(defun xdoc::topic-to-rendered (xdoc::topic xdoc::topic-to-rendered-table)
  (cdr
   (xdoc::hons-get (intern xdoc::topic &quot;ACL2&quot;) xdoc::topic-to-rendered-table)))">topic-to-rendered</a> mangle
            topic-to-rendered-table))))
    (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> start) nil)
      ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> rendered) (<a class="sym-link local-def" href="#def-print-missing-topic-name" data-sym="PRINT-MISSING-TOPIC-NAME" title="(defun xdoc::print-missing-topic-name (xdoc::name)
  (xdoc::wormhole-eval &#39;xdoc::xdoc-missing-link
   &#39;(lambda (whs)
      (xdoc::set-wormhole-data whs
       (cons xdoc::name (xdoc::wormhole-data whs))))">print-missing-topic-name</a> (<a class="sym-link system" href="../../axioms.html#def-subseq" data-sym="SUBSEQ">subseq</a> text start (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> text))))
      (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((text-topic0 (<a class="sym-link system" href="../../axioms.html#def-subseq" data-sym="SUBSEQ">subseq</a> text start (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> text))) (acl2-prefix-posn (<a class="sym-link system" href="../../axioms.html#def-search" data-sym="SEARCH">search</a> <span class="string">"acl2::"</span> text-topic0 <span class="keyword">:test</span> '<a class="sym-link system" href="../../axioms.html#def-char-equal" data-sym="CHAR-EQUAL">char-equal</a>))
            (text-topic (if acl2-prefix-posn
                (<a class="sym-link system" href="../../axioms.html#def-subseq" data-sym="SUBSEQ">subseq</a> text-topic0 <span class="number">6</span> (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> text-topic0))
                text-topic0)))
          (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-string-equal" data-sym="STRING-EQUAL">string-equal</a> rendered text-topic) (if acl2-prefix-posn
                (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> text-topic)
                <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>))
            (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (let ((posn (<a class="sym-link system" href="../../axioms.html#def-search" data-sym="SEARCH">search</a> <span class="string">"::"</span> rendered)))
                (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> posn
                     (<a class="sym-link system" href="../../axioms.html#def-string-equal" data-sym="STRING-EQUAL">string-equal</a> (<a class="sym-link system" href="../../axioms.html#def-subseq" data-sym="SUBSEQ">subseq</a> rendered
                         (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> posn <span class="number">2</span>)
                         (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> rendered))
                       text-topic0)) (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a>
                        (<a class="sym-link system" href="../../axioms.html#def-string-downcase" data-sym="STRING-DOWNCASE">string-downcase</a> (<a class="sym-link system" href="../../axioms.html#def-subseq" data-sym="SUBSEQ">subseq</a> rendered <span class="number">0</span> (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> posn <span class="number">2</span>)))
                        text-topic0)))
                  (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> rendered))))))))))</pre>
  </div>

<div class="form-block function" id="def-fix-close-see" data-defines="FIX-CLOSE-SEE" data-references="CAR,CONSP,ASSERT$,T,STRINGP,LENGTH,1+,SUBSEQ,STRING,QUOTE,CONCATENATE,NULL,COND,MATCH,BRACKET-POSN,STR,DEFUN" data-used-by="MERGE-TEXT" data-part-name="FIX-CLOSE-SEE" data-part-args="MATCH,BRACKET-POSN,STR" data-part-body="CAR,CONSP,ASSERT$,T,STRINGP,LENGTH,1+,SUBSEQ,STRING,QUOTE,CONCATENATE,MATCH,STR,BRACKET-POSN,NULL,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FIX-CLOSE-SEE">fix-close-see</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-fix-close-see" data-sym="FIX-CLOSE-SEE" title="(defun xdoc::fix-close-see (xdoc::str xdoc::bracket-posn xdoc::match)
  (cond ((null xdoc::bracket-posn) xdoc::str)
        ((null xdoc::match)
         (concatenate &#39;string (subseq xdoc::str 0 xdoc::bracket-posn)
                      (subseq xdoc::str (1+ xdoc::bracket-posn)
...">fix-close-see</a>
  (str bracket-posn <a class="sym-link system" href="../../basis-b.html#def-match" data-sym="MATCH">match</a>)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> bracket-posn) str)
    ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> <a class="sym-link system" href="../../basis-b.html#def-match" data-sym="MATCH">match</a>) (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a>
        (<a class="sym-link system" href="../../axioms.html#def-subseq" data-sym="SUBSEQ">subseq</a> str <span class="number">0</span> bracket-posn)
        (<a class="sym-link system" href="../../axioms.html#def-subseq" data-sym="SUBSEQ">subseq</a> str
          (<a class="sym-link system" href="../../axioms.html#def-1_2B" data-sym="1+">1+</a> bracket-posn)
          (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> str))))
    ((stringp <a class="sym-link system" href="../../basis-b.html#def-match" data-sym="MATCH">match</a>) (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a>
        (<a class="sym-link system" href="../../axioms.html#def-subseq" data-sym="SUBSEQ">subseq</a> str <span class="number">0</span> bracket-posn)
        (<a class="sym-link system" href="../../axioms.html#def-subseq" data-sym="SUBSEQ">subseq</a> str
          (<a class="sym-link system" href="../../axioms.html#def-1_2B" data-sym="1+">1+</a> bracket-posn)
          (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> str))
        <span class="string">" (see ["</span>
        <a class="sym-link system" href="../../basis-b.html#def-match" data-sym="MATCH">match</a>
        <span class="string">"])"</span>))
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-assert_24" data-sym="ASSERT$">assert$</a> (consp <a class="sym-link system" href="../../basis-b.html#def-match" data-sym="MATCH">match</a>)
        (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a>
          (<a class="sym-link system" href="../../axioms.html#def-subseq" data-sym="SUBSEQ">subseq</a> str <span class="number">0</span> (<a class="sym-link system" href="../../axioms.html#def-1_2B" data-sym="1+">1+</a> bracket-posn))
          (car <a class="sym-link system" href="../../basis-b.html#def-match" data-sym="MATCH">match</a>)
          <span class="string">"]"</span>)))))</pre>
  </div>

<div class="form-block function" id="def-skip-to-close" data-defines="SKIP-TO-CLOSE" data-references="CDR,EQUAL,CLOSETOK-NAME,CLOSETOK-P,AND,NAME,CAR,TOK1,B*,T,ATOM,COND,X,TAG,DEFUN" data-used-by="MERGE-TEXT" data-part-name="SKIP-TO-CLOSE" data-part-args="X,TAG" data-part-body="SKIP-TO-CLOSE,CDR,TAG,EQUAL,CLOSETOK-NAME,CLOSETOK-P,AND,NAME,CAR,TOK1,B*,T,X,ATOM,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="SKIP-TO-CLOSE">skip-to-close</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-skip-to-close" data-sym="SKIP-TO-CLOSE" title="(defun xdoc::skip-to-close (xdoc::tag xdoc::x)
  (cond ((atom xdoc::x) xdoc::x)
        (t
         (xdoc::b*
          ((xdoc::tok1 (car xdoc::x))
...">skip-to-close</a>
  (tag x)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> x) x)
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (b* ((tok1 (car x)) (name (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (closetok-p tok1)
              (closetok-name tok1))))
        (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((equal name tag) (cdr x))
          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link local-def" href="#def-skip-to-close" data-sym="SKIP-TO-CLOSE" title="(defun xdoc::skip-to-close (xdoc::tag xdoc::x)
  (cond ((atom xdoc::x) xdoc::x)
        (t
         (xdoc::b*
          ((xdoc::tok1 (car xdoc::x))
...">skip-to-close</a> tag (cdr x))))))))</pre>
  </div>

<div class="form-block function" id="def-translate-entities-to-plaintext-aux" data-defines="TRANSLATE-ENTITIES-TO-PLAINTEXT-AUX" data-references="+,CONS,REVAPPEND-CHARS,ENTITYTOK-AS-PLAINTEXT,PLAINTEXT,READ-ENTITY,TOK,ERR,EQL,CHAR,CHAR1,MV,>=,WHEN,B*,ACC,XL,N,X,DEFUN" data-used-by="TRANSLATE-ENTITIES-TO-PLAINTEXT" data-part-name="TRANSLATE-ENTITIES-TO-PLAINTEXT-AUX" data-part-args="ACC,XL,N,X" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="TRANSLATE-ENTITIES-TO-PLAINTEXT-AUX">translate-entities-to-plaintext-aux</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-translate-entities-to-plaintext-aux" data-sym="TRANSLATE-ENTITIES-TO-PLAINTEXT-AUX" title="(defun xdoc::translate-entities-to-plaintext-aux
       (xdoc::x xdoc::n xdoc::xl xdoc::acc)
  &quot;Returns (MV ERR ACC)&quot;
  (xdoc::b*
   (((when (&gt;= xdoc::n xdoc::xl)) (xdoc::mv nil xdoc::acc))
...">translate-entities-to-plaintext-aux</a>
  (x n xl acc)
  <span class="string">"Returns (MV ERR ACC)"</span>
  (b* (((when (<a class="sym-link system" href="../../axioms.html#def-_3E_3D" data-sym="&gt;=">&gt;=</a> n xl)) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> nil acc)) (char1 (<a class="sym-link system" href="../../axioms.html#def-char" data-sym="CHAR">char</a> x n))
      ((when (<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> char1 #\&amp;)) (b* (((<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> err n tok) (read-entity x n xl)) ((when err) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> err nil))
            (plaintext (entitytok-as-plaintext tok))
            (acc (revappend-chars plaintext acc)))
          (<a class="sym-link local-def" href="#def-translate-entities-to-plaintext-aux" data-sym="TRANSLATE-ENTITIES-TO-PLAINTEXT-AUX" title="(defun xdoc::translate-entities-to-plaintext-aux
       (xdoc::x xdoc::n xdoc::xl xdoc::acc)
  &quot;Returns (MV ERR ACC)&quot;
  (xdoc::b*
   (((when (&gt;= xdoc::n xdoc::xl)) (xdoc::mv nil xdoc::acc))
...">translate-entities-to-plaintext-aux</a> x
            n
            xl
            acc)))
      (acc (cons char1 acc)))
    (<a class="sym-link local-def" href="#def-translate-entities-to-plaintext-aux" data-sym="TRANSLATE-ENTITIES-TO-PLAINTEXT-AUX" title="(defun xdoc::translate-entities-to-plaintext-aux
       (xdoc::x xdoc::n xdoc::xl xdoc::acc)
  &quot;Returns (MV ERR ACC)&quot;
  (xdoc::b*
   (((when (&gt;= xdoc::n xdoc::xl)) (xdoc::mv nil xdoc::acc))
...">translate-entities-to-plaintext-aux</a> x
      (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">1</span> n)
      xl
      acc)))</pre>
  </div>

<div class="form-block function" id="def-translate-entities-to-plaintext" data-defines="TRANSLATE-ENTITIES-TO-PLAINTEXT" data-references="RCHARS-TO-STRING,LENGTH,TRANSLATE-ENTITIES-TO-PLAINTEXT-AUX,ACC,ERR,MV,B*,X,DEFUN" data-used-by="TRANSLATE-ATT-TO-PLAINTEXT" data-part-name="TRANSLATE-ENTITIES-TO-PLAINTEXT" data-part-args="X" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="TRANSLATE-ENTITIES-TO-PLAINTEXT">translate-entities-to-plaintext</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-translate-entities-to-plaintext" data-sym="TRANSLATE-ENTITIES-TO-PLAINTEXT" title="(defun xdoc::translate-entities-to-plaintext (xdoc::x)
  &quot;Returns (MV ERR PLAINTEXT-STR)&quot;
  (xdoc::b*
   (((xdoc::mv xdoc::err xdoc::acc)
     (xdoc::translate-entities-to-plaintext-aux xdoc::x 0 (length xdoc::x)
...">translate-entities-to-plaintext</a>
  (x)
  <span class="string">"Returns (MV ERR PLAINTEXT-STR)"</span>
  (b* (((<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> err acc) (<a class="sym-link local-def" href="#def-translate-entities-to-plaintext-aux" data-sym="TRANSLATE-ENTITIES-TO-PLAINTEXT-AUX" title="(defun xdoc::translate-entities-to-plaintext-aux
       (xdoc::x xdoc::n xdoc::xl xdoc::acc)
  &quot;Returns (MV ERR ACC)&quot;
  (xdoc::b*
   (((when (&gt;= xdoc::n xdoc::xl)) (xdoc::mv nil xdoc::acc))
...">translate-entities-to-plaintext-aux</a> x
         <span class="number">0</span>
         (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> x)
         nil)))
    (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> err (rchars-to-string acc))))</pre>
  </div>

<div class="form-block function" id="def-translate-att-to-plaintext" data-defines="TRANSLATE-ATT-TO-PLAINTEXT" data-references="QUOTE,HARD?,ER,WHEN,TRANSLATE-ENTITIES-TO-PLAINTEXT,TEXT,ERR,MV,B*,X,CTX,DEFUN" data-used-by="MERGE-TEXT" data-part-name="TRANSLATE-ATT-TO-PLAINTEXT" data-part-args="X,CTX" data-part-body="CTX,TRANSLATE-ATT-TO-PLAINTEXT,QUOTE,HARD?,ER,WHEN,X,TRANSLATE-ENTITIES-TO-PLAINTEXT,TEXT,ERR,MV,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="TRANSLATE-ATT-TO-PLAINTEXT">translate-att-to-plaintext</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-translate-att-to-plaintext" data-sym="TRANSLATE-ATT-TO-PLAINTEXT" title="(defun xdoc::translate-att-to-plaintext (xdoc::ctx xdoc::x)
  (xdoc::b*
   (((xdoc::mv xdoc::err xdoc::text)
     (xdoc::translate-entities-to-plaintext xdoc::x))
    ((when xdoc::err)
...">translate-att-to-plaintext</a>
  (ctx x)
  (b* (((<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> err text) (<a class="sym-link local-def" href="#def-translate-entities-to-plaintext" data-sym="TRANSLATE-ENTITIES-TO-PLAINTEXT" title="(defun xdoc::translate-entities-to-plaintext (xdoc::x)
  &quot;Returns (MV ERR PLAINTEXT-STR)&quot;
  (xdoc::b*
   (((xdoc::mv xdoc::err xdoc::acc)
     (xdoc::translate-entities-to-plaintext-aux xdoc::x 0 (length xdoc::x)
...">translate-entities-to-plaintext</a> x)) ((when err) (<a class="sym-link system" href="../../axioms.html#def-er" data-sym="ER">er</a> hard?
          '<a class="sym-link local-def" href="#def-translate-att-to-plaintext" data-sym="TRANSLATE-ATT-TO-PLAINTEXT" title="(defun xdoc::translate-att-to-plaintext (xdoc::ctx xdoc::x)
  (xdoc::b*
   (((xdoc::mv xdoc::err xdoc::text)
     (xdoc::translate-entities-to-plaintext xdoc::x))
    ((when xdoc::err)
...">translate-att-to-plaintext</a>
          <span class="string">"Error in ~s0: ~s1~%"</span>
          ctx
          err)
        <span class="string">""</span>))
    text))</pre>
  </div>

<div class="form-block other" id="form-24" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> *img-prefix*
  (coerce (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (code-char <span class="number">25</span>)) '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a>))</pre>
  </div>

<div class="form-block other" id="form-25" typeof="Code">
    <div class="form-header"><span class="form-type">other</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defconst" data-sym="DEFCONST">defconst</a> *img-suffix*
  (coerce (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> (code-char <span class="number">26</span>)) '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a>))</pre>
  </div>

<div class="form-block function" id="def-push-tstk" data-defines="PUSH-TSTK" data-references="CONS,T,NULL,COND,TSTK,TOK,DEFUN" data-used-by="MERGE-TEXT" data-part-name="PUSH-TSTK" data-part-args="TSTK,TOK" data-part-body="CONS,T,TOK,TSTK,NULL,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="PUSH-TSTK">push-tstk</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-push-tstk" data-sym="PUSH-TSTK" title="(defun xdoc::push-tstk (xdoc::tok xdoc::tstk)
  (cond ((null xdoc::tstk) xdoc::tok) (t (cons xdoc::tok xdoc::tstk))))">push-tstk</a>
  (tok tstk)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> tstk) tok)
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (cons tok tstk))))</pre>
  </div>

<div class="form-block function" id="def-pop-tstk" data-defines="POP-TSTK" data-references="CDR,T,CAR,EQ,ATOM,COND,TSTK,DEFUN" data-used-by="MERGE-TEXT" data-part-name="POP-TSTK" data-part-args="TSTK" data-part-body="CDR,T,CAR,EQ,TSTK,ATOM,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="POP-TSTK">pop-tstk</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-pop-tstk" data-sym="POP-TSTK" title="(defun xdoc::pop-tstk (xdoc::tstk)
  (cond ((atom xdoc::tstk) nil) ((eq (car xdoc::tstk) :text) nil)
        (t (cdr xdoc::tstk))))">pop-tstk</a>
  (tstk)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> tstk) nil)
    ((<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (car tstk) <span class="keyword">:text</span>) nil)
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (cdr tstk))))</pre>
  </div>

<div class="form-block function" id="def-accumulate-tstk" data-defines="ACCUMULATE-TSTK" data-references="CDR,T,CONS,CAR,EQ,ATOM,COND,REST,TSTK,DEFUN" data-used-by="MERGE-TEXT" data-part-name="ACCUMULATE-TSTK" data-part-args="REST,TSTK" data-part-body="CDR,ACCUMULATE-TSTK,T,CONS,CAR,EQ,REST,TSTK,ATOM,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="ACCUMULATE-TSTK">accumulate-tstk</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-accumulate-tstk" data-sym="ACCUMULATE-TSTK" title="(defun xdoc::accumulate-tstk (xdoc::tstk rest)
  (cond ((atom xdoc::tstk) rest)
        ((eq (car xdoc::tstk) :text) (cons xdoc::tstk rest))
        (t
         (xdoc::accumulate-tstk (cdr xdoc::tstk)">accumulate-tstk</a>
  (tstk <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> tstk) <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>)
    ((<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (car tstk) <span class="keyword">:text</span>) (cons tstk <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>))
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link local-def" href="#def-accumulate-tstk" data-sym="ACCUMULATE-TSTK" title="(defun xdoc::accumulate-tstk (xdoc::tstk rest)
  (cond ((atom xdoc::tstk) rest)
        ((eq (car xdoc::tstk) :text) (cons xdoc::tstk rest))
        (t
         (xdoc::accumulate-tstk (cdr xdoc::tstk)">accumulate-tstk</a> (cdr tstk)
        (cons (car tstk) <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>)))))</pre>
  </div>

<div class="form-block function" id="def-merge-text" data-defines="MERGE-TEXT" data-references="TEXTTOK-TEXTTREE,MERGED-TOK,UNLESS,NORMALIZE-WHITESPACE,ZP,ENTITYTOK-AS-PLAINTEXT,ENTITYTOK-P,TRANSLATE-ATT-TO-PLAINTEXT,HREF-PLAIN,LET*,FIX-CLOSE-SEE,EQ,TEXT-MATCHES-MANGLE,TEXTTOK-P,CONSP,AND,ASSERT$,MATCH,LENGTH,LEFT-BRACKET-START,BRACKET-POSN,TEXTTOK-TEXT,TEXT,MEMBER-EQUAL,ACCUMULATE-TSTK,POP-TSTK,-,CLOSETOK-NAME,CLOSETOK-P,PUSH-TSTK,SKIP-TO-CLOSE,CADR,CDDR,NULL,ENTRY,LET,OR,CAT,CONS,T,*IMG-SUFFIX*,OPENTOK-ATTS,ASSOC-EQUAL,*IMG-PREFIX*,STRING,QUOTE,CONCATENATE,LIST,TOK,COND,+,EQUAL,IF,OPENTOK-NAME,NAME,OPENTOK-P,CDR,REST,CAR,TOK1,ATOM,WHEN,B*,TSTK,IMGP,XDOC-TAG-ALIST,TOPIC-TO-RENDERED-TABLE,HREF,CODES,ACC,X,DEFUN" data-used-by="SUMMARIZE-NEARBY-TOPIC,TOPIC-TO-TEXT" data-part-name="MERGE-TEXT" data-part-args="TSTK,IMGP,XDOC-TAG-ALIST,TOPIC-TO-RENDERED-TABLE,HREF,CODES,ACC,X" data-part-body="TEXTTOK-TEXTTREE,MERGED-TOK,UNLESS,NORMALIZE-WHITESPACE,ZP,ENTITYTOK-AS-PLAINTEXT,ENTITYTOK-P,TRANSLATE-ATT-TO-PLAINTEXT,HREF-PLAIN,LET*,FIX-CLOSE-SEE,EQ,TEXT-MATCHES-MANGLE,TEXTTOK-P,CONSP,AND,ASSERT$,MATCH,LENGTH,LEFT-BRACKET-START,BRACKET-POSN,TEXTTOK-TEXT,TEXT,MEMBER-EQUAL,ACCUMULATE-TSTK,POP-TSTK,-,CLOSETOK-NAME,CLOSETOK-P,PUSH-TSTK,SKIP-TO-CLOSE,CADR,CDDR,NULL,ENTRY,LET,OR,CAT,TSTK,XDOC-TAG-ALIST,TOPIC-TO-RENDERED-TABLE,HREF,CONS,MERGE-TEXT,T,*IMG-SUFFIX*,OPENTOK-ATTS,ASSOC-EQUAL,*IMG-PREFIX*,STRING,QUOTE,CONCATENATE,IMGP,LIST,TOK,COND,+,EQUAL,IF,CODES,OPENTOK-NAME,NAME,OPENTOK-P,CDR,REST,CAR,TOK1,ACC,X,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="MERGE-TEXT">merge-text</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a>
  (x acc
    codes
    href
    topic-to-rendered-table
    <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
    imgp
    tstk)
  (b* (((when (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)) acc) (tok1 (car x))
      (<a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a> (cdr x))
      ((when (opentok-p tok1)) (b* ((name (opentok-name tok1)) (codes (if (equal name <span class="string">"code"</span>)
                (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">1</span> codes)
                codes)))
          (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((equal name <span class="string">"img"</span>) (b* ((tok (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> <span class="keyword">:text</span> (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (imgp (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a>
                           *img-prefix*
                           (cdr (<a class="sym-link system" href="../../axioms.html#def-assoc-equal" data-sym="ASSOC-EQUAL">assoc-equal</a> <span class="string">"src"</span> (opentok-atts tok1)))
                           *img-suffix*))
                       (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> <span class="string">"{IMAGE}"</span>)))))
                (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> (cons tok <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>)
                  acc
                  codes
                  href
                  topic-to-rendered-table
                  <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
                  imgp
                  tstk)))
            ((equal name <span class="string">"icon"</span>) (b* ((tok (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> <span class="keyword">:text</span> <span class="string">"{ICON}"</span>)))
                (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> (cons tok <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>)
                  acc
                  codes
                  href
                  topic-to-rendered-table
                  <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
                  imgp
                  tstk)))
            ((equal name <span class="string">"a"</span>) (b* ((href (cdr (<a class="sym-link system" href="../../axioms.html#def-assoc-equal" data-sym="ASSOC-EQUAL">assoc-equal</a> <span class="string">"href"</span> (opentok-atts tok1)))) (tok (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> <span class="keyword">:text</span> (cat <span class="string">"{"</span>))))
                (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> (cons tok <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>)
                  acc
                  codes
                  href
                  topic-to-rendered-table
                  <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
                  imgp
                  tstk)))
            ((equal name <span class="string">"see"</span>) (b* ((href (<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> href
                     (cdr (<a class="sym-link system" href="../../axioms.html#def-assoc-equal" data-sym="ASSOC-EQUAL">assoc-equal</a> <span class="string">"topic"</span> (opentok-atts tok1))))) (tok (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> <span class="keyword">:text</span> <span class="string">"["</span>)))
                (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> (cons tok <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>)
                  acc
                  codes
                  href
                  topic-to-rendered-table
                  <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
                  imgp
                  tstk)))
            ((equal name <span class="string">"srclink"</span>) (b* ((tok (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> <span class="keyword">:text</span> <span class="string">"&lt;"</span>)))
                (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> (cons tok <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>)
                  acc
                  codes
                  href
                  topic-to-rendered-table
                  <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
                  imgp
                  tstk)))
            (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (let ((entry (<a class="sym-link system" href="../../axioms.html#def-assoc-equal" data-sym="ASSOC-EQUAL">assoc-equal</a> name <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>)))
                (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> entry) (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>
                      (cons tok1 acc)
                      codes
                      href
                      topic-to-rendered-table
                      <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
                      imgp
                      tstk))
                  ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> (cdr entry)) (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>
                      acc
                      codes
                      nil
                      topic-to-rendered-table
                      <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
                      imgp
                      tstk))
                  ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> (<a class="sym-link system" href="../../axioms.html#def-cddr" data-sym="CDDR">cddr</a> entry)) (b* ((tok (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> <span class="keyword">:text</span> (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> entry))))
                      (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> (cons tok (<a class="sym-link local-def" href="#def-skip-to-close" data-sym="SKIP-TO-CLOSE" title="(defun xdoc::skip-to-close (xdoc::tag xdoc::x)
  (cond ((atom xdoc::x) xdoc::x)
        (t
         (xdoc::b*
          ((xdoc::tok1 (car xdoc::x))
...">skip-to-close</a> name x))
                        acc
                        codes
                        href
                        topic-to-rendered-table
                        <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
                        imgp
                        tstk)))
                  (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (b* ((tok (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> <span class="keyword">:text</span> (<a class="sym-link system" href="../../axioms.html#def-cadr" data-sym="CADR">cadr</a> entry))))
                      (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> (cons tok <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>)
                        acc
                        codes
                        href
                        topic-to-rendered-table
                        <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
                        imgp
                        (<a class="sym-link local-def" href="#def-push-tstk" data-sym="PUSH-TSTK" title="(defun xdoc::push-tstk (xdoc::tok xdoc::tstk)
  (cond ((null xdoc::tstk) xdoc::tok) (t (cons xdoc::tok xdoc::tstk))))">push-tstk</a> tok tstk))))))))))
      ((when (closetok-p tok1)) (b* ((name (closetok-name tok1)) (codes (if (equal name <span class="string">"code"</span>)
                (<a class="sym-link system" href="../../axioms.html#def--" data-sym="-">-</a> <span class="number">1</span> codes)
                codes))
            (entry (<a class="sym-link system" href="../../axioms.html#def-assoc-equal" data-sym="ASSOC-EQUAL">assoc-equal</a> name <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>)))
          (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> (entry (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> (cdr entry)) (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>
                    acc
                    codes
                    href
                    topic-to-rendered-table
                    <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
                    imgp
                    tstk))
                ((<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> (<a class="sym-link system" href="../../axioms.html#def-cddr" data-sym="CDDR">cddr</a> entry)) (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>
                    acc
                    codes
                    href
                    topic-to-rendered-table
                    <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
                    imgp
                    tstk))
                (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (b* ((tok (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> <span class="keyword">:text</span> (<a class="sym-link system" href="../../axioms.html#def-cddr" data-sym="CDDR">cddr</a> entry))) (tstk (<a class="sym-link local-def" href="#def-pop-tstk" data-sym="POP-TSTK" title="(defun xdoc::pop-tstk (xdoc::tstk)
  (cond ((atom xdoc::tstk) nil) ((eq (car xdoc::tstk) :text) nil)
        (t (cdr xdoc::tstk))))">pop-tstk</a> tstk)))
                    (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> (cons tok (<a class="sym-link local-def" href="#def-accumulate-tstk" data-sym="ACCUMULATE-TSTK" title="(defun xdoc::accumulate-tstk (xdoc::tstk rest)
  (cond ((atom xdoc::tstk) rest)
        ((eq (car xdoc::tstk) :text) (cons xdoc::tstk rest))
        (t
         (xdoc::accumulate-tstk (cdr xdoc::tstk)">accumulate-tstk</a> tstk <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>))
                      acc
                      codes
                      href
                      topic-to-rendered-table
                      <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
                      imgp
                      tstk)))))
            ((<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> name '(<span class="string">"see"</span>)) (b* ((text (texttok-text (car acc))) (bracket-posn (<a class="sym-link local-def" href="#def-left-bracket-start" data-sym="LEFT-BRACKET-START" title="(defun xdoc::left-bracket-start (xdoc::text xdoc::bound)
  (let ((xdoc::p (search &quot;[&quot; xdoc::text :from-end t :end2 xdoc::bound)))
    (and xdoc::p
         (cond ((eql xdoc::p 0) 0)
               ((eql (char xdoc::text (1- xdoc::p)) xdoc::*escape-char*)
...">left-bracket-start</a> text (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> text)))
                  (<a class="sym-link system" href="../../basis-b.html#def-match" data-sym="MATCH">match</a> (<a class="sym-link system" href="../../axioms.html#def-assert_24" data-sym="ASSERT$">assert$</a> bracket-posn
                      (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> href
                        (consp acc)
                        (texttok-p (car acc))
                        (<a class="sym-link local-def" href="#def-text-matches-mangle" data-sym="TEXT-MATCHES-MANGLE" title="(defun xdoc::text-matches-mangle
       (xdoc::text xdoc::mangle xdoc::topic-to-rendered-table)
  (let* ((xdoc::bracket-posn
          (xdoc::left-bracket-start xdoc::text (length xdoc::text)))
         (xdoc::start (and xdoc::bracket-posn (1+ xdoc::bracket-posn)))
...">text-matches-mangle</a> text
                          href
                          topic-to-rendered-table)))))
                (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> <a class="sym-link system" href="../../basis-b.html#def-match" data-sym="MATCH">match</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>) (let ((tok (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> <span class="keyword">:text</span> <span class="string">"]"</span>)))
                      (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> (cons tok <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>)
                        acc
                        codes
                        nil
                        topic-to-rendered-table
                        <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
                        imgp
                        tstk)))
                  (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>
                      (cons (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> <span class="keyword">:text</span> (<a class="sym-link local-def" href="#def-fix-close-see" data-sym="FIX-CLOSE-SEE" title="(defun xdoc::fix-close-see (xdoc::str xdoc::bracket-posn xdoc::match)
  (cond ((null xdoc::bracket-posn) xdoc::str)
        ((null xdoc::match)
         (concatenate &#39;string (subseq xdoc::str 0 xdoc::bracket-posn)
                      (subseq xdoc::str (1+ xdoc::bracket-posn)
...">fix-close-see</a> text
                            bracket-posn
                            <a class="sym-link system" href="../../basis-b.html#def-match" data-sym="MATCH">match</a>))
                        (cdr acc))
                      codes
                      nil
                      topic-to-rendered-table
                      <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
                      imgp
                      tstk)))))
            ((<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> name '(<span class="string">"a"</span>)) (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((href-plain (if href
                     (<a class="sym-link local-def" href="#def-translate-att-to-plaintext" data-sym="TRANSLATE-ATT-TO-PLAINTEXT" title="(defun xdoc::translate-att-to-plaintext (xdoc::ctx xdoc::x)
  (xdoc::b*
   (((xdoc::mv xdoc::err xdoc::text)
     (xdoc::translate-entities-to-plaintext xdoc::x))
    ((when xdoc::err)
...">translate-att-to-plaintext</a> 'href href)
                     <span class="string">""</span>)) (tok (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> <span class="keyword">:text</span> (cat <span class="string">" | "</span> href-plain <span class="string">"}"</span>))))
                (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> (cons tok <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>)
                  acc
                  codes
                  nil
                  topic-to-rendered-table
                  <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
                  imgp
                  tstk)))
            ((equal name <span class="string">"srclink"</span>) (let ((tok (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> <span class="keyword">:text</span> <span class="string">"&gt;"</span>)))
                (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> (cons tok <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>)
                  acc
                  codes
                  href
                  topic-to-rendered-table
                  <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
                  imgp
                  tstk)))
            (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>
                (cons tok1 acc)
                codes
                href
                topic-to-rendered-table
                <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
                imgp
                tstk)))))
      (tok1 (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((entitytok-p tok1) (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> <span class="keyword">:text</span> (entitytok-as-plaintext tok1)))
          ((<a class="sym-link system" href="../../axioms.html#def-zp" data-sym="ZP">zp</a> codes) (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> <span class="keyword">:text</span> (normalize-whitespace (texttok-text tok1))))
          (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> tok1)))
      ((unless (texttok-p (car acc))) (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>
          (cons tok1 acc)
          codes
          href
          topic-to-rendered-table
          <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
          imgp
          tstk))
      (merged-tok (<a class="sym-link system" href="../../axioms.html#def-list" data-sym="LIST">list</a> <span class="keyword">:text</span> (cons (texttok-texttree (car acc))
            (texttok-texttree tok1)))))
    (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>
      (cons merged-tok (cdr acc))
      codes
      href
      topic-to-rendered-table
      <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
      imgp
      tstk)))</pre>
  </div>

<div class="form-block function" id="def-has-tag-above" data-defines="HAS-TAG-ABOVE" data-references="CDR,CAR,OPENTOK-NAME,EQUAL,OR,ATOM,IF,OPEN-TAGS,TAG,DEFUN" data-used-by="TOKENS-TO-TERMINAL,GET-INDENT-LEVEL" data-part-name="HAS-TAG-ABOVE" data-part-args="OPEN-TAGS,TAG" data-part-body="CDR,HAS-TAG-ABOVE,CAR,OPENTOK-NAME,TAG,EQUAL,OR,OPEN-TAGS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="HAS-TAG-ABOVE">has-tag-above</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-has-tag-above" data-sym="HAS-TAG-ABOVE" title="(defun xdoc::has-tag-above (xdoc::tag xdoc::open-tags)
  (if (atom xdoc::open-tags)
      nil
      (or (equal xdoc::tag (xdoc::opentok-name (car xdoc::open-tags)))
          (xdoc::has-tag-above xdoc::tag (cdr xdoc::open-tags)))))">has-tag-above</a>
  (tag open-tags)
  (if (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> open-tags)
    nil
    (<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (equal tag (opentok-name (car open-tags)))
      (<a class="sym-link local-def" href="#def-has-tag-above" data-sym="HAS-TAG-ABOVE" title="(defun xdoc::has-tag-above (xdoc::tag xdoc::open-tags)
  (if (atom xdoc::open-tags)
      nil
      (or (equal xdoc::tag (xdoc::opentok-name (car xdoc::open-tags)))
          (xdoc::has-tag-above xdoc::tag (cdr xdoc::open-tags)))))">has-tag-above</a> tag (cdr open-tags)))))</pre>
  </div>

<div class="form-block function" id="def-get-indent-level" data-defines="GET-INDENT-LEVEL" data-references="EQUAL,HAS-TAG-ABOVE,IF,CDR,+,QUOTE,MEMBER-EQUAL,CAR,OPENTOK-NAME,NAME,ATOM,WHEN,B*,OPEN-TAGS,DEFUN" data-used-by="TOKENS-TO-TERMINAL,AUTO-INDENT" data-part-name="GET-INDENT-LEVEL" data-part-args="OPEN-TAGS" data-part-body="EQUAL,HAS-TAG-ABOVE,IF,CDR,GET-INDENT-LEVEL,+,QUOTE,MEMBER-EQUAL,CAR,OPENTOK-NAME,NAME,OPEN-TAGS,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="GET-INDENT-LEVEL">get-indent-level</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-get-indent-level" data-sym="GET-INDENT-LEVEL" title="(defun xdoc::get-indent-level (xdoc::open-tags)
  (xdoc::b*
   (((when (atom xdoc::open-tags)) 0)
    (xdoc::name (xdoc::opentok-name (car xdoc::open-tags)))
    ((when (xdoc::member-equal xdoc::name &#39;(&quot;h1&quot; &quot;h2&quot; &quot;h3&quot;))) 0)
...">get-indent-level</a>
  (open-tags)
  (b* (((when (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> open-tags)) <span class="number">0</span>) (name (opentok-name (car open-tags)))
      ((when (<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> name '(<span class="string">"h1"</span> <span class="string">"h2"</span> <span class="string">"h3"</span>))) <span class="number">0</span>)
      ((when (<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> name
           '(<span class="string">"p"</span> <span class="string">"short"</span> <span class="string">"h4"</span> <span class="string">"h5"</span> <span class="string">"index_entry"</span>))) (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">2</span> (<a class="sym-link local-def" href="#def-get-indent-level" data-sym="GET-INDENT-LEVEL" title="(defun xdoc::get-indent-level (xdoc::open-tags)
  (xdoc::b*
   (((when (atom xdoc::open-tags)) 0)
    (xdoc::name (xdoc::opentok-name (car xdoc::open-tags)))
    ((when (xdoc::member-equal xdoc::name &#39;(&quot;h1&quot; &quot;h2&quot; &quot;h3&quot;))) 0)
...">get-indent-level</a> (cdr open-tags))))
      ((when (<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> name '(<span class="string">"index_body"</span>))) (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">4</span> (<a class="sym-link local-def" href="#def-get-indent-level" data-sym="GET-INDENT-LEVEL" title="(defun xdoc::get-indent-level (xdoc::open-tags)
  (xdoc::b*
   (((when (atom xdoc::open-tags)) 0)
    (xdoc::name (xdoc::opentok-name (car xdoc::open-tags)))
    ((when (xdoc::member-equal xdoc::name &#39;(&quot;h1&quot; &quot;h2&quot; &quot;h3&quot;))) 0)
...">get-indent-level</a> (cdr open-tags))))
      ((when (<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> name '(<span class="string">"ol"</span> <span class="string">"ul"</span>))) (if (<a class="sym-link local-def" href="#def-has-tag-above" data-sym="HAS-TAG-ABOVE" title="(defun xdoc::has-tag-above (xdoc::tag xdoc::open-tags)
  (if (atom xdoc::open-tags)
      nil
      (or (equal xdoc::tag (xdoc::opentok-name (car xdoc::open-tags)))
          (xdoc::has-tag-above xdoc::tag (cdr xdoc::open-tags)))))">has-tag-above</a> <span class="string">"li"</span> open-tags)
          (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">4</span> (<a class="sym-link local-def" href="#def-get-indent-level" data-sym="GET-INDENT-LEVEL" title="(defun xdoc::get-indent-level (xdoc::open-tags)
  (xdoc::b*
   (((when (atom xdoc::open-tags)) 0)
    (xdoc::name (xdoc::opentok-name (car xdoc::open-tags)))
    ((when (xdoc::member-equal xdoc::name &#39;(&quot;h1&quot; &quot;h2&quot; &quot;h3&quot;))) 0)
...">get-indent-level</a> (cdr open-tags)))
          (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">6</span> (<a class="sym-link local-def" href="#def-get-indent-level" data-sym="GET-INDENT-LEVEL" title="(defun xdoc::get-indent-level (xdoc::open-tags)
  (xdoc::b*
   (((when (atom xdoc::open-tags)) 0)
    (xdoc::name (xdoc::opentok-name (car xdoc::open-tags)))
    ((when (xdoc::member-equal xdoc::name &#39;(&quot;h1&quot; &quot;h2&quot; &quot;h3&quot;))) 0)
...">get-indent-level</a> (cdr open-tags)))))
      ((when (equal name <span class="string">"dt"</span>)) (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">4</span> (<a class="sym-link local-def" href="#def-get-indent-level" data-sym="GET-INDENT-LEVEL" title="(defun xdoc::get-indent-level (xdoc::open-tags)
  (xdoc::b*
   (((when (atom xdoc::open-tags)) 0)
    (xdoc::name (xdoc::opentok-name (car xdoc::open-tags)))
    ((when (xdoc::member-equal xdoc::name &#39;(&quot;h1&quot; &quot;h2&quot; &quot;h3&quot;))) 0)
...">get-indent-level</a> (cdr open-tags))))
      ((when (equal name <span class="string">"dd"</span>)) (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">6</span> (<a class="sym-link local-def" href="#def-get-indent-level" data-sym="GET-INDENT-LEVEL" title="(defun xdoc::get-indent-level (xdoc::open-tags)
  (xdoc::b*
   (((when (atom xdoc::open-tags)) 0)
    (xdoc::name (xdoc::opentok-name (car xdoc::open-tags)))
    ((when (xdoc::member-equal xdoc::name &#39;(&quot;h1&quot; &quot;h2&quot; &quot;h3&quot;))) 0)
...">get-indent-level</a> (cdr open-tags))))
      ((when (equal name <span class="string">"code"</span>)) (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">4</span> (<a class="sym-link local-def" href="#def-get-indent-level" data-sym="GET-INDENT-LEVEL" title="(defun xdoc::get-indent-level (xdoc::open-tags)
  (xdoc::b*
   (((when (atom xdoc::open-tags)) 0)
    (xdoc::name (xdoc::opentok-name (car xdoc::open-tags)))
    ((when (xdoc::member-equal xdoc::name &#39;(&quot;h1&quot; &quot;h2&quot; &quot;h3&quot;))) 0)
...">get-indent-level</a> (cdr open-tags))))
      ((when (equal name <span class="string">"math"</span>)) (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">4</span> (<a class="sym-link local-def" href="#def-get-indent-level" data-sym="GET-INDENT-LEVEL" title="(defun xdoc::get-indent-level (xdoc::open-tags)
  (xdoc::b*
   (((when (atom xdoc::open-tags)) 0)
    (xdoc::name (xdoc::opentok-name (car xdoc::open-tags)))
    ((when (xdoc::member-equal xdoc::name &#39;(&quot;h1&quot; &quot;h2&quot; &quot;h3&quot;))) 0)
...">get-indent-level</a> (cdr open-tags))))
      ((when (equal name <span class="string">"blockquote"</span>)) (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">4</span> (<a class="sym-link local-def" href="#def-get-indent-level" data-sym="GET-INDENT-LEVEL" title="(defun xdoc::get-indent-level (xdoc::open-tags)
  (xdoc::b*
   (((when (atom xdoc::open-tags)) 0)
    (xdoc::name (xdoc::opentok-name (car xdoc::open-tags)))
    ((when (xdoc::member-equal xdoc::name &#39;(&quot;h1&quot; &quot;h2&quot; &quot;h3&quot;))) 0)
...">get-indent-level</a> (cdr open-tags))))
      ((when (<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> name '(<span class="string">"table"</span>))) (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">4</span> (<a class="sym-link local-def" href="#def-get-indent-level" data-sym="GET-INDENT-LEVEL" title="(defun xdoc::get-indent-level (xdoc::open-tags)
  (xdoc::b*
   (((when (atom xdoc::open-tags)) 0)
    (xdoc::name (xdoc::opentok-name (car xdoc::open-tags)))
    ((when (xdoc::member-equal xdoc::name &#39;(&quot;h1&quot; &quot;h2&quot; &quot;h3&quot;))) 0)
...">get-indent-level</a> (cdr open-tags)))))
    (<a class="sym-link local-def" href="#def-get-indent-level" data-sym="GET-INDENT-LEVEL" title="(defun xdoc::get-indent-level (xdoc::open-tags)
  (xdoc::b*
   (((when (atom xdoc::open-tags)) 0)
    (xdoc::name (xdoc::opentok-name (car xdoc::open-tags)))
    ((when (xdoc::member-equal xdoc::name &#39;(&quot;h1&quot; &quot;h2&quot; &quot;h3&quot;))) 0)
...">get-indent-level</a> (cdr open-tags))))</pre>
  </div>

<div class="form-block function" id="def-get-list-type" data-defines="GET-LIST-TYPE" data-references="CDR,EQUAL,CAR,OPENTOK-NAME,NAME,ATOM,WHEN,B*,OPEN-TAGS,DEFUN" data-used-by="TOKENS-TO-TERMINAL" data-part-name="GET-LIST-TYPE" data-part-args="OPEN-TAGS" data-part-body="CDR,GET-LIST-TYPE,EQUAL,CAR,OPENTOK-NAME,NAME,OPEN-TAGS,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="GET-LIST-TYPE">get-list-type</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-get-list-type" data-sym="GET-LIST-TYPE" title="(defun xdoc::get-list-type (xdoc::open-tags)
  (xdoc::b*
   (((when (atom xdoc::open-tags)) :bulleted)
    (xdoc::name (xdoc::opentok-name (car xdoc::open-tags)))
    ((when (equal xdoc::name &quot;ol&quot;)) :numbered)
...">get-list-type</a>
  (open-tags)
  (b* (((when (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> open-tags)) <span class="keyword">:bulleted</span>) (name (opentok-name (car open-tags)))
      ((when (equal name <span class="string">"ol"</span>)) <span class="keyword">:numbered</span>)
      ((when (equal name <span class="string">"ul"</span>)) <span class="keyword">:bulleted</span>))
    (<a class="sym-link local-def" href="#def-get-list-type" data-sym="GET-LIST-TYPE" title="(defun xdoc::get-list-type (xdoc::open-tags)
  (xdoc::b*
   (((when (atom xdoc::open-tags)) :bulleted)
    (xdoc::name (xdoc::opentok-name (car xdoc::open-tags)))
    ((when (equal xdoc::name &quot;ol&quot;)) :numbered)
...">get-list-type</a> (cdr open-tags))))</pre>
  </div>

<div class="form-block function" id="def-auto-indent" data-defines="AUTO-INDENT" data-references="GET-INDENT-LEVEL,MAKE-LIST,APPEND,OPEN-TAGS,ACC,DEFUN" data-used-by="TOKENS-TO-TERMINAL" data-part-name="AUTO-INDENT" data-part-args="OPEN-TAGS,ACC" data-part-body="ACC,OPEN-TAGS,GET-INDENT-LEVEL,MAKE-LIST,APPEND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="AUTO-INDENT">auto-indent</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-auto-indent" data-sym="AUTO-INDENT" title="(defun xdoc::auto-indent (xdoc::acc xdoc::open-tags)
  (append
   (make-list (xdoc::get-indent-level xdoc::open-tags) :initial-element #\ )
   xdoc::acc))">auto-indent</a>
  (acc open-tags)
  (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> (<a class="sym-link system" href="../../axioms.html#def-make-list" data-sym="MAKE-LIST">make-list</a> (<a class="sym-link local-def" href="#def-get-indent-level" data-sym="GET-INDENT-LEVEL" title="(defun xdoc::get-indent-level (xdoc::open-tags)
  (xdoc::b*
   (((when (atom xdoc::open-tags)) 0)
    (xdoc::name (xdoc::opentok-name (car xdoc::open-tags)))
    ((when (xdoc::member-equal xdoc::name &#39;(&quot;h1&quot; &quot;h2&quot; &quot;h3&quot;))) 0)
...">get-indent-level</a> open-tags)
      <span class="keyword">:initial-element</span> #\ )
    acc))</pre>
  </div>

<div class="form-block function" id="def-maybe-newline" data-defines="MAYBE-NEWLINE" data-references="CONS,CAR,EQL,ATOM,OR,IF,REMOVE-SPACES-FROM-FRONT,B*,ACC,DEFUN" data-used-by="TOKENS-TO-TERMINAL" data-part-name="MAYBE-NEWLINE" data-part-args="ACC" data-part-body="CONS,CAR,EQL,ATOM,OR,IF,REMOVE-SPACES-FROM-FRONT,ACC,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="MAYBE-NEWLINE">maybe-newline</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-maybe-newline" data-sym="MAYBE-NEWLINE" title="(defun xdoc::maybe-newline (xdoc::acc)
  (xdoc::b*
   ((xdoc::acc (xdoc::remove-spaces-from-front xdoc::acc))
    (xdoc::acc
     (if (or (atom xdoc::acc) (eql (car xdoc::acc) #\Newline))
...">maybe-newline</a>
  (acc)
  (b* ((acc (remove-spaces-from-front acc)) (acc (if (<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> acc) (<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> (car acc) #\
))
          acc
          (cons #\
 acc))))
    acc))</pre>
  </div>

<div class="form-block function" id="def-maybe-doublespace" data-defines="MAYBE-DOUBLESPACE" data-references="CONS,CDR,LIST*,CAR,EQL,UNLESS,ATOM,WHEN,REMOVE-SPACES-FROM-FRONT,B*,ACC,DEFUN" data-used-by="TOKENS-TO-TERMINAL" data-part-name="MAYBE-DOUBLESPACE" data-part-args="ACC" data-part-body="CONS,CDR,LIST*,CAR,EQL,UNLESS,ATOM,WHEN,REMOVE-SPACES-FROM-FRONT,ACC,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="MAYBE-DOUBLESPACE">maybe-doublespace</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-maybe-doublespace" data-sym="MAYBE-DOUBLESPACE" title="(defun xdoc::maybe-doublespace (xdoc::acc)
  (xdoc::b*
   ((xdoc::acc (xdoc::remove-spaces-from-front xdoc::acc))
    ((when (atom xdoc::acc)) xdoc::acc)
    ((unless (eql (car xdoc::acc) #\Newline))
...">maybe-doublespace</a>
  (acc)
  (b* ((acc (remove-spaces-from-front acc)) ((when (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> acc)) acc)
      ((unless (<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> (car acc) #\
)) (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> #\
 #\
 acc))
      (acc (remove-spaces-from-front (cdr acc)))
      ((when (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> acc)) acc)
      ((unless (<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> (car acc) #\
)) (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> #\
 #\
 acc)))
    (cons #\
 acc)))</pre>
  </div>

<div class="form-block function" id="def-maybe-triplespace" data-defines="MAYBE-TRIPLESPACE" data-references="CDR,LIST*,CAR,EQL,UNLESS,ATOM,WHEN,REMOVE-SPACES-FROM-FRONT,B*,ACC,DEFUN" data-used-by="TOKENS-TO-TERMINAL" data-part-name="MAYBE-TRIPLESPACE" data-part-args="ACC" data-part-body="CDR,LIST*,CAR,EQL,UNLESS,ATOM,WHEN,REMOVE-SPACES-FROM-FRONT,ACC,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="MAYBE-TRIPLESPACE">maybe-triplespace</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-maybe-triplespace" data-sym="MAYBE-TRIPLESPACE" title="(defun xdoc::maybe-triplespace (xdoc::acc)
  (xdoc::b*
   ((xdoc::acc (xdoc::remove-spaces-from-front xdoc::acc))
    ((when (atom xdoc::acc)) xdoc::acc)
    ((unless (eql (car xdoc::acc) #\Newline))
...">maybe-triplespace</a>
  (acc)
  (b* ((acc (remove-spaces-from-front acc)) ((when (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> acc)) acc)
      ((unless (<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> (car acc) #\
)) (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> #\
 #\
 #\
 acc))
      (acc (remove-spaces-from-front (cdr acc)))
      ((when (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> acc)) acc)
      ((unless (<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> (car acc) #\
)) (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> #\
 #\
 #\
 acc))
      (acc (remove-spaces-from-front (cdr acc)))
      ((when (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> acc)) acc)
      ((unless (<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> (car acc) #\
)) (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> #\
 #\
 #\
 acc)))
    (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> #\
 #\
 acc)))</pre>
  </div>

<div class="form-block function" id="def-prepend-each-line" data-defines="PREPEND-EACH-LINE" data-references="APPEND,REMOVE-SPACES-FROM-FRONT,CONS,+,EQL,UNLESS,CHAR,CHAR-N,>=,WHEN,B*,ACC,XL,N,X,SPACES,DEFUN" data-used-by="TOKENS-TO-TERMINAL" data-part-name="PREPEND-EACH-LINE" data-part-args="ACC,XL,N,X,SPACES" data-part-body="APPEND,REMOVE-SPACES-FROM-FRONT,CONS,+,SPACES,PREPEND-EACH-LINE,EQL,UNLESS,X,CHAR,CHAR-N,ACC,XL,N,>=,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="PREPEND-EACH-LINE">prepend-each-line</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-prepend-each-line" data-sym="PREPEND-EACH-LINE" title="(defun xdoc::prepend-each-line
       (xdoc::spaces xdoc::x xdoc::n xdoc::xl xdoc::acc)
  (xdoc::b*
   (((when (&gt;= xdoc::n xdoc::xl)) xdoc::acc)
    (xdoc::char-n (char xdoc::x xdoc::n))
...">prepend-each-line</a>
  (<a class="sym-link system" href="../../basis-a.html#def-spaces" data-sym="SPACES">spaces</a> x n xl acc)
  (b* (((when (<a class="sym-link system" href="../../axioms.html#def-_3E_3D" data-sym="&gt;=">&gt;=</a> n xl)) acc) (char-n (<a class="sym-link system" href="../../axioms.html#def-char" data-sym="CHAR">char</a> x n))
      ((unless (<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> char-n #\
)) (<a class="sym-link local-def" href="#def-prepend-each-line" data-sym="PREPEND-EACH-LINE" title="(defun xdoc::prepend-each-line
       (xdoc::spaces xdoc::x xdoc::n xdoc::xl xdoc::acc)
  (xdoc::b*
   (((when (&gt;= xdoc::n xdoc::xl)) xdoc::acc)
    (xdoc::char-n (char xdoc::x xdoc::n))
...">prepend-each-line</a> <a class="sym-link system" href="../../basis-a.html#def-spaces" data-sym="SPACES">spaces</a>
          x
          (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">1</span> n)
          xl
          (cons char-n acc)))
      (acc (remove-spaces-from-front acc))
      (acc (cons #\
 acc))
      (acc (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> <a class="sym-link system" href="../../basis-a.html#def-spaces" data-sym="SPACES">spaces</a> acc)))
    (<a class="sym-link local-def" href="#def-prepend-each-line" data-sym="PREPEND-EACH-LINE" title="(defun xdoc::prepend-each-line
       (xdoc::spaces xdoc::x xdoc::n xdoc::xl xdoc::acc)
  (xdoc::b*
   (((when (&gt;= xdoc::n xdoc::xl)) xdoc::acc)
    (xdoc::char-n (char xdoc::x xdoc::n))
...">prepend-each-line</a> <a class="sym-link system" href="../../basis-a.html#def-spaces" data-sym="SPACES">spaces</a>
      x
      (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">1</span> n)
      xl
      acc)))</pre>
  </div>

<div class="form-block function" id="def-tokens-to-terminal" data-defines="TOKENS-TO-TERMINAL" data-references="WORD-WRAP-PARAGRAPH,WRAPPED,LET,PREPEND-EACH-LINE,START-FROM,CHAR,EQL,>,AND,STARTS-WITH-NEWLINE-P,LEN,LEVEL,HAS-TAG-ABOVE,CODEP,TEXTTOK-TEXT,TEXT,LIST*,CLOSETOK-NAME,CLOSETOK-P,STRINGP,ASSOC-EQUAL,TITLE,OPENTOK-ATTS,ATTS,MAYBE-TRIPLESPACE,MAYBE-NEWLINE,AUTO-INDENT,REVAPPEND-CHARS,APPEND,MAYBE-DOUBLESPACE,-,MAKE-LIST,SPACES,GET-INDENT-LEVEL,DESIRED,LENGTH,BULLET-LEN,NAT-TO-DEC-STRING,CAT,GET-LIST-TYPE,EQ,IF,BULLET,T,NFIX,+,EQUAL,QUOTE,MEMBER-EQUAL,COND,CONS,OPENTOK-NAME,NAME,OPENTOK-P,CDR,REST,CAR,TOK1,ATOM,WHEN,B*,ACC,LIST-NUMS,OPEN-TAGS,WRAP-COL,TOKENS,DEFUN" data-used-by="SUMMARIZE-NEARBY-TOPIC,TOPIC-TO-TEXT" data-part-name="TOKENS-TO-TERMINAL" data-part-args="ACC,LIST-NUMS,OPEN-TAGS,WRAP-COL,TOKENS" data-part-body="WORD-WRAP-PARAGRAPH,WRAPPED,LET,PREPEND-EACH-LINE,START-FROM,CHAR,EQL,>,AND,STARTS-WITH-NEWLINE-P,LEN,LEVEL,HAS-TAG-ABOVE,CODEP,TEXTTOK-TEXT,TEXT,LIST*,CLOSETOK-NAME,CLOSETOK-P,WRAP-COL,TOKENS-TO-TERMINAL,STRINGP,ASSOC-EQUAL,TITLE,OPENTOK-ATTS,ATTS,MAYBE-TRIPLESPACE,MAYBE-NEWLINE,AUTO-INDENT,REVAPPEND-CHARS,APPEND,MAYBE-DOUBLESPACE,-,MAKE-LIST,SPACES,GET-INDENT-LEVEL,DESIRED,LENGTH,BULLET-LEN,NAT-TO-DEC-STRING,CAT,GET-LIST-TYPE,EQ,IF,BULLET,T,NFIX,+,EQUAL,QUOTE,MEMBER-EQUAL,COND,LIST-NUMS,CONS,OPEN-TAGS,OPENTOK-NAME,NAME,OPENTOK-P,CDR,REST,CAR,TOK1,ACC,TOKENS,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="TOKENS-TO-TERMINAL">tokens-to-terminal</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-tokens-to-terminal" data-sym="TOKENS-TO-TERMINAL" title="(defun xdoc::tokens-to-terminal
       (xdoc::tokens xdoc::wrap-col xdoc::open-tags xdoc::list-nums xdoc::acc)
  (xdoc::b*
   (((when (atom xdoc::tokens)) xdoc::acc) (xdoc::tok1 (car xdoc::tokens))
    (rest (cdr xdoc::tokens))
...">tokens-to-terminal</a>
  (tokens wrap-col
    open-tags
    list-nums
    acc)
  (b* (((when (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> tokens)) acc) (tok1 (car tokens))
      (<a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a> (cdr tokens))
      ((when (opentok-p tok1)) (b* ((name (opentok-name tok1)) (open-tags (cons tok1 open-tags))
            (list-nums (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> name '(<span class="string">"ol"</span> <span class="string">"ul"</span>)) (cons <span class="number">0</span> list-nums))
                ((equal name <span class="string">"li"</span>) (cons (<a class="sym-link system" href="../../axioms.html#def-_2B" data-sym="+">+</a> <span class="number">1</span> (<a class="sym-link system" href="../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> (car list-nums)))
                    (cdr list-nums)))
                (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> list-nums)))
            (acc (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((equal name <span class="string">"li"</span>) (b* ((bullet (if (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (<a class="sym-link local-def" href="#def-get-list-type" data-sym="GET-LIST-TYPE" title="(defun xdoc::get-list-type (xdoc::open-tags)
  (xdoc::b*
   (((when (atom xdoc::open-tags)) :bulleted)
    (xdoc::name (xdoc::opentok-name (car xdoc::open-tags)))
    ((when (equal xdoc::name &quot;ol&quot;)) :numbered)
...">get-list-type</a> open-tags) <span class="keyword">:bulleted</span>)
                         <span class="string">"* "</span>
                         (cat (nat-to-dec-string (<a class="sym-link system" href="../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> (car list-nums)))
                           <span class="string">". "</span>))) (bullet-len (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> bullet))
                      (desired (<a class="sym-link local-def" href="#def-get-indent-level" data-sym="GET-INDENT-LEVEL" title="(defun xdoc::get-indent-level (xdoc::open-tags)
  (xdoc::b*
   (((when (atom xdoc::open-tags)) 0)
    (xdoc::name (xdoc::opentok-name (car xdoc::open-tags)))
    ((when (xdoc::member-equal xdoc::name &#39;(&quot;h1&quot; &quot;h2&quot; &quot;h3&quot;))) 0)
...">get-indent-level</a> open-tags))
                      (<a class="sym-link system" href="../../basis-a.html#def-spaces" data-sym="SPACES">spaces</a> (<a class="sym-link system" href="../../axioms.html#def-make-list" data-sym="MAKE-LIST">make-list</a> (<a class="sym-link system" href="../../axioms.html#def-nfix" data-sym="NFIX">nfix</a> (<a class="sym-link system" href="../../axioms.html#def--" data-sym="-">-</a> desired bullet-len))
                          <span class="keyword">:initial-element</span> #\ ))
                      (acc (<a class="sym-link local-def" href="#def-maybe-doublespace" data-sym="MAYBE-DOUBLESPACE" title="(defun xdoc::maybe-doublespace (xdoc::acc)
  (xdoc::b*
   ((xdoc::acc (xdoc::remove-spaces-from-front xdoc::acc))
    ((when (atom xdoc::acc)) xdoc::acc)
    ((unless (eql (car xdoc::acc) #\Newline))
...">maybe-doublespace</a> acc))
                      (acc (<a class="sym-link system" href="../../axioms.html#def-append" data-sym="APPEND">append</a> <a class="sym-link system" href="../../basis-a.html#def-spaces" data-sym="SPACES">spaces</a> acc))
                      (acc (revappend-chars bullet acc)))
                    acc))
                ((<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> name
                   '(<span class="string">"h4"</span> <span class="string">"h5"</span>
                     <span class="string">"p"</span>
                     <span class="string">"li"</span>
                     <span class="string">"dt"</span>
                     <span class="string">"dd"</span>
                     <span class="string">"br"</span>
                     <span class="string">"index_head"</span>
                     <span class="string">"index_body"</span>
                     <span class="string">"blockquote"</span>)) (<a class="sym-link local-def" href="#def-auto-indent" data-sym="AUTO-INDENT" title="(defun xdoc::auto-indent (xdoc::acc xdoc::open-tags)
  (append
   (make-list (xdoc::get-indent-level xdoc::open-tags) :initial-element #\ )
   xdoc::acc))">auto-indent</a> (<a class="sym-link local-def" href="#def-maybe-newline" data-sym="MAYBE-NEWLINE" title="(defun xdoc::maybe-newline (xdoc::acc)
  (xdoc::b*
   ((xdoc::acc (xdoc::remove-spaces-from-front xdoc::acc))
    (xdoc::acc
     (if (or (atom xdoc::acc) (eql (car xdoc::acc) #\Newline))
...">maybe-newline</a> acc)
                    open-tags))
                ((<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> name
                   '(<span class="string">"code"</span> <span class="string">"math"</span> <span class="string">"short"</span> <span class="string">"long"</span>)) (<a class="sym-link local-def" href="#def-auto-indent" data-sym="AUTO-INDENT" title="(defun xdoc::auto-indent (xdoc::acc xdoc::open-tags)
  (append
   (make-list (xdoc::get-indent-level xdoc::open-tags) :initial-element #\ )
   xdoc::acc))">auto-indent</a> (<a class="sym-link local-def" href="#def-maybe-doublespace" data-sym="MAYBE-DOUBLESPACE" title="(defun xdoc::maybe-doublespace (xdoc::acc)
  (xdoc::b*
   ((xdoc::acc (xdoc::remove-spaces-from-front xdoc::acc))
    ((when (atom xdoc::acc)) xdoc::acc)
    ((unless (eql (car xdoc::acc) #\Newline))
...">maybe-doublespace</a> acc)
                    open-tags))
                ((<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> name '(<span class="string">"h1"</span> <span class="string">"h2"</span> <span class="string">"h3"</span>)) (<a class="sym-link local-def" href="#def-auto-indent" data-sym="AUTO-INDENT" title="(defun xdoc::auto-indent (xdoc::acc xdoc::open-tags)
  (append
   (make-list (xdoc::get-indent-level xdoc::open-tags) :initial-element #\ )
   xdoc::acc))">auto-indent</a> (<a class="sym-link local-def" href="#def-maybe-triplespace" data-sym="MAYBE-TRIPLESPACE" title="(defun xdoc::maybe-triplespace (xdoc::acc)
  (xdoc::b*
   ((xdoc::acc (xdoc::remove-spaces-from-front xdoc::acc))
    ((when (atom xdoc::acc)) xdoc::acc)
    ((unless (eql (car xdoc::acc) #\Newline))
...">maybe-triplespace</a> acc)
                    open-tags))
                ((<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> name '(<span class="string">"table"</span>)) (<a class="sym-link local-def" href="#def-auto-indent" data-sym="AUTO-INDENT" title="(defun xdoc::auto-indent (xdoc::acc xdoc::open-tags)
  (append
   (make-list (xdoc::get-indent-level xdoc::open-tags) :initial-element #\ )
   xdoc::acc))">auto-indent</a> (<a class="sym-link local-def" href="#def-maybe-newline" data-sym="MAYBE-NEWLINE" title="(defun xdoc::maybe-newline (xdoc::acc)
  (xdoc::b*
   ((xdoc::acc (xdoc::remove-spaces-from-front xdoc::acc))
    (xdoc::acc
     (if (or (atom xdoc::acc) (eql (car xdoc::acc) #\Newline))
...">maybe-newline</a> acc)
                    open-tags))
                ((equal name <span class="string">"index"</span>) (b* ((atts (opentok-atts tok1)) (title (cdr (<a class="sym-link system" href="../../axioms.html#def-assoc-equal" data-sym="ASSOC-EQUAL">assoc-equal</a> <span class="string">"title"</span> atts)))
                      (title (if (stringp title)
                          title
                          <span class="string">"??? title ???"</span>))
                      (acc (<a class="sym-link local-def" href="#def-maybe-triplespace" data-sym="MAYBE-TRIPLESPACE" title="(defun xdoc::maybe-triplespace (xdoc::acc)
  (xdoc::b*
   ((xdoc::acc (xdoc::remove-spaces-from-front xdoc::acc))
    ((when (atom xdoc::acc)) xdoc::acc)
    ((unless (eql (car xdoc::acc) #\Newline))
...">maybe-triplespace</a> acc))
                      (acc (revappend-chars title acc))
                      (acc (<a class="sym-link local-def" href="#def-maybe-doublespace" data-sym="MAYBE-DOUBLESPACE" title="(defun xdoc::maybe-doublespace (xdoc::acc)
  (xdoc::b*
   ((xdoc::acc (xdoc::remove-spaces-from-front xdoc::acc))
    ((when (atom xdoc::acc)) xdoc::acc)
    ((unless (eql (car xdoc::acc) #\Newline))
...">maybe-doublespace</a> acc)))
                    acc))
                (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> acc))))
          (<a class="sym-link local-def" href="#def-tokens-to-terminal" data-sym="TOKENS-TO-TERMINAL" title="(defun xdoc::tokens-to-terminal
       (xdoc::tokens xdoc::wrap-col xdoc::open-tags xdoc::list-nums xdoc::acc)
  (xdoc::b*
   (((when (atom xdoc::tokens)) xdoc::acc) (xdoc::tok1 (car xdoc::tokens))
    (rest (cdr xdoc::tokens))
...">tokens-to-terminal</a> <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>
            wrap-col
            open-tags
            list-nums
            acc)))
      ((when (closetok-p tok1)) (b* ((name (closetok-name tok1)) (open-tags (cdr open-tags))
            (list-nums (if (<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> name '(<span class="string">"ol"</span> <span class="string">"ul"</span>))
                (cdr list-nums)
                list-nums))
            (acc (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> name
                   '(<span class="string">"h1"</span> <span class="string">"h2"</span>
                     <span class="string">"h3"</span>
                     <span class="string">"h4"</span>
                     <span class="string">"h5"</span>
                     <span class="string">"p"</span>
                     <span class="string">"dl"</span>
                     <span class="string">"ul"</span>
                     <span class="string">"ol"</span>
                     <span class="string">"short"</span>
                     <span class="string">"code"</span>
                     <span class="string">"math"</span>
                     <span class="string">"index"</span>
                     <span class="string">"index_body"</span>
                     <span class="string">"blockquote"</span>
                     <span class="string">"table"</span>)) (<a class="sym-link local-def" href="#def-auto-indent" data-sym="AUTO-INDENT" title="(defun xdoc::auto-indent (xdoc::acc xdoc::open-tags)
  (append
   (make-list (xdoc::get-indent-level xdoc::open-tags) :initial-element #\ )
   xdoc::acc))">auto-indent</a> (<a class="sym-link local-def" href="#def-maybe-doublespace" data-sym="MAYBE-DOUBLESPACE" title="(defun xdoc::maybe-doublespace (xdoc::acc)
  (xdoc::b*
   ((xdoc::acc (xdoc::remove-spaces-from-front xdoc::acc))
    ((when (atom xdoc::acc)) xdoc::acc)
    ((unless (eql (car xdoc::acc) #\Newline))
...">maybe-doublespace</a> acc)
                    open-tags))
                ((<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> name
                   '(<span class="string">"li"</span> <span class="string">"dd"</span> <span class="string">"dt"</span> <span class="string">"index_head"</span> <span class="string">"tr"</span>)) (<a class="sym-link local-def" href="#def-auto-indent" data-sym="AUTO-INDENT" title="(defun xdoc::auto-indent (xdoc::acc xdoc::open-tags)
  (append
   (make-list (xdoc::get-indent-level xdoc::open-tags) :initial-element #\ )
   xdoc::acc))">auto-indent</a> (<a class="sym-link local-def" href="#def-maybe-newline" data-sym="MAYBE-NEWLINE" title="(defun xdoc::maybe-newline (xdoc::acc)
  (xdoc::b*
   ((xdoc::acc (xdoc::remove-spaces-from-front xdoc::acc))
    (xdoc::acc
     (if (or (atom xdoc::acc) (eql (car xdoc::acc) #\Newline))
...">maybe-newline</a> acc)
                    open-tags))
                ((<a class="sym-link system" href="../../axioms.html#def-member-equal" data-sym="MEMBER-EQUAL">member-equal</a> name '(<span class="string">"td"</span> <span class="string">"th"</span>)) (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> #\  #\  #\| #\	 acc))
                (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> acc))))
          (<a class="sym-link local-def" href="#def-tokens-to-terminal" data-sym="TOKENS-TO-TERMINAL" title="(defun xdoc::tokens-to-terminal
       (xdoc::tokens xdoc::wrap-col xdoc::open-tags xdoc::list-nums xdoc::acc)
  (xdoc::b*
   (((when (atom xdoc::tokens)) xdoc::acc) (xdoc::tok1 (car xdoc::tokens))
    (rest (cdr xdoc::tokens))
...">tokens-to-terminal</a> <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>
            wrap-col
            open-tags
            list-nums
            acc)))
      (text (texttok-text tok1))
      (codep (<a class="sym-link local-def" href="#def-has-tag-above" data-sym="HAS-TAG-ABOVE" title="(defun xdoc::has-tag-above (xdoc::tag xdoc::open-tags)
  (if (atom xdoc::open-tags)
      nil
      (or (equal xdoc::tag (xdoc::opentok-name (car xdoc::open-tags)))
          (xdoc::has-tag-above xdoc::tag (cdr xdoc::open-tags)))))">has-tag-above</a> <span class="string">"code"</span> open-tags))
      (level (<a class="sym-link local-def" href="#def-get-indent-level" data-sym="GET-INDENT-LEVEL" title="(defun xdoc::get-indent-level (xdoc::open-tags)
  (xdoc::b*
   (((when (atom xdoc::open-tags)) 0)
    (xdoc::name (xdoc::opentok-name (car xdoc::open-tags)))
    ((when (xdoc::member-equal xdoc::name &#39;(&quot;h1&quot; &quot;h2&quot; &quot;h3&quot;))) 0)
...">get-indent-level</a> open-tags))
      (acc (if codep
          (b* ((<a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> text)) (starts-with-newline-p (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-_3E" data-sym="&gt;">&gt;</a> <a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> <span class="number">0</span>) (<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> (<a class="sym-link system" href="../../axioms.html#def-char" data-sym="CHAR">char</a> text <span class="number">0</span>) #\
)))
              (start-from (if starts-with-newline-p
                  <span class="number">1</span>
                  <span class="number">0</span>)))
            (<a class="sym-link local-def" href="#def-prepend-each-line" data-sym="PREPEND-EACH-LINE" title="(defun xdoc::prepend-each-line
       (xdoc::spaces xdoc::x xdoc::n xdoc::xl xdoc::acc)
  (xdoc::b*
   (((when (&gt;= xdoc::n xdoc::xl)) xdoc::acc)
    (xdoc::char-n (char xdoc::x xdoc::n))
...">prepend-each-line</a> (<a class="sym-link system" href="../../axioms.html#def-make-list" data-sym="MAKE-LIST">make-list</a> level <span class="keyword">:initial-element</span> #\ )
              text
              start-from
              (<a class="sym-link system" href="../../axioms.html#def-length" data-sym="LENGTH">length</a> text)
              acc))
          (let ((wrapped (word-wrap-paragraph text
                 level
                 wrap-col)))
            (revappend-chars wrapped acc)))))
    (<a class="sym-link local-def" href="#def-tokens-to-terminal" data-sym="TOKENS-TO-TERMINAL" title="(defun xdoc::tokens-to-terminal
       (xdoc::tokens xdoc::wrap-col xdoc::open-tags xdoc::list-nums xdoc::acc)
  (xdoc::b*
   (((when (atom xdoc::tokens)) xdoc::acc) (xdoc::tok1 (car xdoc::tokens))
    (rest (cdr xdoc::tokens))
...">tokens-to-terminal</a> <a class="sym-link system" href="../../axioms.html#def-rest" data-sym="REST">rest</a>
      wrap-col
      open-tags
      list-nums
      acc)))</pre>
  </div>

<div class="form-block function" id="def-revappend-full-symbol" data-defines="REVAPPEND-FULL-SYMBOL" data-references="SYMBOL-NAME,SYMBOL-PACKAGE-NAME,REVAPPEND-CHARS,B*,ANS,SYM,DEFUN" data-used-by="REVAPPEND-PARENTS" data-part-name="REVAPPEND-FULL-SYMBOL" data-part-args="ANS,SYM" data-part-body="SYMBOL-NAME,SYM,SYMBOL-PACKAGE-NAME,REVAPPEND-CHARS,ANS,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="REVAPPEND-FULL-SYMBOL">revappend-full-symbol</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-revappend-full-symbol" data-sym="REVAPPEND-FULL-SYMBOL" title="(defun xdoc::revappend-full-symbol (xdoc::sym xdoc::ans)
  (xdoc::b*
   ((xdoc::ans
     (str::revappend-chars (xdoc::symbol-package-name xdoc::sym) xdoc::ans))
    (xdoc::ans (str::revappend-chars &quot;::&quot; xdoc::ans))
...">revappend-full-symbol</a>
  (sym ans)
  (b* ((ans (revappend-chars (symbol-package-name sym)
         ans)) (ans (revappend-chars <span class="string">"::"</span> ans))
      (ans (revappend-chars (symbol-name sym) ans)))
    ans))</pre>
  </div>

<div class="form-block function" id="def-revappend-parents" data-defines="REVAPPEND-PARENTS" data-references="REVAPPEND-CHARS,CDDR,CONSP,IF,CAR,REVAPPEND-FULL-SYMBOL,CDR,ATOM,WHEN,B*,ANS,PARENTS,DEFUN" data-used-by="TOPIC-TO-TEXT" data-part-name="REVAPPEND-PARENTS" data-part-args="ANS,PARENTS" data-part-body="REVAPPEND-PARENTS,REVAPPEND-CHARS,CDDR,CONSP,IF,CAR,REVAPPEND-FULL-SYMBOL,CDR,ANS,PARENTS,ATOM,WHEN,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="REVAPPEND-PARENTS">revappend-parents</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-revappend-parents" data-sym="REVAPPEND-PARENTS" title="(defun xdoc::revappend-parents (xdoc::parents xdoc::ans)
  (xdoc::b*
   (((when (atom xdoc::parents)) xdoc::ans)
    ((when (atom (cdr xdoc::parents)))
     (xdoc::revappend-full-symbol (car xdoc::parents) xdoc::ans))
...">revappend-parents</a>
  (parents ans)
  (b* (((when (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> parents)) ans) ((when (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> (cdr parents))) (<a class="sym-link local-def" href="#def-revappend-full-symbol" data-sym="REVAPPEND-FULL-SYMBOL" title="(defun xdoc::revappend-full-symbol (xdoc::sym xdoc::ans)
  (xdoc::b*
   ((xdoc::ans
     (str::revappend-chars (xdoc::symbol-package-name xdoc::sym) xdoc::ans))
    (xdoc::ans (str::revappend-chars &quot;::&quot; xdoc::ans))
...">revappend-full-symbol</a> (car parents) ans))
      (ans (<a class="sym-link local-def" href="#def-revappend-full-symbol" data-sym="REVAPPEND-FULL-SYMBOL" title="(defun xdoc::revappend-full-symbol (xdoc::sym xdoc::ans)
  (xdoc::b*
   ((xdoc::ans
     (str::revappend-chars (xdoc::symbol-package-name xdoc::sym) xdoc::ans))
    (xdoc::ans (str::revappend-chars &quot;::&quot; xdoc::ans))
...">revappend-full-symbol</a> (car parents) ans))
      (ans (if (consp (<a class="sym-link system" href="../../axioms.html#def-cddr" data-sym="CDDR">cddr</a> parents))
          (revappend-chars <span class="string">", "</span> ans)
          (revappend-chars <span class="string">" and "</span> ans))))
    (<a class="sym-link local-def" href="#def-revappend-parents" data-sym="REVAPPEND-PARENTS" title="(defun xdoc::revappend-parents (xdoc::parents xdoc::ans)
  (xdoc::b*
   (((when (atom xdoc::parents)) xdoc::ans)
    ((when (atom (cdr xdoc::parents)))
     (xdoc::revappend-full-symbol (car xdoc::parents) xdoc::ans))
...">revappend-parents</a> (cdr parents) ans)))</pre>
  </div>

<div class="form-block function" id="def-render-sym" data-defines="RENDER-SYM" data-references="SYMBOL-PACKAGE-NAME,STRING,QUOTE,CONCATENATE,RENDERED-NAME,INTERN,EQ,IF,SYMBOL-NAME,STR,LET,SYM,DEFUN" data-used-by="TOPIC-TO-RENDERED-TABLE-INIT-1,ACL2-BROKEN-LINKS-ALIST-TO-RENDERED-TABLE-INIT" data-part-name="RENDER-SYM" data-part-args="SYM" data-part-body="SYMBOL-PACKAGE-NAME,STRING,QUOTE,CONCATENATE,RENDERED-NAME,INTERN,EQ,IF,SYM,SYMBOL-NAME,STR,LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="RENDER-SYM">render-sym</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-render-sym" data-sym="RENDER-SYM" title="(defun xdoc::render-sym (xdoc::sym)
  (let ((xdoc::str (symbol-name xdoc::sym)))
    (if (eq (intern xdoc::str &quot;ACL2&quot;) xdoc::sym)
        (xdoc::rendered-name xdoc::str)
        (concatenate &#39;string (xdoc::symbol-package-name xdoc::sym) &quot;::&quot;">render-sym</a>
  (sym)
  (let ((str (symbol-name sym)))
    (if (<a class="sym-link system" href="../../axioms.html#def-eq" data-sym="EQ">eq</a> (<a class="sym-link system" href="../../axioms.html#def-intern" data-sym="INTERN">intern</a> str <span class="string">"ACL2"</span>) sym)
      (rendered-name str)
      (<a class="sym-link system" href="../../axioms.html#def-concatenate" data-sym="CONCATENATE">concatenate</a> '<a class="sym-link system" href="../../axioms.html#def-string" data-sym="STRING">string</a>
        (symbol-package-name sym)
        <span class="string">"::"</span>
        (rendered-name str)))))</pre>
  </div>

<div class="form-block function" id="def-acl2-broken-links-alist-to-rendered-table-init" data-defines="ACL2-BROKEN-LINKS-ALIST-TO-RENDERED-TABLE-INIT" data-references="RENDER-SYM,CAAR,URL,INTERN,ACONS,CDR,T,ENDP,COND,ACC,ALIST,DEFUN" data-used-by="TOPIC-TO-RENDERED-TABLE-INIT" data-part-name="ACL2-BROKEN-LINKS-ALIST-TO-RENDERED-TABLE-INIT" data-part-args="ACC,ALIST" data-part-body="RENDER-SYM,CAAR,URL,INTERN,ACONS,CDR,ACL2-BROKEN-LINKS-ALIST-TO-RENDERED-TABLE-INIT,T,ACC,ALIST,ENDP,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="ACL2-BROKEN-LINKS-ALIST-TO-RENDERED-TABLE-INIT">acl2-broken-links-alist-to-rendered-table-init</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-acl2-broken-links-alist-to-rendered-table-init" data-sym="ACL2-BROKEN-LINKS-ALIST-TO-RENDERED-TABLE-INIT" title="(defun xdoc::acl2-broken-links-alist-to-rendered-table-init
       (xdoc::alist xdoc::acc)
  (cond ((endp xdoc::alist) xdoc::acc)
        (t
         (xdoc::acl2-broken-links-alist-to-rendered-table-init
...">acl2-broken-links-alist-to-rendered-table-init</a>
  (alist acc)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> alist) acc)
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link local-def" href="#def-acl2-broken-links-alist-to-rendered-table-init" data-sym="ACL2-BROKEN-LINKS-ALIST-TO-RENDERED-TABLE-INIT" title="(defun xdoc::acl2-broken-links-alist-to-rendered-table-init
       (xdoc::alist xdoc::acc)
  (cond ((endp xdoc::alist) xdoc::acc)
        (t
         (xdoc::acl2-broken-links-alist-to-rendered-table-init
...">acl2-broken-links-alist-to-rendered-table-init</a> (cdr alist)
        (<a class="sym-link system" href="../../axioms.html#def-acons" data-sym="ACONS">acons</a> (<a class="sym-link system" href="../../axioms.html#def-intern" data-sym="INTERN">intern</a> (url (<a class="sym-link system" href="../../axioms.html#def-caar" data-sym="CAAR">caar</a> alist)) <span class="string">"ACL2"</span>)
          (<a class="sym-link local-def" href="#def-render-sym" data-sym="RENDER-SYM" title="(defun xdoc::render-sym (xdoc::sym)
  (let ((xdoc::str (symbol-name xdoc::sym)))
    (if (eq (intern xdoc::str &quot;ACL2&quot;) xdoc::sym)
        (xdoc::rendered-name xdoc::str)
        (concatenate &#39;string (xdoc::symbol-package-name xdoc::sym) &quot;::&quot;">render-sym</a> (<a class="sym-link system" href="../../axioms.html#def-caar" data-sym="CAAR">caar</a> alist))
          acc)))))</pre>
  </div>

<div class="form-block function" id="def-topic-to-rendered-table-init-1" data-defines="TOPIC-TO-RENDERED-TABLE-INIT-1" data-references="RENDER-SYM,URL,INTERN,ACONS,CAR,ASSOC-EQ,NAME,LET,CDR,T,ENDP,COND,ACC,TABLE,DEFUN" data-used-by="TOPIC-TO-RENDERED-TABLE-INIT" data-part-name="TOPIC-TO-RENDERED-TABLE-INIT-1" data-part-args="ACC,TABLE" data-part-body="RENDER-SYM,URL,INTERN,ACONS,CAR,ASSOC-EQ,NAME,LET,CDR,TOPIC-TO-RENDERED-TABLE-INIT-1,T,ACC,TABLE,ENDP,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="TOPIC-TO-RENDERED-TABLE-INIT-1">topic-to-rendered-table-init-1</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-topic-to-rendered-table-init-1" data-sym="TOPIC-TO-RENDERED-TABLE-INIT-1" title="(defun xdoc::topic-to-rendered-table-init-1 (xdoc::table xdoc::acc)
  (cond ((endp xdoc::table) xdoc::acc)
        (t
         (xdoc::topic-to-rendered-table-init-1 (cdr xdoc::table)
          (let ((xdoc::name (cdr (xdoc::assoc-eq :name (car xdoc::table)))))
...">topic-to-rendered-table-init-1</a>
  (<a class="sym-link system" href="../../axioms.html#def-table" data-sym="TABLE">table</a> acc)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../axioms.html#def-endp" data-sym="ENDP">endp</a> <a class="sym-link system" href="../../axioms.html#def-table" data-sym="TABLE">table</a>) acc)
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link local-def" href="#def-topic-to-rendered-table-init-1" data-sym="TOPIC-TO-RENDERED-TABLE-INIT-1" title="(defun xdoc::topic-to-rendered-table-init-1 (xdoc::table xdoc::acc)
  (cond ((endp xdoc::table) xdoc::acc)
        (t
         (xdoc::topic-to-rendered-table-init-1 (cdr xdoc::table)
          (let ((xdoc::name (cdr (xdoc::assoc-eq :name (car xdoc::table)))))
...">topic-to-rendered-table-init-1</a> (cdr <a class="sym-link system" href="../../axioms.html#def-table" data-sym="TABLE">table</a>)
        (let ((name (cdr (<a class="sym-link system" href="../../axioms.html#def-assoc-eq" data-sym="ASSOC-EQ">assoc-eq</a> <span class="keyword">:name</span> (car <a class="sym-link system" href="../../axioms.html#def-table" data-sym="TABLE">table</a>)))))
          (<a class="sym-link system" href="../../axioms.html#def-acons" data-sym="ACONS">acons</a> (<a class="sym-link system" href="../../axioms.html#def-intern" data-sym="INTERN">intern</a> (url name) <span class="string">"ACL2"</span>)
            (<a class="sym-link local-def" href="#def-render-sym" data-sym="RENDER-SYM" title="(defun xdoc::render-sym (xdoc::sym)
  (let ((xdoc::str (symbol-name xdoc::sym)))
    (if (eq (intern xdoc::str &quot;ACL2&quot;) xdoc::sym)
        (xdoc::rendered-name xdoc::str)
        (concatenate &#39;string (xdoc::symbol-package-name xdoc::sym) &quot;::&quot;">render-sym</a> name)
            acc))))))</pre>
  </div>

<div class="form-block function" id="def-topic-to-rendered-table-init" data-defines="TOPIC-TO-RENDERED-TABLE-INIT" data-references="CONS,F-PUT-GLOBAL,TOPIC-TO-RENDERED-TABLE-INIT-1,MAKE-FAST-ALIST,FAL,UNQUOTE,ACL2-BROKEN-LINKS-ALIST-TO-RENDERED-TABLE-INIT,QUOTEP,NULL,OR,ASSERT$,ALIST0,W,*ACL2-BROKEN-LINKS-ALIST*,DEFINED-CONSTANT,CVAL,LET*,FAST-ALIST-FREE,PROG2$,T,CDR,VALUE,CAR,EQUAL,COND,ALL-XDOC-TOPICS,TABLE,ER-LET*,F-GET-GLOBAL,TOPIC-TO-RENDERED-PAIR,QUOTE,F-BOUNDP-GLOBAL,AND,PAIR,LET,STATE,DEFUN" data-used-by="SUMMARIZE-NEARBY-TOPIC,TOPIC-TO-TEXT" data-part-name="TOPIC-TO-RENDERED-TABLE-INIT" data-part-args="STATE" data-part-body="CONS,F-PUT-GLOBAL,TOPIC-TO-RENDERED-TABLE-INIT-1,MAKE-FAST-ALIST,FAL,UNQUOTE,ACL2-BROKEN-LINKS-ALIST-TO-RENDERED-TABLE-INIT,QUOTEP,NULL,OR,ASSERT$,ALIST0,W,*ACL2-BROKEN-LINKS-ALIST*,DEFINED-CONSTANT,CVAL,LET*,FAST-ALIST-FREE,PROG2$,T,CDR,VALUE,CAR,EQUAL,COND,ALL-XDOC-TOPICS,TABLE,ER-LET*,F-GET-GLOBAL,STATE,TOPIC-TO-RENDERED-PAIR,QUOTE,F-BOUNDP-GLOBAL,AND,PAIR,LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="TOPIC-TO-RENDERED-TABLE-INIT">topic-to-rendered-table-init</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-topic-to-rendered-table-init" data-sym="TOPIC-TO-RENDERED-TABLE-INIT" title="(defun xdoc::topic-to-rendered-table-init (xdoc::state)
  (let ((xdoc::pair
         (and (f-boundp-global &#39;xdoc::topic-to-rendered-pair xdoc::state)
              (f-get-global &#39;xdoc::topic-to-rendered-pair xdoc::state))))
    (er-let* ((xdoc::table (xdoc::all-xdoc-topics xdoc::state)))
...">topic-to-rendered-table-init</a>
  (state)
  (let ((pair (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> (<a class="sym-link system" href="../../axioms.html#def-f-boundp-global" data-sym="F-BOUNDP-GLOBAL">f-boundp-global</a> 'topic-to-rendered-pair state)
         (<a class="sym-link system" href="../../axioms.html#def-f-get-global" data-sym="F-GET-GLOBAL">f-get-global</a> 'topic-to-rendered-pair state))))
    (<a class="sym-link system" href="../../basis-b.html#def-er-let_2A" data-sym="ER-LET*">er-let*</a> ((<a class="sym-link system" href="../../axioms.html#def-table" data-sym="TABLE">table</a> (all-xdoc-topics state)))
      (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((equal (car pair) <a class="sym-link system" href="../../axioms.html#def-table" data-sym="TABLE">table</a>) (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> (cdr pair)))
        (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../axioms.html#def-prog2_24" data-sym="PROG2$">prog2$</a> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> pair (fast-alist-free (cdr pair)))
            (<a class="sym-link system" href="../../axioms.html#def-let_2A" data-sym="LET*">let*</a> ((cval (<a class="sym-link system" href="../../basis-a.html#def-defined-constant" data-sym="DEFINED-CONSTANT">defined-constant</a> '*acl2-broken-links-alist*
                   (<a class="sym-link system" href="../../axioms.html#def-w" data-sym="W">w</a> state))) (alist0 (<a class="sym-link system" href="../../axioms.html#def-assert_24" data-sym="ASSERT$">assert$</a> (<a class="sym-link system" href="../../axioms.html#def-or" data-sym="OR">or</a> (<a class="sym-link system" href="../../axioms.html#def-null" data-sym="NULL">null</a> cval) (<a class="sym-link system" href="../../axioms.html#def-quotep" data-sym="QUOTEP">quotep</a> cval))
                    (<a class="sym-link local-def" href="#def-acl2-broken-links-alist-to-rendered-table-init" data-sym="ACL2-BROKEN-LINKS-ALIST-TO-RENDERED-TABLE-INIT" title="(defun xdoc::acl2-broken-links-alist-to-rendered-table-init
       (xdoc::alist xdoc::acc)
  (cond ((endp xdoc::alist) xdoc::acc)
        (t
         (xdoc::acl2-broken-links-alist-to-rendered-table-init
...">acl2-broken-links-alist-to-rendered-table-init</a> (<a class="sym-link system" href="../../axioms.html#def-unquote" data-sym="UNQUOTE">unquote</a> cval)
                      nil)))
                (fal (make-fast-alist (<a class="sym-link local-def" href="#def-topic-to-rendered-table-init-1" data-sym="TOPIC-TO-RENDERED-TABLE-INIT-1" title="(defun xdoc::topic-to-rendered-table-init-1 (xdoc::table xdoc::acc)
  (cond ((endp xdoc::table) xdoc::acc)
        (t
         (xdoc::topic-to-rendered-table-init-1 (cdr xdoc::table)
          (let ((xdoc::name (cdr (xdoc::assoc-eq :name (car xdoc::table)))))
...">topic-to-rendered-table-init-1</a> <a class="sym-link system" href="../../axioms.html#def-table" data-sym="TABLE">table</a>
                      alist0)))
                (state (<a class="sym-link system" href="../../axioms.html#def-f-put-global" data-sym="F-PUT-GLOBAL">f-put-global</a> 'topic-to-rendered-pair
                    (cons <a class="sym-link system" href="../../axioms.html#def-table" data-sym="TABLE">table</a> fal)
                    state)))
              (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> fal))))))))</pre>
  </div>

<div class="form-block function" id="def-render-images" data-defines="RENDER-IMAGES" data-references="EQUAL,NOT,AND,MV,IGNORE,DECLARE,GETENV$,VAL,ERP,MV-LET,STATE,DEFUN" data-used-by="SUMMARIZE-NEARBY-TOPIC,TOPIC-TO-TEXT" data-part-name="RENDER-IMAGES" data-part-args="STATE" data-part-body="EQUAL,NOT,AND,MV,IGNORE,DECLARE,GETENV$,STATE,VAL,ERP,MV-LET" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="RENDER-IMAGES">render-images</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-render-images" data-sym="RENDER-IMAGES" title="(defun xdoc::render-images (xdoc::state)
  (xdoc::mv-let (xdoc::erp xdoc::val xdoc::state)
   (xdoc::getenv$ &quot;ACL2_DOC_IMAGES&quot; xdoc::state) (declare (ignore xdoc::erp))
   (xdoc::mv (and xdoc::val (not (equal xdoc::val &quot;&quot;))) xdoc::state)))">render-images</a>
  (state)
  (<a class="sym-link system" href="../../axioms.html#def-mv-let" data-sym="MV-LET">mv-let</a> (erp val state)
    (<a class="sym-link system" href="../../axioms.html#def-getenv_24" data-sym="GETENV$">getenv$</a> <span class="string">"ACL2_DOC_IMAGES"</span> state)
    (declare (ignore erp))
    (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> val (<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> (equal val <span class="string">""</span>)))
      state)))</pre>
  </div>

<div class="form-block function" id="def-topic-to-text" data-defines="TOPIC-TO-TEXT" data-references="LIST*,REVAPPEND-PARENTS,PARENTS,CONS,IF,FROM,SYMBOL-NAME,SYMBOL-PACKAGE-NAME,REVAPPEND-CHARS,ANS,TOKENS-TO-TERMINAL,RCHARS-TO-STRING,TERMINAL,MERGE-TEXT,REVERSE,MERGED-TOKENS,RENDER-IMAGES,IMGP,XDOC-TAG-ALIST,TOPIC-TO-RENDERED-TABLE-INIT,TOPIC-TO-RENDERED-TABLE,*NLS*,CAT,WHEN,PARSE-XML,TOKENS,ERR,FAST-ALIST-FREE,-,T,ACONS,PREPROCESS-TOPIC,TEXT,MV,TOPICS-FAL,ASSOC,CDR,NAME,B*,STATE,ALL-TOPICS,X,DEFUN" data-used-by="DISPLAY-TOPIC" data-part-name="TOPIC-TO-TEXT" data-part-args="STATE,ALL-TOPICS,X" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="TOPIC-TO-TEXT">topic-to-text</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-topic-to-text" data-sym="TOPIC-TO-TEXT" title="(defun xdoc::topic-to-text (xdoc::x xdoc::all-topics xdoc::state)
  &quot;Returns (MV TEXT STATE)&quot;
  (xdoc::b*
   ((xdoc::name (cdr (assoc :name xdoc::x)))
    (xdoc::topics-fal (xdoc::topics-fal xdoc::all-topics))
...">topic-to-text</a>
  (x all-topics state)
  <span class="string">"Returns (MV TEXT STATE)"</span>
  (b* ((name (cdr (<a class="sym-link system" href="../../axioms.html#def-assoc" data-sym="ASSOC">assoc</a> <span class="keyword">:name</span> x))) (topics-fal (topics-fal all-topics))
      ((<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> text state) (preprocess-topic (<a class="sym-link system" href="../../axioms.html#def-acons" data-sym="ACONS">acons</a> <span class="keyword">:parents</span> nil x)
          all-topics
          topics-fal
          <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>
          state))
      (<a class="sym-link system" href="../../axioms.html#def--" data-sym="-">-</a> (fast-alist-free topics-fal))
      ((<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> err tokens) (parse-xml text))
      ((when err) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (cat <span class="string">"Error displaying xdoc topic: "</span>
            *nls*
            *nls*
            err
            *nls*
            *nls*)
          state))
      ((<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> err
         topic-to-rendered-table
         state) (<a class="sym-link local-def" href="#def-topic-to-rendered-table-init" data-sym="TOPIC-TO-RENDERED-TABLE-INIT" title="(defun xdoc::topic-to-rendered-table-init (xdoc::state)
  (let ((xdoc::pair
         (and (f-boundp-global &#39;xdoc::topic-to-rendered-pair xdoc::state)
              (f-get-global &#39;xdoc::topic-to-rendered-pair xdoc::state))))
    (er-let* ((xdoc::table (xdoc::all-xdoc-topics xdoc::state)))
...">topic-to-rendered-table-init</a> state))
      ((when err) (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (cat <span class="string">"Error displaying xdoc topic: "</span>
            *nls*
            *nls*
            err
            *nls*
            *nls*)
          state))
      ((<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../axioms.html#def--" data-sym="-">-</a> <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a> state) (<a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a> state))
      ((<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> imgp state) (<a class="sym-link local-def" href="#def-render-images" data-sym="RENDER-IMAGES" title="(defun xdoc::render-images (xdoc::state)
  (xdoc::mv-let (xdoc::erp xdoc::val xdoc::state)
   (xdoc::getenv$ &quot;ACL2_DOC_IMAGES&quot; xdoc::state) (declare (ignore xdoc::erp))
   (xdoc::mv (and xdoc::val (not (equal xdoc::val &quot;&quot;))) xdoc::state)))">render-images</a> state))
      (merged-tokens (<a class="sym-link system" href="../../axioms.html#def-reverse" data-sym="REVERSE">reverse</a> (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> tokens
            nil
            <span class="number">0</span>
            nil
            topic-to-rendered-table
            <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
            imgp
            nil)))
      (terminal (rchars-to-string (<a class="sym-link local-def" href="#def-tokens-to-terminal" data-sym="TOKENS-TO-TERMINAL" title="(defun xdoc::tokens-to-terminal
       (xdoc::tokens xdoc::wrap-col xdoc::open-tags xdoc::list-nums xdoc::acc)
  (xdoc::b*
   (((when (atom xdoc::tokens)) xdoc::acc) (xdoc::tok1 (car xdoc::tokens))
    (rest (cdr xdoc::tokens))
...">tokens-to-terminal</a> merged-tokens
            <span class="number">70</span>
            nil
            nil
            nil)))
      (ans nil)
      (ans (revappend-chars (symbol-package-name name)
          ans))
      (ans (revappend-chars <span class="string">"::"</span> ans))
      (ans (revappend-chars (symbol-name name) ans))
      (from (cdr (<a class="sym-link system" href="../../axioms.html#def-assoc" data-sym="ASSOC">assoc</a> <span class="keyword">:from</span> x)))
      (ans (if from
          (b* ((ans (revappend-chars <span class="string">" -- "</span> ans)) (ans (revappend-chars from ans))
              (ans (cons #\
 ans)))
            ans)
          ans))
      (parents (cdr (<a class="sym-link system" href="../../axioms.html#def-assoc" data-sym="ASSOC">assoc</a> <span class="keyword">:parents</span> x)))
      (ans (if parents
          (b* ((ans (revappend-chars <span class="string">"Parents: "</span> ans)) (ans (<a class="sym-link local-def" href="#def-revappend-parents" data-sym="REVAPPEND-PARENTS" title="(defun xdoc::revappend-parents (xdoc::parents xdoc::ans)
  (xdoc::b*
   (((when (atom xdoc::parents)) xdoc::ans)
    ((when (atom (cdr xdoc::parents)))
     (xdoc::revappend-full-symbol (car xdoc::parents) xdoc::ans))
...">revappend-parents</a> parents ans))
              (ans (<a class="sym-link system" href="../../axioms.html#def-list_2A" data-sym="LIST*">list*</a> #\
 #\. ans)))
            ans)
          ans))
      (ans (cons #\
 ans))
      (ans (revappend-chars terminal ans))
      (ans (cons #\
 ans)))
    (<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> (rchars-to-string ans) state)))</pre>
  </div>

<div class="form-block function" id="def-warn-on-missing-topic-names" data-defines="WARN-ON-MISSING-TOPIC-NAMES" data-references="TOGGLE-INHIBIT-WARNING,REMOVE-DUPLICATES-EQUAL,REVERSE,DEFAULT-STATE-VARS,XDOC,WARNING$-CW0,AND,WORMHOLE-DATA,DATA,LET,WHS,LAMBDA,XDOC-MISSING-LINK,QUOTE,WORMHOLE-EVAL,T,WARNING-OFF-P,COND,STATE,DEFUN" data-used-by="DISPLAY-TOPIC" data-part-name="WARN-ON-MISSING-TOPIC-NAMES" data-part-args="STATE" data-part-body="TOGGLE-INHIBIT-WARNING,REMOVE-DUPLICATES-EQUAL,REVERSE,DEFAULT-STATE-VARS,XDOC,WARNING$-CW0,AND,WORMHOLE-DATA,DATA,LET,WHS,LAMBDA,XDOC-MISSING-LINK,QUOTE,WORMHOLE-EVAL,T,STATE,WARNING-OFF-P,COND" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="WARN-ON-MISSING-TOPIC-NAMES">warn-on-missing-topic-names</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-warn-on-missing-topic-names" data-sym="WARN-ON-MISSING-TOPIC-NAMES" title="(defun xdoc::warn-on-missing-topic-names (xdoc::state)
  (cond ((warning-off-p &quot;xdoc-link&quot; xdoc::state) nil)
        (t
         (xdoc::wormhole-eval &#39;xdoc::xdoc-missing-link
          &#39;(lambda (whs)
...">warn-on-missing-topic-names</a>
  (state)
  (<a class="sym-link system" href="../../axioms.html#def-cond" data-sym="COND">cond</a> ((<a class="sym-link system" href="../../basis-a.html#def-warning-off-p" data-sym="WARNING-OFF-P">warning-off-p</a> <span class="string">"xdoc-link"</span> state) nil)
    (<a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a> (<a class="sym-link system" href="../../basis-a.html#def-wormhole-eval" data-sym="WORMHOLE-EVAL">wormhole-eval</a> 'xdoc-missing-link
        '(lambda (whs)
          (let ((data (<a class="sym-link system" href="../../basis-a.html#def-wormhole-data" data-sym="WORMHOLE-DATA">wormhole-data</a> whs)))
            (<a class="sym-link system" href="../../axioms.html#def-and" data-sym="AND">and</a> data
              (warning$-cw0 'xdoc
                nil
                (<a class="sym-link system" href="../../basis-a.html#def-default-state-vars" data-sym="DEFAULT-STATE-VARS">default-state-vars</a> <a class="sym-link system" href="../../axioms.html#def-t" data-sym="T">t</a>)
                <span class="string">"Please note the following broken topic link ~
                        name~#0~[~/s~]: ~&amp;0.  To suppress such warnings: ~x1."</span>
                (<a class="sym-link system" href="../../axioms.html#def-reverse" data-sym="REVERSE">reverse</a> (<a class="sym-link system" href="../../axioms.html#def-remove-duplicates-equal" data-sym="REMOVE-DUPLICATES-EQUAL">remove-duplicates-equal</a> data))
                '(<a class="sym-link system" href="../../axioms.html#def-toggle-inhibit-warning" data-sym="TOGGLE-INHIBIT-WARNING">toggle-inhibit-warning</a> <span class="string">"xdoc-link"</span>)))))
        nil))))</pre>
  </div>

<div class="form-block function" id="def-display-topic" data-defines="DISPLAY-TOPIC" data-references="WARN-ON-MISSING-TOPIC-NAMES,PROG2$,*STANDARD-CO*,PRINC$,TOPIC-TO-TEXT,TEXT,MV,B*,STATE,ALL-TOPICS,X,DEFUN" data-used-by="COLON-XDOC-FN" data-part-name="DISPLAY-TOPIC" data-part-args="STATE,ALL-TOPICS,X" data-part-body="WARN-ON-MISSING-TOPIC-NAMES,PROG2$,*STANDARD-CO*,PRINC$,ALL-TOPICS,X,TOPIC-TO-TEXT,STATE,TEXT,MV,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="DISPLAY-TOPIC">display-topic</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-display-topic" data-sym="DISPLAY-TOPIC" title="(defun xdoc::display-topic (xdoc::x xdoc::all-topics xdoc::state)
  (xdoc::b*
   (((xdoc::mv xdoc::text xdoc::state)
     (xdoc::topic-to-text xdoc::x xdoc::all-topics xdoc::state))
    (xdoc::state (xdoc::princ$ xdoc::text xdoc::*standard-co* xdoc::state)))">display-topic</a>
  (x all-topics state)
  (b* (((<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> text state) (<a class="sym-link local-def" href="#def-topic-to-text" data-sym="TOPIC-TO-TEXT" title="(defun xdoc::topic-to-text (xdoc::x xdoc::all-topics xdoc::state)
  &quot;Returns (MV TEXT STATE)&quot;
  (xdoc::b*
   ((xdoc::name (cdr (assoc :name xdoc::x)))
    (xdoc::topics-fal (xdoc::topics-fal xdoc::all-topics))
...">topic-to-text</a> x all-topics state)) (state (<a class="sym-link system" href="../../axioms.html#def-princ_24" data-sym="PRINC$">princ$</a> text <a class="sym-link system" href="../../axioms.html#def-_2Astandard-co_2A" data-sym="*STANDARD-CO*">*standard-co*</a> state)))
    (<a class="sym-link system" href="../../axioms.html#def-prog2_24" data-sym="PROG2$">prog2$</a> (<a class="sym-link local-def" href="#def-warn-on-missing-topic-names" data-sym="WARN-ON-MISSING-TOPIC-NAMES" title="(defun xdoc::warn-on-missing-topic-names (xdoc::state)
  (cond ((warning-off-p &quot;xdoc-link&quot; xdoc::state) nil)
        (t
         (xdoc::wormhole-eval &#39;xdoc::xdoc-missing-link
          &#39;(lambda (whs)
...">warn-on-missing-topic-names</a> state)
      state)))</pre>
  </div>

<div class="form-block function" id="def-summarize-nearby-topic" data-defines="SUMMARIZE-NEARBY-TOPIC" data-references="PREFIX-LINES,SYMBOL-NAME,SYMBOL-PACKAGE-NAME,TOKENS-TO-TERMINAL,RCHARS-TO-STRING,TERMINAL,MERGE-TEXT,REVERSE,MERGED-TOKENS,RENDER-IMAGES,IMGP,XDOC-TAG-ALIST,-,TOPIC-TO-RENDERED-TABLE-INIT,TOPIC-TO-RENDERED-TABLE,NEWLINE,*STANDARD-CO*,PRINC$,CW,WHEN,PARSE-XML,TOKENS,ERR,PRINTTREE->STR,PREPROCESS-MAIN,SHORT-ACC,MV,SHORT,BASE-PKG,ASSOC,CDR,NAME,B*,STATE,X,DEFUN" data-used-by="SUMMARIZE-NEARBY-TOPICS" data-part-name="SUMMARIZE-NEARBY-TOPIC" data-part-args="STATE,X" data-part-body="PREFIX-LINES,SYMBOL-NAME,SYMBOL-PACKAGE-NAME,TOKENS-TO-TERMINAL,RCHARS-TO-STRING,TERMINAL,MERGE-TEXT,REVERSE,MERGED-TOKENS,RENDER-IMAGES,IMGP,XDOC-TAG-ALIST,-,TOPIC-TO-RENDERED-TABLE-INIT,TOPIC-TO-RENDERED-TABLE,NEWLINE,*STANDARD-CO*,PRINC$,CW,WHEN,PARSE-XML,TOKENS,ERR,PRINTTREE->STR,PREPROCESS-MAIN,STATE,SHORT-ACC,MV,SHORT,BASE-PKG,X,ASSOC,CDR,NAME,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="SUMMARIZE-NEARBY-TOPIC">summarize-nearby-topic</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-summarize-nearby-topic" data-sym="SUMMARIZE-NEARBY-TOPIC" title="(defun xdoc::summarize-nearby-topic (xdoc::x xdoc::state)
  (xdoc::b*
   ((xdoc::name (cdr (assoc :name xdoc::x)))
    (xdoc::base-pkg (cdr (assoc :base-pkg xdoc::x)))
    (xdoc::short (cdr (assoc :short xdoc::x)))
...">summarize-nearby-topic</a>
  (x state)
  (b* ((name (cdr (<a class="sym-link system" href="../../axioms.html#def-assoc" data-sym="ASSOC">assoc</a> <span class="keyword">:name</span> x))) (base-pkg (cdr (<a class="sym-link system" href="../../axioms.html#def-assoc" data-sym="ASSOC">assoc</a> <span class="keyword">:base-pkg</span> x)))
      (short (cdr (<a class="sym-link system" href="../../axioms.html#def-assoc" data-sym="ASSOC">assoc</a> <span class="keyword">:short</span> x)))
      ((<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> short-acc state) (preprocess-main short
          name
          nil
          nil
          base-pkg
          state
          nil))
      (short (printtree-&gt;str short-acc))
      ((<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> err tokens) (parse-xml short))
      ((when err) (<a class="sym-link system" href="../../axioms.html#def-cw" data-sym="CW">cw</a> <span class="string">"Error summarizing xdoc topic:~%~%"</span>)
        (b* ((state (<a class="sym-link system" href="../../axioms.html#def-princ_24" data-sym="PRINC$">princ$</a> err <a class="sym-link system" href="../../axioms.html#def-_2Astandard-co_2A" data-sym="*STANDARD-CO*">*standard-co*</a> state)) (state (<a class="sym-link system" href="../../basis-a.html#def-newline" data-sym="NEWLINE">newline</a> <a class="sym-link system" href="../../axioms.html#def-_2Astandard-co_2A" data-sym="*STANDARD-CO*">*standard-co*</a> state))
            (state (<a class="sym-link system" href="../../basis-a.html#def-newline" data-sym="NEWLINE">newline</a> <a class="sym-link system" href="../../axioms.html#def-_2Astandard-co_2A" data-sym="*STANDARD-CO*">*standard-co*</a> state)))
          state))
      ((<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> err
         topic-to-rendered-table
         state) (<a class="sym-link local-def" href="#def-topic-to-rendered-table-init" data-sym="TOPIC-TO-RENDERED-TABLE-INIT" title="(defun xdoc::topic-to-rendered-table-init (xdoc::state)
  (let ((xdoc::pair
         (and (f-boundp-global &#39;xdoc::topic-to-rendered-pair xdoc::state)
              (f-get-global &#39;xdoc::topic-to-rendered-pair xdoc::state))))
    (er-let* ((xdoc::table (xdoc::all-xdoc-topics xdoc::state)))
...">topic-to-rendered-table-init</a> state))
      ((when err) (<a class="sym-link system" href="../../axioms.html#def-cw" data-sym="CW">cw</a> <span class="string">"Error summarizing xdoc topic:~%~%"</span>)
        (b* ((state (<a class="sym-link system" href="../../axioms.html#def-princ_24" data-sym="PRINC$">princ$</a> err <a class="sym-link system" href="../../axioms.html#def-_2Astandard-co_2A" data-sym="*STANDARD-CO*">*standard-co*</a> state)) (state (<a class="sym-link system" href="../../basis-a.html#def-newline" data-sym="NEWLINE">newline</a> <a class="sym-link system" href="../../axioms.html#def-_2Astandard-co_2A" data-sym="*STANDARD-CO*">*standard-co*</a> state))
            (state (<a class="sym-link system" href="../../basis-a.html#def-newline" data-sym="NEWLINE">newline</a> <a class="sym-link system" href="../../axioms.html#def-_2Astandard-co_2A" data-sym="*STANDARD-CO*">*standard-co*</a> state)))
          state))
      ((<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> <a class="sym-link system" href="../../axioms.html#def--" data-sym="-">-</a> <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a> state) (<a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a> state))
      ((<a class="sym-link system" href="../../axioms.html#def-mv" data-sym="MV">mv</a> imgp state) (<a class="sym-link local-def" href="#def-render-images" data-sym="RENDER-IMAGES" title="(defun xdoc::render-images (xdoc::state)
  (xdoc::mv-let (xdoc::erp xdoc::val xdoc::state)
   (xdoc::getenv$ &quot;ACL2_DOC_IMAGES&quot; xdoc::state) (declare (ignore xdoc::erp))
   (xdoc::mv (and xdoc::val (not (equal xdoc::val &quot;&quot;))) xdoc::state)))">render-images</a> state))
      (merged-tokens (<a class="sym-link system" href="../../axioms.html#def-reverse" data-sym="REVERSE">reverse</a> (<a class="sym-link local-def" href="#def-merge-text" data-sym="MERGE-TEXT" title="(defun xdoc::merge-text
       (xdoc::x xdoc::acc xdoc::codes xdoc::href xdoc::topic-to-rendered-table
        xdoc::xdoc-tag-alist xdoc::imgp xdoc::tstk)
  (xdoc::b*
   (((when (atom xdoc::x)) xdoc::acc) (xdoc::tok1 (car xdoc::x))
...">merge-text</a> tokens
            nil
            <span class="number">0</span>
            nil
            topic-to-rendered-table
            <a class="sym-link local-def" href="#def-xdoc-tag-alist" data-sym="XDOC-TAG-ALIST" title="(defun xdoc::xdoc-tag-alist (xdoc::state)
  (declare (xdoc::xargs :guard t))
  (xdoc::b*
   (((xdoc::er xdoc::val) (xdoc::getenv$ &quot;ACL2_XDOC_TAGS&quot; xdoc::state)))
   (xdoc::value
...">xdoc-tag-alist</a>
            imgp
            nil)))
      (terminal (rchars-to-string (<a class="sym-link local-def" href="#def-tokens-to-terminal" data-sym="TOKENS-TO-TERMINAL" title="(defun xdoc::tokens-to-terminal
       (xdoc::tokens xdoc::wrap-col xdoc::open-tags xdoc::list-nums xdoc::acc)
  (xdoc::b*
   (((when (atom xdoc::tokens)) xdoc::acc) (xdoc::tok1 (car xdoc::tokens))
    (rest (cdr xdoc::tokens))
...">tokens-to-terminal</a> merged-tokens
            <span class="number">70</span>
            nil
            nil
            nil)))
      (state (<a class="sym-link system" href="../../axioms.html#def-princ_24" data-sym="PRINC$">princ$</a> <span class="string">"    "</span> <a class="sym-link system" href="../../axioms.html#def-_2Astandard-co_2A" data-sym="*STANDARD-CO*">*standard-co*</a> state))
      (state (<a class="sym-link system" href="../../axioms.html#def-princ_24" data-sym="PRINC$">princ$</a> (symbol-package-name name)
          <a class="sym-link system" href="../../axioms.html#def-_2Astandard-co_2A" data-sym="*STANDARD-CO*">*standard-co*</a>
          state))
      (state (<a class="sym-link system" href="../../axioms.html#def-princ_24" data-sym="PRINC$">princ$</a> <span class="string">"::"</span> <a class="sym-link system" href="../../axioms.html#def-_2Astandard-co_2A" data-sym="*STANDARD-CO*">*standard-co*</a> state))
      (state (<a class="sym-link system" href="../../axioms.html#def-princ_24" data-sym="PRINC$">princ$</a> (symbol-name name)
          <a class="sym-link system" href="../../axioms.html#def-_2Astandard-co_2A" data-sym="*STANDARD-CO*">*standard-co*</a>
          state))
      (state (<a class="sym-link system" href="../../basis-a.html#def-newline" data-sym="NEWLINE">newline</a> <a class="sym-link system" href="../../axioms.html#def-_2Astandard-co_2A" data-sym="*STANDARD-CO*">*standard-co*</a> state))
      (state (<a class="sym-link system" href="../../axioms.html#def-princ_24" data-sym="PRINC$">princ$</a> (prefix-lines terminal <span class="string">"      "</span>)
          <a class="sym-link system" href="../../axioms.html#def-_2Astandard-co_2A" data-sym="*STANDARD-CO*">*standard-co*</a>
          state))
      (state (<a class="sym-link system" href="../../basis-a.html#def-newline" data-sym="NEWLINE">newline</a> <a class="sym-link system" href="../../axioms.html#def-_2Astandard-co_2A" data-sym="*STANDARD-CO*">*standard-co*</a> state)))
    state))</pre>
  </div>

<div class="form-block function" id="def-summarize-nearby-topics" data-defines="SUMMARIZE-NEARBY-TOPICS" data-references="CDR,CAR,SUMMARIZE-NEARBY-TOPIC,PPROGN,ATOM,IF,STATE,X,DEFUN" data-used-by="SUGGEST-ALTERNATIVES" data-part-name="SUMMARIZE-NEARBY-TOPICS" data-part-args="STATE,X" data-part-body="CDR,SUMMARIZE-NEARBY-TOPICS,CAR,SUMMARIZE-NEARBY-TOPIC,PPROGN,STATE,X,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="SUMMARIZE-NEARBY-TOPICS">summarize-nearby-topics</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-summarize-nearby-topics" data-sym="SUMMARIZE-NEARBY-TOPICS" title="(defun xdoc::summarize-nearby-topics (xdoc::x xdoc::state)
  (if (atom xdoc::x)
      xdoc::state
      (xdoc::pprogn (xdoc::summarize-nearby-topic (car xdoc::x) xdoc::state)
       (xdoc::summarize-nearby-topics (cdr xdoc::x) xdoc::state))))">summarize-nearby-topics</a>
  (x state)
  (if (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> x)
    state
    (<a class="sym-link system" href="../../axioms.html#def-pprogn" data-sym="PPROGN">pprogn</a> (<a class="sym-link local-def" href="#def-summarize-nearby-topic" data-sym="SUMMARIZE-NEARBY-TOPIC" title="(defun xdoc::summarize-nearby-topic (xdoc::x xdoc::state)
  (xdoc::b*
   ((xdoc::name (cdr (assoc :name xdoc::x)))
    (xdoc::base-pkg (cdr (assoc :base-pkg xdoc::x)))
    (xdoc::short (cdr (assoc :short xdoc::x)))
...">summarize-nearby-topic</a> (car x) state)
      (<a class="sym-link local-def" href="#def-summarize-nearby-topics" data-sym="SUMMARIZE-NEARBY-TOPICS" title="(defun xdoc::summarize-nearby-topics (xdoc::x xdoc::state)
  (if (atom xdoc::x)
      xdoc::state
      (xdoc::pprogn (xdoc::summarize-nearby-topic (car xdoc::x) xdoc::state)
       (xdoc::summarize-nearby-topics (cdr xdoc::x) xdoc::state))))">summarize-nearby-topics</a> (cdr x) state))))</pre>
  </div>

<div class="form-block function" id="def-find-topics" data-defines="FIND-TOPICS" data-references="CDR,CAR,FIND-TOPIC,CONS,ATOM,IF,ALL-TOPICS,NAMES,DEFUN" data-used-by="SUGGEST-ALTERNATIVES" data-part-name="FIND-TOPICS" data-part-args="ALL-TOPICS,NAMES" data-part-body="CDR,FIND-TOPICS,ALL-TOPICS,CAR,FIND-TOPIC,CONS,NAMES,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="FIND-TOPICS">find-topics</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-find-topics" data-sym="FIND-TOPICS" title="(defun xdoc::find-topics (xdoc::names xdoc::all-topics)
  (if (atom xdoc::names)
      nil
      (cons (xdoc::find-topic (car xdoc::names) xdoc::all-topics)
            (xdoc::find-topics (cdr xdoc::names) xdoc::all-topics))))">find-topics</a>
  (names all-topics)
  (if (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> names)
    nil
    (cons (find-topic (car names) all-topics)
      (<a class="sym-link local-def" href="#def-find-topics" data-sym="FIND-TOPICS" title="(defun xdoc::find-topics (xdoc::names xdoc::all-topics)
  (if (atom xdoc::names)
      nil
      (cons (xdoc::find-topic (car xdoc::names) xdoc::all-topics)
            (xdoc::find-topics (cdr xdoc::names) xdoc::all-topics))))">find-topics</a> (cdr names) all-topics))))</pre>
  </div>

<div class="form-block function" id="def-all-topic-names" data-defines="ALL-TOPIC-NAMES" data-references="CAR,ASSOC,CDR,CONS,ATOM,IF,TOPICS,DEFUN" data-used-by="SUGGEST-ALTERNATIVES" data-part-name="ALL-TOPIC-NAMES" data-part-args="TOPICS" data-part-body="ALL-TOPIC-NAMES,CAR,ASSOC,CDR,CONS,TOPICS,ATOM,IF" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="ALL-TOPIC-NAMES">all-topic-names</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-all-topic-names" data-sym="ALL-TOPIC-NAMES" title="(defun xdoc::all-topic-names (xdoc::topics)
  (if (atom xdoc::topics)
      nil
      (cons (cdr (assoc :name (car xdoc::topics)))
            (xdoc::all-topic-names (cdr xdoc::topics)))))">all-topic-names</a>
  (topics)
  (if (<a class="sym-link system" href="../../axioms.html#def-atom" data-sym="ATOM">atom</a> topics)
    nil
    (cons (cdr (<a class="sym-link system" href="../../axioms.html#def-assoc" data-sym="ASSOC">assoc</a> <span class="keyword">:name</span> (car topics)))
      (<a class="sym-link local-def" href="#def-all-topic-names" data-sym="ALL-TOPIC-NAMES" title="(defun xdoc::all-topic-names (xdoc::topics)
  (if (atom xdoc::topics)
      nil
      (cons (cdr (assoc :name (car xdoc::topics)))
            (xdoc::all-topic-names (cdr xdoc::topics)))))">all-topic-names</a> (cdr topics)))))</pre>
  </div>

<div class="form-block function" id="def-suggest-alternatives" data-defines="SUGGEST-ALTERNATIVES" data-references="*STANDARD-CO*,NEWLINE,SUMMARIZE-NEARBY-TOPICS,FIND-TOPICS,SUGGESTED-TOPICS,LEN,EQL,IF,UNLESS,SYMBOL-NAME,SYMBOL-PACKAGE-NAME,CW,-,XDOC-AUTOCORRECT,SUGGESTIONS,ALL-TOPIC-NAMES,TOPIC-NAMES,B*,SYMBOLP,XARGS,DECLARE,STATE,ALL-TOPICS,NAME,DEFUN" data-used-by="COLON-XDOC-FN" data-part-name="SUGGEST-ALTERNATIVES" data-part-args="STATE,ALL-TOPICS,NAME" data-part-declare="NAME,SYMBOLP,XARGS,DECLARE" data-part-body="*STANDARD-CO*,NEWLINE,SUMMARIZE-NEARBY-TOPICS,FIND-TOPICS,SUGGESTED-TOPICS,LEN,EQL,IF,STATE,UNLESS,SYMBOL-NAME,SYMBOL-PACKAGE-NAME,CW,-,NAME,XDOC-AUTOCORRECT,SUGGESTIONS,ALL-TOPICS,ALL-TOPIC-NAMES,TOPIC-NAMES,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="SUGGEST-ALTERNATIVES">suggest-alternatives</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-suggest-alternatives" data-sym="SUGGEST-ALTERNATIVES" title="(defun xdoc::suggest-alternatives (xdoc::name xdoc::all-topics xdoc::state)
  (declare (xdoc::xargs :guard (symbolp xdoc::name)))
  (xdoc::b*
   ((xdoc::topic-names (xdoc::all-topic-names xdoc::all-topics))
    (xdoc::suggestions (xdoc::xdoc-autocorrect xdoc::name xdoc::topic-names))
...">suggest-alternatives</a>
  (name all-topics state)
  (declare (xargs <span class="keyword">:guard</span> (symbolp name)))
  (b* ((topic-names (<a class="sym-link local-def" href="#def-all-topic-names" data-sym="ALL-TOPIC-NAMES" title="(defun xdoc::all-topic-names (xdoc::topics)
  (if (atom xdoc::topics)
      nil
      (cons (cdr (assoc :name (car xdoc::topics)))
            (xdoc::all-topic-names (cdr xdoc::topics)))))">all-topic-names</a> all-topics)) (suggestions (xdoc-autocorrect name topic-names))
      (<a class="sym-link system" href="../../axioms.html#def--" data-sym="-">-</a> (<a class="sym-link system" href="../../axioms.html#def-cw" data-sym="CW">cw</a> <span class="string">"~%Argh!  No documentation for ~s0::~s1.~%"</span>
          (symbol-package-name name)
          (symbol-name name)))
      ((unless suggestions) state)
      (<a class="sym-link system" href="../../axioms.html#def--" data-sym="-">-</a> (if (<a class="sym-link system" href="../../axioms.html#def-eql" data-sym="EQL">eql</a> (<a class="sym-link system" href="../../axioms.html#def-len" data-sym="LEN">len</a> suggestions) <span class="number">1</span>)
          (<a class="sym-link system" href="../../axioms.html#def-cw" data-sym="CW">cw</a> <span class="string">"Hrmn, maybe you wanted this one:~%~%"</span>)
          (<a class="sym-link system" href="../../axioms.html#def-cw" data-sym="CW">cw</a> <span class="string">"Hrmn, maybe you wanted one of these:~%~%"</span>)))
      (suggested-topics (<a class="sym-link local-def" href="#def-find-topics" data-sym="FIND-TOPICS" title="(defun xdoc::find-topics (xdoc::names xdoc::all-topics)
  (if (atom xdoc::names)
      nil
      (cons (xdoc::find-topic (car xdoc::names) xdoc::all-topics)
            (xdoc::find-topics (cdr xdoc::names) xdoc::all-topics))))">find-topics</a> suggestions all-topics))
      (state (<a class="sym-link local-def" href="#def-summarize-nearby-topics" data-sym="SUMMARIZE-NEARBY-TOPICS" title="(defun xdoc::summarize-nearby-topics (xdoc::x xdoc::state)
  (if (atom xdoc::x)
      xdoc::state
      (xdoc::pprogn (xdoc::summarize-nearby-topic (car xdoc::x) xdoc::state)
       (xdoc::summarize-nearby-topics (cdr xdoc::x) xdoc::state))))">summarize-nearby-topics</a> suggested-topics
          state))
      (state (<a class="sym-link system" href="../../basis-a.html#def-newline" data-sym="NEWLINE">newline</a> <a class="sym-link system" href="../../axioms.html#def-_2Astandard-co_2A" data-sym="*STANDARD-CO*">*standard-co*</a> state)))
    state))</pre>
  </div>

<div class="form-block function" id="def-colon-xdoc-fn" data-defines="COLON-XDOC-FN" data-references="DISPLAY-TOPIC,VALUE,SUGGEST-ALTERNATIVES,LET,NOT,WHEN,FIND-TOPIC,XDOC-ENTRY,B*,SYMBOLP,XARGS,DECLARE,STATE,ALL-TOPICS,NAME,DEFUN" data-part-name="COLON-XDOC-FN" data-part-args="STATE,ALL-TOPICS,NAME" data-part-declare="NAME,SYMBOLP,XARGS,DECLARE" data-part-body="DISPLAY-TOPIC,VALUE,SUGGEST-ALTERNATIVES,STATE,LET,NOT,WHEN,ALL-TOPICS,NAME,FIND-TOPIC,XDOC-ENTRY,B*" typeof="SoftwareSourceCode">
    <div class="form-header"><span class="form-name" property="name" data-sym="COLON-XDOC-FN">colon-xdoc-fn</span><span class="form-type">function</span></div>
    <pre class="code" property="text">(<a class="sym-link system" href="../../axioms.html#def-defun" data-sym="DEFUN">defun</a> <a class="sym-link local-def" href="#def-colon-xdoc-fn" data-sym="COLON-XDOC-FN" title="(defun xdoc::colon-xdoc-fn (xdoc::name xdoc::all-topics xdoc::state)
  (declare (xdoc::xargs :guard (symbolp xdoc::name)))
  (xdoc::b*
   ((xdoc::xdoc-entry (xdoc::find-topic xdoc::name xdoc::all-topics))
    ((when (not xdoc::xdoc-entry))
...">colon-xdoc-fn</a>
  (name all-topics state)
  (declare (xargs <span class="keyword">:guard</span> (symbolp name)))
  (b* ((xdoc-entry (find-topic name all-topics)) ((when (<a class="sym-link system" href="../../axioms.html#def-not" data-sym="NOT">not</a> xdoc-entry)) (let ((state (<a class="sym-link local-def" href="#def-suggest-alternatives" data-sym="SUGGEST-ALTERNATIVES" title="(defun xdoc::suggest-alternatives (xdoc::name xdoc::all-topics xdoc::state)
  (declare (xdoc::xargs :guard (symbolp xdoc::name)))
  (xdoc::b*
   ((xdoc::topic-names (xdoc::all-topic-names xdoc::all-topics))
    (xdoc::suggestions (xdoc::xdoc-autocorrect xdoc::name xdoc::topic-names))
...">suggest-alternatives</a> name
               all-topics
               state)))
          (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> <span class="keyword">:invisible</span>)))
      (state (<a class="sym-link local-def" href="#def-display-topic" data-sym="DISPLAY-TOPIC" title="(defun xdoc::display-topic (xdoc::x xdoc::all-topics xdoc::state)
  (xdoc::b*
   (((xdoc::mv xdoc::text xdoc::state)
     (xdoc::topic-to-text xdoc::x xdoc::all-topics xdoc::state))
    (xdoc::state (xdoc::princ$ xdoc::text xdoc::*standard-co* xdoc::state)))">display-topic</a> xdoc-entry
          all-topics
          state)))
    (<a class="sym-link system" href="../../axioms.html#def-value" data-sym="VALUE">value</a> <span class="keyword">:invisible</span>)))</pre>
  </div>


  </main>
  
<script>
// ACL2 Book HTML Documentation - Interactive Features
// Generated by cert2 - build2 system

// State
let activeFilter = null;
let activePartFilter = null;
let activeNameFilter = null;
let currentFontSize = 14;

// Theme management
function getStoredTheme() {
  return localStorage.getItem('acl2-theme') || 'dark';
}

function setTheme(theme) {
  if (theme === 'light') {
    document.documentElement.setAttribute('data-theme', 'light');
    document.getElementById('theme-toggle').textContent = '🌙';
  } else {
    document.documentElement.removeAttribute('data-theme');
    document.getElementById('theme-toggle').textContent = '☀️';
  }
  localStorage.setItem('acl2-theme', theme);
}

function toggleTheme() {
  const current = getStoredTheme();
  setTheme(current === 'dark' ? 'light' : 'dark');
}

// Font size management
function getStoredFontSize() {
  return parseInt(localStorage.getItem('acl2-fontsize') || '14', 10);
}

function setFontSize(size) {
  size = Math.max(10, Math.min(24, size)); // Clamp between 10-24
  currentFontSize = size;
  document.body.style.fontSize = size + 'px';
  localStorage.setItem('acl2-fontsize', size.toString());
}

function increaseFontSize() {
  setFontSize(currentFontSize + 2);
}

function decreaseFontSize() {
  setFontSize(currentFontSize - 2);
}

// Get all form blocks
function getFormBlocks() {
  return document.querySelectorAll('.form-block');
}

// Clear all filters
function clearFilter() {
  activeFilter = null;
  activePartFilter = null;
  activeNameFilter = null;
  getFormBlocks().forEach(b => {
    b.classList.remove('hidden', 'dimmed');
  });
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  const status = document.querySelector('.filter-status');
  status.classList.remove('active');
  // Slide name filter back to original position
  document.querySelector('.controls-left').style.transform = '';
  // Clear the name filter input
  const nameInput = document.getElementById('name-filter');
  if (nameInput) nameInput.value = '';
}

// Show filter status and slide name filter right
function showFilterStatus(text) {
  const status = document.querySelector('.filter-status');
  status.classList.add('active');
  status.querySelector('.filter-text').textContent = text;
  // Slide name filter to the right to make room
  setTimeout(() => {
    const statusWidth = status.offsetWidth;
    document.querySelector('.controls-left').style.transform = `translateX(${statusWidth + 15}px)`;
  }, 10);
}

// Filter to show only forms that define or reference a symbol
function filterBySymbol(symName, showUsedBy) {
  clearFilter();
  activeFilter = symName;
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines;
    const references = (block.dataset.references || '').split(',');
    const usedBy = (block.dataset.usedBy || '').split(',');
    
    let show = false;
    if (showUsedBy) {
      // Show forms that USE this symbol
      show = references.includes(symName) || definesName === symName;
    } else {
      // Show forms that this symbol USES
      show = usedBy.includes(symName) || definesName === symName;
    }
    
    if (show) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering by: ${symName} (${visibleCount} items)`);
}

// Filter by defthm part (term, hints, rule-classes, etc.)
function filterByPart(formId, partName) {
  clearFilter();
  activePartFilter = { formId, partName };
  
  // Get the part's referenced symbols
  // data-part-term becomes dataset.partTerm, data-part-hints becomes dataset.partHints, etc.
  const block = document.getElementById(formId);
  const datasetKey = 'part' + partName.charAt(0).toUpperCase() + partName.slice(1).replace(/-([a-z])/g, (g) => g[1].toUpperCase());
  const partData = block.dataset[datasetKey];
  if (!partData) return;
  
  const partSyms = partData.split(',').filter(s => s);
  
  // Highlight the button
  block.querySelector(`.part-btn[data-part="${partName}"]`).classList.add('active');
  
  // Hide forms not referenced by this part
  getFormBlocks().forEach(b => {
    const definesName = b.dataset.defines;
    if (b.id === formId || partSyms.includes(definesName)) {
      b.classList.remove('hidden');
    } else {
      b.classList.add('hidden');
    }
  });
  
  // Update status
  showFilterStatus(`Filtering ${formId} :${partName} (${partSyms.length} references)`);
}

// Filter by name (substring or regex)
function filterByName(pattern, useRegex) {
  // Clear other filters but keep the input value
  activeFilter = null;
  activePartFilter = null;
  document.querySelectorAll('.part-btn').forEach(b => b.classList.remove('active'));
  
  if (!pattern || pattern.trim() === '') {
    // Empty pattern - show all
    activeNameFilter = null;
    getFormBlocks().forEach(b => b.classList.remove('hidden'));
    const status = document.querySelector('.filter-status');
    status.classList.remove('active');
    document.querySelector('.controls-left').style.transform = '';
    return;
  }
  
  activeNameFilter = pattern;
  
  let matcher;
  let isValidRegex = true;
  
  if (useRegex) {
    try {
      matcher = new RegExp(pattern, 'i');
    } catch (e) {
      // Invalid regex - show error in status and don't filter
      showFilterStatus(`Invalid regex: ${e.message}`);
      return;
    }
  } else {
    // Plain substring match (case-insensitive)
    const lowerPattern = pattern.toLowerCase();
    matcher = { test: (s) => s.toLowerCase().includes(lowerPattern) };
  }
  
  const blocks = getFormBlocks();
  let visibleCount = 0;
  
  blocks.forEach(block => {
    const definesName = block.dataset.defines || '';
    if (matcher.test(definesName)) {
      block.classList.remove('hidden');
      visibleCount++;
    } else {
      block.classList.add('hidden');
    }
  });
  
  // Update status
  const modeText = useRegex ? 'regex' : 'name';
  showFilterStatus(`Filtering by ${modeText}: "${pattern}" (${visibleCount} matches)`);
}

// Click on a name to show what references it
function handleNameClick(symName) {
  if (activeFilter === symName) {
    clearFilter();
  } else {
    filterBySymbol(symName, true);
  }
}

// Navigate to a definition (same file or different)
function navigateTo(symName, file) {
  if (file) {
    // External file - navigate
    window.location.href = file + '.html#def-' + symName.toLowerCase();
  } else {
    // Same file - scroll
    const target = document.getElementById('def-' + symName.toLowerCase());
    if (target) {
      target.scrollIntoView({ behavior: 'smooth', block: 'center' });
      target.classList.add('highlight');
      setTimeout(() => target.classList.remove('highlight'), 400);
    }
  }
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  // Part buttons
  document.querySelectorAll('.part-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const formId = btn.closest('.form-block').id;
      const partName = btn.dataset.part;
      if (activePartFilter && activePartFilter.formId === formId && 
          activePartFilter.partName === partName) {
        clearFilter();
      } else {
        filterByPart(formId, partName);
      }
    });
  });
  
  // Clear filter button
  document.querySelector('.clear-filter').addEventListener('click', clearFilter);
  
  // Name filter input
  const nameFilter = document.getElementById('name-filter');
  const regexToggle = document.getElementById('regex-toggle');
  
  let filterTimeout = null;
  nameFilter.addEventListener('input', () => {
    // Debounce the filter to avoid excessive updates while typing
    clearTimeout(filterTimeout);
    filterTimeout = setTimeout(() => {
      filterByName(nameFilter.value, regexToggle.checked);
    }, 150);
  });
  
  // Re-filter when regex toggle changes
  regexToggle.addEventListener('change', () => {
    if (nameFilter.value) {
      filterByName(nameFilter.value, regexToggle.checked);
    }
  });
  
  // Allow Escape key to clear filter when in input
  nameFilter.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      clearFilter();
      nameFilter.blur();
    }
  });
  
  // Symbol references (old span-based refs)
  document.querySelectorAll('.sym-ref').forEach(ref => {
    ref.addEventListener('click', (e) => {
      e.stopPropagation();
      const sym = ref.dataset.sym;
      const file = ref.dataset.file;
      if (file) {
        navigateTo(sym, file);
      } else {
        handleNameClick(sym);
      }
    });
  });
  
  // Symbol links (new anchor-based links)
  // These use standard <a> tags so navigation happens automatically
  // But we need to clear filters if target would be hidden
  document.querySelectorAll('.sym-link').forEach(link => {
    link.addEventListener('click', (e) => {
      const href = link.getAttribute('href');
      if (href && href.startsWith('#')) {
        // Local link - check if target is hidden by filter
        const targetId = href.substring(1);
        const target = document.getElementById(targetId);
        if (target) {
          // If target is hidden, clear the filter first
          if (target.classList.contains('hidden')) {
            clearFilter();
          }
          // Add highlight effect after a short delay
          setTimeout(() => {
            target.classList.add('highlight');
            setTimeout(() => target.classList.remove('highlight'), 400);
          }, 100);
        }
      }
      // For external links, default behavior handles navigation
    });
  });
  
  // Form names (show what uses them)
  document.querySelectorAll('.form-name').forEach(name => {
    name.addEventListener('click', (e) => {
      handleNameClick(name.dataset.sym);
    });
  });
  
  // Handle hash navigation (when arriving at page with #anchor)
  if (window.location.hash) {
    const target = document.querySelector(window.location.hash);
    if (target) {
      setTimeout(() => {
        target.scrollIntoView({ behavior: 'smooth', block: 'center' });
        target.classList.add('highlight');
        setTimeout(() => target.classList.remove('highlight'), 400);
      }, 200);
    }
  }
  
  // Initialize theme from storage
  setTheme(getStoredTheme());
  
  // Initialize font size from storage
  currentFontSize = getStoredFontSize();
  setFontSize(currentFontSize);
  
  // Theme toggle button
  document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
  
  // Font size buttons
  document.getElementById('font-larger').addEventListener('click', increaseFontSize);
  document.getElementById('font-smaller').addEventListener('click', decreaseFontSize);
});

</script>

</body>
</html>